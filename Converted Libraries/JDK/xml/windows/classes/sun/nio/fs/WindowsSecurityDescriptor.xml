<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.fs">
        <import package="java.nio.file.ProviderMismatchException"/>
        <import package="java.nio.file.attribute"/>
        <import package="java.util"/>
        <import package="java.io.IOException"/>
        <import package="sun.misc.Unsafe"/>
        <import package="sun.nio.fs.WindowsNativeDispatcher"/>
        <import package="sun.nio.fs.WindowsConstants"/>
        <class name="WindowsSecurityDescriptor" line="9">
            <javadoc line="9">
                A SecurityDescriptor for use when setting a file&apos;s ACL or creating a file
                  with an initial ACL.                
            </javadoc>
            <declaration name="unsafe" type="Unsafe" line="14"/>
            <declaration name="SIZEOF_ACL" type="short" line="15"/>
            <javadoc line="15">
                typedef struct _ACL {
                  BYTE  AclRevision;
                  BYTE  Sbz1;
                  WORD  AclSize;
                  WORD  AceCount;
                  WORD  Sbz2;
                  } ACL;
                  typedef struct _ACE_HEADER {
                  BYTE AceType;
                  BYTE AceFlags;
                  WORD AceSize;
                  } ACE_HEADER;
                  typedef struct _ACCESS_ALLOWED_ACE {
                  ACE_HEADER Header;
                  ACCESS_MASK Mask;
                  DWORD SidStart;
                  } ACCESS_ALLOWED_ACE;
                  typedef struct _ACCESS_DENIED_ACE {
                  ACE_HEADER Header;
                  ACCESS_MASK Mask;
                  DWORD SidStart;
                  } ACCESS_DENIED_ACE;
                  typedef struct _SECURITY_DESCRIPTOR {
                  BYTE  Revision;
                  BYTE  Sbz1;
                  SECURITY_DESCRIPTOR_CONTROL Control;
                  PSID Owner;
                  PSID Group;
                  PACL Sacl;
                  PACL Dacl;
                  } SECURITY_DESCRIPTOR;                
            </javadoc>
            <declaration name="SIZEOF_ACCESS_ALLOWED_ACE" type="short" line="49"/>
            <declaration name="SIZEOF_ACCESS_DENIED_ACE" type="short" line="50"/>
            <declaration name="SIZEOF_SECURITY_DESCRIPTOR" type="short" line="51"/>
            <declaration name="OFFSETOF_TYPE" type="short" line="52"/>
            <declaration name="OFFSETOF_FLAGS" type="short" line="53"/>
            <declaration name="OFFSETOF_ACCESS_MASK" type="short" line="54"/>
            <declaration name="OFFSETOF_SID" type="short" line="55"/>
            <declaration name="NULL_DESCRIPTOR" type="WindowsSecurityDescriptor" line="56"/>
            <declaration name="sidList" type="List&lt;Long&gt;" line="57"/>
            <declaration name="aclBuffer" type="NativeBuffer" line="58"/>
            <javadoc line="59">
                Creates the &quot;null&quot; SecurityDescriptor                
            </javadoc>
            <method name="WindowsSecurityDescriptor" type="constructor" line="62"/>
            <javadoc line="67">
                Creates a SecurityDescriptor from the given ACL                
            </javadoc>
            <method name="WindowsSecurityDescriptor" type="constructor" line="70">
                <params>
                    <param name="acl" type="List<AclEntry>"/>
                </params>
                <declaration name="initialized" type="boolean" line="71"/>
                <scope line="74">
                    <declaration name="size" type="int" line="75"/>
                    <scope line="76">
                        <declaration name="user" type="UserPrincipal" line="77"/>
                        <declaration name="sidString" type="String" line="79"/>
                        <scope line="80">
                            <declaration name="pSid" type="long" line="81"/>
                        </scope>
                        <scope line="85"/>
                    </scope>
                    <declaration name="i" type="int" line="92"/>
                    <scope line="93">
                        <declaration name="entry" type="AclEntry" line="94"/>
                        <declaration name="pSid" type="long" line="95"/>
                        <scope line="96"/>
                        <scope line="99"/>
                    </scope>
                </scope>
                <scope line="108"/>
                <scope line="111"/>
            </method>
            <javadoc line="115">
                Releases memory associated with SecurityDescriptor                
            </javadoc>
            <method name="release" type="void" line="118">
                <scope line="121">
                    <scope line="122"/>
                </scope>
            </method>
            <javadoc line="127">
                Returns address of SecurityDescriptor                
            </javadoc>
            <method name="address" type="long" line="130"/>
            <method name="decode" type="AclEntry" line="133">
                <params>
                    <param name="aceAddress" type="long"/>
                </params>
                <declaration name="aceType" type="byte" line="134"/>
                <declaration name="type" type="AclEntryType" line="136"/>
                <scope line="137"/>
                <scope line="140"/>
                <declaration name="aceFlags" type="byte" line="143"/>
                <declaration name="flags" type="Set&lt;AclEntryFlag&gt;" line="144"/>
                <declaration name="mask" type="int" line="149"/>
                <declaration name="perms" type="Set&lt;AclEntryPermission&gt;" line="150"/>
                <declaration name="sidAddress" type="long" line="165"/>
                <declaration name="user" type="UserPrincipal" line="166"/>
            </method>
            <method name="encode" type="void" line="169">
                <params>
                    <param name="ace" type="AclEntry"/>
                    <param name="sidAddress" type="long"/>
                    <param name="aclAddress" type="long"/>
                </params>
                <declaration name="allow" type="boolean" line="171"/>
                <declaration name="aceMask" type="Set&lt;AclEntryPermission&gt;" line="172"/>
                <declaration name="mask" type="int" line="173"/>
                <declaration name="aceFlags" type="Set&lt;AclEntryFlag&gt;" line="188"/>
                <declaration name="flags" type="byte" line="189"/>
                <scope line="194"/>
                <scope line="197"/>
            </method>
            <javadoc line="201">
                Creates a security descriptor with a DACL representing the given ACL.                
            </javadoc>
            <method name="create" type="WindowsSecurityDescriptor" line="204">
                <params>
                    <param name="acl" type="List<AclEntry>"/>
                </params>
            </method>
            <javadoc line="207">
                Processes the array of attributes looking for the attribute &quot;acl:acl&quot;.
                  Returns security descriptor representing the ACL or the &quot;null&quot; security
                  descriptor if the attribute is not in the array.                
            </javadoc>
            <method name="fromAttribute" type="WindowsSecurityDescriptor" line="212">
                <params>
                    <param name="attrs" type="FileAttribute<?>"/>
                </params>
                <declaration name="sd" type="WindowsSecurityDescriptor" line="213"/>
                <scope line="214">
                    <scope line="217">
                        <declaration name="acl" type="List&lt;AclEntry&gt;" line="218"/>
                    </scope>
                    <scope line="221"/>
                </scope>
            </method>
            <javadoc line="227">
                Extracts DACL from security descriptor.                
            </javadoc>
            <method name="getAcl" type="List<AclEntry>" line="230">
                <params>
                    <param name="pSecurityDescriptor" type="long"/>
                </params>
                <declaration name="aclAddress" type="long" line="231"/>
                <declaration name="aceCount" type="int" line="232"/>
                <scope line="233"/>
                <scope line="236">
                    <declaration name="aclInfo" type="AclInformation" line="237"/>
                </scope>
                <declaration name="result" type="ArrayList&lt;AclEntry&gt;" line="240"/>
                <scope line="241">
                    <declaration name="aceAddress" type="long" line="242"/>
                    <declaration name="entry" type="AclEntry" line="243"/>
                </scope>
            </method>
        </class>
    </source>