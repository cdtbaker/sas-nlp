<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.fs">
        <import package="java.nio.file"/>
        <import package="java.io.IOException"/>
        <import package="java.util.concurrent.ExecutionException"/>
        <import package="com.sun.nio.file.ExtendedCopyOption"/>
        <import package="sun.nio.fs.WindowsNativeDispatcher"/>
        <import package="sun.nio.fs.WindowsConstants"/>
        <class name="WindowsFileCopy" line="36">
            <javadoc line="36">
                Utility methods for copying and moving files.                
            </javadoc>
            <method name="WindowsFileCopy" type="constructor" line="41"/>
            <javadoc line="44">
                Copy file from source to target                
            </javadoc>
            <method name="copy" type="void" line="51">
                <params>
                    <param name="source" type="WindowsPath"/>
                    <param name="target" type="WindowsPath"/>
                    <param name="options" type="CopyOption"/>
                </params>
                <comment line="53">
                    map options                    
                </comment>
                <comment line="80">
                    check permissions. If the source file is a symbolic link then
                     later we must also check LinkPermission                    
                </comment>
                <comment line="88">
                    get attributes of source file
                     attempt to get attributes of target file
                     if both files are the same there is nothing to do
                     if target exists and !replace then throw exception                    
                </comment>
                <comment line="103">
                    source attributes                    
                </comment>
                <comment line="110">
                    open target (don&apos;t follow links)                    
                </comment>
                <comment line="117">
                    if both files are the same then nothing to do                    
                </comment>
                <comment line="122">
                    can&apos;t replace file                    
                </comment>
                <comment line="132">
                    ignore                    
                </comment>
                <comment line="139">
                    if source file is a symbolic link then we must check for LinkPermission                    
                </comment>
                <comment line="147">
                    if target exists then delete it.                    
                </comment>
                <comment line="157">
                    ERROR_ALREADY_EXISTS is returned when attempting to delete
                     non-empty directory on SAMBA servers.                    
                </comment>
                <comment line="170">
                    Use CopyFileEx if the file is not a directory or junction                    
                </comment>
                <comment line="177">
                    interruptible copy                    
                </comment>
                <comment line="181">
                    TRUE                    
                </comment>
                <comment line="202">
                    non-interruptible copy                    
                </comment>
                <comment line="210">
                    CopyFileEx does not copy security attributes                    
                </comment>
                <comment line="214">
                    ignore                    
                </comment>
                <comment line="220">
                    copy directory or directory junction                    
                </comment>
                <comment line="235">
                    copy DOS/timestamps attributes                    
                </comment>
                <comment line="248">
                    copy security attributes. If this fail it doesn&apos;t cause the move
                     to fail.                    
                </comment>
                <declaration name="replaceExisting" type="boolean" line="53"/>
                <declaration name="copyAttributes" type="boolean" line="54"/>
                <declaration name="followLinks" type="boolean" line="55"/>
                <declaration name="interruptible" type="boolean" line="56"/>
                <scope line="57">
                    <scope line="58"/>
                    <scope line="62"/>
                    <scope line="66"/>
                    <scope line="70"/>
                </scope>
                <declaration name="sm" type="SecurityManager" line="81"/>
                <scope line="82"/>
                <declaration name="sourceAttrs" type="WindowsFileAttributes" line="92"/>
                <declaration name="targetAttrs" type="WindowsFileAttributes" line="93"/>
                <declaration name="sourceHandle" type="long" line="95"/>
                <scope line="96"/>
                <scope line="98"/>
                <scope line="101">
                    <scope line="103"/>
                    <scope line="105"/>
                    <declaration name="targetHandle" type="long" line="110"/>
                    <scope line="111">
                        <scope line="113">
                            <scope line="117"/>
                            <scope line="122"/>
                        </scope>
                        <scope line="127"/>
                    </scope>
                    <scope line="130"/>
                </scope>
                <scope line="134"/>
                <scope line="139"/>
                <declaration name="sourcePath" type="String" line="143"/>
                <declaration name="targetPath" type="String" line="144"/>
                <scope line="147">
                    <scope line="148">
                        <scope line="149"/>
                        <scope line="151"/>
                    </scope>
                    <scope line="154">
                        <scope line="155">
                            <scope line="160"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="170">
                    <declaration name="flags" type="int" line="171"/>
                    <scope line="175">
                        <anonymous_class line="177">
                            <method name="cancelValue" type="int" line="179">
                                <comment line="181">
                                    TRUE                                    
                                </comment>
                            </method>
                            <method name="implRun" type="void" line="183">
                                <scope line="184"/>
                                <scope line="187"/>
                            </method>
                        </anonymous_class>
                        <declaration name="copyTask" type="Cancellable" line="177"/>
                        <scope line="192"/>
                        <scope line="194">
                            <declaration name="t" type="Throwable" line="195"/>
                        </scope>
                    </scope>
                    <scope line="200">
                        <scope line="202"/>
                        <scope line="204"/>
                    </scope>
                    <scope line="208">
                        <scope line="210"/>
                        <scope line="212"/>
                    </scope>
                </scope>
                <scope line="220">
                    <scope line="221"/>
                    <scope line="223">
                        <declaration name="linkTarget" type="String" line="224"/>
                        <declaration name="flags" type="int" line="225"/>
                    </scope>
                </scope>
                <scope line="230"/>
                <scope line="233">
                    <declaration name="view" type="WindowsFileAttributeViews.Dos" line="235"/>
                    <scope line="237"/>
                    <scope line="239">
                        <scope line="240">
                            <scope line="241"/>
                            <scope line="243"/>
                        </scope>
                    </scope>
                    <scope line="249"/>
                    <scope line="251"/>
                </scope>
            </method>
            <javadoc line="255">
                Move file from source to target                
            </javadoc>
            <method name="move" type="void" line="260">
                <params>
                    <param name="source" type="WindowsPath"/>
                    <param name="target" type="WindowsPath"/>
                    <param name="options" type="CopyOption"/>
                </params>
                <comment line="262">
                    map options                    
                </comment>
                <comment line="275">
                    ignore                    
                </comment>
                <comment line="291">
                    atomic case                    
                </comment>
                <comment line="307">
                    get attributes of source file
                     attempt to get attributes of target file
                     if both files are the same there is nothing to do
                     if target exists and !replace then throw exception                    
                </comment>
                <comment line="322">
                    source attributes                    
                </comment>
                <comment line="329">
                    open target (don&apos;t follow links)                    
                </comment>
                <comment line="336">
                    if both files are the same then nothing to do                    
                </comment>
                <comment line="341">
                    can&apos;t replace file                    
                </comment>
                <comment line="351">
                    ignore                    
                </comment>
                <comment line="358">
                    if target exists then delete it.                    
                </comment>
                <comment line="368">
                    ERROR_ALREADY_EXISTS is returned when attempting to delete
                     non-empty directory on SAMBA servers.                    
                </comment>
                <comment line="381">
                    first try MoveFileEx (no options). If target is on same volume then
                     all attributes (including security attributes) are preserved.                    
                </comment>
                <comment line="391">
                    target is on different volume so use MoveFileEx with copy option                    
                </comment>
                <comment line="398">
                    MoveFileEx does not copy security attributes when moving
                     across volumes.                    
                </comment>
                <comment line="403">
                    ignore                    
                </comment>
                <comment line="408">
                    moving directory or directory-link to another file system                    
                </comment>
                <comment line="411">
                    create new directory or directory junction                    
                </comment>
                <comment line="425">
                    copy timestamps/DOS attributes                    
                </comment>
                <comment line="431">
                    rollback                    
                </comment>
                <comment line="438">
                    copy security attributes. If this fails it doesn&apos;t cause the move
                     to fail.                    
                </comment>
                <comment line="444">
                    delete source                    
                </comment>
                <comment line="448">
                    rollback                    
                </comment>
                <comment line="452">
                    ERROR_ALREADY_EXISTS is returned when attempting to delete
                     non-empty directory on SAMBA servers.                    
                </comment>
            </method>
            <method name="asWin32Path" type="String" line="464">
                <params>
                    <param name="path" type="WindowsPath"/>
                </params>
                <scope line="465"/>
                <scope line="467"/>
            </method>
            <javadoc line="473">
                Copy DACL/owner/group from source to target                
            </javadoc>
            <method name="copySecurityAttributes" type="void" line="480">
                <params>
                    <param name="source" type="WindowsPath"/>
                    <param name="target" type="WindowsPath"/>
                    <param name="followLinks" type="boolean"/>
                </params>
                <comment line="484">
                    may need SeRestorePrivilege to set file owner                    
                </comment>
                <declaration name="path" type="String" line="481"/>
                <declaration name="priv" type="WindowsSecurity.Privilege" line="484"/>
                <scope line="486">
                    <declaration name="request" type="int" line="487"/>
                    <declaration name="buffer" type="NativeBuffer" line="489"/>
                    <scope line="491">
                        <scope line="492"/>
                        <scope line="495"/>
                    </scope>
                    <scope line="498"/>
                </scope>
                <scope line="501"/>
            </method>
            <javadoc line="506">
                Add long path prefix to path if required                
            </javadoc>
            <method name="addPrefixIfNeeded" type="String" line="509">
                <params>
                    <param name="path" type="String"/>
                </params>
                <scope line="510">
                    <scope line="511"/>
                    <scope line="513"/>
                </scope>
            </method>
        </class>
    </source>