<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.fs">
        <import package="java.nio.file"/>
        <import package="java.io.IOException"/>
        <import package="java.util.concurrent.ExecutionException"/>
        <import package="com.sun.nio.file.ExtendedCopyOption"/>
        <import package="sun.nio.fs.WindowsNativeDispatcher"/>
        <import package="sun.nio.fs.WindowsConstants"/>
        <class name="WindowsFileCopy" line="36">
            <javadoc line="36">
                Utility methods for copying and moving files.                
            </javadoc>
            <method name="WindowsFileCopy" type="constructor" line="41"/>
            <javadoc line="44">
                Copy file from source to target                
            </javadoc>
            <method name="copy" type="void" line="51">
                <params>
                    <param name="source" type="WindowsPath"/>
                    <param name="target" type="WindowsPath"/>
                    <param name="options" type="CopyOption"/>
                </params>
                <comment line="52">
                    map options                    
                </comment>
                <comment line="79">
                    check permissions. If the source file is a symbolic link then                    
                </comment>
                <comment line="80">
                    later we must also check LinkPermission                    
                </comment>
                <comment line="87">
                    get attributes of source file                    
                </comment>
                <comment line="88">
                    attempt to get attributes of target file                    
                </comment>
                <comment line="89">
                    if both files are the same there is nothing to do                    
                </comment>
                <comment line="90">
                    if target exists and !replace then throw exception                    
                </comment>
                <comment line="102">
                    source attributes                    
                </comment>
                <comment line="109">
                    open target (don&apos;t follow links)                    
                </comment>
                <comment line="116">
                    if both files are the same then nothing to do                    
                </comment>
                <comment line="121">
                    can&apos;t replace file                    
                </comment>
                <comment line="131">
                    ignore                    
                </comment>
                <comment line="138">
                    if source file is a symbolic link then we must check for LinkPermission                    
                </comment>
                <comment line="146">
                    if target exists then delete it.                    
                </comment>
                <comment line="156">
                    ERROR_ALREADY_EXISTS is returned when attempting to delete                    
                </comment>
                <comment line="157">
                    non-empty directory on SAMBA servers.                    
                </comment>
                <comment line="169">
                    Use CopyFileEx if the file is not a directory or junction                    
                </comment>
                <comment line="176">
                    interruptible copy                    
                </comment>
                <comment line="180">
                    TRUE                    
                </comment>
                <comment line="201">
                    non-interruptible copy                    
                </comment>
                <comment line="209">
                    CopyFileEx does not copy security attributes                    
                </comment>
                <comment line="213">
                    ignore                    
                </comment>
                <comment line="219">
                    copy directory or directory junction                    
                </comment>
                <comment line="234">
                    copy DOS/timestamps attributes                    
                </comment>
                <comment line="247">
                    copy security attributes. If this fail it doesn&apos;t cause the move                    
                </comment>
                <comment line="248">
                    to fail.                    
                </comment>
                <declaration name="replaceExisting" type="boolean" line="53"/>
                <declaration name="copyAttributes" type="boolean" line="54"/>
                <declaration name="followLinks" type="boolean" line="55"/>
                <declaration name="interruptible" type="boolean" line="56"/>
                <scope line="57">
                    <scope line="58"/>
                    <scope line="62"/>
                    <scope line="66"/>
                    <scope line="70"/>
                </scope>
                <declaration name="sm" type="SecurityManager" line="81"/>
                <scope line="82"/>
                <declaration name="sourceAttrs" type="WindowsFileAttributes" line="92"/>
                <declaration name="targetAttrs" type="WindowsFileAttributes" line="93"/>
                <declaration name="sourceHandle" type="long" line="95"/>
                <scope line="96"/>
                <scope line="98"/>
                <scope line="101">
                    <scope line="103"/>
                    <scope line="105"/>
                    <declaration name="targetHandle" type="long" line="110"/>
                    <scope line="111">
                        <scope line="113">
                            <scope line="117"/>
                            <scope line="122"/>
                        </scope>
                        <scope line="127"/>
                    </scope>
                    <scope line="130"/>
                </scope>
                <scope line="134"/>
                <scope line="139"/>
                <declaration name="sourcePath" type="String" line="143"/>
                <declaration name="targetPath" type="String" line="144"/>
                <scope line="147">
                    <scope line="148">
                        <scope line="149"/>
                        <scope line="151"/>
                    </scope>
                    <scope line="154">
                        <scope line="155">
                            <scope line="160"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="170">
                    <declaration name="flags" type="int" line="171"/>
                    <scope line="175">
                        <anonymous_class line="177">
                            <method name="cancelValue" type="int" line="179">
                                <comment line="180">
                                    TRUE                                    
                                </comment>
                            </method>
                            <method name="implRun" type="void" line="183">
                                <scope line="184"/>
                                <scope line="187"/>
                            </method>
                        </anonymous_class>
                        <declaration name="copyTask" type="Cancellable" line="177"/>
                        <scope line="192"/>
                        <scope line="194">
                            <declaration name="t" type="Throwable" line="195"/>
                        </scope>
                    </scope>
                    <scope line="200">
                        <scope line="202"/>
                        <scope line="204"/>
                    </scope>
                    <scope line="208">
                        <scope line="210"/>
                        <scope line="212"/>
                    </scope>
                </scope>
                <scope line="220">
                    <scope line="221"/>
                    <scope line="223">
                        <declaration name="linkTarget" type="String" line="224"/>
                        <declaration name="flags" type="int" line="225"/>
                    </scope>
                </scope>
                <scope line="230"/>
                <scope line="233">
                    <declaration name="view" type="WindowsFileAttributeViews.Dos" line="235"/>
                    <scope line="237"/>
                    <scope line="239">
                        <scope line="240">
                            <scope line="241"/>
                            <scope line="243"/>
                        </scope>
                    </scope>
                    <scope line="249"/>
                    <scope line="251"/>
                </scope>
            </method>
            <javadoc line="255">
                Move file from source to target                
            </javadoc>
            <method name="move" type="void" line="260">
                <params>
                    <param name="source" type="WindowsPath"/>
                    <param name="target" type="WindowsPath"/>
                    <param name="options" type="CopyOption"/>
                </params>
                <comment line="261">
                    map options                    
                </comment>
                <comment line="274">
                    ignore                    
                </comment>
                <comment line="290">
                    atomic case                    
                </comment>
                <comment line="306">
                    get attributes of source file                    
                </comment>
                <comment line="307">
                    attempt to get attributes of target file                    
                </comment>
                <comment line="308">
                    if both files are the same there is nothing to do                    
                </comment>
                <comment line="309">
                    if target exists and !replace then throw exception                    
                </comment>
                <comment line="321">
                    source attributes                    
                </comment>
                <comment line="328">
                    open target (don&apos;t follow links)                    
                </comment>
                <comment line="335">
                    if both files are the same then nothing to do                    
                </comment>
                <comment line="340">
                    can&apos;t replace file                    
                </comment>
                <comment line="350">
                    ignore                    
                </comment>
                <comment line="357">
                    if target exists then delete it.                    
                </comment>
                <comment line="367">
                    ERROR_ALREADY_EXISTS is returned when attempting to delete                    
                </comment>
                <comment line="368">
                    non-empty directory on SAMBA servers.                    
                </comment>
                <comment line="380">
                    first try MoveFileEx (no options). If target is on same volume then                    
                </comment>
                <comment line="381">
                    all attributes (including security attributes) are preserved.                    
                </comment>
                <comment line="390">
                    target is on different volume so use MoveFileEx with copy option                    
                </comment>
                <comment line="397">
                    MoveFileEx does not copy security attributes when moving                    
                </comment>
                <comment line="398">
                    across volumes.                    
                </comment>
                <comment line="402">
                    ignore                    
                </comment>
                <comment line="407">
                    moving directory or directory-link to another file system                    
                </comment>
                <comment line="410">
                    create new directory or directory junction                    
                </comment>
                <comment line="424">
                    copy timestamps/DOS attributes                    
                </comment>
                <comment line="430">
                    rollback                    
                </comment>
                <comment line="437">
                    copy security attributes. If this fails it doesn&apos;t cause the move                    
                </comment>
                <comment line="438">
                    to fail.                    
                </comment>
                <comment line="443">
                    delete source                    
                </comment>
                <comment line="447">
                    rollback                    
                </comment>
                <comment line="451">
                    ERROR_ALREADY_EXISTS is returned when attempting to delete                    
                </comment>
                <comment line="452">
                    non-empty directory on SAMBA servers.                    
                </comment>
                <declaration name="atomicMove" type="boolean" line="262"/>
                <declaration name="replaceExisting" type="boolean" line="263"/>
                <scope line="264">
                    <scope line="265"/>
                    <scope line="269"/>
                    <scope line="273"/>
                </scope>
                <declaration name="sm" type="SecurityManager" line="281"/>
                <scope line="282"/>
                <declaration name="sourcePath" type="String" line="287"/>
                <declaration name="targetPath" type="String" line="288"/>
                <scope line="291">
                    <scope line="292"/>
                    <scope line="294">
                        <scope line="295"/>
                    </scope>
                </scope>
                <declaration name="sourceAttrs" type="WindowsFileAttributes" line="311"/>
                <declaration name="targetAttrs" type="WindowsFileAttributes" line="312"/>
                <declaration name="sourceHandle" type="long" line="314"/>
                <scope line="315"/>
                <scope line="317"/>
                <scope line="320">
                    <scope line="322"/>
                    <scope line="324"/>
                    <declaration name="targetHandle" type="long" line="329"/>
                    <scope line="330">
                        <scope line="332">
                            <scope line="336"/>
                            <scope line="341"/>
                        </scope>
                        <scope line="346"/>
                    </scope>
                    <scope line="349"/>
                </scope>
                <scope line="353"/>
                <scope line="358">
                    <scope line="359">
                        <scope line="360"/>
                        <scope line="362"/>
                    </scope>
                    <scope line="365">
                        <scope line="366">
                            <scope line="371"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="382"/>
                <scope line="385"/>
                <scope line="391">
                    <scope line="392"/>
                    <scope line="394"/>
                    <scope line="399"/>
                    <scope line="401"/>
                </scope>
                <scope line="411">
                    <scope line="412"/>
                    <scope line="414">
                        <declaration name="linkTarget" type="String" line="415"/>
                    </scope>
                </scope>
                <scope line="420"/>
                <declaration name="view" type="WindowsFileAttributeViews.Dos" line="425"/>
                <scope line="427"/>
                <scope line="429">
                    <scope line="431"/>
                    <scope line="433"/>
                </scope>
                <scope line="439"/>
                <scope line="441"/>
                <scope line="444"/>
                <scope line="446">
                    <scope line="448"/>
                    <scope line="450"/>
                    <scope line="455"/>
                </scope>
            </method>
            <method name="asWin32Path" type="String" line="464">
                <params>
                    <param name="path" type="WindowsPath"/>
                </params>
                <scope line="465"/>
                <scope line="467"/>
            </method>
            <javadoc line="473">
                Copy DACL/owner/group from source to target                
            </javadoc>
            <method name="copySecurityAttributes" type="void" line="480">
                <params>
                    <param name="source" type="WindowsPath"/>
                    <param name="target" type="WindowsPath"/>
                    <param name="followLinks" type="boolean"/>
                </params>
                <comment line="483">
                    may need SeRestorePrivilege to set file owner                    
                </comment>
                <declaration name="path" type="String" line="481"/>
                <declaration name="priv" type="WindowsSecurity.Privilege" line="484"/>
                <scope line="486">
                    <declaration name="request" type="int" line="487"/>
                    <declaration name="buffer" type="NativeBuffer" line="489"/>
                    <scope line="491">
                        <scope line="492"/>
                        <scope line="495"/>
                    </scope>
                    <scope line="498"/>
                </scope>
                <scope line="501"/>
            </method>
            <javadoc line="506">
                Add long path prefix to path if required                
            </javadoc>
            <method name="addPrefixIfNeeded" type="String" line="509">
                <params>
                    <param name="path" type="String"/>
                </params>
                <scope line="510">
                    <scope line="511"/>
                    <scope line="513"/>
                </scope>
            </method>
        </class>
    </source>