<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5.internal.tools">
        <import package="sun.security.krb5"/>
        <import package="sun.security.krb5.internal.ktab"/>
        <import package="java.io.IOException"/>
        <import package="java.io.BufferedReader"/>
        <import package="java.io.InputStreamReader"/>
        <import package="java.io.File"/>
        <import package="java.text.DateFormat"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.Date"/>
        <import package="java.util.Locale"/>
        <import package="sun.security.krb5.internal.crypto.EType"/>
        <class name="Ktab" line="44">
            <comment line="55">
                KeyTabAdmin admin;                
            </comment>
            <comment line="58">
                name and directory of key table                
            </comment>
            <comment line="65">
                true if delete without prompt. Default false                
            </comment>
            <comment line="66">
                true if new keys are appended. Default false                
            </comment>
            <comment line="67">
                kvno to delete, -1 all, -2 old. Default -1                
            </comment>
            <comment line="68">
                kvno to add. Default -1, means auto incremented                
            </comment>
            <javadoc line="44">
                This class can execute as a command-line tool to help the user manage
                  entries in the key table.
                  Available functions include list/add/update/delete service key(s).                
                <author>
                    Yanni Zhang                    
                </author>
                <author>
                    Ram Marti                    
                </author>
            </javadoc>
            <declaration name="table" type="KeyTab" line="55"/>
            <declaration name="action" type="char" line="56"/>
            <declaration name="name" type="String" line="57"/>
            <declaration name="principal" type="String" line="58"/>
            <declaration name="showEType" type="boolean" line="59"/>
            <declaration name="showTime" type="boolean" line="60"/>
            <declaration name="etype" type="int" line="61"/>
            <declaration name="password" type="char[]" line="62"/>
            <declaration name="forced" type="boolean" line="64"/>
            <declaration name="append" type="boolean" line="65"/>
            <declaration name="vDel" type="int" line="66"/>
            <declaration name="vAdd" type="int" line="67"/>
            <javadoc line="69">
                The main program that can be invoked at command line.
                  See {@link #printHelp} for usages.                
            </javadoc>
            <method name="main" type="void" line="73">
                <params>
                    <param name="args" type="String[]"/>
                </params>
                <comment line="86">
                    ktab.admin = new KeyTabAdmin();    // use the default keytab.                    
                </comment>
                <declaration name="ktab" type="Ktab" line="74"/>
                <scope line="75"/>
                <scope line="78"/>
                <scope line="80"/>
                <scope line="83">
                    <scope line="84">
                        <scope line="87">
                            <scope line="88"/>
                            <scope line="90"/>
                        </scope>
                    </scope>
                    <scope line="95">
                        <scope line="97"/>
                        <scope line="101"/>
                        <scope line="104">
                            <scope line="105"/>
                            <scope line="107"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="114"/>
                <scope line="117"/>
            </method>
            <javadoc line="136">
                Parses the command line arguments.                
            </javadoc>
            <method name="processArgs" type="void" line="139">
                <params>
                    <param name="args" type="String[]"/>
                </params>
                <comment line="142">
                    Commands (should appear before options):
                       -l
                       -a &lt;princ&gt;
                       -d &lt;princ&gt;
                     Options:
                       -e &lt;etype&gt; (for -d)
                       -e (for -l)
                       -n &lt;kvno&gt;
                       -k &lt;keytab&gt;
                       -t
                       -f
                       -append
                     Optional extra arguments:
                       password for -a
                       [kvno|all|old] for -d                    
                </comment>
                <comment line="163">
                    Commands                    
                </comment>
                <comment line="164">
                    list                    
                </comment>
                <comment line="167">
                    add a new entry to keytab.                    
                </comment>
                <comment line="174">
                    delete entries                    
                </comment>
                <comment line="182">
                    Options                    
                </comment>
                <comment line="184">
                    list etypes                    
                </comment>
                <comment line="186">
                    delete etypes                    
                </comment>
                <comment line="202">
                    kvno for -a                    
                </comment>
                <comment line="215">
                    specify keytab to use                    
                </comment>
                <comment line="226">
                    list timestamps                    
                </comment>
                <comment line="229">
                    force delete, no prompt                    
                </comment>
                <comment line="232">
                    -a, new keys append to file                    
                </comment>
                <comment line="239">
                    optional standalone arguments                    
                </comment>
                <declaration name="argAlreadyAppeared" type="boolean" line="157"/>
                <scope line="158">
                    <scope line="159">
                        <scope line="168"/>
                        <scope line="175"/>
                        <scope line="183"/>
                        <scope line="185">
                            <scope line="186"/>
                            <scope line="189">
                                <scope line="191"/>
                            </scope>
                            <scope line="194"/>
                        </scope>
                        <scope line="197"/>
                        <scope line="202"/>
                        <scope line="205">
                            <scope line="207"/>
                        </scope>
                        <scope line="210"/>
                        <scope line="215"/>
                        <scope line="219"/>
                        <scope line="221"/>
                    </scope>
                    <scope line="238">
                        <scope line="239"/>
                        <scope line="242"/>
                        <scope line="244">
                            <scope line="248">
                                <scope line="249">
                                    <scope line="251"/>
                                </scope>
                                <scope line="254"/>
                            </scope>
                        </scope>
                        <scope line="259"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="267">
                Adds a service key to key table. If the specified key table does not
                  exist, the program will automatically generate
                  a new key table.                
            </javadoc>
            <method name="addEntry" type="void" line="272">
                <comment line="301">
                    admin.addEntry(pname, password);                    
                </comment>
                <comment line="303">
                    clear password                    
                </comment>
                <comment line="304">
                    admin.save();                    
                </comment>
                <declaration name="pname" type="PrincipalName" line="273"/>
                <scope line="274">
                    <scope line="276"/>
                </scope>
                <scope line="279"/>
                <scope line="285">
                    <scope line="286">
                        <declaration name="cis" type="BufferedReader" line="287"/>
                    </scope>
                    <scope line="292"/>
                </scope>
                <scope line="299"/>
                <scope line="309"/>
                <scope line="313"/>
            </method>
            <javadoc line="320">
                Lists key table name and entries in it.                
            </javadoc>
            <method name="listKt" type="void" line="323">
                <declaration name="entries" type="KeyTabEntry[]" line="325"/>
                <scope line="326">
                    <declaration name="output" type="String[][]" line="327"/>
                    <declaration name="column" type="int" line="328"/>
                    <scope line="332">
                        <declaration name="princ" type="String" line="340"/>
                        <scope line="341">
                            <declaration name="e" type="int" line="342"/>
                        </scope>
                        <scope line="345"/>
                    </scope>
                    <declaration name="width" type="int[]" line="349"/>
                    <scope line="350">
                        <scope line="351">
                            <scope line="352"/>
                        </scope>
                    </scope>
                    <scope line="358"/>
                    <scope line="362"/>
                    <scope line="367">
                        <scope line="368"/>
                    </scope>
                </scope>
                <scope line="373"/>
            </method>
            <javadoc line="378">
                Deletes an entry from the key table.                
            </javadoc>
            <method name="deleteEntry" type="void" line="381">
                <comment line="404">
                    no error, the user did not want to delete the entry                    
                </comment>
                <declaration name="pname" type="PrincipalName" line="382"/>
                <scope line="383">
                    <scope line="385"/>
                    <scope line="388">
                        <declaration name="answer" type="String" line="389"/>
                        <declaration name="cis" type="BufferedReader" line="390"/>
                        <scope line="402"/>
                    </scope>
                </scope>
                <scope line="407"/>
                <scope line="412"/>
                <declaration name="count" type="int" line="419"/>
                <scope line="421"/>
                <scope line="425">
                    <scope line="426"/>
                    <scope line="428"/>
                </scope>
            </method>
            <method name="error" type="void" line="438">
                <params>
                    <param name="errors" type="String"/>
                </params>
                <scope line="439"/>
            </method>
            <javadoc line="445">
                Prints out the help information.                
            </javadoc>
            <method name="printHelp" type="void" line="448"/>
        </class>
    </source>