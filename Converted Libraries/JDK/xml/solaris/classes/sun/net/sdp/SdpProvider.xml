<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.net.sdp">
        <import package="sun.net.NetHooks"/>
        <import package="java.net.InetAddress"/>
        <import package="java.net.Inet4Address"/>
        <import package="java.net.UnknownHostException"/>
        <import package="java.util"/>
        <import package="java.io.File"/>
        <import package="java.io.FileDescriptor"/>
        <import package="java.io.IOException"/>
        <import package="java.io.PrintStream"/>
        <import package="java.security.AccessController"/>
        <import package="sun.net.sdp.SdpSupport"/>
        <import package="sun.security.action.GetPropertyAction"/>
        <class name="SdpProvider" line="14">
            <extends class="NetHooks.Provider"/>
            <javadoc line="14">
                A NetHooks provider that converts sockets from the TCP to SDP protocol prior
                  to binding or connecting.                
            </javadoc>
            <declaration name="MAX_PORT" type="int" line="19"/>
            <declaration name="enabled" type="boolean" line="20"/>
            <declaration name="rules" type="List&lt;Rule&gt;" line="21"/>
            <declaration name="log" type="PrintStream" line="22"/>
            <method name="SdpProvider" type="constructor" line="23">
                <declaration name="file" type="String" line="24"/>
                <scope line="25"/>
                <declaration name="list" type="List&lt;Rule&gt;" line="30"/>
                <scope line="31">
                    <scope line="32"/>
                    <scope line="35"/>
                </scope>
                <declaration name="out" type="PrintStream" line="39"/>
                <declaration name="logfile" type="String" line="40"/>
                <scope line="41">
                    <scope line="43">
                        <scope line="44"/>
                        <scope line="47"/>
                    </scope>
                </scope>
            </method>
            <declaration name="Action" type="enum" line="55"/>
            <scope line="55"/>
            <interface name="Rule">
                <method name="match" type="boolean" line="57"/>
            </interface>
            <class name="PortRangeRule" line="59">
                <implements interface="Rule"/>
                <declaration name="action" type="Action" line="60"/>
                <declaration name="portStart" type="int" line="61"/>
                <declaration name="portEnd" type="int" line="62"/>
                <method name="PortRangeRule" type="constructor" line="63">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="portStart" type="int"/>
                        <param name="portEnd" type="int"/>
                    </params>
                </method>
                <method name="action" type="Action" line="68"/>
                <method name="match" type="boolean" line="71">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="address" type="InetAddress"/>
                        <param name="port" type="int"/>
                    </params>
                </method>
            </class>
            <class name="AddressPortRangeRule" line="75">
                <extends class="PortRangeRule"/>
                <declaration name="addressAsBytes" type="byte[]" line="76"/>
                <declaration name="prefixByteCount" type="int" line="77"/>
                <declaration name="mask" type="byte" line="78"/>
                <method name="AddressPortRangeRule" type="constructor" line="79">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="address" type="InetAddress"/>
                        <param name="prefix" type="int"/>
                        <param name="port" type="int"/>
                        <param name="end" type="int"/>
                    </params>
                </method>
                <method name="match" type="boolean" line="85">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="address" type="InetAddress"/>
                        <param name="port" type="int"/>
                    </params>
                    <declaration name="candidate" type="byte[]" line="87"/>
                    <scope line="89"/>
                </method>
            </class>
            <method name="parsePortRange" type="int[]" line="96">
                <params>
                    <param name="s" type="String"/>
                </params>
                <declaration name="pos" type="int" line="97"/>
                <scope line="98">
                    <declaration name="result" type="int[]" line="99"/>
                    <scope line="100">
                        <declaration name="all" type="boolean" line="101"/>
                    </scope>
                    <scope line="105">
                        <declaration name="low" type="String" line="106"/>
                        <declaration name="high" type="String" line="108"/>
                    </scope>
                </scope>
                <scope line="115"/>
            </method>
            <method name="fail" type="void" line="119">
                <params>
                    <param name="msg" type="String"/>
                    <param name="args" type="Object"/>
                </params>
                <declaration name="f" type="Formatter" line="120"/>
            </method>
            <method name="loadRulesFromFile" type="List<Rule>" line="124">
                <params>
                    <param name="file" type="String"/>
                </params>
                <declaration name="scanner" type="Scanner" line="125"/>
                <scope line="126">
                    <declaration name="result" type="List&lt;Rule&gt;" line="127"/>
                    <scope line="128">
                        <declaration name="line" type="String" line="129"/>
                        <declaration name="s" type="String[]" line="131"/>
                        <scope line="132"/>
                        <declaration name="action" type="Action" line="136"/>
                        <scope line="137">
                            <scope line="138"/>
                        </scope>
                        <scope line="143"/>
                        <declaration name="ports" type="int[]" line="147"/>
                        <scope line="148"/>
                        <scope line="152"/>
                        <declaration name="pos" type="int" line="156"/>
                        <scope line="157">
                            <scope line="158">
                                <declaration name="addresses" type="InetAddress[]" line="159"/>
                                <scope line="160">
                                    <declaration name="prefix" type="int" line="161"/>
                                </scope>
                            </scope>
                            <scope line="165">
                                <declaration name="address" type="InetAddress" line="166"/>
                                <declaration name="prefix" type="int" line="167"/>
                                <scope line="168">
                                    <scope line="170"/>
                                    <scope line="173"/>
                                </scope>
                                <scope line="177"/>
                                <scope line="179"/>
                                <scope line="182"/>
                            </scope>
                        </scope>
                        <scope line="188"/>
                    </scope>
                </scope>
                <scope line="195"/>
            </method>
            <method name="convertTcpToSdpIfMatch" type="void" line="199">
                <params>
                    <param name="fdObj" type="FileDescriptor"/>
                    <param name="action" type="Action"/>
                    <param name="address" type="InetAddress"/>
                    <param name="port" type="int"/>
                </params>
                <declaration name="matched" type="boolean" line="200"/>
                <scope line="201">
                    <scope line="202"/>
                </scope>
                <scope line="208">
                    <declaration name="addr" type="String" line="209"/>
                    <scope line="210"/>
                    <scope line="213"/>
                </scope>
            </method>
            <method name="implBeforeTcpBind" type="void" line="218">
                <params>
                    <param name="fdObj" type="FileDescriptor"/>
                    <param name="address" type="InetAddress"/>
                    <param name="port" type="int"/>
                </params>
            </method>
            <method name="implBeforeTcpConnect" type="void" line="221">
                <params>
                    <param name="fdObj" type="FileDescriptor"/>
                    <param name="address" type="InetAddress"/>
                    <param name="port" type="int"/>
                </params>
            </method>
        </class>
    </source>