<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.net.sdp">
        <import package="sun.net.NetHooks"/>
        <import package="java.net.InetAddress"/>
        <import package="java.net.Inet4Address"/>
        <import package="java.net.UnknownHostException"/>
        <import package="java.util"/>
        <import package="java.io.File"/>
        <import package="java.io.FileDescriptor"/>
        <import package="java.io.IOException"/>
        <import package="java.io.PrintStream"/>
        <import package="java.security.AccessController"/>
        <import package="sun.net.sdp.SdpSupport"/>
        <import package="sun.security.action.GetPropertyAction"/>
        <class name="SdpProvider" line="42">
            <extends class="NetHooks.Provider"/>
            <comment line="49">
                maximum port                
            </comment>
            <comment line="52">
                indicates if SDP is enabled and the rules for when the protocol is used                
            </comment>
            <comment line="56">
                logging for debug purposes                
            </comment>
            <comment line="97">
                supported actions                
            </comment>
            <comment line="103">
                a rule for matching a bind or connect request                
            </comment>
            <comment line="108">
                rule to match port[-end]                
            </comment>
            <comment line="129">
                rule to match address[/prefix] port[-end]                
            </comment>
            <comment line="164">
                parses port:[-end]                
            </comment>
            <comment line="193">
                loads rules from the given file
                 Each non-blank/non-comment line must have the format:
                 (&quot;bind&quot; | &quot;connect&quot;) 1*LWSP-char (hostname | ipaddress[&quot;/&quot; prefix])
                     1*LWSP-char (&quot;*&quot; | port) [ &quot;-&quot; (&quot;*&quot; | port) ]                
            </comment>
            <comment line="291">
                converts unbound TCP socket to a SDP socket if it matches the rules                
            </comment>
            <javadoc line="42">
                A NetHooks provider that converts sockets from the TCP to SDP protocol prior
                  to binding or connecting.                
            </javadoc>
            <declaration name="MAX_PORT" type="int" line="49"/>
            <declaration name="enabled" type="boolean" line="52"/>
            <declaration name="rules" type="List&lt;Rule&gt;" line="53"/>
            <declaration name="log" type="PrintStream" line="56"/>
            <method name="SdpProvider" type="constructor" line="58">
                <comment line="60">
                    if this property is not defined then there is nothing to do.                    
                </comment>
                <comment line="69">
                    load configuration file                    
                </comment>
                <comment line="79">
                    check if debugging is enabled                    
                </comment>
                <declaration name="file" type="String" line="60"/>
                <scope line="62"/>
                <declaration name="list" type="List&lt;Rule&gt;" line="69"/>
                <scope line="70">
                    <scope line="71"/>
                    <scope line="73"/>
                </scope>
                <declaration name="out" type="PrintStream" line="79"/>
                <declaration name="logfile" type="String" line="80"/>
                <scope line="82">
                    <scope line="84">
                        <scope line="85"/>
                        <scope line="87"/>
                    </scope>
                </scope>
            </method>
            <interface name="Rule">
                <method name="match" type="boolean" line="104"/>
            </interface>
            <class name="PortRangeRule" line="108">
                <implements interface="Rule"/>
                <declaration name="action" type="Action" line="109"/>
                <declaration name="portStart" type="int" line="110"/>
                <declaration name="portEnd" type="int" line="111"/>
                <method name="PortRangeRule" type="constructor" line="112">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="portStart" type="int"/>
                        <param name="portEnd" type="int"/>
                    </params>
                </method>
                <method name="action" type="Action" line="117"/>
                <method name="match" type="boolean" line="121">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="address" type="InetAddress"/>
                        <param name="port" type="int"/>
                    </params>
                </method>
            </class>
            <class name="AddressPortRangeRule" line="129">
                <extends class="PortRangeRule"/>
                <declaration name="addressAsBytes" type="byte[]" line="130"/>
                <declaration name="prefixByteCount" type="int" line="131"/>
                <declaration name="mask" type="byte" line="132"/>
                <method name="AddressPortRangeRule" type="constructor" line="135">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="address" type="InetAddress"/>
                        <param name="prefix" type="int"/>
                        <param name="port" type="int"/>
                        <param name="end" type="int"/>
                    </params>
                </method>
                <method name="match" type="boolean" line="142">
                    <params>
                        <param name="action" type="Action"/>
                        <param name="address" type="InetAddress"/>
                        <param name="port" type="int"/>
                    </params>
                    <comment line="147">
                        same address type?                        
                    </comment>
                    <comment line="150">
                        check bytes                        
                    </comment>
                    <comment line="155">
                        check remaining bits                        
                    </comment>
                    <declaration name="candidate" type="byte[]" line="145"/>
                    <scope line="150"/>
                </method>
            </class>
            <method name="parsePortRange" type="int[]" line="164">
                <params>
                    <param name="s" type="String"/>
                </params>
                <declaration name="pos" type="int" line="165"/>
                <scope line="166">
                    <declaration name="result" type="int[]" line="167"/>
                    <scope line="168">
                        <declaration name="all" type="boolean" line="169"/>
                    </scope>
                    <scope line="172">
                        <declaration name="low" type="String" line="173"/>
                        <declaration name="high" type="String" line="175"/>
                    </scope>
                </scope>
                <scope line="181"/>
            </method>
            <method name="fail" type="void" line="186">
                <params>
                    <param name="msg" type="String"/>
                    <param name="args" type="Object"/>
                </params>
                <declaration name="f" type="Formatter" line="187"/>
            </method>
            <method name="loadRulesFromFile" type="List<Rule>" line="198">
                <params>
                    <param name="file" type="String"/>
                </params>
                <comment line="206">
                    skip blank lines and comments                    
                </comment>
                <comment line="210">
                    must have 3 fields                    
                </comment>
                <comment line="217">
                    first field is the action (&quot;bind&quot; or &quot;connect&quot;)                    
                </comment>
                <comment line="230">
                    * port[-end]                    
                </comment>
                <comment line="237">
                    match all addresses                    
                </comment>
                <comment line="243">
                    hostname | ipaddress[/prefix]                    
                </comment>
                <comment line="247">
                    hostname or ipaddress (no prefix)                    
                </comment>
                <comment line="256">
                    ipaddress/prefix                    
                </comment>
                <comment line="263">
                    must be 1-31                    
                </comment>
                <comment line="266">
                    must be 1-128                    
                </comment>
                <declaration name="scanner" type="Scanner" line="199"/>
                <scope line="200">
                    <declaration name="result" type="List&lt;Rule&gt;" line="201"/>
                    <scope line="202">
                        <declaration name="line" type="String" line="203"/>
                        <declaration name="s" type="String[]" line="210"/>
                        <scope line="211"/>
                        <declaration name="action" type="Action" line="217"/>
                        <scope line="218">
                            <scope line="219"/>
                        </scope>
                        <scope line="224"/>
                        <declaration name="ports" type="int[]" line="230"/>
                        <scope line="231"/>
                        <scope line="237"/>
                        <declaration name="pos" type="int" line="243"/>
                        <scope line="244">
                            <scope line="245">
                                <declaration name="addresses" type="InetAddress[]" line="247"/>
                                <scope line="248">
                                    <declaration name="prefix" type="int" line="249"/>
                                </scope>
                            </scope>
                            <scope line="254">
                                <declaration name="address" type="InetAddress" line="256"/>
                                <declaration name="prefix" type="int" line="258"/>
                                <scope line="259">
                                    <scope line="261"/>
                                    <scope line="264"/>
                                </scope>
                                <scope line="268"/>
                                <scope line="271"/>
                                <scope line="274"/>
                            </scope>
                        </scope>
                        <scope line="279"/>
                    </scope>
                </scope>
                <scope line="285"/>
            </method>
            <method name="convertTcpToSdpIfMatch" type="void" line="296">
                <params>
                    <param name="fdObj" type="FileDescriptor"/>
                    <param name="action" type="Action"/>
                    <param name="address" type="InetAddress"/>
                    <param name="port" type="int"/>
                </params>
                <declaration name="matched" type="boolean" line="297"/>
                <scope line="298">
                    <scope line="299"/>
                </scope>
                <scope line="305">
                    <declaration name="addr" type="String" line="306"/>
                    <scope line="308"/>
                    <scope line="310"/>
                </scope>
            </method>
            <method name="implBeforeTcpBind" type="void" line="321">
                <params>
                    <param name="fdObj" type="FileDescriptor"/>
                    <param name="address" type="InetAddress"/>
                    <param name="port" type="int"/>
                </params>
            </method>
            <method name="implBeforeTcpConnect" type="void" line="331">
                <params>
                    <param name="fdObj" type="FileDescriptor"/>
                    <param name="address" type="InetAddress"/>
                    <param name="port" type="int"/>
                </params>
            </method>
        </class>
    </source>