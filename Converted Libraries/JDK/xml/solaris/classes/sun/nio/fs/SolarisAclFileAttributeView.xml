<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.fs">
        <import package="java.nio.file"/>
        <import package="java.nio.file.attribute"/>
        <import package="java.util"/>
        <import package="java.io.IOException"/>
        <import package="sun.misc.Unsafe"/>
        <import package="sun.nio.fs.UnixConstants"/>
        <import package="sun.nio.fs.SolarisConstants"/>
        <import package="sun.nio.fs.SolarisNativeDispatcher"/>
        <class name="SolarisAclFileAttributeView" line="39">
            <extends class="AbstractAclFileAttributeView"/>
            <comment line="50">
                Maximum number of entries allowed in an ACL                
            </comment>
            <comment line="299">
                Retrns true if NFSv4 ACLs not enabled on file system                
            </comment>
            <javadoc line="39">
                Solaris implementation of AclFileAttributeView with native support for
                  NFSv4 ACLs on ZFS.                
            </javadoc>
            <declaration name="unsafe" type="Unsafe" line="47"/>
            <declaration name="MAX_ACL_ENTRIES" type="int" line="50"/>
            <declaration name="SIZEOF_ACE_T" type="short" line="52"/>
            <javadoc line="52">
                typedef struct ace {
                  uid_t        a_who;
                  uitn32_t     a_access_mark;
                  uint16_t     a_flags;
                  uint16_t     a_type;
                  } act_t;                
            </javadoc>
            <declaration name="OFFSETOF_UID" type="short" line="61"/>
            <declaration name="OFFSETOF_MASK" type="short" line="62"/>
            <declaration name="OFFSETOF_FLAGS" type="short" line="63"/>
            <declaration name="OFFSETOF_TYPE" type="short" line="64"/>
            <declaration name="file" type="UnixPath" line="66"/>
            <declaration name="followLinks" type="boolean" line="67"/>
            <method name="SolarisAclFileAttributeView" type="constructor" line="69">
                <params>
                    <param name="file" type="UnixPath"/>
                    <param name="followLinks" type="boolean"/>
                </params>
            </method>
            <javadoc line="74">
                Permission checks to access file                
            </javadoc>
            <method name="checkAccess" type="void" line="80">
                <params>
                    <param name="file" type="UnixPath"/>
                    <param name="checkRead" type="boolean"/>
                    <param name="checkWrite" type="boolean"/>
                </params>
                <declaration name="sm" type="SecurityManager" line="81"/>
                <scope line="82"/>
            </method>
            <javadoc line="91">
                Encode the ACL to the given buffer                
            </javadoc>
            <method name="encode" type="void" line="94">
                <params>
                    <param name="acl" type="List&lt;AclEntry&gt;"/>
                    <param name="address" type="long"/>
                </params>
                <comment line="100">
                    map UserPrincipal to uid and flags                    
                </comment>
                <comment line="125">
                    map ACE type                    
                </comment>
                <comment line="144">
                    map permissions                    
                </comment>
                <comment line="176">
                    FIXME - it would be desirable to know here if the file is a
                     directory or not. Solaris returns EINVAL if an ACE has a directory
                     -only flag and the file is not a directory.                    
                </comment>
                <declaration name="offset" type="long" line="95"/>
                <scope line="96">
                    <declaration name="flags" type="int" line="97"/>
                    <declaration name="who" type="UserPrincipal" line="100"/>
                    <declaration name="user" type="UnixUserPrincipals.User" line="103"/>
                    <declaration name="uid" type="int" line="104"/>
                    <scope line="105"/>
                    <scope line="115">
                        <scope line="116"/>
                        <scope line="119"/>
                    </scope>
                    <declaration name="type" type="int" line="125"/>
                    <declaration name="aceMask" type="Set&amp;lt;AclEntryPermission&amp;gt;" line="144"/>
                    <declaration name="mask" type="int" line="145"/>
                    <declaration name="aceFlags" type="Set&amp;lt;AclEntryFlag&amp;gt;" line="178"/>
                </scope>
            </method>
            <javadoc line="197">
                Decode the buffer, returning an ACL                
            </javadoc>
            <method name="decode" type="List&lt;AclEntry&gt;" line="200">
                <params>
                    <param name="address" type="long"/>
                    <param name="n" type="int"/>
                </params>
                <comment line="211">
                    map uid and flags to UserPrincipal                    
                </comment>
                <comment line="223">
                    can be gid                    
                </comment>
                <comment line="288">
                    build the ACL entry and add it to the list                    
                </comment>
            </method>
            <method name="isAclsEnabled" type="boolean" line="299">
                <params>
                    <param name="fd" type="int"/>
                </params>
                <scope line="300">
                    <declaration name="enabled" type="long" line="301"/>
                </scope>
                <scope line="304"/>
            </method>
            <method name="getAcl" type="List&lt;AclEntry&gt;" line="312">
                <comment line="314">
                    permission check                    
                </comment>
                <comment line="317">
                    open file (will fail if file is a link and not following links)                    
                </comment>
                <comment line="322">
                    read ACL and decode it                    
                </comment>
                <comment line="332">
                    keep compiler happy                    
                </comment>
            </method>
            <method name="setAcl" type="void" line="341">
                <params>
                    <param name="acl" type="List&lt;AclEntry&gt;"/>
                </params>
                <comment line="343">
                    permission check                    
                </comment>
                <comment line="346">
                    open file (will fail if file is a link and not following links)                    
                </comment>
                <comment line="349">
                    SECURITY: need to copy list as can change during processing                    
                </comment>
                <declaration name="fd" type="int" line="346"/>
                <scope line="347">
                    <declaration name="n" type="int" line="350"/>
                    <declaration name="address" type="long" line="352"/>
                    <scope line="353"/>
                    <scope line="356">
                        <scope line="357"/>
                    </scope>
                    <scope line="364"/>
                </scope>
                <scope line="367"/>
            </method>
            <method name="getOwner" type="UserPrincipal" line="375">
                <comment line="385">
                    keep compile happy                    
                </comment>
                <scope line="378">
                    <declaration name="attrs" type="UnixFileAttributes" line="379"/>
                </scope>
                <scope line="382"/>
            </method>
            <method name="setOwner" type="void" line="389">
                <params>
                    <param name="owner" type="UserPrincipal"/>
                </params>
                <declaration name="uid" type="int" line="396"/>
                <scope line="398">
                    <scope line="399"/>
                    <scope line="401"/>
                </scope>
                <scope line="404"/>
            </method>
        </class>
    </source>