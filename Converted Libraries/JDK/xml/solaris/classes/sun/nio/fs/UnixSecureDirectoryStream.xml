<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.fs">
        <import package="java.nio.file"/>
        <import package="java.nio.file.attribute"/>
        <import package="java.nio.channels.SeekableByteChannel"/>
        <import package="java.util"/>
        <import package="java.util.concurrent.TimeUnit"/>
        <import package="java.io.IOException"/>
        <import package="sun.nio.fs.UnixNativeDispatcher"/>
        <import package="sun.nio.fs.UnixConstants"/>
        <class name="UnixSecureDirectoryStream" line="38">
            <implements interface="SecureDirectoryStream">
                <type_params>
                    <type_param name="Path"/>
                </type_params>
            </implements>
            <javadoc line="38">
                Unix implementation of SecureDirectoryStream.                
            </javadoc>
            <declaration name="ds" type="UnixDirectoryStream" line="45"/>
            <declaration name="dfd" type="int" line="46"/>
            <method name="UnixSecureDirectoryStream" type="constructor" line="52">
                <params>
                    <param name="dir" type="UnixPath"/>
                    <param name="dp" type="long"/>
                    <param name="dfd" type="int"/>
                    <param name="filter" type="DirectoryStream.Filter&lt;? super Path&gt;"/>
                </params>
            </method>
            <method name="close" type="void" line="60">
                <scope line="62">
                    <scope line="63"/>
                </scope>
                <scope line="66"/>
            </method>
            <method name="iterator" type="Iterator&lt;Path&gt;" line="72"/>
            <method name="getName" type="UnixPath" line="76">
                <params>
                    <param name="obj" type="Path"/>
                </params>
            </method>
            <javadoc line="84">
                Opens sub-directory in this directory                
            </javadoc>
            <method name="newDirectoryStream" type="SecureDirectoryStream&lt;Path&gt;" line="91">
                <params>
                    <param name="obj" type="Path"/>
                    <param name="options" type="LinkOption"/>
                </params>
                <comment line="97">
                    permission check using name resolved against original path of directory                    
                </comment>
                <comment line="108">
                    open directory and create new secure directory stream                    
                </comment>
                <declaration name="file" type="UnixPath" line="92"/>
                <declaration name="child" type="UnixPath" line="93"/>
                <declaration name="followLinks" type="boolean" line="94"/>
                <declaration name="sm" type="SecurityManager" line="97"/>
                <scope line="98"/>
                <scope line="103">
                    <declaration name="newdfd1" type="int" line="108"/>
                    <declaration name="newdfd2" type="int" line="109"/>
                    <declaration name="ptr" type="long" line="110"/>
                    <scope line="111">
                        <declaration name="flags" type="int" line="112"/>
                    </scope>
                    <scope line="118"/>
                </scope>
                <scope line="128"/>
            </method>
            <javadoc line="133">
                Opens file in this directory                
            </javadoc>
            <method name="newByteChannel" type="SeekableByteChannel" line="141">
                <params>
                    <param name="obj" type="Path"/>
                    <param name="options" type="Set&lt;? extends OpenOption&gt;"/>
                    <param name="attrs" type="FileAttribute&lt;?&gt;"/>
                </params>
                <comment line="148">
                    path for permission check                    
                </comment>
                <comment line="159">
                    keep compiler happy                    
                </comment>
                <declaration name="file" type="UnixPath" line="142"/>
                <declaration name="mode" type="int" line="144"/>
                <declaration name="pathToCheck" type="String" line="148"/>
                <scope line="151">
                    <scope line="154"/>
                    <scope line="156"/>
                </scope>
                <scope line="160"/>
            </method>
            <javadoc line="165">
                Deletes file/directory in this directory. Works in a race-free manner
                  when invoked with flags.                
            </javadoc>
            <method name="implDelete" type="void" line="171">
                <params>
                    <param name="obj" type="Path"/>
                    <param name="haveFlags" type="boolean"/>
                    <param name="flags" type="int"/>
                </params>
                <comment line="175">
                    permission check using name resolved against original path of directory                    
                </comment>
                <comment line="187">
                    need file attribute to know if file is directory. This creates
                     a race in that the file may be replaced by a directory or a
                     directory replaced by a file between the time we query the
                     file type and unlink it.                    
                </comment>
                <declaration name="file" type="UnixPath" line="172"/>
                <declaration name="sm" type="SecurityManager" line="175"/>
                <scope line="176"/>
                <scope line="181">
                    <scope line="185">
                        <declaration name="attrs" type="UnixFileAttributes" line="190"/>
                        <scope line="191"/>
                        <scope line="193"/>
                    </scope>
                    <scope line="199"/>
                    <scope line="201">
                        <scope line="202">
                            <scope line="203"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="209"/>
            </method>
            <method name="deleteFile" type="void" line="215">
                <params>
                    <param name="file" type="Path"/>
                </params>
            </method>
            <method name="deleteDirectory" type="void" line="220">
                <params>
                    <param name="dir" type="Path"/>
                </params>
            </method>
            <javadoc line="224">
                Rename/move file in this directory to another (open) directory                
            </javadoc>
            <method name="move" type="void" line="230">
                <params>
                    <param name="fromObj" type="Path"/>
                    <param name="dir" type="SecureDirectoryStream&lt;Path&gt;"/>
                    <param name="toObj" type="Path"/>
                </params>
                <comment line="240">
                    permission check                    
                </comment>
                <comment line="247">
                    lock ordering doesn&apos;t matter                    
                </comment>
                <declaration name="from" type="UnixPath" line="231"/>
                <declaration name="to" type="UnixPath" line="232"/>
                <declaration name="that" type="UnixSecureDirectoryStream" line="237"/>
                <declaration name="sm" type="SecurityManager" line="240"/>
                <scope line="241"/>
                <scope line="248">
                    <scope line="250">
                        <scope line="253"/>
                        <scope line="255">
                            <scope line="256"/>
                        </scope>
                    </scope>
                    <scope line="262"/>
                </scope>
                <scope line="265"/>
            </method>
            <method name="getFileAttributeViewImpl" type="V" line="274">
                <params>
                    <param name="file" type="UnixPath"/>
                    <param name="type" type="Class&lt;V&gt;"/>
                    <param name="followLinks" type="boolean"/>
                </params>
                <comment line="285">
                    TBD - should also support AclFileAttributeView                    
                </comment>
                <declaration name="c" type="Class&amp;lt;?&amp;gt;" line="277"/>
                <scope line="278"/>
                <scope line="281"/>
            </method>
            <javadoc line="288">
                Returns file attribute view bound to this directory                
            </javadoc>
            <method name="getFileAttributeView" type="V" line="292">
                <params>
                    <param name="type" type="Class&lt;V&gt;"/>
                </params>
            </method>
            <javadoc line="296">
                Returns file attribute view bound to dfd/filename.                
            </javadoc>
            <method name="getFileAttributeView" type="V" line="303">
                <params>
                    <param name="obj" type="Path"/>
                    <param name="type" type="Class&lt;V&gt;"/>
                    <param name="options" type="LinkOption"/>
                </params>
                <declaration name="file" type="UnixPath" line="304"/>
                <declaration name="followLinks" type="boolean" line="305"/>
            </method>
            <class name="BasicFileAttributeViewImpl" line="309">
                <implements interface="BasicFileAttributeView"/>
                <javadoc line="309">
                    A BasicFileAttributeView implementation that using a dfd/name pair.                    
                </javadoc>
                <declaration name="file" type="UnixPath" line="315"/>
                <declaration name="followLinks" type="boolean" line="316"/>
                <method name="BasicFileAttributeViewImpl" type="constructor" line="319">
                    <params>
                        <param name="file" type="UnixPath"/>
                        <param name="followLinks" type="boolean"/>
                    </params>
                </method>
                <method name="open" type="int" line="324">
                    <comment line="333">
                        keep compiler happy                        
                    </comment>
                    <declaration name="oflags" type="int" line="325"/>
                    <scope line="328"/>
                    <scope line="330"/>
                </method>
                <method name="checkWriteAccess" type="void" line="336">
                    <declaration name="sm" type="SecurityManager" line="337"/>
                    <scope line="338">
                        <scope line="339"/>
                        <scope line="341"/>
                    </scope>
                </method>
                <method name="name" type="String" line="348"/>
                <method name="readAttributes" type="BasicFileAttributes" line="353">
                    <comment line="373">
                        SECURITY: must return as BasicFileAttribute                        
                    </comment>
                    <comment line="377">
                        keep compiler happy                        
                    </comment>
                    <scope line="355">
                        <declaration name="sm" type="SecurityManager" line="359"/>
                        <scope line="360">
                            <scope line="361"/>
                            <scope line="363"/>
                        </scope>
                        <scope line="367">
                            <declaration name="attrs" type="UnixFileAttributes" line="368"/>
                        </scope>
                        <scope line="374"/>
                    </scope>
                    <scope line="378"/>
                </method>
                <method name="setTimes" type="void" line="388">
                    <params>
                        <param name="lastModifiedTime" type="FileTime"/>
                        <param name="lastAccessTime" type="FileTime"/>
                        <param name="createTime" type="FileTime"/>
                    </params>
                    <comment line="387">
                        ignore                        
                    </comment>
                    <comment line="399">
                        if not changing both attributes then need existing attributes                        
                    </comment>
                    <comment line="411">
                        update times                        
                    </comment>
                    <scope line="392">
                        <declaration name="fd" type="int" line="396"/>
                        <scope line="397">
                            <scope line="399">
                                <scope line="400">
                                    <declaration name="attrs" type="UnixFileAttributes" line="401"/>
                                </scope>
                                <scope line="406"/>
                            </scope>
                            <scope line="411"/>
                            <scope line="415"/>
                        </scope>
                        <scope line="418"/>
                    </scope>
                    <scope line="422"/>
                </method>
            </class>
            <class name="PosixFileAttributeViewImpl" line="428">
                <extends class="BasicFileAttributeViewImpl"/>
                <implements interface="PosixFileAttributeView"/>
                <javadoc line="428">
                    A PosixFileAttributeView implementation that using a dfd/name pair.                    
                </javadoc>
                <method name="PosixFileAttributeViewImpl" type="constructor" line="434">
                    <params>
                        <param name="file" type="UnixPath"/>
                        <param name="followLinks" type="boolean"/>
                    </params>
                </method>
                <method name="checkWriteAndUserAccess" type="void" line="438">
                    <declaration name="sm" type="SecurityManager" line="439"/>
                    <scope line="440"/>
                </method>
                <method name="name" type="String" line="447"/>
                <method name="readAttributes" type="PosixFileAttributes" line="452">
                    <comment line="475">
                        keep compiler happy                        
                    </comment>
                    <declaration name="sm" type="SecurityManager" line="453"/>
                    <scope line="454"/>
                    <scope line="463">
                        <scope line="467">
                            <declaration name="attrs" type="UnixFileAttributes" line="468"/>
                        </scope>
                        <scope line="472"/>
                    </scope>
                    <scope line="476"/>
                </method>
                <method name="setPermissions" type="void" line="484">
                    <params>
                        <param name="perms" type="Set&lt;PosixFilePermission&gt;"/>
                    </params>
                    <comment line="486">
                        permission check                        
                    </comment>
                    <scope line="489">
                        <declaration name="fd" type="int" line="493"/>
                        <scope line="494"/>
                        <scope line="496"/>
                        <scope line="498"/>
                    </scope>
                    <scope line="502"/>
                </method>
                <method name="setOwners" type="void" line="507">
                    <params>
                        <param name="uid" type="int"/>
                        <param name="gid" type="int"/>
                    </params>
                    <comment line="509">
                        permission check                        
                    </comment>
                    <scope line="512">
                        <declaration name="fd" type="int" line="516"/>
                        <scope line="517"/>
                        <scope line="519"/>
                        <scope line="521"/>
                    </scope>
                    <scope line="525"/>
                </method>
                <method name="getOwner" type="UserPrincipal" line="531"/>
                <method name="setOwner" type="void" line="538">
                    <params>
                        <param name="owner" type="UserPrincipal"/>
                    </params>
                    <declaration name="uid" type="int" line="543"/>
                </method>
                <method name="setGroup" type="void" line="550">
                    <params>
                        <param name="group" type="GroupPrincipal"/>
                    </params>
                    <declaration name="gid" type="int" line="553"/>
                </method>
            </class>
        </class>
    </source>