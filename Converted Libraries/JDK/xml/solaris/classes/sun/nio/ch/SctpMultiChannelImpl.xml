<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.ch">
        <import package="java.net.InetAddress"/>
        <import package="java.net.SocketAddress"/>
        <import package="java.net.SocketException"/>
        <import package="java.net.InetSocketAddress"/>
        <import package="java.io.FileDescriptor"/>
        <import package="java.io.IOException"/>
        <import package="java.util.Collections"/>
        <import package="java.util.Map.Entry"/>
        <import package="java.util.Iterator"/>
        <import package="java.util.Set"/>
        <import package="java.util.HashSet"/>
        <import package="java.util.HashMap"/>
        <import package="java.nio.ByteBuffer"/>
        <import package="java.nio.channels.SelectionKey"/>
        <import package="java.nio.channels.ClosedChannelException"/>
        <import package="java.nio.channels.NotYetBoundException"/>
        <import package="java.nio.channels.spi.SelectorProvider"/>
        <import package="com.sun.nio.sctp.AbstractNotificationHandler"/>
        <import package="com.sun.nio.sctp.Association"/>
        <import package="com.sun.nio.sctp.AssociationChangeNotification"/>
        <import package="com.sun.nio.sctp.HandlerResult"/>
        <import package="com.sun.nio.sctp.IllegalReceiveException"/>
        <import package="com.sun.nio.sctp.InvalidStreamException"/>
        <import package="com.sun.nio.sctp.IllegalUnbindException"/>
        <import package="com.sun.nio.sctp.NotificationHandler"/>
        <import package="com.sun.nio.sctp.MessageInfo"/>
        <import package="com.sun.nio.sctp.SctpChannel"/>
        <import package="com.sun.nio.sctp.SctpMultiChannel"/>
        <import package="com.sun.nio.sctp.SctpSocketOption"/>
        <import package="com.sun.nio.sctp.SctpStandardSocketOptions"/>
        <import package="sun.nio.ch.SctpResultContainer"/>
        <class name="SctpMultiChannelImpl" line="59">
            <extends class="SctpMultiChannel"/>
            <comment line="70">
                                
            </comment>
            <comment line="74">
                                
            </comment>
            <comment line="77">
                                
            </comment>
            <comment line="80">
                Lock held by any thread that modifies the state fields declared below                
            </comment>
            <comment line="90">
                                
            </comment>
            <comment line="93">
                                
            </comment>
            <comment line="96">
                                
            </comment>
            <comment line="97">
                                
            </comment>
            <comment line="99">
                                
            </comment>
            <comment line="105">
                                
            </comment>
            <comment line="107">
                If an association has been shutdown mark it for removal after                
            </comment>
            <comment line="116">
                                
            </comment>
            <comment line="762">
                TODO: Add support for ttl and isComplete to both 121 12M
                       SCTP_EOR not yet supported on reference platforms
                       TTL support limited...                
            </comment>
            <comment line="957">
                Use common native implementation shared between                
            </comment>
            <implements interface="SelChImpl"/>
            <javadoc line="59">
                An implementation of SctpMultiChannel                
            </javadoc>
            <declaration name="fd" type="FileDescriptor" line="65"/>
            <declaration name="fdVal" type="int" line="67"/>
            <declaration name="receiverThread" type="long" line="70"/>
            <declaration name="senderThread" type="long" line="71"/>
            <declaration name="receiveLock" type="Object" line="74"/>
            <declaration name="sendLock" type="Object" line="77"/>
            <declaration name="stateLock" type="Object" line="81"/>
            <declaration name="state" type="ChannelState" line="90"/>
            <declaration name="port" type="int" line="93"/>
            <declaration name="localAddresses" type="HashSet&lt;InetSocketAddress&gt;" line="94"/>
            <declaration name="wildcard" type="boolean" line="96"/>
            <declaration name="addressMap" type="HashMap&lt;SocketAddress,Association&gt;" line="99"/>
            <declaration name="associationMap" type="HashMap&lt;Association,Set&lt;SocketAddress&gt;&gt;" line="101"/>
            <declaration name="associationToRemove" type="ThreadLocal&lt;Association&gt;" line="108"/>
            <anonymous_class line="109">
                <method name="initialValue" type="Association" line="110"/>
            </anonymous_class>
            <declaration name="receiveInvoked" type="ThreadLocal&lt;Boolean&gt;" line="116"/>
            <anonymous_class line="117">
                <method name="initialValue" type="Boolean" line="118"/>
            </anonymous_class>
            <method name="SctpMultiChannelImpl" type="constructor" line="124">
                <params>
                    <param name="provider" type="SelectorProvider"/>
                </params>
                <comment line="125">
                    TODO: update provider, remove public modifier                    
                </comment>
                <comment line="127">
                                        
                </comment>
            </method>
            <method name="bind" type="SctpMultiChannel" line="133">
                <params>
                    <param name="local" type="SocketAddress"/>
                    <param name="backlog" type="int"/>
                </params>
                <scope line="134">
                    <scope line="135">
                        <scope line="136">
                            <declaration name="isa" type="InetSocketAddress" line="140"/>
                            <declaration name="sm" type="SecurityManager" line="143"/>
                            <declaration name="boundIsa" type="InetSocketAddress" line="148"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="bindAddress" type="SctpMultiChannel" line="163">
                <params>
                    <param name="address" type="InetAddress"/>
                </params>
            </method>
            <method name="unbindAddress" type="SctpMultiChannel" line="169">
                <params>
                    <param name="address" type="InetAddress"/>
                </params>
            </method>
            <method name="bindUnbindAddress" type="SctpMultiChannel" line="175">
                <params>
                    <param name="address" type="InetAddress"/>
                    <param name="add" type="boolean"/>
                </params>
                <comment line="198">
                                        
                </comment>
                <comment line="199">
                    Verify that there is more than one address                    
                </comment>
                <comment line="216">
                                        
                </comment>
                <scope line="179">
                    <scope line="180">
                        <scope line="181">
                            <scope line="192">
                                <scope line="193">
                                    <scope line="194"/>
                                </scope>
                            </scope>
                            <scope line="198">
                                <declaration name="foundAddress" type="boolean" line="203"/>
                                <scope line="204">
                                    <scope line="205"/>
                                </scope>
                            </scope>
                            <scope line="219">
                                <scope line="220">
                                    <scope line="221"/>
                                </scope>
                            </scope>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="associations" type="Set<Association>" line="235">
                <scope line="236"/>
            </method>
            <method name="isBound" type="boolean" line="246">
                <scope line="247"/>
            </method>
            <method name="ensureOpen" type="void" line="252">
                <scope line="253"/>
            </method>
            <method name="receiverCleanup" type="void" line="259">
                <scope line="260"/>
            </method>
            <method name="senderCleanup" type="void" line="267">
                <scope line="268"/>
            </method>
            <method name="implConfigureBlocking" type="void" line="276">
                <params>
                    <param name="block" type="boolean"/>
                </params>
            </method>
            <method name="implCloseSelectableChannel" type="void" line="281">
                <scope line="282"/>
            </method>
            <method name="getFD" type="FileDescriptor" line="297"/>
            <method name="getFDVal" type="int" line="302"/>
            <javadoc line="306">
                Translates native poll revent ops into a ready operation ops                
            </javadoc>
            <method name="translateReadyOps" type="boolean" line="310">
                <params>
                    <param name="ops" type="int"/>
                    <param name="initialOps" type="int"/>
                    <param name="sk" type="SelectionKeyImpl"/>
                </params>
                <comment line="316">
                    This should only happen if this channel is pre-closed while a
                     selection operation is in progress                    
                </comment>
                <declaration name="intOps" type="int" line="311"/>
                <declaration name="oldOps" type="int" line="312"/>
                <declaration name="newOps" type="int" line="313"/>
                <scope line="315"/>
                <scope line="323"/>
            </method>
            <method name="translateAndUpdateReadyOps" type="boolean" line="342">
                <params>
                    <param name="ops" type="int"/>
                    <param name="sk" type="SelectionKeyImpl"/>
                </params>
            </method>
            <method name="translateAndSetReadyOps" type="boolean" line="347">
                <params>
                    <param name="ops" type="int"/>
                    <param name="sk" type="SelectionKeyImpl"/>
                </params>
            </method>
            <method name="translateAndSetInterestOps" type="void" line="352">
                <params>
                    <param name="ops" type="int"/>
                    <param name="sk" type="SelectionKeyImpl"/>
                </params>
                <declaration name="newOps" type="int" line="353"/>
            </method>
            <method name="kill" type="void" line="362">
                <comment line="372">
                                        
                </comment>
                <scope line="363">
                    <scope line="366"/>
                    <scope line="373"/>
                    <scope line="376"/>
                </scope>
            </method>
            <method name="setOption" type="SctpMultiChannel" line="386">
                <params>
                    <param name="name" type="SctpSocketOption<T>"/>
                    <param name="value" type="T"/>
                    <param name="association" type="Association"/>
                </params>
                <scope line="392">
                    <scope line="394"/>
                    <declaration name="assocId" type="int" line="400"/>
                </scope>
            </method>
            <method name="getOption" type="T" line="409">
                <params>
                    <param name="name" type="SctpSocketOption<T>"/>
                    <param name="association" type="Association"/>
                </params>
                <scope line="415">
                    <scope line="417"/>
                    <declaration name="assocId" type="int" line="423"/>
                </scope>
            </method>
            <class name="DefaultOptionsHolder" line="428">
                <declaration name="defaultOptions" type="Set&lt;SctpSocketOption&lt;?&gt;&gt;" line="429"/>
                <method name="defaultOptions" type="Set<SctpSocketOption<?>>" line="431">
                    <declaration name="set" type="HashSet&lt;SctpSocketOption&lt;?&gt;&gt;" line="432"/>
                </method>
            </class>
            <method name="supportedOptions" type="Set<SctpSocketOption<?>>" line="448"/>
            <method name="receive" type="MessageInfo" line="456">
                <params>
                    <param name="buffer" type="ByteBuffer"/>
                    <param name="attachment" type="T"/>
                    <param name="handler" type="NotificationHandler<T>"/>
                </params>
                <comment line="498">
                                        
                </comment>
                <comment line="500">
                                        
                </comment>
                <comment line="509">
                                        
                </comment>
                <comment line="523">
                                        
                </comment>
                <comment line="526">
                                        
                </comment>
                <comment line="532">
                                        
                </comment>
                <scope line="468">
                    <declaration name="resultContainer" type="SctpResultContainer" line="469"/>
                    <scope line="470">
                        <scope line="472">
                            <declaration name="n" type="int" line="477"/>
                            <scope line="478">
                                <scope line="481"/>
                                <scope line="487"/>
                            </scope>
                            <scope line="491"/>
                            <scope line="497">
                                <scope line="499">
                                    <declaration name="info" type="SctpMessageInfoImpl" line="501"/>
                                    <declaration name="sm" type="SecurityManager" line="505"/>
                                    <scope line="506">
                                        <declaration name="isa" type="InetSocketAddress" line="507"/>
                                        <scope line="508">
                                            <scope line="510"/>
                                            <scope line="513"/>
                                        </scope>
                                    </scope>
                                </scope>
                                <scope line="522"/>
                            </scope>
                            <scope line="526">
                                <scope line="527"/>
                            </scope>
                        </scope>
                    </scope>
                </scope>
                <scope line="536"/>
            </method>
            <method name="receive" type="int" line="546">
                <params>
                    <param name="fd" type="int"/>
                    <param name="dst" type="ByteBuffer"/>
                    <param name="resultContainer" type="SctpResultContainer"/>
                </params>
                <comment line="554">
                                        
                </comment>
                <declaration name="pos" type="int" line="547"/>
                <declaration name="lim" type="int" line="548"/>
                <declaration name="rem" type="int" line="550"/>
                <declaration name="newSize" type="int" line="555"/>
                <declaration name="bb" type="ByteBuffer" line="556"/>
                <scope line="557">
                    <declaration name="n" type="int" line="558"/>
                </scope>
                <scope line="563"/>
            </method>
            <method name="receiveIntoNativeBuffer" type="int" line="573">
                <params>
                    <param name="fd" type="int"/>
                    <param name="resultContainer" type="SctpResultContainer"/>
                    <param name="bb" type="ByteBuffer"/>
                    <param name="rem" type="int"/>
                    <param name="pos" type="int"/>
                </params>
                <declaration name="n" type="int" line="574"/>
            </method>
            <declaration name="internalNotificationHandler" type="InternalNotificationHandler" line="580"/>
            <method name="handleNotificationInternal" type="void" line="584">
                <params>
                    <param name="resultContainer" type="SctpResultContainer"/>
                </params>
            </method>
            <class name="InternalNotificationHandler" line="589">
                <type_params>
                    <type_param name="T"/>
                </type_params>
                <extends class="AbstractNotificationHandler">
                    <type_params>
                        <type_param name="T"/>
                    </type_params>
                </extends>
                <method name="handleNotification" type="HandlerResult" line="594">
                    <params>
                        <param name="not" type="AssociationChangeNotification"/>
                        <param name="unused" type="T"/>
                    </params>
                    <comment line="597">
                                                
                    </comment>
                    <comment line="606">
                        case RESTART: ???                        
                    </comment>
                    <comment line="607">
                                                
                    </comment>
                    <declaration name="sac" type="SctpAssocChange" line="595"/>
                    <declaration name="newAssociation" type="Association" line="600"/>
                </method>
            </class>
            <method name="invokeNotificationHandler" type="HandlerResult" line="617">
                <params>
                    <param name="resultContainer" type="SctpResultContainer"/>
                    <param name="handler" type="NotificationHandler<T>"/>
                    <param name="attachment" type="T"/>
                </params>
                <comment line="624">
                                        
                </comment>
                <comment line="645">
                                        
                </comment>
                <comment line="652">
                    Only remove associations after user handler                    
                </comment>
                <declaration name="result" type="HandlerResult" line="618"/>
                <declaration name="notification" type="SctpNotification" line="619"/>
                <scope line="622"/>
                <scope line="624">
                    <declaration name="absHandler" type="AbstractNotificationHandler" line="625"/>
                </scope>
                <scope line="651">
                    <declaration name="assoc" type="Association" line="654"/>
                    <scope line="655"/>
                </scope>
            </method>
            <method name="lookupAssociation" type="Association" line="665">
                <params>
                    <param name="assocId" type="int"/>
                </params>
                <comment line="666">
                                        
                </comment>
                <scope line="667">
                    <declaration name="assocs" type="Set&lt;Association&gt;" line="668"/>
                    <scope line="669">
                        <scope line="670"/>
                    </scope>
                </scope>
            </method>
            <method name="addAssociation" type="void" line="678">
                <params>
                    <param name="association" type="Association"/>
                </params>
                <comment line="686">
                    OK, determining connected addresses may not be possible                    
                </comment>
                <scope line="679">
                    <declaration name="assocId" type="int" line="680"/>
                    <declaration name="addresses" type="Set&lt;SocketAddress&gt;" line="681"/>
                    <scope line="683"/>
                    <scope line="685"/>
                    <scope line="691"/>
                </scope>
            </method>
            <method name="removeAssociation" type="void" line="698">
                <params>
                    <param name="association" type="Association"/>
                </params>
                <comment line="706">
                    OK, determining connected addresses may not be possible                    
                </comment>
                <comment line="721">
                                        
                </comment>
                <scope line="699">
                    <declaration name="assocId" type="int" line="700"/>
                    <declaration name="addresses" type="Set&lt;SocketAddress&gt;" line="701"/>
                    <scope line="703"/>
                    <scope line="705"/>
                    <declaration name="assocs" type="Set&lt;Association&gt;" line="710"/>
                    <scope line="711">
                        <scope line="712"/>
                    </scope>
                    <scope line="717"/>
                    <scope line="720">
                        <declaration name="addrAssocs" type="Set&lt;java.util.Map.Entry&lt;SocketAddress,Association&gt;&gt;" line="722"/>
                        <declaration name="iterator" type="Iterator&lt;Entry&lt;SocketAddress,Association&gt;&gt;" line="724"/>
                        <scope line="725">
                            <declaration name="entry" type="Entry&lt;SocketAddress,Association&gt;" line="726"/>
                            <scope line="727"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="735">
                @throws IllegalArgumentExceptionIf the given association is not controlled by this channel                
                <return>
                    {@code true} if, and only if, the given association is one
                      of the current associations controlled by this channel                    
                </return>
            </javadoc>
            <method name="checkAssociation" type="boolean" line="742">
                <params>
                    <param name="messageAssoc" type="Association"/>
                </params>
                <scope line="743">
                    <scope line="744">
                        <scope line="745"/>
                    </scope>
                </scope>
            </method>
            <method name="checkStreamNumber" type="void" line="754">
                <params>
                    <param name="assoc" type="Association"/>
                    <param name="streamNumber" type="int"/>
                </params>
                <scope line="755"/>
            </method>
            <method name="send" type="int" line="767">
                <params>
                    <param name="buffer" type="ByteBuffer"/>
                    <param name="messageInfo" type="MessageInfo"/>
                </params>
                <comment line="791">
                                        
                </comment>
                <comment line="798">
                                        
                </comment>
                <comment line="811">
                                        
                </comment>
                <scope line="774">
                    <declaration name="n" type="int" line="780"/>
                    <scope line="781">
                        <declaration name="assocId" type="int" line="782"/>
                        <declaration name="address" type="SocketAddress" line="783"/>
                        <scope line="786">
                            <declaration name="assoc" type="Association" line="792"/>
                            <declaration name="addr" type="InetSocketAddress" line="793"/>
                            <scope line="794">
                                <scope line="799"/>
                            </scope>
                            <scope line="804">
                                <declaration name="association" type="Association" line="806"/>
                                <scope line="807"/>
                                <scope line="811">
                                    <declaration name="sm" type="SecurityManager" line="812"/>
                                </scope>
                            </scope>
                            <scope line="817"/>
                        </scope>
                        <scope line="823"/>
                    </scope>
                    <scope line="828"/>
                </scope>
            </method>
            <method name="send" type="int" line="841">
                <params>
                    <param name="fd" type="int"/>
                    <param name="src" type="ByteBuffer"/>
                    <param name="assocId" type="int"/>
                    <param name="target" type="SocketAddress"/>
                    <param name="messageInfo" type="MessageInfo"/>
                </params>
                <comment line="850">
                                        
                </comment>
                <comment line="860">
                                        
                </comment>
                <comment line="866">
                                        
                </comment>
                <declaration name="streamNumber" type="int" line="842"/>
                <declaration name="unordered" type="boolean" line="843"/>
                <declaration name="ppid" type="int" line="844"/>
                <declaration name="pos" type="int" line="851"/>
                <declaration name="lim" type="int" line="852"/>
                <declaration name="rem" type="int" line="855"/>
                <declaration name="bb" type="ByteBuffer" line="856"/>
                <scope line="857">
                    <declaration name="n" type="int" line="863"/>
                    <scope line="865"/>
                </scope>
                <scope line="870"/>
            </method>
            <method name="sendFromNativeBuffer" type="int" line="882">
                <params>
                    <param name="fd" type="int"/>
                    <param name="bb" type="ByteBuffer"/>
                    <param name="target" type="SocketAddress"/>
                    <param name="assocId" type="int"/>
                    <param name="streamNumber" type="int"/>
                    <param name="unordered" type="boolean"/>
                    <param name="ppid" type="int"/>
                </params>
                <declaration name="pos" type="int" line="883"/>
                <declaration name="lim" type="int" line="884"/>
                <declaration name="rem" type="int" line="886"/>
                <declaration name="written" type="int" line="888"/>
            </method>
            <method name="shutdown" type="SctpMultiChannel" line="897">
                <params>
                    <param name="association" type="Association"/>
                </params>
                <scope line="898"/>
            </method>
            <method name="getAllLocalAddresses" type="Set<SocketAddress>" line="910">
                <scope line="911"/>
            </method>
            <method name="getRemoteAddresses" type="Set<SocketAddress>" line="923">
                <params>
                    <param name="association" type="Association"/>
                </params>
                <comment line="932">
                                        
                </comment>
                <scope line="924">
                    <scope line="929"/>
                    <scope line="931">
                        <declaration name="addrs" type="Set&lt;SocketAddress&gt;" line="933"/>
                    </scope>
                </scope>
            </method>
            <method name="branch" type="SctpChannel" line="941">
                <params>
                    <param name="association" type="Association"/>
                </params>
                <comment line="949">
                                        
                </comment>
                <scope line="942">
                    <declaration name="bFd" type="FileDescriptor" line="947"/>
                </scope>
            </method>
            <method name="receive0" type="int" line="962">
                <params>
                    <param name="fd" type="int"/>
                    <param name="resultContainer" type="SctpResultContainer"/>
                    <param name="address" type="long"/>
                    <param name="length" type="int"/>
                </params>
                <comment line="964">
                                        
                </comment>
            </method>
            <method name="send0" type="int" line="975">
                <params>
                    <param name="fd" type="int"/>
                    <param name="address" type="long"/>
                    <param name="length" type="int"/>
                    <param name="target" type="SocketAddress"/>
                    <param name="assocId" type="int"/>
                    <param name="streamNumber" type="int"/>
                    <param name="unordered" type="boolean"/>
                    <param name="ppid" type="int"/>
                </params>
            </method>
            <scope line="980"/>
        </class>
    </source>