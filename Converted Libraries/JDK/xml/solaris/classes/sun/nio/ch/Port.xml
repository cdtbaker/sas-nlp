<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.nio.ch">
        <import package="java.nio.channels.spi.AsynchronousChannelProvider"/>
        <import package="java.nio.channels"/>
        <import package="java.io.IOException"/>
        <import package="java.io.Closeable"/>
        <import package="java.io.FileDescriptor"/>
        <import package="java.util.Map"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.concurrent.locks.ReadWriteLock"/>
        <import package="java.util.concurrent.locks.ReentrantReadWriteLock"/>
        <class name="Port" line="38">
            <extends class="AsynchronousChannelGroupImpl"/>
            <comment line="56">
                maps fd to &quot;pollable&quot; channel                
            </comment>
            <javadoc line="38">
                Base implementation of AsynchronousChannelGroupImpl for Unix systems.                
            </javadoc>
            <declaration name="POLLIN" type="short" line="43"/>
            <declaration name="POLLOUT" type="short" line="44"/>
            <declaration name="POLLERR" type="short" line="45"/>
            <declaration name="POLLHUP" type="short" line="46"/>
            <interface name="PollableChannel">
                <implements interface="Closeable"/>
                <javadoc line="48">
                    Implemented by clients registered with this port.                    
                </javadoc>
                <method name="onEvent" type="void" line="52"/>
            </interface>
            <declaration name="fdToChannelLock" type="ReadWriteLock" line="56"/>
            <declaration name="fdToChannel" type="Map&lt;Integer,PollableChannel&gt;" line="57"/>
            <method name="Port" type="constructor" line="61">
                <params>
                    <param name="provider" type="AsynchronousChannelProvider"/>
                    <param name="pool" type="ThreadPool"/>
                </params>
            </method>
            <javadoc line="65">
                Register channel identified by its file descriptor                
            </javadoc>
            <method name="register" type="void" line="68">
                <params>
                    <param name="fd" type="int"/>
                    <param name="ch" type="PollableChannel"/>
                </params>
                <scope line="70"/>
                <scope line="74"/>
            </method>
            <javadoc line="79">
                Unregister channel identified by its file descriptor                
            </javadoc>
            <method name="unregister" type="void" line="82">
                <params>
                    <param name="fd" type="int"/>
                </params>
                <comment line="90">
                    last key to be removed so check if group is shutdown                    
                </comment>
                <comment line="98">
                    continue shutdown                    
                </comment>
                <declaration name="checkForShutdown" type="boolean" line="83"/>
                <scope line="86"/>
                <scope line="93"/>
                <scope line="98">
                    <scope line="99"/>
                    <scope line="101"/>
                </scope>
            </method>
            <method name="startPoll" type="void" line="104"/>
            <javadoc line="104">
                Register file descriptor with polling mechanism for given events.
                  The implementation should translate the events as required.                
            </javadoc>
            <method name="isEmpty" type="boolean" line="111">
                <scope line="113"/>
                <scope line="115"/>
            </method>
            <method name="attachForeignChannel" type="Object" line="121">
                <params>
                    <param name="channel" type="Channel"/>
                    <param name="fd" type="FileDescriptor"/>
                </params>
                <declaration name="fdVal" type="int" line="122"/>
                <anonymous_class line="123">
                    <method name="onEvent" type="void" line="124">
                        <params>
                            <param name="events" type="int"/>
                            <param name="mayInvokeDirect" type="boolean"/>
                        </params>
                    </method>
                    <method name="close" type="void" line="125"/>
                </anonymous_class>
            </method>
            <method name="detachForeignChannel" type="void" line="133">
                <params>
                    <param name="key" type="Object"/>
                </params>
            </method>
            <method name="closeAllChannels" type="void" line="138">
                <comment line="140">
                    Close channels in batches of up to 128 channels. This allows close
                     to remove the channel from the map without interference.                    
                </comment>
                <comment line="148">
                    grab a batch of up to 128 channels                    
                </comment>
                <comment line="161">
                    close them                    
                </comment>
                <declaration name="MAX_BATCH_SIZE" type="int" line="139"/>
                <declaration name="channels" type="PollableChannel" line="144"/>
                <declaration name="count" type="int" line="145"/>
                <scope line="146">
                    <scope line="150">
                        <scope line="151"/>
                    </scope>
                    <scope line="156"/>
                    <scope line="161">
                        <scope line="162"/>
                        <scope line="164"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>