<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.jcp.xml.dsig.internal.dom">
        <import package="javax.xml.crypto"/>
        <import package="javax.xml.crypto.dom.DOMCryptoContext"/>
        <import package="javax.xml.crypto.dsig"/>
        <import package="javax.xml.crypto.dsig.keyinfo.KeyValue"/>
        <import package="java.security.KeyException"/>
        <import package="java.security.KeyFactory"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <import package="java.security.PublicKey"/>
        <import package="java.security.interfaces.DSAParams"/>
        <import package="java.security.interfaces.DSAPublicKey"/>
        <import package="java.security.interfaces.RSAPublicKey"/>
        <import package="java.security.spec.DSAPublicKeySpec"/>
        <import package="java.security.spec.InvalidKeySpecException"/>
        <import package="java.security.spec.KeySpec"/>
        <import package="java.security.spec.RSAPublicKeySpec"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.Node"/>
        <class name="DOMKeyValue" line="49">
            <extends class="DOMStructure"/>
            <comment line="61">
                DSAKeyValue CryptoBinaries                
            </comment>
            <comment line="64">
                RSAKeyValue CryptoBinaries                
            </comment>
            <implements interface="KeyValue"/>
            <javadoc line="49">
                DOM-based implementation of KeyValue.                
                <author>
                    Sean Mullan                    
                </author>
            </javadoc>
            <declaration name="rsakf" type="KeyFactory" line="56"/>
            <declaration name="publicKey" type="PublicKey" line="57"/>
            <declaration name="externalPublicKey" type="javax.xml.crypto.dom.DOMStructure" line="58"/>
            <declaration name="p" type="DOMCryptoBinary" line="61"/>
            <declaration name="modulus" type="DOMCryptoBinary" line="64"/>
            <method name="DOMKeyValue" type="constructor" line="66">
                <params>
                    <param name="key" type="PublicKey"/>
                </params>
                <scope line="67"/>
                <scope line="71">
                    <declaration name="dkey" type="DSAPublicKey" line="72"/>
                    <declaration name="params" type="DSAParams" line="73"/>
                </scope>
                <scope line="78">
                    <declaration name="rkey" type="RSAPublicKey" line="79"/>
                </scope>
                <scope line="82"/>
            </method>
            <javadoc line="88">
                Creates a &lt;code&gt;DOMKeyValue&lt;/code&gt; from an element.                
                <param>
                    kvElem a KeyValue element                    
                </param>
            </javadoc>
            <method name="DOMKeyValue" type="constructor" line="93">
                <params>
                    <param name="kvElem" type="Element"/>
                </params>
                <declaration name="kvtElem" type="Element" line="94"/>
                <scope line="95"/>
                <scope line="97"/>
                <scope line="99"/>
            </method>
            <method name="getPublicKey" type="PublicKey" line="105">
                <scope line="106"/>
                <scope line="108"/>
            </method>
            <method name="marshal" type="void" line="114">
                <params>
                    <param name="parent" type="Node"/>
                    <param name="dsPrefix" type="String"/>
                    <param name="context" type="DOMCryptoContext"/>
                </params>
                <comment line="117">
                    create KeyValue element                    
                </comment>
                <declaration name="ownerDoc" type="Document" line="115"/>
                <declaration name="kvElem" type="Element" line="118"/>
            </method>
            <method name="marshalPublicKey" type="void" line="126">
                <params>
                    <param name="parent" type="Node"/>
                    <param name="doc" type="Document"/>
                    <param name="dsPrefix" type="String"/>
                    <param name="context" type="DOMCryptoContext"/>
                </params>
                <comment line="129">
                    create and append DSAKeyValue element                    
                </comment>
                <comment line="132">
                    create and append RSAKeyValue element                    
                </comment>
                <scope line="127">
                    <scope line="128"/>
                    <scope line="131"/>
                    <scope line="134"/>
                </scope>
                <scope line="138"/>
            </method>
            <method name="marshalDSAPublicKey" type="void" line="144">
                <params>
                    <param name="parent" type="Node"/>
                    <param name="doc" type="Document"/>
                    <param name="dsPrefix" type="String"/>
                    <param name="context" type="DOMCryptoContext"/>
                </params>
                <comment line="147">
                    parameters J, Seed &amp; PgenCounter are not included                    
                </comment>
                <declaration name="dsaElem" type="Element" line="145"/>
                <declaration name="pElem" type="Element" line="148"/>
                <declaration name="qElem" type="Element" line="150"/>
                <declaration name="gElem" type="Element" line="152"/>
                <declaration name="yElem" type="Element" line="154"/>
            </method>
            <method name="marshalRSAPublicKey" type="void" line="168">
                <params>
                    <param name="parent" type="Node"/>
                    <param name="doc" type="Document"/>
                    <param name="dsPrefix" type="String"/>
                    <param name="context" type="DOMCryptoContext"/>
                </params>
                <declaration name="rsaElem" type="Element" line="169"/>
                <declaration name="modulusElem" type="Element" line="171"/>
                <declaration name="exponentElem" type="Element" line="173"/>
            </method>
            <method name="unmarshalDSAKeyValue" type="DSAPublicKey" line="183">
                <params>
                    <param name="kvtElem" type="Element"/>
                </params>
                <comment line="193">
                    check for P and Q                    
                </comment>
                <comment line="215">
                    @@@ do we care about j, pgenCounter or seed?                    
                </comment>
                <scope line="184">
                    <scope line="185"/>
                    <scope line="187"/>
                </scope>
                <declaration name="curElem" type="Element" line="192"/>
                <scope line="194"/>
                <scope line="200"/>
                <scope line="206"/>
                <scope line="210"/>
                <declaration name="spec" type="DSAPublicKeySpec" line="216"/>
            </method>
            <method name="unmarshalRSAKeyValue" type="RSAPublicKey" line="222">
                <params>
                    <param name="kvtElem" type="Element"/>
                </params>
                <scope line="223">
                    <scope line="224"/>
                    <scope line="226"/>
                </scope>
                <declaration name="modulusElem" type="Element" line="231"/>
                <declaration name="exponentElem" type="Element" line="233"/>
                <declaration name="spec" type="RSAPublicKeySpec" line="235"/>
            </method>
            <method name="generatePublicKey" type="PublicKey" line="240">
                <params>
                    <param name="kf" type="KeyFactory"/>
                    <param name="keyspec" type="KeySpec"/>
                </params>
                <comment line="244">
                    @@@ should dump exception to log                    
                </comment>
                <scope line="241"/>
                <scope line="243"/>
            </method>
            <method name="equals" type="boolean" line="249">
                <params>
                    <param name="obj" type="Object"/>
                </params>
                <comment line="266">
                    no practical way to determine if the keys are equal                    
                </comment>
                <scope line="250"/>
                <scope line="253"/>
                <scope line="256">
                    <declaration name="kv" type="KeyValue" line="257"/>
                    <scope line="258">
                        <scope line="259"/>
                    </scope>
                    <scope line="262"/>
                </scope>
                <scope line="265"/>
            </method>
        </class>
    </source>