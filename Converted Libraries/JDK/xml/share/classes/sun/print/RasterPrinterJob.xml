<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.print">
        <import package="java.io.FilePermission"/>
        <import package="java.awt.Color"/>
        <import package="java.awt.Dialog"/>
        <import package="java.awt.Frame"/>
        <import package="java.awt.Graphics"/>
        <import package="java.awt.Graphics2D"/>
        <import package="java.awt.GraphicsConfiguration"/>
        <import package="java.awt.GraphicsEnvironment"/>
        <import package="java.awt.HeadlessException"/>
        <import package="java.awt.KeyboardFocusManager"/>
        <import package="java.awt.Rectangle"/>
        <import package="java.awt.Shape"/>
        <import package="java.awt.geom.AffineTransform"/>
        <import package="java.awt.geom.Area"/>
        <import package="java.awt.geom.Point2D"/>
        <import package="java.awt.geom.Rectangle2D"/>
        <import package="java.awt.image.BufferedImage"/>
        <import package="java.awt.print.Book"/>
        <import package="java.awt.print.Pageable"/>
        <import package="java.awt.print.PageFormat"/>
        <import package="java.awt.print.Paper"/>
        <import package="java.awt.print.Printable"/>
        <import package="java.awt.print.PrinterAbortException"/>
        <import package="java.awt.print.PrinterException"/>
        <import package="java.awt.print.PrinterJob"/>
        <import package="java.awt.Window"/>
        <import package="java.io.File"/>
        <import package="java.io.IOException"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.Enumeration"/>
        <import package="java.util.Locale"/>
        <import package="sun.awt.image.ByteInterleavedRaster"/>
        <import package="javax.print.Doc"/>
        <import package="javax.print.DocFlavor"/>
        <import package="javax.print.DocPrintJob"/>
        <import package="javax.print.PrintException"/>
        <import package="javax.print.PrintService"/>
        <import package="javax.print.PrintServiceLookup"/>
        <import package="javax.print.ServiceUI"/>
        <import package="javax.print.StreamPrintService"/>
        <import package="javax.print.StreamPrintServiceFactory"/>
        <import package="javax.print.attribute.Attribute"/>
        <import package="javax.print.attribute.AttributeSet"/>
        <import package="javax.print.attribute.HashPrintRequestAttributeSet"/>
        <import package="javax.print.attribute.PrintRequestAttributeSet"/>
        <import package="javax.print.attribute.Size2DSyntax"/>
        <import package="javax.print.attribute.standard.Chromaticity"/>
        <import package="javax.print.attribute.standard.Copies"/>
        <import package="javax.print.attribute.standard.Destination"/>
        <import package="javax.print.attribute.standard.DialogTypeSelection"/>
        <import package="javax.print.attribute.standard.Fidelity"/>
        <import package="javax.print.attribute.standard.JobName"/>
        <import package="javax.print.attribute.standard.JobSheets"/>
        <import package="javax.print.attribute.standard.Media"/>
        <import package="javax.print.attribute.standard.MediaPrintableArea"/>
        <import package="javax.print.attribute.standard.MediaSize"/>
        <import package="javax.print.attribute.standard.MediaSizeName"/>
        <import package="javax.print.attribute.standard.OrientationRequested"/>
        <import package="javax.print.attribute.standard.PageRanges"/>
        <import package="javax.print.attribute.standard.PrinterState"/>
        <import package="javax.print.attribute.standard.PrinterStateReason"/>
        <import package="javax.print.attribute.standard.PrinterStateReasons"/>
        <import package="javax.print.attribute.standard.PrinterIsAcceptingJobs"/>
        <import package="javax.print.attribute.standard.RequestingUserName"/>
        <import package="javax.print.attribute.standard.SheetCollate"/>
        <import package="javax.print.attribute.standard.Sides"/>
        <import package="sun.print.PageableDoc"/>
        <import package="sun.print.ServiceDialog"/>
        <import package="sun.print.SunPrinterJobService"/>
        <import package="sun.print.SunPageSelection"/>
        <class name="RasterPrinterJob" line="102">
            <extends class="PrinterJob"/>
            <comment line="110">
                                
            </comment>
            <comment line="112">
                                
            </comment>
            <comment line="115">
                                
            </comment>
            <comment line="118">
                                
            </comment>
            <comment line="130">
                                
            </comment>
            <comment line="196">
                                
            </comment>
            <comment line="269">
                variables representing values extracted from an attribute set.
                 These take precedence over values set on a printer job                
            </comment>
            <comment line="313">
                                
            </comment>
            <comment line="319">
                                
            </comment>
            <comment line="400">
                                
            </comment>
            <comment line="419">
                A convenience method which returns the default service
                 for 2D &lt;code&gt;PrinterJob&lt;code&gt;s.
                 May return null if there is no suitable default (although there
                 may still be 2D services available).
                 @return default 2D print service, or null.
                 @since     1.4                
            </comment>
            <comment line="1027">
                subclasses may need to pull extra information out of the attribute set
                 They can override this method &amp; call super.setAttributes()                
            </comment>
            <comment line="1239">
                Services we don&apos;t recognize as built-in services can&apos;t be
                 implemented as subclasses of PrinterJob, therefore we create
                 a DocPrintJob from their service and pass a Doc representing
                 the application&apos;s printjob                
            </comment>
            <comment line="1616">
                Used when executing a print job where an attribute set may
                 over ride API values.                
            </comment>
            <comment line="1631">
                Used when executing a print job where an attribute set may
                 over ride API values.                
            </comment>
            <comment line="1665">
                Used when executing a print job where an attribute set may
                 over ride API values.                
            </comment>
            <comment line="1739">
                                
            </comment>
            <comment line="1775">
                The printer graphics config is cached on the job, so that it can
                 be created once, and updated only as needed (for now only to change
                 the bounds if when using a Pageable the page sizes changes).                
            </comment>
            <comment line="2260">
                On-screen drawString renders most control chars as the missing glyph
                 and have the non-zero advance of that glyph.
                 Exceptions are \t, \n and \r which are considered zero-width.
                 This is a utility method used by subclasses to remove them so we
                 don&apos;t have to worry about platform or font specific handling of them.                
            </comment>
            <javadoc line="102">
                A class which rasterizes a printer job.                
                <author>
                    Richard Blanchard                    
                </author>
            </javadoc>
            <declaration name="PRINTER" type="int" line="112"/>
            <declaration name="FILE" type="int" line="115"/>
            <declaration name="STREAM" type="int" line="118"/>
            <declaration name="MAX_BAND_SIZE" type="int" line="120"/>
            <javadoc line="120">
                Maximum amount of memory in bytes to use for the
                  buffered image &quot;band&quot;. 4Mb is a compromise between
                  limiting the number of bands on hi-res printers and
                  not using too much of the Java heap or causing paging
                  on systems with little RAM.                
            </javadoc>
            <declaration name="DPI" type="float" line="130"/>
            <declaration name="FORCE_PIPE_PROP" type="String" line="132"/>
            <javadoc line="132">
                Useful mainly for debugging, this system property
                  can be used to force the printing code to print
                  using a particular pipeline. The two currently
                  supported values are FORCE_RASTER and FORCE_PDL.                
            </javadoc>
            <declaration name="FORCE_RASTER" type="String" line="140"/>
            <javadoc line="140">
                When the system property FORCE_PIPE_PROP has this value
                  then each page of a print job will be rendered through
                  the raster pipeline.                
            </javadoc>
            <declaration name="FORCE_PDL" type="String" line="147"/>
            <javadoc line="147">
                When the system property FORCE_PIPE_PROP has this value
                  then each page of a print job will be rendered through
                  the PDL pipeline.                
            </javadoc>
            <declaration name="SHAPE_TEXT_PROP" type="String" line="154"/>
            <javadoc line="154">
                When the system property SHAPE_TEXT_PROP has this value
                  then text is always rendered as a shape, and no attempt is made
                  to match the font through GDI                
            </javadoc>
            <declaration name="forcePDL" type="boolean" line="161"/>
            <javadoc line="161">
                values obtained from System properties in static initialiser block                
            </javadoc>
            <declaration name="forceRaster" type="boolean" line="165"/>
            <declaration name="shapeTextProp" type="boolean" line="166"/>
            <scope line="168">
                <declaration name="forceStr" type="String" line="174"/>
                <scope line="178">
                    <scope line="179"/>
                    <scope line="181"/>
                </scope>
                <declaration name="shapeTextStr" type="String" line="186"/>
                <scope line="190"/>
            </scope>
            <declaration name="cachedBandWidth" type="int" line="197"/>
            <javadoc line="197">
                Used to minimise GC &amp; reallocation of band when printing                
            </javadoc>
            <declaration name="cachedBandHeight" type="int" line="201"/>
            <declaration name="cachedBand" type="BufferedImage" line="202"/>
            <declaration name="mNumCopies" type="int" line="204"/>
            <javadoc line="204">
                The number of book copies to be printed.                
            </javadoc>
            <declaration name="mCollate" type="boolean" line="209"/>
            <javadoc line="209">
                Collation effects the order of the pages printed
                  when multiple copies are requested. For two copies
                  of a three page document the page order is:
                  mCollate true: 1, 2, 3, 1, 2, 3
                  mCollate false: 1, 1, 2, 2, 3, 3                
            </javadoc>
            <declaration name="mFirstPage" type="int" line="218"/>
            <javadoc line="218">
                The zero based indices of the first and last
                  pages to be printed. If &apos;mFirstPage&apos; is
                  UNDEFINED_PAGE_NUM then the first page to
                  be printed is page 0. If &apos;mLastPage&apos; is
                  UNDEFINED_PAGE_NUM then the last page to
                  be printed is the last one in the book.                
            </javadoc>
            <declaration name="mLastPage" type="int" line="227"/>
            <declaration name="previousPaper" type="Paper" line="229"/>
            <javadoc line="229">
                The previous print stream Paper
                  Used to check if the paper size has changed such that the
                  implementation needs to emit the new paper size information
                  into the print stream.
                  Since we do our own rotation, and the margins aren&apos;t relevant,
                  Its strictly the dimensions of the paper that we will check.                
            </javadoc>
            <declaration name="mDocument" type="Pageable" line="239"/>
            <javadoc line="239">
                The document to be printed. It is initialized to an
                  empty (zero pages) book.                
            </javadoc>
            <declaration name="mDocName" type="String" line="245"/>
            <javadoc line="245">
                The name of the job being printed.                
            </javadoc>
            <declaration name="performingPrinting" type="boolean" line="251"/>
            <javadoc line="251">
                Printing cancellation flags                
            </javadoc>
            <declaration name="userCancelled" type="boolean" line="255"/>
            <declaration name="printToFilePermission" type="FilePermission" line="257"/>
            <javadoc line="257">
                Print to file permission variables.                
            </javadoc>
            <declaration name="redrawList" type="ArrayList" line="262"/>
            <javadoc line="262">
                List of areas &amp; the graphics state for redrawing                
            </javadoc>
            <declaration name="copiesAttr" type="int" line="271"/>
            <declaration name="jobNameAttr" type="String" line="272"/>
            <declaration name="userNameAttr" type="String" line="273"/>
            <declaration name="pageRangesAttr" type="PageRanges" line="274"/>
            <declaration name="sidesAttr" type="Sides" line="275"/>
            <declaration name="destinationAttr" type="String" line="276"/>
            <declaration name="noJobSheet" type="boolean" line="277"/>
            <declaration name="mDestType" type="int" line="278"/>
            <declaration name="mDestination" type="String" line="279"/>
            <declaration name="collateAttReq" type="boolean" line="280"/>
            <declaration name="landscapeRotates270" type="boolean" line="282"/>
            <javadoc line="282">
                Device rotation flag, if it support 270, this is set to true;                
            </javadoc>
            <declaration name="attributes" type="PrintRequestAttributeSet" line="287"/>
            <javadoc line="287">
                attributes used by no-args page and print dialog and print method to
                  communicate state                
            </javadoc>
            <class name="GraphicsState" line="293">
                <comment line="301">
                    Area of page to repaint                    
                </comment>
                <comment line="302">
                    image drawing clip.                    
                </comment>
                <comment line="303">
                    to transform clip to dev coords.                    
                </comment>
                <comment line="304">
                    X scale from region to device resolution                    
                </comment>
                <comment line="305">
                    Y scale from region to device resolution                    
                </comment>
                <javadoc line="293">
                    Class to keep state information for redrawing areas
                      &quot;region&quot; is an area at as a high a resolution as possible.
                      The redrawing code needs to look at sx, sy to calculate the scale
                      to device resolution.                    
                </javadoc>
                <declaration name="region" type="Rectangle2D" line="300"/>
                <declaration name="theClip" type="Shape" line="301"/>
                <declaration name="theTransform" type="AffineTransform" line="302"/>
                <declaration name="sx" type="double" line="303"/>
                <declaration name="sy" type="double" line="304"/>
            </class>
            <declaration name="myService" type="PrintService" line="307"/>
            <javadoc line="307">
                Service for this job                
            </javadoc>
            <method name="RasterPrinterJob" type="constructor" line="315"/>
            <method name="getXRes" type="double" line="320"/>
            <javadoc line="320">
                Returns the resolution in dots per inch across the width
                  of the page.                
            </javadoc>
            <method name="getYRes" type="double" line="326"/>
            <javadoc line="326">
                Returns the resolution in dots per inch down the height
                  of the page.                
            </javadoc>
            <method name="getPhysicalPrintableX" type="double" line="332"/>
            <javadoc line="332">
                Must be obtained from the current printer.
                  Value is in device pixels.
                  Not adjusted for orientation of the paper.                
            </javadoc>
            <method name="getPhysicalPrintableY" type="double" line="339"/>
            <javadoc line="339">
                Must be obtained from the current printer.
                  Value is in device pixels.
                  Not adjusted for orientation of the paper.                
            </javadoc>
            <method name="getPhysicalPrintableWidth" type="double" line="346"/>
            <javadoc line="346">
                Must be obtained from the current printer.
                  Value is in device pixels.
                  Not adjusted for orientation of the paper.                
            </javadoc>
            <method name="getPhysicalPrintableHeight" type="double" line="353"/>
            <javadoc line="353">
                Must be obtained from the current printer.
                  Value is in device pixels.
                  Not adjusted for orientation of the paper.                
            </javadoc>
            <method name="getPhysicalPageWidth" type="double" line="360"/>
            <javadoc line="360">
                Must be obtained from the current printer.
                  Value is in device pixels.
                  Not adjusted for orientation of the paper.                
            </javadoc>
            <method name="getPhysicalPageHeight" type="double" line="367"/>
            <javadoc line="367">
                Must be obtained from the current printer.
                  Value is in device pixels.
                  Not adjusted for orientation of the paper.                
            </javadoc>
            <method name="startPage" type="void" line="374"/>
            <javadoc line="374">
                Begin a new page.                
            </javadoc>
            <method name="endPage" type="void" line="381"/>
            <javadoc line="381">
                End a page.                
            </javadoc>
            <method name="printBand" type="void" line="388"/>
            <javadoc line="388">
                Prints the contents of the array of ints, &apos;data&apos;
                  to the current page. The band is placed at the
                  location (x, y) in device coordinates on the
                  page. The width and height of the band is
                  specified by the caller.                
            </javadoc>
            <javadoc line="401">
                save graphics state of a PathGraphics for later redrawing
                  of part of page represented by the region in that state                
            </javadoc>
            <method name="saveState" type="void" line="407">
                <params>
                    <param name="at" type="AffineTransform"/>
                    <param name="clip" type="Shape"/>
                    <param name="region" type="Rectangle2D"/>
                    <param name="sx" type="double"/>
                    <param name="sy" type="double"/>
                </params>
                <declaration name="gstate" type="GraphicsState" line="408"/>
            </method>
            <method name="lookupDefaultPrintService" type="PrintService" line="426">
                <comment line="429">
                                        
                </comment>
                <declaration name="service" type="PrintService" line="427"/>
                <scope line="434"/>
                <scope line="436">
                    <declaration name="services" type="PrintService[]" line="437"/>
                    <scope line="440"/>
                </scope>
            </method>
            <javadoc line="447">
                Returns the service (printer) for this printer job.
                  Implementations of this class which do not support print services
                  may return null;                
                <return>
                    the service for this printer job.                    
                </return>
            </javadoc>
            <method name="getPrintService" type="PrintService" line="454">
                <scope line="455">
                    <declaration name="svc" type="PrintService" line="456"/>
                    <scope line="459">
                        <scope line="460"/>
                        <scope line="463"/>
                    </scope>
                    <scope line="466">
                        <declaration name="svcs" type="PrintService[]" line="467"/>
                        <scope line="469">
                            <scope line="470"/>
                            <scope line="473"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="481">
                Associate this PrinterJob with a new PrintService.
                  Throws &lt;code&gt;PrinterException&lt;/code&gt; if the specified service
                  cannot support the &lt;code&gt;Pageable&lt;/code&gt; and
                  &lt;code&gt;Printable&lt;/code&gt; interfaces necessary to support 2D printing.                
                <param>
                    a print service which supports 2D printing.                    
                </param>
                <throws>
                    PrinterException if the specified service does not support
                      2D printing or no longer available.                    
                </throws>
            </javadoc>
            <method name="setPrintService" type="void" line="493">
                <params>
                    <param name="service" type="PrintService"/>
                </params>
                <comment line="500">
                    Check the list of services.  This service may have been                    
                </comment>
                <comment line="501">
                    deleted already                    
                </comment>
                <scope line="494"/>
                <scope line="497"/>
                <scope line="499">
                    <declaration name="prnState" type="PrinterState" line="502"/>
                    <scope line="504">
                        <declaration name="prnStateReasons" type="PrinterStateReasons" line="505"/>
                        <scope line="510"/>
                    </scope>
                    <scope line="519"/>
                    <scope line="521"/>
                </scope>
            </method>
            <method name="updatePageAttributes" type="void" line="529">
                <params>
                    <param name="service" type="PrintService"/>
                    <param name="page" type="PageFormat"/>
                </params>
                <comment line="541">
                    We should limit the list where we search the matching                    
                </comment>
                <comment line="542">
                    media, this will prevent mapping to wrong media ex. Ledger                    
                </comment>
                <comment line="543">
                    can be mapped to B.  Especially useful when creating                    
                </comment>
                <comment line="544">
                    custom MediaSize.                    
                </comment>
                <scope line="530"/>
                <declaration name="x" type="float" line="534"/>
                <declaration name="y" type="float" line="537"/>
                <declaration name="mediaList" type="Media[]" line="545"/>
                <declaration name="media" type="Media" line="547"/>
                <scope line="548"/>
                <scope line="551"/>
                <scope line="554"/>
                <declaration name="orient" type="OrientationRequested" line="558"/>
                <scope line="570"/>
                <scope line="573"/>
                <declaration name="ix" type="float" line="578"/>
                <declaration name="iw" type="float" line="579"/>
                <declaration name="iy" type="float" line="580"/>
                <declaration name="ih" type="float" line="581"/>
                <scope line="583"/>
                <scope line="586"/>
            </method>
            <javadoc line="590">
                Display a dialog to the user allowing the modification of a
                  PageFormat instance.
                  The &lt;code&gt;page&lt;/code&gt; argument is used to initialize controls
                  in the page setup dialog.
                  If the user cancels the dialog, then the method returns the
                  original &lt;code&gt;page&lt;/code&gt; object unmodified.
                  If the user okays the dialog then the method returns a new
                  PageFormat object with the indicated changes.
                  In either case the original &lt;code&gt;page&lt;/code&gt; object will
                  not be modified.                
                <param>
                    page    the default PageFormat presented to the user
                      for modification                    
                </param>
                <return>
                    the original <code>page</code> object if the dialog
                      is cancelled, or a new PageFormat object containing
                      the format indicated by the user if the dialog is
                      acknowledged                    
                </return>
                <exception>
                    HeadlessException if GraphicsEnvironment.isHeadless()
                      returns true.                    
                </exception>
                <see>
                    java.awt.GraphicsEnvironment#isHeadless                    
                </see>
                <since>
                    1.2                    
                </since>
            </javadoc>
            <method name="pageDialog" type="PageFormat" line="613">
                <params>
                    <param name="page" type="PageFormat"/>
                </params>
                <scope line="614"/>
                <declaration name="gc" type="GraphicsConfiguration" line="618"/>
                <anonymous_class line="624">
                    <method name="run" type="Object" line="625">
                        <declaration name="service" type="PrintService" line="626"/>
                        <scope line="627"/>
                    </method>
                </anonymous_class>
                <declaration name="service" type="PrintService" line="622"/>
                <scope line="635"/>
                <declaration name="newPage" type="PageFormat" line="640"/>
                <scope line="642"/>
                <scope line="644"/>
            </method>
            <javadoc line="649">
                return a PageFormat corresponding to the updated attributes,
                  or null if the user cancelled the dialog.                
            </javadoc>
            <method name="pageDialog" type="PageFormat" line="654">
                <params>
                    <param name="attributes" type="PrintRequestAttributeSet"/>
                </params>
                <comment line="728">
                    units == 1 to avoid FP error                    
                </comment>
                <comment line="738">
                    Should pass in same unit as updatePageAttributes                    
                </comment>
                <comment line="739">
                    to avoid rounding off errors.                    
                </comment>
                <scope line="655"/>
                <declaration name="gc" type="GraphicsConfiguration" line="659"/>
                <declaration name="bounds" type="Rectangle" line="662"/>
                <declaration name="x" type="int" line="663"/>
                <declaration name="y" type="int" line="664"/>
                <anonymous_class line="668">
                    <method name="run" type="Object" line="669">
                        <declaration name="service" type="PrintService" line="670"/>
                        <scope line="671"/>
                    </method>
                </anonymous_class>
                <declaration name="service" type="PrintService" line="666"/>
                <scope line="679"/>
                <declaration name="pageDialog" type="ServiceDialog" line="683"/>
                <scope line="688">
                    <declaration name="newas" type="PrintRequestAttributeSet" line="689"/>
                    <declaration name="amCategory" type="Class" line="691"/>
                    <scope line="694"/>
                    <declaration name="page" type="PageFormat" line="699"/>
                    <declaration name="orient" type="OrientationRequested" line="701"/>
                    <declaration name="pfOrient" type="int" line="704"/>
                    <scope line="705">
                        <scope line="706"/>
                        <scope line="708"/>
                    </scope>
                    <declaration name="media" type="Media" line="714"/>
                    <scope line="715"/>
                    <scope line="719"/>
                    <declaration name="size" type="MediaSize" line="722"/>
                    <scope line="724"/>
                    <declaration name="paper" type="Paper" line="727"/>
                    <declaration name="dim" type="float" line="728"/>
                    <declaration name="w" type="double" line="729"/>
                    <declaration name="h" type="double" line="730"/>
                    <declaration name="area" type="MediaPrintableArea" line="732"/>
                    <declaration name="ix" type="double" line="735"/>
                    <scope line="737"/>
                    <scope line="749">
                        <scope line="750"/>
                        <scope line="753"/>
                        <scope line="757"/>
                        <scope line="760"/>
                    </scope>
                </scope>
                <scope line="769"/>
            </method>
            <javadoc line="774">
                Presents the user a dialog for changing properties of the
                  print job interactively.
                  The services browsable here are determined by the type of
                  service currently installed.
                  If the application installed a StreamPrintService on this
                  PrinterJob, only the available StreamPrintService (factories) are
                  browsable.                
                <param>
                    attributes to store changed properties.                    
                </param>
                <return>
                    false if the user cancels the dialog and true otherwise.                    
                </return>
                <exception>
                    HeadlessException if GraphicsEnvironment.isHeadless()
                      returns true.                    
                </exception>
                <see>
                    java.awt.GraphicsEnvironment#isHeadless                    
                </see>
            </javadoc>
            <method name="printDialog" type="boolean" line="790">
                <params>
                    <param name="attributes" type="PrintRequestAttributeSet"/>
                </params>
                <comment line="799">
                    Check for native, note that default dialog is COMMON.                    
                </comment>
                <comment line="817">
                    A security check has already been performed in the
                     java.awt.print.printerJob.getPrinterJob method.
                     So by the time we get here, it is OK for the current thread
                     to print either to a file (from a Dialog we control!) or
                     to a chosen printer.
                    
                     We raise privilege when we put up the dialog, to avoid
                     the &quot;warning applet window&quot; banner.                    
                </comment>
                <comment line="866">
                    No services but default PrintService exists?
                     Create services using defaultService.                    
                </comment>
                <comment line="900">
                    The only time it would throw an exception is when
                     newService is no longer available but we should still
                     select this printer.                    
                </comment>
                <scope line="791"/>
                <declaration name="dlg" type="DialogTypeSelection" line="796"/>
                <scope line="800">
                    <scope line="802"/>
                    <scope line="806"/>
                    <declaration name="ret" type="boolean" line="810"/>
                </scope>
                <declaration name="gc" type="GraphicsConfiguration" line="826"/>
                <anonymous_class line="832">
                    <method name="run" type="Object" line="833">
                        <declaration name="service" type="PrintService" line="834"/>
                        <scope line="835"/>
                    </method>
                </anonymous_class>
                <declaration name="service" type="PrintService" line="830"/>
                <scope line="843"/>
                <declaration name="services" type="PrintService[]" line="847"/>
                <declaration name="spsFactories" type="StreamPrintServiceFactory[]" line="848"/>
                <scope line="849">
                    <scope line="852"/>
                </scope>
                <scope line="855">
                    <anonymous_class line="858">
                        <method name="run" type="Object" line="859">
                            <declaration name="services" type="PrintService[]" line="860"/>
                        </method>
                    </anonymous_class>
                    <scope line="865"/>
                </scope>
                <declaration name="bounds" type="Rectangle" line="875"/>
                <declaration name="x" type="int" line="876"/>
                <declaration name="y" type="int" line="877"/>
                <declaration name="newService" type="PrintService" line="878"/>
                <scope line="879"/>
                <scope line="885"/>
                <scope line="892"/>
                <scope line="896">
                    <scope line="897"/>
                    <scope line="899"/>
                </scope>
            </method>
            <javadoc line="911">
                Presents the user a dialog for changing properties of the
                  print job interactively.                
                <returns>
                    false if the user cancels the dialog and
                      true otherwise.                    
                </returns>
                <exception>
                    HeadlessException if GraphicsEnvironment.isHeadless()
                      returns true.                    
                </exception>
                <see>
                    java.awt.GraphicsEnvironment#isHeadless                    
                </see>
            </javadoc>
            <method name="printDialog" type="boolean" line="920">
                <scope line="922"/>
                <declaration name="attributes" type="PrintRequestAttributeSet" line="926"/>
                <declaration name="doPrint" type="boolean" line="930"/>
                <scope line="931">
                    <declaration name="jobName" type="JobName" line="932"/>
                    <scope line="933"/>
                    <declaration name="copies" type="Copies" line="936"/>
                    <scope line="937"/>
                    <declaration name="dest" type="Destination" line="941"/>
                    <scope line="943">
                        <scope line="944"/>
                        <scope line="947">
                            <declaration name="ps" type="PrintService" line="949"/>
                            <scope line="950">
                                <declaration name="defaultDest" type="Destination" line="951"/>
                                <scope line="953"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="958">
                        <declaration name="ps" type="PrintService" line="960"/>
                        <scope line="961"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="970">
                The pages in the document to be printed by this PrinterJob
                  are drawn by the Printable object &apos;painter&apos;. The PageFormat
                  for each page is the default page format.                
                <param>
                    Printable Called to render each page of the document.                    
                </param>
            </javadoc>
            <method name="setPrintable" type="void" line="976">
                <params>
                    <param name="painter" type="Printable"/>
                </params>
            </method>
            <javadoc line="980">
                The pages in the document to be printed by this PrinterJob
                  are drawn by the Printable object &apos;painter&apos;. The PageFormat
                  of each page is &apos;format&apos;.                
                <param>
                    Printable Called to render each page of the document.                    
                </param>
                <param>
                    PageFormat The size and orientation of each page to
                      be printed.                    
                </param>
            </javadoc>
            <method name="setPrintable" type="void" line="988">
                <params>
                    <param name="painter" type="Printable"/>
                    <param name="format" type="PageFormat"/>
                </params>
            </method>
            <javadoc line="993">
                The pages in the document to be printed are held by the
                  Pageable instance &apos;document&apos;. &apos;document&apos; will be queried
                  for the number of pages as well as the PageFormat and
                  Printable for each page.                
                <param>
                    Pageable The document to be printed. It may not be null.                    
                </param>
                <exception>
                    NullPointerException the Pageable passed in was null.                    
                </exception>
                <see>
                    PageFormat                    
                </see>
                <see>
                    Printable                    
                </see>
            </javadoc>
            <method name="setPageable" type="void" line="1003">
                <params>
                    <param name="document" type="Pageable"/>
                </params>
                <scope line="1004"/>
                <scope line="1007"/>
            </method>
            <method name="initPrinter" type="void" line="1012"/>
            <method name="isSupportedValue" type="boolean" line="1017">
                <params>
                    <param name="attrval" type="Attribute"/>
                    <param name="attrset" type="PrintRequestAttributeSet"/>
                </params>
                <declaration name="ps" type="PrintService" line="1018"/>
            </method>
            <method name="setAttributes" type="void" line="1030">
                <params>
                    <param name="attributes" type="PrintRequestAttributeSet"/>
                </params>
                <comment line="1031">
                                        
                </comment>
                <comment line="1062">
                    Since we have verified supported values if fidelity is true,
                     we can either ignore unsupported values, or substitute a
                     reasonable alternative                    
                </comment>
                <comment line="1085">
                    get to, from, min, max page ranges                    
                </comment>
                <comment line="1087">
                    setPageRanges uses 0-based indexing so we subtract 1                    
                </comment>
                <comment line="1108">
                    Old code (new File(destination.getURI())).getPath()                    
                </comment>
                <comment line="1109">
                    would generate a &quot;URI is not hierarchical&quot; IAE                    
                </comment>
                <comment line="1110">
                    for &quot;file:out.prn&quot; so we use getSchemeSpecificPart instead                    
                </comment>
                <comment line="1113">
                    paranoid exception                    
                </comment>
                <comment line="1150">
                    OpenBook is used internally only when app uses Printable.
                     This is the case when we use the values from the attribute set.                    
                </comment>
                <comment line="1162">
                    We could almost(!) use PrinterJob.getPageFormat() except
                     here we need to start with the PageFormat from the OpenBook :                    
                </comment>
                <comment line="1170">
                    If there&apos;s a media but no media printable area, we can try
                     to retrieve the default value for mpa and use that.                    
                </comment>
                <comment line="1231">
                    for AWT where pageable is not an instance of OpenBook,                    
                </comment>
                <comment line="1232">
                    we need to save paper info                    
                </comment>
                <declaration name="service" type="PrintService" line="1041"/>
                <scope line="1042"/>
                <declaration name="fidelity" type="boolean" line="1046"/>
                <declaration name="attrFidelity" type="Fidelity" line="1047"/>
                <scope line="1048"/>
                <scope line="1052">
                    <declaration name="unsupported" type="AttributeSet" line="1053"/>
                    <scope line="1057"/>
                </scope>
                <declaration name="collateAttr" type="SheetCollate" line="1068"/>
                <scope line="1070"/>
                <scope line="1075"/>
                <scope line="1080"/>
                <scope line="1082">
                    <scope line="1084">
                        <declaration name="range" type="int[][]" line="1086"/>
                    </scope>
                    <scope line="1089"/>
                </scope>
                <declaration name="copies" type="Copies" line="1094"/>
                <scope line="1096"/>
                <scope line="1099"/>
                <declaration name="destination" type="Destination" line="1103"/>
                <scope line="1106">
                    <scope line="1107"/>
                    <scope line="1113">
                        <declaration name="defaultDest" type="Destination" line="1114"/>
                        <scope line="1116"/>
                    </scope>
                </scope>
                <declaration name="jobSheets" type="JobSheets" line="1123"/>
                <scope line="1124"/>
                <declaration name="jobName" type="JobName" line="1128"/>
                <scope line="1130"/>
                <scope line="1133"/>
                <declaration name="userName" type="RequestingUserName" line="1137"/>
                <scope line="1140"/>
                <scope line="1142">
                    <scope line="1143"/>
                    <scope line="1145"/>
                </scope>
                <declaration name="media" type="Media" line="1153"/>
                <declaration name="orientReq" type="OrientationRequested" line="1154"/>
                <declaration name="mpa" type="MediaPrintableArea" line="1156"/>
                <scope line="1160">
                    <declaration name="pageable" type="Pageable" line="1165"/>
                    <declaration name="printable" type="Printable" line="1166"/>
                    <declaration name="pf" type="PageFormat" line="1167"/>
                    <declaration name="paper" type="Paper" line="1168"/>
                    <scope line="1175">
                        <declaration name="mpaVals" type="Object" line="1176"/>
                        <scope line="1180"/>
                    </scope>
                    <scope line="1186">
                        <declaration name="orient" type="int" line="1187"/>
                        <scope line="1188"/>
                        <scope line="1190"/>
                        <scope line="1192"/>
                    </scope>
                    <scope line="1199">
                        <scope line="1200">
                            <declaration name="msn" type="MediaSizeName" line="1201"/>
                            <declaration name="msz" type="MediaSize" line="1202"/>
                            <scope line="1203">
                                <declaration name="paperWid" type="float" line="1204"/>
                                <declaration name="paperHgt" type="float" line="1205"/>
                                <scope line="1207"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="1217">
                        <declaration name="printableArea" type="float[]" line="1218"/>
                        <scope line="1220"/>
                    </scope>
                </scope>
                <scope line="1230"/>
            </method>
            <method name="spoolToService" type="void" line="1246">
                <params>
                    <param name="psvc" type="PrintService"/>
                    <param name="attributes" type="PrintRequestAttributeSet"/>
                </params>
                <scope line="1248"/>
                <declaration name="job" type="DocPrintJob" line="1252"/>
                <declaration name="doc" type="Doc" line="1253"/>
                <scope line="1254"/>
                <scope line="1257"/>
                <scope line="1259"/>
            </method>
            <javadoc line="1264">
                Prints a set of pages.                
                <exception>
                    java.awt.print.PrinterException an error in the print system
                      caused the job to be aborted                    
                </exception>
                <see>
                    java.awt.print.Book                    
                </see>
                <see>
                    java.awt.print.Pageable                    
                </see>
                <see>
                    java.awt.print.Printable                    
                </see>
            </javadoc>
            <method name="print" type="void" line="1272"/>
            <declaration name="debugPrint" type="boolean" line="1276"/>
            <method name="debug_println" type="void" line="1277">
                <params>
                    <param name="str" type="String"/>
                </params>
                <scope line="1278"/>
            </method>
            <method name="print" type="void" line="1284">
                <params>
                    <param name="attributes" type="PrintRequestAttributeSet"/>
                </params>
                <comment line="1286">
                    In the future PrinterJob will probably always dispatch
                     the print job to the PrintService.
                     This is how third party 2D Print Services will be invoked
                     when applications use the PrinterJob API.
                     However the JRE&apos;s concrete PrinterJob implementations have
                     not yet been re-worked to be implemented as standalone
                     services, and are implemented only as subclasses of PrinterJob.
                     So here we dispatch only those services we do not recognize
                     as implemented through platform subclasses of PrinterJob
                     (and this class).                    
                </comment>
                <comment line="1304">
                    Check the list of services.  This service may have been                    
                </comment>
                <comment line="1305">
                    deleted already                    
                </comment>
                <comment line="1328">
                    throw exception for invalid destination                    
                </comment>
                <comment line="1330">
                    destinationAttr is null for Destination(new URI(&quot;&quot;))                    
                </comment>
                <comment line="1331">
                    because isAttributeValueSupported returns false in setAttributes                    
                </comment>
                <comment line="1333">
                    Destination(new URI(&quot; &quot;)) throws URISyntaxException                    
                </comment>
                <comment line="1336">
                    check if this is a new file and if filename chars are valid                    
                </comment>
                <comment line="1344">
                    There is already file read/write access so at this point                    
                </comment>
                <comment line="1345">
                    only delete access is denied.  Just ignore it because in                    
                </comment>
                <comment line="1346">
                    most cases the file created in createNewFile gets overwritten                    
                </comment>
                <comment line="1347">
                    anyway.                    
                </comment>
                <comment line="1363">
                    We need to make sure that the collation and copies                    
                </comment>
                <comment line="1372">
                    Get the range of pages we are to print. If the
                     last page to print is unknown, then we print to
                     the end of the document. Note that firstPage
                     and lastPage are 0 based page indices.                    
                </comment>
                <comment line="1402">
                    PageRanges can be set even if RANGE is not selected                    
                </comment>
                <comment line="1403">
                    so we need to check if it is selected.                    
                </comment>
                <comment line="1418">
                    Three nested loops iterate over the document. The outer loop
                     counts the number of collated copies while the inner loop
                     counts the number of nonCollated copies. Normally, one of
                     these two loops will only execute once; that is we will
                     either print collated copies or noncollated copies. The
                     middle loop iterates over the pages.
                     If a PageRanges attribute is used, it constrains the pages
                     that are imaged. If a platform subclass (though a user dialog)
                     requests a page range via setPageRange(). it too can
                     constrain the page ranges that are imaged.
                     It is expected that only one of these will be used in a
                     job but both should be able to co-exist.                    
                </comment>
                <comment line="1468">
                    reset previousPaper in case this job is invoked again.                    
                </comment>
                <declaration name="psvc" type="PrintService" line="1298"/>
                <scope line="1300"/>
                <declaration name="prnState" type="PrinterState" line="1306"/>
                <scope line="1308">
                    <declaration name="prnStateReasons" type="PrinterStateReasons" line="1309"/>
                    <scope line="1314"/>
                </scope>
                <scope line="1321"/>
                <scope line="1326">
                    <scope line="1329">
                        <declaration name="f" type="File" line="1334"/>
                        <scope line="1335">
                            <scope line="1337"/>
                        </scope>
                        <scope line="1340"/>
                        <scope line="1343"/>
                        <declaration name="pFile" type="File" line="1350"/>
                        <scope line="1354"/>
                    </scope>
                </scope>
                <scope line="1359"/>
                <declaration name="numCollatedCopies" type="int" line="1367"/>
                <declaration name="numNonCollatedCopies" type="int" line="1368"/>
                <declaration name="numPages" type="int" line="1377"/>
                <scope line="1378"/>
                <declaration name="firstPage" type="int" line="1382"/>
                <declaration name="lastPage" type="int" line="1383"/>
                <scope line="1384">
                    <declaration name="totalPages" type="int" line="1385"/>
                    <scope line="1386"/>
                </scope>
                <scope line="1391">
                    <scope line="1392"/>
                    <scope line="1398"/>
                    <declaration name="rangeIsSelected" type="boolean" line="1404"/>
                    <scope line="1405">
                        <declaration name="pages" type="SunPageSelection" line="1406"/>
                        <scope line="1408"/>
                    </scope>
                    <scope line="1431">
                        <scope line="1437">
                            <scope line="1439">
                                <declaration name="nexti" type="int" line="1440"/>
                                <scope line="1441"/>
                                <scope line="1443"/>
                            </scope>
                            <scope line="1452">
                                <scope line="1453"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="1463"/>
                </scope>
                <scope line="1467">
                    <scope line="1470">
                        <scope line="1471"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="1480">
                updates a Paper object to reflect the current printer&apos;s selected
                  paper size and imageable area for that paper size.
                  Default implementation copies settings from the original, applies
                  applies some validity checks, changes them only if they are
                  clearly unreasonable, then sets them into the new Paper.
                  Subclasses are expected to override this method to make more
                  informed decisons.                
            </javadoc>
            <method name="validatePaper" type="void" line="1489">
                <params>
                    <param name="origPaper" type="Paper"/>
                    <param name="newPaper" type="Paper"/>
                </params>
                <comment line="1500">
                    Assume any +ve values are legal. Overall paper dimensions
                     take precedence. Make sure imageable area fits on the paper.                    
                </comment>
                <comment line="1510">
                    full widthheight is not likely to be imageable, but since we
                     don&apos;t know the limits we have to allow it                    
                </comment>
                <scope line="1490"/>
                <scope line="1492">
                    <declaration name="wid" type="double" line="1493"/>
                    <declaration name="hgt" type="double" line="1494"/>
                    <declaration name="ix" type="double" line="1495"/>
                    <declaration name="iy" type="double" line="1496"/>
                    <declaration name="iw" type="double" line="1497"/>
                    <declaration name="ih" type="double" line="1498"/>
                    <declaration name="defaultPaper" type="Paper" line="1503"/>
                    <scope line="1513"/>
                    <scope line="1516"/>
                    <scope line="1519"/>
                    <scope line="1522"/>
                </scope>
            </method>
            <javadoc line="1530">
                The passed in PageFormat will be copied and altered to describe
                  the default page size and orientation of the PrinterJob&apos;s
                  current printer.
                  Platform subclasses which can access the actual default paper size
                  for a printer may override this method.                
            </javadoc>
            <method name="defaultPage" type="PageFormat" line="1537">
                <params>
                    <param name="page" type="PageFormat"/>
                </params>
                <comment line="1566">
                    Default to A4 paper outside North America.                    
                </comment>
                <comment line="1569">
                    ie &quot;C&quot;                    
                </comment>
                <declaration name="newPage" type="PageFormat" line="1538"/>
                <declaration name="newPaper" type="Paper" line="1540"/>
                <declaration name="ptsPerInch" type="double" line="1541"/>
                <declaration name="w" type="double" line="1542"/>
                <declaration name="media" type="Media" line="1543"/>
                <declaration name="service" type="PrintService" line="1545"/>
                <scope line="1546">
                    <declaration name="size" type="MediaSize" line="1547"/>
                    <scope line="1553"/>
                </scope>
                <declaration name="defaultCountry" type="String" line="1568"/>
                <scope line="1572">
                    <declaration name="mmPerInch" type="double" line="1574"/>
                </scope>
            </method>
            <javadoc line="1588">
                The passed in PageFormat is cloned and altered to be usable on
                  the PrinterJob&apos;s current printer.                
            </javadoc>
            <method name="validatePage" type="PageFormat" line="1592">
                <params>
                    <param name="page" type="PageFormat"/>
                </params>
                <declaration name="newPage" type="PageFormat" line="1593"/>
                <declaration name="newPaper" type="Paper" line="1594"/>
            </method>
            <javadoc line="1601">
                Set the number of copies to be printed.                
            </javadoc>
            <method name="setCopies" type="void" line="1604">
                <params>
                    <param name="copies" type="int"/>
                </params>
            </method>
            <javadoc line="1608">
                Get the number of copies to be printed.                
            </javadoc>
            <method name="getCopies" type="int" line="1611"/>
            <method name="getCopiesInt" type="int" line="1618"/>
            <javadoc line="1622">
                Get the name of the printing user.
                  The caller must have security permission to read system properties.                
            </javadoc>
            <method name="getUserName" type="String" line="1626"/>
            <method name="getUserNameInt" type="String" line="1633">
                <scope line="1634"/>
                <scope line="1636">
                    <scope line="1637"/>
                    <scope line="1639"/>
                </scope>
            </method>
            <javadoc line="1645">
                Set the name of the document to be printed.
                  The document name can not be null.                
            </javadoc>
            <method name="setJobName" type="void" line="1649">
                <params>
                    <param name="jobName" type="String"/>
                </params>
                <scope line="1650"/>
                <scope line="1652"/>
            </method>
            <javadoc line="1657">
                Get the name of the document to be printed.                
            </javadoc>
            <method name="getJobName" type="String" line="1660"/>
            <method name="getJobNameInt" type="String" line="1667"/>
            <javadoc line="1671">
                Set the range of pages from a Book to be printed.
                  Both &apos;firstPage&apos; and &apos;lastPage&apos; are zero based
                  page indices. If either parameter is less than
                  zero then the page range is set to be from the
                  first page to the last.                
            </javadoc>
            <method name="setPageRange" type="void" line="1678">
                <params>
                    <param name="firstPage" type="int"/>
                    <param name="lastPage" type="int"/>
                </params>
                <scope line="1679"/>
                <scope line="1683"/>
            </method>
            <javadoc line="1689">
                Return the zero based index of the first page to
                  be printed in this job.                
            </javadoc>
            <method name="getFirstPage" type="int" line="1693"/>
            <javadoc line="1697">
                Return the zero based index of the last page to
                  be printed in this job.                
            </javadoc>
            <method name="getLastPage" type="int" line="1701"/>
            <javadoc line="1705">
                Set whether copies should be collated or not.
                  Two collated copies of a three page document
                  print in this order: 1, 2, 3, 1, 2, 3 while
                  uncollated copies print in this order:
                  1, 1, 2, 2, 3, 3.
                  This is set when request is using an attribute set.                
            </javadoc>
            <method name="setCollated" type="void" line="1713">
                <params>
                    <param name="collate" type="boolean"/>
                </params>
            </method>
            <javadoc line="1718">
                Return true if collated copies will be printed as determined
                  in an attribute set.                
            </javadoc>
            <method name="isCollated" type="boolean" line="1722"/>
            <method name="startDoc" type="void" line="1726"/>
            <javadoc line="1726">
                Called by the print() method at the start of
                  a print job.                
            </javadoc>
            <method name="endDoc" type="void" line="1732"/>
            <javadoc line="1732">
                Called by the print() method at the end of
                  a print job.                
            </javadoc>
            <method name="abortDoc" type="void" line="1739"/>
            <method name="cancelDoc" type="void" line="1741">
                <scope line="1743"/>
            </method>
            <javadoc line="1751">
                Returns how many times the entire book should
                  be printed by the PrintJob. If the printer
                  itself supports collation then this method
                  should return 1 indicating that the entire
                  book need only be printed once and the copies
                  will be collated and made in the printer.                
            </javadoc>
            <method name="getCollatedCopies" type="int" line="1759"/>
            <javadoc line="1763">
                Returns how many times each page in the book
                  should be consecutively printed by PrintJob.
                  If the printer makes copies itself then this
                  method should return 1.                
            </javadoc>
            <method name="getNoncollatedCopies" type="int" line="1769"/>
            <declaration name="deviceWidth" type="int" line="1779"/>
            <declaration name="defaultDeviceTransform" type="AffineTransform" line="1780"/>
            <declaration name="pgConfig" type="PrinterGraphicsConfig" line="1781"/>
            <method name="setGraphicsConfigInfo" type="void" line="1784">
                <params>
                    <param name="at" type="AffineTransform"/>
                    <param name="pw" type="double"/>
                    <param name="ph" type="double"/>
                </params>
                <declaration name="pt" type="Point2D.Double" line="1785"/>
                <scope line="1792"/>
            </method>
            <method name="getPrinterGraphicsConfig" type="PrinterGraphicsConfig" line="1801">
                <scope line="1802"/>
                <declaration name="deviceID" type="String" line="1805"/>
                <declaration name="service" type="PrintService" line="1806"/>
                <scope line="1807"/>
            </method>
            <javadoc line="1816">
                Print a page from the provided document.                
                <return>
                    int Printable.PAGE_EXISTS if the page existed and was drawn and
                      Printable.NO_SUCH_PAGE if the page did not exist.                    
                </return>
                <see>
                    java.awt.print.Printable                    
                </see>
            </javadoc>
            <method name="printPage" type="int" line="1824">
                <params>
                    <param name="document" type="Pageable"/>
                    <param name="pageIndex" type="int"/>
                </params>
                <comment line="1840">
                    Get the imageable area from Paper instead of PageFormat
                     because we do not want it adjusted by the page orientation.                    
                </comment>
                <comment line="1844">
                    if non-portrait and 270 degree landscape rotation                    
                </comment>
                <comment line="1866">
                    The deviceArea is the imageable area in the printer&apos;s
                     resolution.                    
                </comment>
                <comment line="1875">
                    Build and hold on to a uniform transform so that
                     we can get back to device space at the beginning
                     of each band.                    
                </comment>
                <comment line="1881">
                    The scale transform is used to switch from the
                     device space to the user&apos;s 72 dpi space.                    
                </comment>
                <comment line="1887">
                    bandwidth is multiple of 4 as the data is used in a win32 DIB and
                     some drivers behave badly if scanlines aren&apos;t multiples of 4 bytes.                    
                </comment>
                <comment line="1903">
                    Figure out the number of lines that will fit into
                     our maximum band size. The hard coded 3 reflects the
                     fact that we can only create 24 bit per pixel 3 byte BGR
                     BufferedImages. FIX.                    
                </comment>
                <comment line="1913">
                    The device transform is used to move the band down
                     the page using translates. Normally this is all it
                     would do, but since, when printing, the Window&apos;s
                     DIB format wants the last line to be first (lowest) in
                     memory, the deviceTransform moves the origin to the
                     bottom of the band and flips the origin. This way the
                     app prints upside down into the band which is the DIB
                     format.                    
                </comment>
                <comment line="1927">
                    Create a BufferedImage to hold the band. We set the clip
                     of the band to be tight around the bits so that the
                     application can use it to figure what part of the
                     page needs to be drawn. The clip is never altered in
                     this method, but we do translate the band&apos;s coordinate
                     system so that the app will see the clip moving down the
                     page though it s always around the same set of pixels.                    
                </comment>
                <comment line="1938">
                    Have the app draw into a PeekGraphics object so we can
                     learn something about the needs of the print job.                    
                </comment>
                <comment line="1957">
                    Update the information used to return a GraphicsConfiguration
                     for this printer device. It needs to be updated per page as
                     not all pages in a job may be the same size (different bounds)
                     The transform is the scaling transform as this corresponds to
                     the default transform for the device. The width and height are
                     those of the paper, not the page format, as we want to describe
                     the bounds of the device in its natural coordinate system of
                     device coordinate whereas a page format may be in a rotated context.                    
                </comment>
                <comment line="1973">
                    We need to check if the paper size is changed.
                     Note that it is not sufficient to ask for the pageformat
                     of &quot;pageIndex-1&quot;, since PageRanges mean that pages can be
                     skipped. So we have to look at the actual last paper size used.                    
                </comment>
                <comment line="1990">
                    If we can convert the page directly to the
                     underlying graphics system then we do not
                     need to rasterize. We also may not need to
                     create the &apos;band&apos; if all the pages can take
                     this path.                    
                </comment>
                <comment line="1998">
                    user (0,0) should be origin of page, not imageable area                    
                </comment>
                <comment line="2021">
                    This is the banded-raster printing loop.
                     It should be moved into its own method.                    
                </comment>
                <comment line="2048">
                    We need the actual bits of the BufferedImage to send to
                     the native Window&apos;s code. &apos;data&apos; points to the actual
                     pixels. Right now these are in ARGB format with 8 bits
                     per component. We need to use a monochrome BufferedImage
                     for monochrome printers when this is supported by
                     BufferedImage. FIX                    
                </comment>
                <comment line="2058">
                    Loop over the page moving our band down the page,
                     calling the app to render the band, and then send the band
                     to the printer.                    
                </comment>
                <comment line="2064">
                    device&apos;s printable x,y is really addressable origin
                     we address relative to media origin so when we print a
                     band we need to adjust for the different methods of
                     addressing it.                    
                </comment>
                <comment line="2076">
                    Put the band back into device space and
                     erase the contents of the band.                    
                </comment>
                <comment line="2081">
                    Put the band into the correct location on the
                     page. Once the band is moved we translate the
                     device transform so that the band will move down
                     the page on the next iteration of the loop.                    
                </comment>
                <comment line="2090">
                    Switch the band from device space to user,
                     72 dpi, space.                    
                </comment>
                <comment line="2102">
                    if the client has specified an imageable X or Y
                     which is off than the physically addressable
                     area of the page, then we need to adjust for that
                     here so that we pass only non -ve band coordinates
                     We also need to translate by the adjusted amount
                     so that printing appears in the correct place.                    
                </comment>
                <comment line="2119">
                    Have the app&apos;s painter image into the band
                     and then send the band to the printer.                    
                </comment>
                <declaration name="page" type="PageFormat" line="1825"/>
                <declaration name="origPage" type="PageFormat" line="1826"/>
                <declaration name="painter" type="Printable" line="1827"/>
                <scope line="1828"/>
                <scope line="1832">
                    <declaration name="pe" type="PrinterException" line="1833"/>
                </scope>
                <declaration name="paper" type="Paper" line="1843"/>
                <scope line="1846">
                    <declaration name="left" type="double" line="1848"/>
                    <declaration name="top" type="double" line="1849"/>
                    <declaration name="width" type="double" line="1850"/>
                    <declaration name="height" type="double" line="1851"/>
                    <scope line="1856"/>
                    <scope line="1858"/>
                </scope>
                <declaration name="xScale" type="double" line="1863"/>
                <declaration name="yScale" type="double" line="1864"/>
                <declaration name="deviceArea" type="Rectangle2D" line="1869"/>
                <declaration name="uniformTransform" type="AffineTransform" line="1879"/>
                <declaration name="scaleTransform" type="AffineTransform" line="1884"/>
                <declaration name="bandWidth" type="int" line="1890"/>
                <scope line="1891"/>
                <scope line="1894"/>
                <declaration name="deviceAreaHeight" type="int" line="1898"/>
                <scope line="1899"/>
                <declaration name="bandHeight" type="int" line="1908"/>
                <declaration name="deviceLeft" type="int" line="1910"/>
                <declaration name="deviceTop" type="int" line="1911"/>
                <declaration name="deviceTransform" type="AffineTransform" line="1922"/>
                <declaration name="pBand" type="BufferedImage" line="1935"/>
                <declaration name="peekGraphics" type="PeekGraphics" line="1942"/>
                <declaration name="pageFormatArea" type="Rectangle2D.Double" line="1945"/>
                <declaration name="pgAt" type="AffineTransform" line="1955"/>
                <declaration name="pageResult" type="int" line="1968"/>
                <scope line="1970">
                    <declaration name="thisPaper" type="Paper" line="1978"/>
                    <declaration name="paperChanged" type="boolean" line="1979"/>
                    <declaration name="pathGraphics" type="Graphics2D" line="1986"/>
                    <scope line="1996">
                        <declaration name="initialTx" type="AffineTransform" line="2006"/>
                        <scope line="2010">
                            <declaration name="gstate" type="GraphicsState" line="2011"/>
                        </scope>
                    </scope>
                    <scope line="2024">
                        <declaration name="band" type="BufferedImage" line="2025"/>
                        <scope line="2028"/>
                        <declaration name="bandGraphics" type="Graphics2D" line="2035"/>
                        <declaration name="clipArea" type="Rectangle2D.Double" line="2037"/>
                        <declaration name="painterGraphics" type="ProxyGraphics2D" line="2042"/>
                        <declaration name="clearGraphics" type="Graphics2D" line="2045"/>
                        <declaration name="tile" type="ByteInterleavedRaster" line="2055"/>
                        <declaration name="data" type="byte[]" line="2056"/>
                        <declaration name="deviceBottom" type="int" line="2062"/>
                        <declaration name="deviceAddressableX" type="int" line="2069"/>
                        <declaration name="deviceAddressableY" type="int" line="2070"/>
                        <scope line="2074">
                            <declaration name="clip" type="Rectangle" line="2096"/>
                            <scope line="2100">
                                <declaration name="bandX" type="int" line="2109"/>
                                <scope line="2110"/>
                                <declaration name="bandY" type="int" line="2114"/>
                                <scope line="2115"/>
                            </scope>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="2140">
                If a print job is in progress, print() has been
                  called but has not returned, then this signals
                  that the job should be cancelled and the next
                  chance. If there is no print job in progress then
                  this call does nothing.                
            </javadoc>
            <method name="cancel" type="void" line="2147">
                <scope line="2148">
                    <scope line="2149"/>
                </scope>
            </method>
            <javadoc line="2156">
                Returns true is a print job is ongoing but will
                  be cancelled and the next opportunity. false is
                  returned otherwise.                
            </javadoc>
            <method name="isCancelled" type="boolean" line="2161">
                <declaration name="cancelled" type="boolean" line="2163"/>
                <scope line="2165"/>
            </method>
            <javadoc line="2173">
                Return the Pageable describing the pages to be printed.                
            </javadoc>
            <method name="getPageable" type="Pageable" line="2176"/>
            <javadoc line="2180">
                Examine the metrics captured by the
                  &lt;code&gt;PeekGraphics&lt;/code&gt; instance and
                  if capable of directly converting this
                  print job to the printer&apos;s control language
                  or the native OS&apos;s graphics primitives, then
                  return a &lt;code&gt;PathGraphics&lt;/code&gt; to perform
                  that conversion. If there is not an object
                  capable of the conversion then return
                  &lt;code&gt;null&lt;/code&gt;. Returning &lt;code&gt;null&lt;/code&gt;
                  causes the print job to be rasterized.                
            </javadoc>
            <method name="createPathGraphics" type="Graphics2D" line="2196">
                <params>
                    <param name="graphics" type="PeekGraphics"/>
                    <param name="printerJob" type="PrinterJob"/>
                    <param name="painter" type="Printable"/>
                    <param name="pageFormat" type="PageFormat"/>
                    <param name="pageIndex" type="int"/>
                </params>
            </method>
            <javadoc line="2201">
                Create and return an object that will
                  gather and hold metrics about the print
                  job. This method is passed a &lt;code&gt;Graphics2D&lt;/code&gt;
                  object that can be used as a proxy for the
                  object gathering the print job matrics. The
                  method is also supplied with the instance
                  controlling the print job, &lt;code&gt;printerJob&lt;/code&gt;.                
            </javadoc>
            <method name="createPeekGraphics" type="PeekGraphics" line="2211">
                <params>
                    <param name="graphics" type="Graphics2D"/>
                    <param name="printerJob" type="PrinterJob"/>
                </params>
            </method>
            <javadoc line="2216">
                Configure the passed in Graphics2D so that
                  is contains the defined initial settings
                  for a print job. These settings are:
                  color:  black.
                  clip:   &lt;as passed in&gt;                
            </javadoc>
            <method name="initPrinterGraphics" type="void" line="2223">
                <params>
                    <param name="g" type="Graphics2D"/>
                    <param name="clip" type="Rectangle2D"/>
                </params>
            </method>
            <javadoc line="2230">
                User dialogs should disable &quot;File&quot; buttons if this returns false.                
            </javadoc>
            <method name="checkAllowedToPrintToFile" type="boolean" line="2234">
                <scope line="2235"/>
                <scope line="2238"/>
            </method>
            <javadoc line="2243">
                Break this out as it may be useful when we allow API to
                  specify printing to a file. In that case its probably right
                  to throw a SecurityException if the permission is not granted                
            </javadoc>
            <method name="throwPrintToFile" type="void" line="2248">
                <declaration name="security" type="SecurityManager" line="2249"/>
                <scope line="2250">
                    <scope line="2251"/>
                </scope>
            </method>
            <method name="removeControlChars" type="String" line="2265">
                <params>
                    <param name="s" type="String"/>
                </params>
                <comment line="2278">
                    no need to make a new String.                    
                </comment>
                <declaration name="in_chars" type="char[]" line="2266"/>
                <declaration name="len" type="int" line="2267"/>
                <declaration name="out_chars" type="char[]" line="2268"/>
                <declaration name="pos" type="int" line="2269"/>
                <scope line="2271">
                    <declaration name="c" type="char" line="2272"/>
                    <scope line="2273"/>
                </scope>
                <scope line="2277"/>
                <scope line="2279"/>
            </method>
        </class>
    </source>