<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.net.www.protocol.http">
        <import package="java.io.IOException"/>
        <import package="java.io.ObjectInputStream"/>
        <import package="java.net.PasswordAuthentication"/>
        <import package="java.net.URL"/>
        <import package="java.util.HashMap"/>
        <import package="sun.net.www.HeaderParser"/>
        <class name="AuthenticationInfo" line="37">
            <extends class="AuthCacheValue"/>
            <comment line="46">
                REMIND:  It would be nice if this class understood about partial matching.                
            </comment>
            <comment line="47">
                If you&apos;re authorized for foo.com, chances are high you&apos;re also                
            </comment>
            <comment line="48">
                authorized for baz.foo.com.                
            </comment>
            <comment line="49">
                NB:  When this gets implemented, be careful about the uncaching                
            </comment>
            <comment line="50">
                policy in HttpURLConnection.  A failure on baz.foo.com shouldn&apos;t                
            </comment>
            <comment line="51">
                uncache foo.com!                
            </comment>
            <comment line="55">
                Constants saying what kind of authroization this is.  This determines                
            </comment>
            <comment line="56">
                the namespace in the hash table lookup.                
            </comment>
            <comment line="74">
                                
            </comment>
            <comment line="117">
                check if a request for this destination is in progress
                 return false immediately if not. Otherwise block until
                 request is finished and return true                
            </comment>
            <comment line="146">
                signal completion of an authentication (whether it succeeded or not)
                 so that other threads can continue.                
            </comment>
            <comment line="160">
                public String toString () {                
            </comment>
            <comment line="161">
                return (&quot;{&quot;+type+&quot;:&quot;+authScheme+&quot;:&quot;+protocol+&quot;:&quot;+host+&quot;:&quot;+port+&quot;:&quot;+realm+&quot;:&quot;+path+&quot;}&quot;);                
            </comment>
            <comment line="162">
                }                
            </comment>
            <comment line="164">
                REMIND:  This cache just grows forever.  We should put in a bounded                
            </comment>
            <comment line="165">
                cache, or maybe something using WeakRef&apos;s.                
            </comment>
            <comment line="212">
                Constructor used to limit the authorization to the path within
                 the URL. Use this constructor for origin server entries.                
            </comment>
            <comment line="236">
                reduce the path to the root of where we think the
                 authorization begins. This could get shorter as
                 the url is traversed up following a successful challenge.                
            </comment>
            <comment line="434">
                                
            </comment>
            <implements interface="Cloneable"/>
            <javadoc line="37">
                AuthenticationInfo: Encapsulate the information needed to
                  authenticate a user to a server.                
                <author>
                    Jon Payne                    
                </author>
                <author>
                    Herb Jellinek                    
                </author>
                <author>
                    Bill Foote                    
                </author>
            </javadoc>
            <declaration name="SERVER_AUTHENTICATION" type="char" line="56"/>
            <declaration name="PROXY_AUTHENTICATION" type="char" line="57"/>
            <declaration name="serializeAuth" type="boolean" line="59"/>
            <javadoc line="59">
                If true, then simultaneous authentication requests to the same realm/proxy
                  are serialized, in order to avoid a user having to type the same username/passwords
                  repeatedly, via the Authenticator. Default is false, which means that this
                  behavior is switched off.                
            </javadoc>
            <scope line="67"/>
            <declaration name="pw" type="PasswordAuthentication" line="75"/>
            <method name="credentials" type="PasswordAuthentication" line="77"/>
            <method name="getAuthType" type="AuthCacheValue.Type" line="81"/>
            <method name="getAuthScheme" type="AuthScheme" line="87"/>
            <method name="getHost" type="String" line="91"/>
            <method name="getPort" type="int" line="94"/>
            <method name="getRealm" type="String" line="97"/>
            <method name="getPath" type="String" line="100"/>
            <method name="getProtocolScheme" type="String" line="103"/>
            <declaration name="requests" type="HashMap&lt;String,Thread&gt;" line="107"/>
            <javadoc line="107">
                requests is used to ensure that interaction with the
                  Authenticator for a particular realm is single threaded.
                  ie. if multiple threads need to get credentials from the user
                  at the same time, then all but the first will block until
                  the first completes its authentication.                
            </javadoc>
            <method name="requestIsInProgress" type="boolean" line="120">
                <params>
                    <param name="key" type="String"/>
                </params>
                <comment line="122">
                                        
                </comment>
                <comment line="141">
                                        
                </comment>
                <scope line="121"/>
                <scope line="125">
                    <declaration name="t" type="Thread" line="126"/>
                    <scope line="128"/>
                    <scope line="132"/>
                    <scope line="135">
                        <scope line="136"/>
                        <scope line="138"/>
                    </scope>
                </scope>
            </method>
            <method name="requestCompleted" type="void" line="148">
                <params>
                    <param name="key" type="String"/>
                </params>
                <scope line="149">
                    <declaration name="thread" type="Thread" line="150"/>
                    <scope line="151">
                        <declaration name="waspresent" type="boolean" line="152"/>
                    </scope>
                </scope>
            </method>
            <declaration name="type" type="char" line="166"/>
            <javadoc line="166">
                The type (server/proxy) of authentication this is.  Used for key lookup                
            </javadoc>
            <declaration name="authScheme" type="AuthScheme" line="169"/>
            <javadoc line="169">
                The authentication scheme (basic/digest). Also used for key lookup                
            </javadoc>
            <declaration name="protocol" type="String" line="172"/>
            <javadoc line="172">
                The protocol/scheme (i.e. http or https ). Need to keep the caches
                  logically separate for the two protocols. This field is only used
                  when constructed with a URL (the normal case for server authentication)
                  For proxy authentication the protocol is not relevant.                
            </javadoc>
            <declaration name="host" type="String" line="179"/>
            <javadoc line="179">
                The host we&apos;re authenticating against.                
            </javadoc>
            <declaration name="port" type="int" line="182"/>
            <javadoc line="182">
                The port on the host we&apos;re authenticating against.                
            </javadoc>
            <declaration name="realm" type="String" line="185"/>
            <javadoc line="185">
                The realm we&apos;re authenticating against.                
            </javadoc>
            <declaration name="path" type="String" line="188"/>
            <javadoc line="188">
                The shortest path from the URL we authenticated against.                
            </javadoc>
            <javadoc line="191">
                Use this constructor only for proxy entries                
            </javadoc>
            <method name="AuthenticationInfo" type="constructor" line="192">
                <params>
                    <param name="type" type="char"/>
                    <param name="authScheme" type="AuthScheme"/>
                    <param name="host" type="String"/>
                    <param name="port" type="int"/>
                    <param name="realm" type="String"/>
                </params>
            </method>
            <method name="clone" type="Object" line="202">
                <comment line="206">
                    Cannot happen because Cloneable implemented by AuthenticationInfo                    
                </comment>
                <scope line="203"/>
                <scope line="205"/>
            </method>
            <method name="AuthenticationInfo" type="constructor" line="215">
                <params>
                    <param name="type" type="char"/>
                    <param name="authScheme" type="AuthScheme"/>
                    <param name="url" type="URL"/>
                    <param name="realm" type="String"/>
                </params>
                <scope line="221"/>
                <declaration name="urlPath" type="String" line="226"/>
                <scope line="229"/>
            </method>
            <method name="reducePath" type="String" line="240">
                <params>
                    <param name="urlPath" type="String"/>
                </params>
                <declaration name="sepIndex" type="int" line="241"/>
                <declaration name="targetSuffixIndex" type="int" line="242"/>
            </method>
            <javadoc line="252">
                Returns info for the URL, for an HTTP server auth.  Used when we
                  don&apos;t yet know the realm
                  (i.e. when we&apos;re preemptively setting the auth).                
            </javadoc>
            <method name="getServerAuth" type="AuthenticationInfo" line="257">
                <params>
                    <param name="url" type="URL"/>
                </params>
                <declaration name="port" type="int" line="258"/>
                <scope line="259"/>
                <declaration name="key" type="String" line="262"/>
            </method>
            <javadoc line="267">
                Returns info for the URL, for an HTTP server auth.  Used when we
                  do know the realm (i.e. when we&apos;re responding to a challenge).
                  In this case we do not use the path because the protection space
                  is identified by the host:port:realm only                
            </javadoc>
            <method name="getServerAuthKey" type="String" line="273">
                <params>
                    <param name="url" type="URL"/>
                    <param name="realm" type="String"/>
                    <param name="scheme" type="AuthScheme"/>
                </params>
                <declaration name="port" type="int" line="274"/>
                <scope line="275"/>
                <declaration name="key" type="String" line="278"/>
            </method>
            <method name="getServerAuth" type="AuthenticationInfo" line="283">
                <params>
                    <param name="key" type="String"/>
                </params>
                <comment line="286">
                                        
                </comment>
                <declaration name="cached" type="AuthenticationInfo" line="284"/>
                <scope line="285"/>
            </method>
            <javadoc line="293">
                Return the AuthenticationInfo object from the cache if it&apos;s path is
                  a substring of the supplied URLs path.                
            </javadoc>
            <method name="getAuth" type="AuthenticationInfo" line="297">
                <params>
                    <param name="key" type="String"/>
                    <param name="url" type="URL"/>
                </params>
                <scope line="298"/>
                <scope line="300"/>
            </method>
            <javadoc line="305">
                Returns a firewall authentication, for the given host/port.  Used
                  for preemptive header-setting. Note, the protocol field is always
                  blank for proxies.                
            </javadoc>
            <method name="getProxyAuth" type="AuthenticationInfo" line="310">
                <params>
                    <param name="host" type="String"/>
                    <param name="port" type="int"/>
                </params>
                <declaration name="key" type="String" line="311"/>
                <declaration name="result" type="AuthenticationInfo" line="312"/>
            </method>
            <javadoc line="316">
                Returns a firewall authentication, for the given host/port and realm.
                  Used in response to a challenge. Note, the protocol field is always
                  blank for proxies.                
            </javadoc>
            <method name="getProxyAuthKey" type="String" line="321">
                <params>
                    <param name="host" type="String"/>
                    <param name="port" type="int"/>
                    <param name="realm" type="String"/>
                    <param name="scheme" type="AuthScheme"/>
                </params>
                <declaration name="key" type="String" line="322"/>
            </method>
            <method name="getProxyAuth" type="AuthenticationInfo" line="327">
                <params>
                    <param name="key" type="String"/>
                </params>
                <comment line="330">
                                        
                </comment>
                <declaration name="cached" type="AuthenticationInfo" line="328"/>
                <scope line="329"/>
            </method>
            <javadoc line="337">
                Add this authentication to the cache                
            </javadoc>
            <method name="addToCache" type="void" line="340">
                <declaration name="key" type="String" line="341"/>
                <scope line="343"/>
            </method>
            <method name="endAuthRequest" type="void" line="349">
                <params>
                    <param name="key" type="String"/>
                </params>
                <scope line="350"/>
                <scope line="353"/>
            </method>
            <javadoc line="358">
                Remove this authentication from the cache                
            </javadoc>
            <method name="removeFromCache" type="void" line="361">
                <scope line="363"/>
            </method>
            <method name="supportsPreemptiveAuthorization" type="boolean" line="368"/>
            <javadoc line="368">
                @return true if this authentication supports preemptive authorization                
            </javadoc>
            <javadoc line="373">
                @return the name of the HTTP header this authentication wants set.
                  This is used for preemptive authorization.                
            </javadoc>
            <method name="getHeaderName" type="String" line="377">
                <scope line="378"/>
                <scope line="380"/>
            </method>
            <method name="getHeaderValue" type="String" line="385"/>
            <javadoc line="385">
                Calculates and returns the authentication header value based
                  on the stored authentication parameters. If the calculation does not depend
                  on the URL or the request method then these parameters are ignored.                
                <param>
                    url The URL                    
                </param>
                <param>
                    method The request method                    
                </param>
                <return>
                    the value of the HTTP header this authentication wants set.
                      Used for preemptive authorization.                    
                </return>
            </javadoc>
            <method name="setHeaders" type="boolean" line="396"/>
            <javadoc line="396">
                Set header(s) on the given connection.  Subclasses must override
                  This will only be called for
                  definitive (i.e. non-preemptive) authorization.                
                <param>
                    conn The connection to apply the header(s) to                    
                </param>
                <param>
                    p A source of header values for this connection, if needed.                    
                </param>
                <param>
                    raw The raw header field (if needed)                    
                </param>
                <return>
                    true if all goes well, false if no headers were set.                    
                </return>
            </javadoc>
            <method name="isAuthorizationStale" type="boolean" line="407"/>
            <javadoc line="407">
                Check if the header indicates that the current auth. parameters are stale.
                  If so, then replace the relevant field with the new value
                  and return true. Otherwise return false.
                  returning true means the request can be retried with the same userid/password
                  returning false means we have to go back to the user to ask for a new
                  username password.                
            </javadoc>
            <javadoc line="417">
                Give a key for hash table lookups.                
                <param>
                    includeRealm if you want the realm considered.  Preemptively
                      setting an authorization is done before the realm is known.                    
                </param>
            </javadoc>
            <method name="cacheKey" type="String" line="422">
                <params>
                    <param name="includeRealm" type="boolean"/>
                </params>
                <comment line="423">
                    This must be kept in sync with the getXXXAuth() methods in this                    
                </comment>
                <comment line="424">
                    class.                    
                </comment>
                <scope line="425"/>
                <scope line="428"/>
            </method>
            <declaration name="s1" type="String" line="433"/>
            <method name="readObject" type="void" line="437">
                <params>
                    <param name="s" type="ObjectInputStream"/>
                </params>
            </method>
            <method name="writeObject" type="void" line="445">
                <params>
                    <param name="s" type="java.io.ObjectOutputStream"/>
                </params>
            </method>
        </class>
    </source>