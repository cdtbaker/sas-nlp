<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.net.www.http">
        <import package="java.io"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.regex"/>
        <import package="sun.net.NetProperties"/>
        <import package="sun.util.logging.PlatformLogger"/>
        <class name="HttpCapture" line="34">
            <javadoc line="34">
                Main class of the HTTP traffic capture tool.
                  Captures are triggered by the sun.net.http.captureRules system property.
                  If set, it should point to a file containing the capture rules.
                  Format for the file is simple:
                  - 1 rule per line
                  - Lines starting with a # are considered comments and ignored
                  - a rule is a pair of a regular expression and file pattern, separated by a comma
                  - The regular expression is applied to URLs, if it matches, the traffic for
                  that URL will be captured in the associated file.
                  - if the file name contains a &apos;%d&apos;, then that sequence will be replaced by a
                  unique random number for each URL. This allow for multi-threaded captures
                  of URLs matching the same pattern.
                  - Rules are checked in sequence, in the same order as in the file, until a
                  match is found or the end of the list is reached.
                  Examples of rules:
                  www\.sun\.com , sun%d.log
                  yahoo\.com\/.asf , yahoo.log                
                <author>
                    jccollet                    
                </author>
            </javadoc>
            <declaration name="file" type="File" line="57"/>
            <declaration name="incoming" type="boolean" line="58"/>
            <declaration name="out" type="BufferedWriter" line="59"/>
            <declaration name="initialized" type="boolean" line="60"/>
            <declaration name="patterns" type="ArrayList&lt;Pattern&gt;" line="61"/>
            <declaration name="capFiles" type="ArrayList&lt;String&gt;" line="62"/>
            <method name="init" type="void" line="64">
                <comment line="84">
                    skip line if it&apos;s a comment                    
                </comment>
                <anonymous_class line="67">
                    <method name="run" type="String" line="68"/>
                </anonymous_class>
                <declaration name="rulesFile" type="String" line="66"/>
                <scope line="72">
                    <declaration name="in" type="BufferedReader" line="73"/>
                    <scope line="74"/>
                    <scope line="76"/>
                    <scope line="79">
                        <declaration name="line" type="String" line="80"/>
                        <scope line="81">
                            <scope line="83">
                                <declaration name="s" type="String[]" line="85"/>
                                <scope line="86">
                                    <scope line="87"/>
                                </scope>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="97"/>
                    <scope line="99">
                        <scope line="100"/>
                        <scope line="102"/>
                    </scope>
                </scope>
            </method>
            <method name="isInitialized" type="boolean" line="108"/>
            <method name="HttpCapture" type="constructor" line="112">
                <params>
                    <param name="f" type="File"/>
                    <param name="url" type="java.net.URL"/>
                </params>
                <scope line="114"/>
                <scope line="117"/>
            </method>
            <method name="sent" type="void" line="122">
                <params>
                    <param name="c" type="int"/>
                </params>
                <scope line="123"/>
            </method>
            <method name="received" type="void" line="131">
                <params>
                    <param name="c" type="int"/>
                </params>
                <scope line="132"/>
            </method>
            <method name="flush" type="void" line="140"/>
            <method name="getCapture" type="HttpCapture" line="144">
                <params>
                    <param name="url" type="java.net.URL"/>
                </params>
                <scope line="145"/>
                <scope line="148"/>
                <declaration name="s" type="String" line="151"/>
                <scope line="152">
                    <declaration name="p" type="Pattern" line="153"/>
                    <scope line="154">
                        <declaration name="f" type="String" line="155"/>
                        <declaration name="fi" type="File" line="156"/>
                        <scope line="157">
                            <declaration name="rand" type="java.util.Random" line="158"/>
                            <scope line="159">
                                <declaration name="f2" type="String" line="160"/>
                            </scope>
                        </scope>
                        <scope line="163"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>