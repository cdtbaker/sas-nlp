<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.net.www.protocol.http">
        <import package="sun.net.www"/>
        <import package="java.util.Iterator"/>
        <import package="java.util.HashMap"/>
        <class name="AuthenticationHeader" line="5">
            <javadoc line="5">
                This class is used to parse the information in WWW-Authenticate: and Proxy-Authenticate:
                  headers. It searches among multiple header lines and within each header line
                  for the best currently supported scheme. It can also return a HeaderParser
                  containing the challenge data for that particular scheme.
                  Some examples:
                  WWW-Authenticate: Basic realm=&quot;foo&quot; Digest realm=&quot;bar&quot; NTLM
                  Note the realm parameter must be associated with the particular scheme.
                  or
                  WWW-Authenticate: Basic realm=&quot;foo&quot;
                  WWW-Authenticate: Digest realm=&quot;foo&quot;,qop=&quot;auth&quot;,nonce=&quot;thisisanunlikelynonce&quot;
                  WWW-Authenticate: NTLM
                  or
                  WWW-Authenticate: Basic realm=&quot;foo&quot;
                  WWW-Authenticate: NTLM ASKAJK9893289889QWQIOIONMNMN
                  The last example shows how NTLM breaks the rules of rfc2617 for the structure of
                  the authentication header. This is the reason why the raw header field is used for ntlm.
                  At present, the class chooses schemes in following order :
                  1. Negotiate (if supported)
                  2. Kerberos (if supported)
                  3. Digest
                  4. NTLM (if supported)
                  5. Basic
                  This choice can be modified by setting a system property:
                  -Dhttp.auth.preference=&quot;scheme&quot;
                  which in this case, specifies that &quot;scheme&quot; should be used as the auth scheme when offered
                  disregarding the default prioritisation. If scheme is not offered then the default priority
                  is used.
                  Attention: when http.auth.preference is set as SPNEGO or Kerberos, it&apos;s actually &quot;Negotiate
                  with SPNEGO&quot; or &quot;Negotiate with Kerberos&quot;, which means the user will prefer the Negotiate
                  scheme with GSS/SPNEGO or GSS/Kerberos mechanism.
                  This also means that the real &quot;Kerberos&quot; scheme can never be set as a preference.                
            </javadoc>
            <declaration name="rsp" type="MessageHeader" line="39"/>
            <declaration name="preferred" type="HeaderParser" line="40"/>
            <declaration name="preferred_r" type="String" line="41"/>
            <declaration name="hci" type="HttpCallerInfo" line="42"/>
            <declaration name="dontUseNegotiate" type="boolean" line="43"/>
            <declaration name="authPref" type="String" line="44"/>
            <method name="toString" type="String" line="45"/>
            <scope line="48">
                <scope line="50">
                    <scope line="52"/>
                </scope>
            </scope>
            <declaration name="hdrname" type="String" line="57"/>
            <javadoc line="58">
                parse a set of authentication headers and choose the preferred scheme
                  that we support for a given host                
            </javadoc>
            <method name="AuthenticationHeader" type="constructor" line="62">
                <params>
                    <param name="hdrname" type="String"/>
                    <param name="response" type="MessageHeader"/>
                    <param name="hci" type="HttpCallerInfo"/>
                    <param name="dontUseNegotiate" type="boolean"/>
                </params>
            </method>
            <method name="getHttpCallerInfo" type="HttpCallerInfo" line="70"/>
            <class name="SchemeMapValue" line="73">
                <method name="SchemeMapValue" type="constructor" line="74">
                    <params>
                        <param name="h" type="HeaderParser"/>
                        <param name="r" type="String"/>
                    </params>
                </method>
                <declaration name="raw" type="String" line="78"/>
                <declaration name="parser" type="HeaderParser" line="79"/>
            </class>
            <declaration name="schemes" type="HashMap" line="81"/>
            <method name="parse" type="void" line="82">
                <declaration name="iter" type="Iterator" line="83"/>
                <scope line="84">
                    <declaration name="raw" type="String" line="85"/>
                    <declaration name="hp" type="HeaderParser" line="86"/>
                    <declaration name="keys" type="Iterator" line="87"/>
                    <declaration name="i" type="int" line="88"/>
                    <scope line="89">
                        <scope line="91">
                            <scope line="92">
                                <declaration name="hpn" type="HeaderParser" line="93"/>
                                <declaration name="scheme" type="String" line="94"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="100">
                        <declaration name="hpn" type="HeaderParser" line="101"/>
                        <declaration name="scheme" type="String" line="102"/>
                    </scope>
                </scope>
                <declaration name="v" type="SchemeMapValue" line="106"/>
                <scope line="107">
                    <scope line="108">
                        <declaration name="tmp" type="SchemeMapValue" line="109"/>
                        <scope line="110">
                            <scope line="111"/>
                        </scope>
                    </scope>
                    <scope line="117">
                        <declaration name="tmp" type="SchemeMapValue" line="118"/>
                        <scope line="119">
                            <scope line="120"/>
                        </scope>
                    </scope>
                    <scope line="126">
                        <scope line="127">
                            <scope line="128"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="134">
                    <scope line="135"/>
                </scope>
                <scope line="139"/>
            </method>
            <javadoc line="144">
                return a header parser containing the preferred authentication scheme (only).
                  The preferred scheme is the strongest of the schemes proposed by the server.
                  The returned HeaderParser will contain the relevant parameters for that scheme                
            </javadoc>
            <method name="headerParser" type="HeaderParser" line="149"/>
            <javadoc line="152">
                return the name of the preferred scheme                
            </javadoc>
            <method name="scheme" type="String" line="155">
                <scope line="156"/>
                <scope line="159"/>
            </method>
            <method name="raw" type="String" line="163"/>
            <javadoc line="166">
                returns true is the header exists and contains a recognised scheme                
            </javadoc>
            <method name="isPresent" type="boolean" line="169"/>
        </class>
    </source>