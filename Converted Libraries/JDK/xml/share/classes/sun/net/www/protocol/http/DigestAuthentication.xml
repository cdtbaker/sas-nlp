<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.net.www.protocol.http">
        <import package="java.io"/>
        <import package="java.net.URL"/>
        <import package="java.net.ProtocolException"/>
        <import package="java.net.PasswordAuthentication"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.StringTokenizer"/>
        <import package="java.util.Random"/>
        <import package="sun.net.www.HeaderParser"/>
        <import package="java.security.MessageDigest"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <import package="sun.net.www.protocol.http.HttpURLConnection.HTTP_CONNECT"/>
        <class name="DigestAuthentication" line="41">
            <extends class="AuthenticationInfo"/>
            <comment line="55">
                Authentication parameters defined in RFC2617.                
            </comment>
            <comment line="56">
                One instance of these may be shared among several DigestAuthentication                
            </comment>
            <comment line="57">
                instances as a result of a single authorization (for multiple domains)                
            </comment>
            <comment line="327">
                Calculate the Authorization header field given the request URI
                 and based on the authorization information in params                
            </comment>
            <javadoc line="41">
                DigestAuthentication: Encapsulate an http server authentication using
                  the &quot;Digest&quot; scheme, as described in RFC2069 and updated in RFC2617                
                <author>
                    Bill Foote                    
                </author>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="50"/>
            <declaration name="authMethod" type="String" line="52"/>
            <class name="Parameters" line="58">
                <comment line="62">
                    server proposed qop=auth                    
                </comment>
                <comment line="69">
                    The H(A1) string used for MD5-sess                    
                </comment>
                <comment line="72">
                    Force the HA1 value to be recalculated because the nonce has changed                    
                </comment>
                <comment line="77">
                                        
                </comment>
                <comment line="106">
                                        
                </comment>
                <implements interface="java.io.Serializable"/>
                <declaration name="serialVersionUID" type="long" line="59"/>
                <declaration name="serverQop" type="boolean" line="61"/>
                <declaration name="opaque" type="String" line="62"/>
                <declaration name="cnonce" type="String" line="63"/>
                <declaration name="nonce" type="String" line="64"/>
                <declaration name="algorithm" type="String" line="65"/>
                <declaration name="NCcount" type="int" line="66"/>
                <declaration name="cachedHA1" type="String" line="69"/>
                <declaration name="redoCachedHA1" type="boolean" line="72"/>
                <declaration name="cnonceRepeat" type="int" line="74"/>
                <declaration name="cnoncelen" type="int" line="76"/>
                <declaration name="random" type="Random" line="78"/>
                <scope line="80"/>
                <method name="Parameters" type="constructor" line="84"/>
                <method name="authQop" type="boolean" line="93"/>
                <method name="incrementNC" type="void" line="96"/>
                <method name="getNCCount" type="int" line="99"/>
                <declaration name="cnonce_count" type="int" line="103"/>
                <method name="getCnonce" type="String" line="106">
                    <scope line="107"/>
                </method>
                <method name="setNewCnonce" type="void" line="113">
                    <declaration name="bb" type="byte" line="114"/>
                    <declaration name="cc" type="char" line="115"/>
                    <scope line="117">
                        <declaration name="x" type="int" line="118"/>
                    </scope>
                </method>
                <method name="setQop" type="void" line="127">
                    <params>
                        <param name="qop" type="String"/>
                    </params>
                    <scope line="128">
                        <declaration name="st" type="StringTokenizer" line="129"/>
                        <scope line="130">
                            <scope line="131"/>
                        </scope>
                    </scope>
                </method>
                <method name="getOpaque" type="String" line="140"/>
                <method name="setOpaque" type="void" line="141">
                    <params>
                        <param name="s" type="String"/>
                    </params>
                </method>
                <method name="getNonce" type="String" line="143"/>
                <method name="setNonce" type="void" line="145">
                    <params>
                        <param name="s" type="String"/>
                    </params>
                    <scope line="146"/>
                </method>
                <method name="getCachedHA1" type="String" line="153">
                    <scope line="154"/>
                    <scope line="156"/>
                </method>
                <method name="setCachedHA1" type="void" line="161">
                    <params>
                        <param name="s" type="String"/>
                    </params>
                </method>
                <method name="getAlgorithm" type="String" line="166"/>
                <method name="setAlgorithm" type="void" line="167">
                    <params>
                        <param name="s" type="String"/>
                    </params>
                </method>
            </class>
            <declaration name="params" type="Parameters" line="170"/>
            <javadoc line="172">
                Create a DigestAuthentication                
            </javadoc>
            <method name="DigestAuthentication" type="constructor" line="177">
                <params>
                    <param name="isProxy" type="boolean"/>
                    <param name="url" type="URL"/>
                    <param name="realm" type="String"/>
                    <param name="authMethod" type="String"/>
                    <param name="pw" type="PasswordAuthentication"/>
                    <param name="params" type="Parameters"/>
                </params>
            </method>
            <method name="DigestAuthentication" type="constructor" line="189">
                <params>
                    <param name="isProxy" type="boolean"/>
                    <param name="host" type="String"/>
                    <param name="port" type="int"/>
                    <param name="realm" type="String"/>
                    <param name="authMethod" type="String"/>
                    <param name="pw" type="PasswordAuthentication"/>
                    <param name="params" type="Parameters"/>
                </params>
            </method>
            <javadoc line="200">
                @return true if this authentication supports preemptive authorization                
            </javadoc>
            <method name="supportsPreemptiveAuthorization" type="boolean" line="204"/>
            <javadoc line="208">
                Reclaculates the request-digest and returns it.
                  &lt;P&gt; Used in the common case where the requestURI is simply the
                  abs_path.                
                <param>
                    urlthe URL                    
                </param>
                <param>
                    methodthe HTTP method                    
                </param>
                <return>
                    the value of the HTTP header this authentication wants set                    
                </return>
            </javadoc>
            <method name="getHeaderValue" type="String" line="223">
                <params>
                    <param name="url" type="URL"/>
                    <param name="method" type="String"/>
                </params>
            </method>
            <javadoc line="227">
                Reclaculates the request-digest and returns it.
                  &lt;P&gt; Used when the requestURI is not the abs_path. The exact
                  requestURI can be passed as a String.                
                <param>
                    requestURIthe Request-URI from the HTTP request line                    
                </param>
                <param>
                    methodthe HTTP method                    
                </param>
                <return>
                    the value of the HTTP header this authentication wants set                    
                </return>
            </javadoc>
            <method name="getHeaderValue" type="String" line="241">
                <params>
                    <param name="requestURI" type="String"/>
                    <param name="method" type="String"/>
                </params>
            </method>
            <javadoc line="245">
                Check if the header indicates that the current auth. parameters are stale.
                  If so, then replace the relevant field with the new value
                  and return true. Otherwise return false.
                  returning true means the request can be retried with the same userid/password
                  returning false means we have to go back to the user to ask for a new
                  username password.                
            </javadoc>
            <method name="isAuthorizationStale" type="boolean" line="254">
                <params>
                    <param name="header" type="String"/>
                </params>
                <declaration name="p" type="HeaderParser" line="255"/>
                <declaration name="s" type="String" line="256"/>
                <declaration name="newNonce" type="String" line="259"/>
                <scope line="260"/>
            </method>
            <javadoc line="267">
                Set header(s) on the given connection.                
                <param>
                    conn The connection to apply the header(s) to                    
                </param>
                <param>
                    p A source of header values for this connection, if needed.                    
                </param>
                <param>
                    raw Raw header values for this connection, if needed.                    
                </param>
                <return>
                    true if all goes well, false if no headers were set.                    
                </return>
            </javadoc>
            <method name="setHeaders" type="boolean" line="275">
                <params>
                    <param name="conn" type="HttpURLConnection"/>
                    <param name="p" type="HeaderParser"/>
                    <param name="raw" type="String"/>
                </params>
                <comment line="297">
                    Method seems to get converted to all lower case elsewhere.                    
                </comment>
                <comment line="298">
                    It really does need to start with an upper case letter                    
                </comment>
                <comment line="299">
                    here.                    
                </comment>
                <comment line="305">
                    The default, accoriding to rfc2069                    
                </comment>
                <comment line="309">
                    If authQop is true, then the server is doing RFC2617 and                    
                </comment>
                <comment line="310">
                    has offered qop=auth. We do not support any other modes                    
                </comment>
                <comment line="311">
                    and if auth is not offered we fallback to the RFC2069 behavior                    
                </comment>
                <declaration name="uri" type="String" line="280"/>
                <declaration name="method" type="String" line="281"/>
                <scope line="283"/>
                <scope line="286">
                    <scope line="287"/>
                    <scope line="289"/>
                </scope>
                <scope line="293"/>
                <scope line="296"/>
                <declaration name="algorithm" type="String" line="303"/>
                <scope line="304"/>
                <scope line="313"/>
                <declaration name="value" type="String" line="317"/>
                <scope line="318"/>
                <scope line="321"/>
            </method>
            <method name="getHeaderValueImpl" type="String" line="329">
                <params>
                    <param name="uri" type="String"/>
                    <param name="method" type="String"/>
                </params>
                <declaration name="response" type="String" line="330"/>
                <declaration name="passwd" type="char[]" line="331"/>
                <declaration name="qop" type="boolean" line="332"/>
                <declaration name="opaque" type="String" line="333"/>
                <declaration name="cnonce" type="String" line="334"/>
                <declaration name="nonce" type="String" line="335"/>
                <declaration name="algorithm" type="String" line="336"/>
                <declaration name="nccount" type="int" line="338"/>
                <declaration name="ncstring" type="String" line="339"/>
                <scope line="341">
                    <declaration name="len" type="int" line="343"/>
                </scope>
                <scope line="348"/>
                <scope line="351"/>
                <declaration name="ncfield" type="String" line="355"/>
                <scope line="356"/>
                <declaration name="value" type="String" line="360"/>
                <scope line="368"/>
                <scope line="371"/>
                <scope line="374"/>
            </method>
            <method name="checkResponse" type="void" line="382">
                <params>
                    <param name="header" type="String"/>
                    <param name="method" type="String"/>
                    <param name="url" type="URL"/>
                </params>
            </method>
            <method name="checkResponse" type="void" line="387">
                <params>
                    <param name="header" type="String"/>
                    <param name="method" type="String"/>
                    <param name="uri" type="String"/>
                </params>
                <comment line="419">
                                        
                </comment>
                <declaration name="passwd" type="char[]" line="388"/>
                <declaration name="username" type="String" line="389"/>
                <declaration name="qop" type="boolean" line="390"/>
                <declaration name="opaque" type="String" line="391"/>
                <declaration name="cnonce" type="String" line="392"/>
                <declaration name="nonce" type="String" line="393"/>
                <declaration name="algorithm" type="String" line="394"/>
                <declaration name="nccount" type="int" line="395"/>
                <declaration name="ncstring" type="String" line="396"/>
                <scope line="398"/>
                <scope line="402">
                    <declaration name="len" type="int" line="404"/>
                </scope>
                <scope line="408">
                    <declaration name="expected" type="String" line="409"/>
                    <declaration name="p" type="HeaderParser" line="411"/>
                    <declaration name="rspauth" type="String" line="412"/>
                    <scope line="413"/>
                    <scope line="416"/>
                    <declaration name="nextnonce" type="String" line="420"/>
                    <scope line="421"/>
                </scope>
                <scope line="425"/>
            </method>
            <method name="computeDigest" type="String" line="436">
                <params>
                    <param name="isRequest" type="boolean"/>
                    <param name="userName" type="String"/>
                    <param name="password" type="char[]"/>
                    <param name="realm" type="String"/>
                    <param name="connMethod" type="String"/>
                    <param name="requestURI" type="String"/>
                    <param name="nonceString" type="String"/>
                    <param name="cnonce" type="String"/>
                    <param name="ncValue" type="String"/>
                </params>
                <comment line="466">
                                        
                </comment>
                <comment line="470">
                                        
                </comment>
                <declaration name="A1" type="String" line="438"/>
                <declaration name="algorithm" type="String" line="439"/>
                <declaration name="md5sess" type="boolean" line="440"/>
                <declaration name="md" type="MessageDigest" line="442"/>
                <scope line="444">
                    <scope line="445">
                        <declaration name="s" type="String" line="446"/>
                        <declaration name="s1" type="String" line="447"/>
                    </scope>
                </scope>
                <scope line="452"/>
                <declaration name="A2" type="String" line="457"/>
                <scope line="458"/>
                <scope line="460"/>
                <declaration name="HashA2" type="String" line="463"/>
                <declaration name="combo" type="String" line="464"/>
                <scope line="466"/>
                <scope line="470"/>
            </method>
            <declaration name="charArray" type="char" line="479"/>
            <declaration name="zeroPad" type="String" line="484"/>
            <method name="encode" type="String" line="489">
                <params>
                    <param name="src" type="String"/>
                    <param name="passwd" type="char[]"/>
                    <param name="md" type="MessageDigest"/>
                </params>
                <scope line="490"/>
                <scope line="492"/>
                <scope line="495">
                    <declaration name="passwdBytes" type="byte[]" line="496"/>
                </scope>
                <declaration name="digest" type="byte[]" line="502"/>
                <declaration name="res" type="StringBuffer" line="504"/>
                <scope line="505">
                    <declaration name="hashchar" type="int" line="506"/>
                </scope>
            </method>
        </class>
    </source>