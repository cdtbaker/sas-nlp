<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.validator">
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.cert"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.action.GetBooleanAction"/>
        <import package="sun.security.provider.certpath.AlgorithmChecker"/>
        <class name="PKIXValidator" line="8">
            <extends class="Validator"/>
            <javadoc line="8">
                Validator implementation built on the PKIX CertPath API. This
                  implementation will be emphasized going forward.&lt;p&gt;
                  &lt;p&gt;
                  Note that the validate() implementation tries to use a PKIX validator
                  if that appears possible and a PKIX builder otherwise. This increases
                  performance and currently also leads to better exception messages
                  in case of failures.
                  &lt;p&gt;{@code PKIXValidator} objects are immutable once they have been created.
                  Please DO NOT add methods that can change the state of an instance once
                  it has been created.                
                <author>
                    Andreas Sterbenz                    
                </author>
            </javadoc>
            <declaration name="checkTLSRevocation" type="boolean" line="22"/>
            <javadoc line="22">
                Flag indicating whether to enable revocation check for the PKIX trust
                  manager. Typically, this will only work if the PKIX implementation
                  supports CRL distribution points as we do not manually setup CertStores.                
            </javadoc>
            <declaration name="TRY_VALIDATOR" type="boolean" line="28"/>
            <declaration name="trustedCerts" type="Set&lt;X509Certificate&gt;" line="29"/>
            <declaration name="parameterTemplate" type="PKIXBuilderParameters" line="30"/>
            <declaration name="certPathLength" type="int" line="31"/>
            <declaration name="trustedSubjects" type="Map&lt;X500Principal,List&lt;PublicKey&gt;&gt;" line="32"/>
            <declaration name="factory" type="CertificateFactory" line="33"/>
            <declaration name="plugin" type="boolean" line="34"/>
            <method name="PKIXValidator" type="constructor" line="35">
                <params>
                    <param name="variant" type="String"/>
                    <param name="trustedCerts" type="Collection<X509Certificate>"/>
                </params>
                <scope line="37"/>
                <scope line="40"/>
                <declaration name="trustAnchors" type="Set&lt;TrustAnchor&gt;" line="43"/>
                <scope line="44"/>
                <scope line="47"/>
                <scope line="50"/>
                <scope line="54">
                    <scope line="55"/>
                    <scope line="59">
                        <declaration name="dn" type="X500Principal" line="60"/>
                        <declaration name="keys" type="List&lt;PublicKey&gt;" line="61"/>
                        <scope line="62"/>
                        <scope line="65"/>
                    </scope>
                    <scope line="71"/>
                    <scope line="74"/>
                </scope>
                <scope line="79"/>
            </method>
            <method name="PKIXValidator" type="constructor" line="83">
                <params>
                    <param name="variant" type="String"/>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <scope line="86">
                    <declaration name="cert" type="X509Certificate" line="87"/>
                    <scope line="88"/>
                </scope>
                <scope line="93">
                    <scope line="94"/>
                    <scope line="98">
                        <declaration name="dn" type="X500Principal" line="99"/>
                        <declaration name="keys" type="List&lt;PublicKey&gt;" line="100"/>
                        <scope line="101"/>
                        <scope line="104"/>
                    </scope>
                    <scope line="110"/>
                    <scope line="113"/>
                </scope>
                <scope line="118"/>
            </method>
            <method name="getTrustedCertificates" type="Collection<X509Certificate>" line="122"/>
            <javadoc line="125">
                Returns the length of the last certification path that is validated by
                  CertPathValidator. This is intended primarily as a callback mechanism
                  for PKIXCertPathCheckers to determine the length of the certification
                  path that is being validated. It is necessary since engineValidate()
                  may modify the length of the path.                
                <return>
                    the length of the last certification path passed to
                      CertPathValidator.validate, or -1 if it has not been invoked yet                    
                </return>
            </javadoc>
            <method name="getCertPathLength" type="int" line="134"/>
            <javadoc line="137">
                Set J2SE global default PKIX parameters. Currently, hardcoded to disable
                  revocation checking. In the future, this should be configurable.                
            </javadoc>
            <method name="setDefaultParameters" type="void" line="141">
                <params>
                    <param name="variant" type="String"/>
                </params>
                <scope line="142"/>
                <scope line="145"/>
            </method>
            <javadoc line="149">
                Return the PKIX parameters used by this instance. An application may
                  modify the parameters but must make sure not to perform any concurrent
                  validations.                
            </javadoc>
            <method name="getParameters" type="PKIXBuilderParameters" line="154"/>
            <method name="engineValidate" type="X509Certificate[]" line="157">
                <params>
                    <param name="chain" type="X509Certificate[]"/>
                    <param name="otherCerts" type="Collection<X509Certificate>"/>
                    <param name="constraints" type="AlgorithmConstraints"/>
                    <param name="parameter" type="Object"/>
                </params>
                <scope line="158"/>
                <declaration name="pkixParameters" type="PKIXBuilderParameters" line="161"/>
                <declaration name="algorithmChecker" type="AlgorithmChecker" line="162"/>
                <scope line="163"/>
                <scope line="167">
                    <declaration name="prevIssuer" type="X500Principal" line="168"/>
                    <scope line="169">
                        <declaration name="cert" type="X509Certificate" line="170"/>
                        <declaration name="dn" type="X500Principal" line="171"/>
                        <scope line="172"/>
                        <scope line="175">
                            <scope line="176"/>
                            <declaration name="newChain" type="X509Certificate[]" line="179"/>
                        </scope>
                    </scope>
                    <declaration name="last" type="X509Certificate" line="185"/>
                    <declaration name="issuer" type="X500Principal" line="186"/>
                    <declaration name="subject" type="X500Principal" line="187"/>
                    <scope line="188"/>
                    <scope line="191">
                        <scope line="192">
                            <declaration name="newChain" type="X509Certificate[]" line="193"/>
                            <scope line="195"/>
                            <scope line="198"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="isSignatureValid" type="boolean" line="208">
                <params>
                    <param name="keys" type="List<PublicKey>"/>
                    <param name="sub" type="X509Certificate"/>
                </params>
                <scope line="209">
                    <scope line="210">
                        <scope line="211"/>
                        <scope line="215"/>
                    </scope>
                </scope>
            </method>
            <method name="toArray" type="X509Certificate[]" line="223">
                <params>
                    <param name="path" type="CertPath"/>
                    <param name="anchor" type="TrustAnchor"/>
                </params>
                <declaration name="list" type="List&lt;? extends java.security.cert.Certificate&gt;" line="224"/>
                <declaration name="chain" type="X509Certificate[]" line="225"/>
                <declaration name="trustedCert" type="X509Certificate" line="227"/>
                <scope line="228"/>
            </method>
            <javadoc line="234">
                Set the check date (for debugging).                
            </javadoc>
            <method name="setDate" type="void" line="237">
                <params>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <declaration name="date" type="Date" line="238"/>
                <scope line="239"/>
            </method>
            <method name="doValidate" type="X509Certificate[]" line="243">
                <params>
                    <param name="chain" type="X509Certificate[]"/>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <scope line="244">
                    <declaration name="validator" type="CertPathValidator" line="246"/>
                    <declaration name="path" type="CertPath" line="247"/>
                    <declaration name="result" type="PKIXCertPathValidatorResult" line="249"/>
                </scope>
                <scope line="252"/>
            </method>
            <method name="doBuild" type="X509Certificate[]" line="256">
                <params>
                    <param name="chain" type="X509Certificate[]"/>
                    <param name="otherCerts" type="Collection<X509Certificate>"/>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <scope line="257">
                    <declaration name="selector" type="X509CertSelector" line="259"/>
                    <declaration name="certs" type="Collection&lt;X509Certificate&gt;" line="262"/>
                    <scope line="264"/>
                    <declaration name="store" type="CertStore" line="267"/>
                    <declaration name="builder" type="CertPathBuilder" line="269"/>
                    <declaration name="result" type="PKIXCertPathBuilderResult" line="270"/>
                </scope>
                <scope line="273"/>
            </method>
        </class>
    </source>