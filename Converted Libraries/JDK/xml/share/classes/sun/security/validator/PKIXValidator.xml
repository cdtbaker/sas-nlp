<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.validator">
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.cert"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.action.GetBooleanAction"/>
        <import package="sun.security.provider.certpath.AlgorithmChecker"/>
        <class name="PKIXValidator" line="37">
            <extends class="Validator"/>
            <comment line="64">
                enable use of the validator if possible                
            </comment>
            <comment line="71">
                needed only for the validator                
            </comment>
            <javadoc line="37">
                Validator implementation built on the PKIX CertPath API. This
                  implementation will be emphasized going forward.&lt;p&gt;
                  &lt;p&gt;
                  Note that the validate() implementation tries to use a PKIX validator
                  if that appears possible and a PKIX builder otherwise. This increases
                  performance and currently also leads to better exception messages
                  in case of failures.
                  &lt;p&gt;{@code PKIXValidator} objects are immutable once they have been created.
                  Please DO NOT add methods that can change the state of an instance once
                  it has been created.                
                <author>
                    Andreas Sterbenz                    
                </author>
            </javadoc>
            <declaration name="checkTLSRevocation" type="boolean" line="54"/>
            <javadoc line="54">
                Flag indicating whether to enable revocation check for the PKIX trust
                  manager. Typically, this will only work if the PKIX implementation
                  supports CRL distribution points as we do not manually setup CertStores.                
            </javadoc>
            <declaration name="TRY_VALIDATOR" type="boolean" line="64"/>
            <declaration name="trustedCerts" type="Set&lt;X509Certificate&gt;" line="66"/>
            <declaration name="parameterTemplate" type="PKIXBuilderParameters" line="67"/>
            <declaration name="certPathLength" type="int" line="68"/>
            <declaration name="trustedSubjects" type="Map&lt;X500Principal,List&lt;PublicKey&gt;&gt;" line="71"/>
            <declaration name="factory" type="CertificateFactory" line="72"/>
            <declaration name="plugin" type="boolean" line="74"/>
            <method name="PKIXValidator" type="constructor" line="76">
                <params>
                    <param name="variant" type="String"/>
                    <param name="trustedCerts" type="Collection<X509Certificate>"/>
                </params>
                <comment line="94">
                    initCommon();                    
                </comment>
                <scope line="78"/>
                <scope line="80"/>
                <declaration name="trustAnchors" type="Set&lt;TrustAnchor&gt;" line="83"/>
                <scope line="84"/>
                <scope line="87"/>
                <scope line="89"/>
                <scope line="95">
                    <scope line="96"/>
                    <scope line="100">
                        <declaration name="dn" type="X500Principal" line="101"/>
                        <declaration name="keys" type="List&lt;PublicKey&gt;" line="102"/>
                        <scope line="103"/>
                        <scope line="105"/>
                    </scope>
                    <scope line="111"/>
                    <scope line="113"/>
                </scope>
                <scope line="117"/>
            </method>
            <method name="PKIXValidator" type="constructor" line="122">
                <params>
                    <param name="variant" type="String"/>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <comment line="133">
                    initCommon();                    
                </comment>
                <scope line="125">
                    <declaration name="cert" type="X509Certificate" line="126"/>
                    <scope line="127"/>
                </scope>
                <scope line="134">
                    <scope line="135"/>
                    <scope line="139">
                        <declaration name="dn" type="X500Principal" line="140"/>
                        <declaration name="keys" type="List&lt;PublicKey&gt;" line="141"/>
                        <scope line="142"/>
                        <scope line="144"/>
                    </scope>
                    <scope line="150"/>
                    <scope line="152"/>
                </scope>
                <scope line="156"/>
            </method>
            <method name="getTrustedCertificates" type="Collection<X509Certificate>" line="161"/>
            <javadoc line="165">
                Returns the length of the last certification path that is validated by
                  CertPathValidator. This is intended primarily as a callback mechanism
                  for PKIXCertPathCheckers to determine the length of the certification
                  path that is being validated. It is necessary since engineValidate()
                  may modify the length of the path.                
                <return>
                    the length of the last certification path passed to
                      CertPathValidator.validate, or -1 if it has not been invoked yet                    
                </return>
            </javadoc>
            <method name="getCertPathLength" type="int" line="175">
                <comment line="175">
                    mutable, should be private                    
                </comment>
            </method>
            <javadoc line="179">
                Set J2SE global default PKIX parameters. Currently, hardcoded to disable
                  revocation checking. In the future, this should be configurable.                
            </javadoc>
            <method name="setDefaultParameters" type="void" line="183">
                <params>
                    <param name="variant" type="String"/>
                </params>
                <scope line="185"/>
                <scope line="187"/>
            </method>
            <javadoc line="192">
                Return the PKIX parameters used by this instance. An application may
                  modify the parameters but must make sure not to perform any concurrent
                  validations.                
            </javadoc>
            <method name="getParameters" type="PKIXBuilderParameters" line="197">
                <comment line="197">
                    mutable, should be private                    
                </comment>
            </method>
            <method name="engineValidate" type="X509Certificate[]" line="205">
                <params>
                    <param name="chain" type="X509Certificate[]"/>
                    <param name="otherCerts" type="Collection<X509Certificate>"/>
                    <param name="constraints" type="AlgorithmConstraints"/>
                    <param name="parameter" type="Object"/>
                </params>
                <comment line="211">
                    add  new algorithm constraints checker                    
                </comment>
                <comment line="221">
                    check that chain is in correct order and check if chain contains                    
                </comment>
                <comment line="222">
                    trust anchor                    
                </comment>
                <comment line="229">
                    chain is not ordered correctly, call builder instead                    
                </comment>
                <comment line="233">
                    Check if chain[i] is already trusted. It may be inside                    
                </comment>
                <comment line="234">
                    trustedCerts, or has the same dn and public key as a cert                    
                </comment>
                <comment line="235">
                    inside trustedCerts. The latter happens when a CA has                    
                </comment>
                <comment line="236">
                    updated its cert with a stronger signature algorithm in JRE                    
                </comment>
                <comment line="237">
                    but the weak one is still in circulation.                    
                </comment>
                <comment line="239">
                    trusted cert                    
                </comment>
                <comment line="240">
                    replacing ...                    
                </comment>
                <comment line="241">
                    ... weak cert                    
                </comment>
                <comment line="246">
                    Remove and call validator on partial chain [0 .. i-1]                    
                </comment>
                <comment line="254">
                    apparently issued by trust anchor?                    
                </comment>
                <comment line="263">
                    don&apos;t fallback to builder if called from plugin/webstart                    
                </comment>
                <comment line="265">
                    Validate chain even if no trust anchor is found. This                    
                </comment>
                <comment line="266">
                    allows plugin/webstart to make sure the chain is                    
                </comment>
                <comment line="267">
                    otherwise valid                    
                </comment>
                <comment line="273">
                    temporarily set last cert as sole trust anchor                    
                </comment>
                <comment line="279">
                    should never occur, but ...                    
                </comment>
                <comment line="284">
                    if the rest of the chain is valid, throw exception                    
                </comment>
                <comment line="285">
                    indicating no trust anchor was found                    
                </comment>
                <comment line="289">
                    otherwise, fall back to builder                    
                </comment>
                <scope line="206"/>
                <declaration name="pkixParameters" type="PKIXBuilderParameters" line="212"/>
                <declaration name="algorithmChecker" type="AlgorithmChecker" line="214"/>
                <scope line="215"/>
                <scope line="220">
                    <declaration name="prevIssuer" type="X500Principal" line="223"/>
                    <scope line="224">
                        <declaration name="cert" type="X509Certificate" line="225"/>
                        <declaration name="dn" type="X500Principal" line="226"/>
                        <scope line="228"/>
                        <scope line="242">
                            <scope line="243"/>
                            <declaration name="newChain" type="X509Certificate[]" line="247"/>
                        </scope>
                    </scope>
                    <declaration name="last" type="X509Certificate" line="255"/>
                    <declaration name="issuer" type="X500Principal" line="256"/>
                    <declaration name="subject" type="X500Principal" line="257"/>
                    <scope line="259"/>
                    <scope line="264">
                        <scope line="268">
                            <declaration name="newChain" type="X509Certificate[]" line="269"/>
                            <scope line="274"/>
                            <scope line="278"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="isSignatureValid" type="boolean" line="296">
                <params>
                    <param name="keys" type="List<PublicKey>"/>
                    <param name="sub" type="X509Certificate"/>
                </params>
                <comment line="308">
                    only check if PLUGIN is set                    
                </comment>
                <scope line="297">
                    <scope line="298">
                        <scope line="299"/>
                        <scope line="302"/>
                    </scope>
                </scope>
            </method>
            <method name="toArray" type="X509Certificate[]" line="312">
                <params>
                    <param name="path" type="CertPath"/>
                    <param name="anchor" type="TrustAnchor"/>
                </params>
                <declaration name="list" type="List&lt;? extends java.security.cert.Certificate&gt;" line="313"/>
                <declaration name="chain" type="X509Certificate[]" line="315"/>
                <declaration name="trustedCert" type="X509Certificate" line="317"/>
                <scope line="318"/>
            </method>
            <javadoc line="326">
                Set the check date (for debugging).                
            </javadoc>
            <method name="setDate" type="void" line="329">
                <params>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <declaration name="date" type="Date" line="330"/>
                <scope line="331"/>
            </method>
            <method name="doValidate" type="X509Certificate[]" line="337">
                <params>
                    <param name="chain" type="X509Certificate[]"/>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <comment line="341">
                    do the validation                    
                </comment>
                <scope line="338">
                    <declaration name="validator" type="CertPathValidator" line="342"/>
                    <declaration name="path" type="CertPath" line="343"/>
                    <declaration name="result" type="PKIXCertPathValidatorResult" line="345"/>
                </scope>
                <scope line="349"/>
            </method>
            <method name="doBuild" type="X509Certificate[]" line="357">
                <params>
                    <param name="chain" type="X509Certificate[]"/>
                    <param name="otherCerts" type="Collection<X509Certificate>"/>
                    <param name="params" type="PKIXBuilderParameters"/>
                </params>
                <comment line="362">
                    setup target constraints                    
                </comment>
                <comment line="367">
                    setup CertStores                    
                </comment>
                <comment line="378">
                    do the build                    
                </comment>
                <scope line="359">
                    <declaration name="selector" type="X509CertSelector" line="363"/>
                    <declaration name="certs" type="Collection&lt;X509Certificate&gt;" line="368"/>
                    <scope line="371"/>
                    <declaration name="store" type="CertStore" line="374"/>
                    <declaration name="builder" type="CertPathBuilder" line="379"/>
                    <declaration name="result" type="PKIXCertPathBuilderResult" line="380"/>
                </scope>
                <scope line="384"/>
            </method>
        </class>
    </source>