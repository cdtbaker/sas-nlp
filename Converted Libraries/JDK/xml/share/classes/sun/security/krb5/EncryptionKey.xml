<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5">
        <import package="sun.security.util"/>
        <import package="sun.security.krb5.internal"/>
        <import package="sun.security.krb5.internal.crypto"/>
        <import package="java.io.IOException"/>
        <import package="java.security.GeneralSecurityException"/>
        <import package="java.util.Arrays"/>
        <import package="sun.security.krb5.internal.ktab.KeyTab"/>
        <import package="sun.security.krb5.internal.ccache.CCacheOutputStream"/>
        <import package="javax.crypto.spec.DESKeySpec"/>
        <import package="javax.crypto.spec.DESedeKeySpec"/>
        <class name="EncryptionKey" line="12">
            <implements interface="Cloneable"/>
            <javadoc line="12">
                This class encapsulates the concept of an EncryptionKey. An encryption
                  key is defined in RFC 4120 as:
                  EncryptionKey   ::= SEQUENCE {
                  keytype         [0] Int32 -- actually encryption type --,
                  keyvalue        [1] OCTET STRING
                  }
                  keytype
                  This field specifies the encryption type of the encryption key
                  that follows in the keyvalue field.  Although its name is
                  &quot;keytype&quot;, it actually specifies an encryption type.  Previously,
                  multiple cryptosystems that performed encryption differently but
                  were capable of using keys with the same characteristics were
                  permitted to share an assigned number to designate the type of
                  key; this usage is now deprecated.
                  keyvalue
                  This field contains the key itself, encoded as an octet string.                
            </javadoc>
            <declaration name="NULL_KEY" type="EncryptionKey" line="31"/>
            <declaration name="keyType" type="int" line="32"/>
            <declaration name="keyValue" type="byte[]" line="33"/>
            <declaration name="kvno" type="Integer" line="34"/>
            <declaration name="DEBUG" type="boolean" line="35"/>
            <method name="getEType" type="int" line="36"/>
            <method name="getKeyVersionNumber" type="Integer" line="39"/>
            <javadoc line="42">
                Returns the raw key bytes, not in any ASN.1 encoding.                
            </javadoc>
            <method name="getBytes" type="byte[]" line="45"/>
            <method name="clone" type="Object" line="48"/>
            <javadoc line="51">
                Obtains all versions of the secret key of the principal from a
                  keytab.                
                <Param>
                    princ the principal whose secret key is desired                    
                </Param>
                <param>
                    keytab the path to the keytab file. A value of null
                      will be accepted to indicate that the default path should be
                      searched.                    
                </param>
                <returns>
                    an array of secret keys or null if none were found.                    
                </returns>
            </javadoc>
            <method name="acquireSecretKeys" type="EncryptionKey[]" line="60">
                <params>
                    <param name="princ" type="PrincipalName"/>
                    <param name="keytab" type="String"/>
                </params>
                <declaration name="ktab" type="KeyTab" line="62"/>
            </method>
            <javadoc line="65">
                Obtains a key for a given etype with salt and optional s2kparams                
                <param>
                    password NOT null                    
                </param>
                <param>
                    salt NOT null                    
                </param>
                <param>
                    etype                    
                </param>
                <param>
                    s2kparams can be NULL                    
                </param>
            </javadoc>
            <method name="acquireSecretKey" type="EncryptionKey" line="72">
                <params>
                    <param name="password" type="char[]"/>
                    <param name="salt" type="String"/>
                    <param name="etype" type="int"/>
                    <param name="s2kparams" type="byte[]"/>
                </params>
            </method>
            <javadoc line="75">
                Generate a list of keys using the given principal and password.
                  Construct a key for each configured etype.
                  Caller is responsible for clearing password.                
            </javadoc>
            <method name="acquireSecretKeys" type="EncryptionKey[]" line="80">
                <params>
                    <param name="password" type="char[]"/>
                    <param name="salt" type="String"/>
                </params>
                <declaration name="etypes" type="int[]" line="81"/>
                <scope line="82"/>
                <declaration name="encKeys" type="EncryptionKey[]" line="85"/>
                <scope line="86">
                    <scope line="87"/>
                    <scope line="90">
                        <scope line="91"/>
                    </scope>
                </scope>
            </method>
            <method name="EncryptionKey" type="constructor" line="98">
                <params>
                    <param name="keyValue" type="byte[]"/>
                    <param name="keyType" type="int"/>
                    <param name="kvno" type="Integer"/>
                </params>
                <scope line="99"/>
                <scope line="103"/>
            </method>
            <javadoc line="109">
                Constructs an EncryptionKey by using the specified key type and key
                  value.  It is used to recover the key when retrieving data from
                  credential cache file.                
            </javadoc>
            <method name="EncryptionKey" type="constructor" line="114">
                <params>
                    <param name="keyType" type="int"/>
                    <param name="keyValue" type="byte[]"/>
                </params>
            </method>
            <method name="stringToKey" type="byte[]" line="117">
                <params>
                    <param name="password" type="char[]"/>
                    <param name="salt" type="String"/>
                    <param name="s2kparams" type="byte[]"/>
                    <param name="keyType" type="int"/>
                </params>
                <declaration name="slt" type="char[]" line="118"/>
                <declaration name="pwsalt" type="char[]" line="119"/>
                <scope line="123"/>
                <scope line="140">
                    <declaration name="ke" type="KrbCryptoException" line="141"/>
                </scope>
                <scope line="145"/>
            </method>
            <method name="EncryptionKey" type="constructor" line="149">
                <params>
                    <param name="password" type="char[]"/>
                    <param name="salt" type="String"/>
                    <param name="algorithm" type="String"/>
                </params>
                <scope line="150"/>
                <scope line="153"/>
                <scope line="156"/>
                <scope line="159"/>
                <scope line="162">
                    <scope line="164"/>
                </scope>
                <scope line="168"/>
            </method>
            <javadoc line="174">
                Generates a sub-sessionkey from a given session key.                
            </javadoc>
            <method name="EncryptionKey" type="constructor" line="177">
                <params>
                    <param name="key" type="EncryptionKey"/>
                </params>
                <scope line="179"/>
                <scope line="183">
                    <scope line="184">
                        <scope line="185"/>
                        <scope line="188"/>
                    </scope>
                    <scope line="192">
                        <scope line="193"/>
                        <declaration name="oneKey" type="byte[]" line="196"/>
                        <scope line="197">
                            <scope line="199"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="205">
                    <declaration name="ke" type="KrbCryptoException" line="206"/>
                </scope>
            </method>
            <javadoc line="211">
                Constructs an instance of EncryptionKey type.                
                <param>
                    encoding a single DER-encoded value.                    
                </param>
                <exception>
                    Asn1Exception if an error occurs while decoding an ASN1
                      encoded data.                    
                </exception>
                <exception>
                    IOException if an I/O error occurs while reading encoded
                      data.                    
                </exception>
            </javadoc>
            <method name="EncryptionKey" type="constructor" line="219">
                <params>
                    <param name="encoding" type="DerValue"/>
                </params>
                <declaration name="der" type="DerValue" line="220"/>
                <scope line="221"/>
                <scope line="225"/>
                <scope line="230"/>
                <scope line="234"/>
            </method>
            <javadoc line="238">
                Returns the ASN.1 encoding of this EncryptionKey.
                  &lt;xmp&gt;
                  EncryptionKey ::=   SEQUENCE {
                  keytype[0]    INTEGER,
                  keyvalue[1]   OCTET STRING }
                  &lt;/xmp&gt;
                  &lt;p&gt;
                  This definition reflects the Network Working Group RFC 4120
                  specification available at
                  &lt;a href=&quot;http://www.ietf.org/rfc/rfc4120.txt&quot;&gt;
                  http://www.ietf.org/rfc/rfc4120.txt&lt;/a&gt;.                
                <return>
                    byte array of encoded EncryptionKey object.                    
                </return>
                <exception>
                    Asn1Exception if an error occurs while decoding an ASN1
                      encoded data.                    
                </exception>
                <exception>
                    IOException if an I/O error occurs while reading encoded
                      data.                    
                </exception>
            </javadoc>
            <method name="asn1Encode" type="byte[]" line="256">
                <declaration name="bytes" type="DerOutputStream" line="257"/>
                <declaration name="temp" type="DerOutputStream" line="258"/>
            </method>
            <method name="destroy" type="void" line="268"/>
            <javadoc line="271">
                Parse (unmarshal) an Encryption key from a DER input stream.  This form
                  parsing might be used when expanding a value which is part of
                  a constructed sequence and uses explicitly tagged type.                
                <param>
                    data the Der input stream value, which contains one or more
                      marshaled value.                    
                </param>
                <param>
                    explicitTag tag number.                    
                </param>
                <param>
                    optional indicate if this data field is optional                    
                </param>
                <exception>
                    Asn1Exception if an error occurs while decoding an ASN1
                      encoded data.                    
                </exception>
                <exception>
                    IOException if an I/O error occurs while reading encoded
                      data.                    
                </exception>
                <return>
                    an instance of EncryptionKey.                    
                </return>
            </javadoc>
            <method name="parse" type="EncryptionKey" line="285">
                <params>
                    <param name="data" type="DerInputStream"/>
                    <param name="explicitTag" type="byte"/>
                    <param name="optional" type="boolean"/>
                </params>
                <scope line="286"/>
                <declaration name="der" type="DerValue" line="289"/>
                <scope line="290"/>
                <scope line="293">
                    <declaration name="subDer" type="DerValue" line="294"/>
                </scope>
            </method>
            <javadoc line="298">
                Writes key value in FCC format to a &lt;code&gt;CCacheOutputStream&lt;/code&gt;.                
                <param>
                    cos a <code>CCacheOutputStream</code> to be written to.                    
                </param>
                <exception>
                    IOException if an I/O exception occurs.                    
                </exception>
                <see>
                    sun.security.krb5.internal.ccache.CCacheOutputStream                    
                </see>
            </javadoc>
            <method name="writeKey" type="void" line="304">
                <params>
                    <param name="cos" type="CCacheOutputStream"/>
                </params>
                <scope line="308"/>
            </method>
            <method name="toString" type="String" line="312"/>
            <javadoc line="315">
                Find a key with given etype                
            </javadoc>
            <method name="findKey" type="EncryptionKey" line="318">
                <params>
                    <param name="etype" type="int"/>
                    <param name="keys" type="EncryptionKey[]"/>
                </params>
            </method>
            <javadoc line="321">
                Determines if a kvno matches another kvno. Used in the method
                  findKey(type, kvno, keys). Always returns true if either input
                  is null or zero, in case any side does not have kvno info available.
                  Note: zero is included because N/A is not a legal value for kvno
                  in javax.security.auth.kerberos.KerberosKey. Therefore, the info
                  that the kvno is N/A might be lost when converting between this
                  class and KerberosKey.                
            </javadoc>
            <method name="versionMatches" type="boolean" line="330">
                <params>
                    <param name="v1" type="Integer"/>
                    <param name="v2" type="Integer"/>
                </params>
                <scope line="331"/>
            </method>
            <javadoc line="336">
                Find a key with given etype and kvno                
                <param>
                    kvno if null, return any (first?) key                    
                </param>
            </javadoc>
            <method name="findKey" type="EncryptionKey" line="340">
                <params>
                    <param name="etype" type="int"/>
                    <param name="kvno" type="Integer"/>
                    <param name="keys" type="EncryptionKey[]"/>
                </params>
                <scope line="341"/>
                <declaration name="ktype" type="int" line="344"/>
                <declaration name="etypeFound" type="boolean" line="345"/>
                <scope line="346">
                    <scope line="348">
                        <declaration name="kv" type="Integer" line="349"/>
                        <scope line="350">
                            <scope line="352"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="358">
                    <scope line="359">
                        <scope line="361">
                            <declaration name="kv" type="Integer" line="362"/>
                            <scope line="364"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="370"/>
            </method>
        </class>
    </source>