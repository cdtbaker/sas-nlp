<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5.internal.crypto.dk">
        <import package="java.security"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.spec"/>
        <import package="java.util"/>
        <import package="sun.security.krb5.EncryptedData"/>
        <import package="sun.security.krb5.KrbCryptoException"/>
        <import package="sun.security.krb5.Confounder"/>
        <import package="sun.security.krb5.internal.crypto.KeyUsage"/>
        <class name="ArcFourCrypto" line="10">
            <extends class="DkCrypto"/>
            <javadoc line="10">
                Support for ArcFour in Kerberos
                  as defined in RFC 4757.
                  http://www.ietf.org/rfc/rfc4757.txt                
                <author>
                    Seema Malkani                    
                </author>
            </javadoc>
            <declaration name="debug" type="boolean" line="17"/>
            <declaration name="confounderSize" type="int" line="18"/>
            <declaration name="ZERO_IV" type="byte[]" line="19"/>
            <declaration name="hashSize" type="int" line="20"/>
            <declaration name="keyLength" type="int" line="21"/>
            <method name="ArcFourCrypto" type="constructor" line="22">
                <params>
                    <param name="length" type="int"/>
                </params>
            </method>
            <method name="getKeySeedLength" type="int" line="25"/>
            <method name="randomToKey" type="byte[]" line="28">
                <params>
                    <param name="in" type="byte[]"/>
                </params>
            </method>
            <method name="stringToKey" type="byte[]" line="31">
                <params>
                    <param name="passwd" type="char[]"/>
                </params>
            </method>
            <method name="stringToKey" type="byte[]" line="34">
                <params>
                    <param name="secret" type="char[]"/>
                    <param name="opaque" type="byte[]"/>
                </params>
                <scope line="35"/>
                <declaration name="passwd" type="byte[]" line="38"/>
                <declaration name="digest" type="byte[]" line="39"/>
                <scope line="40">
                    <declaration name="md" type="MessageDigest" line="42"/>
                </scope>
                <scope line="46"/>
                <scope line="49">
                    <scope line="50"/>
                </scope>
            </method>
            <method name="getCipher" type="Cipher" line="56">
                <params>
                    <param name="key" type="byte[]"/>
                    <param name="ivec" type="byte[]"/>
                    <param name="mode" type="int"/>
                </params>
                <scope line="57"/>
                <declaration name="secretKey" type="SecretKeySpec" line="60"/>
                <declaration name="cipher" type="Cipher" line="61"/>
                <declaration name="encIv" type="IvParameterSpec" line="62"/>
            </method>
            <method name="getChecksumLength" type="int" line="66"/>
            <javadoc line="69">
                Get the HMAC-MD5                
            </javadoc>
            <method name="getHmac" type="byte[]" line="72">
                <params>
                    <param name="key" type="byte[]"/>
                    <param name="msg" type="byte[]"/>
                </params>
                <declaration name="keyKi" type="SecretKey" line="73"/>
                <declaration name="m" type="Mac" line="74"/>
                <declaration name="hash" type="byte[]" line="76"/>
            </method>
            <javadoc line="79">
                Calculate the checksum                
            </javadoc>
            <method name="calculateChecksum" type="byte[]" line="82">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="input" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="83"/>
                <scope line="86"/>
                <declaration name="Ksign" type="byte[]" line="89"/>
                <scope line="90">
                    <declaration name="ss" type="byte[]" line="91"/>
                    <declaration name="new_ss" type="byte[]" line="92"/>
                </scope>
                <scope line="96">
                    <declaration name="gse" type="GeneralSecurityException" line="97"/>
                </scope>
                <declaration name="salt" type="byte[]" line="101"/>
                <declaration name="messageDigest" type="MessageDigest" line="102"/>
                <scope line="103"/>
                <scope line="106">
                    <declaration name="gse" type="GeneralSecurityException" line="107"/>
                </scope>
                <declaration name="md5tmp" type="byte[]" line="113"/>
                <declaration name="hmac" type="byte[]" line="114"/>
                <scope line="115"/>
                <scope line="118"/>
                <scope line="121">
                    <declaration name="buf" type="byte[]" line="122"/>
                </scope>
                <scope line="126"/>
            </method>
            <javadoc line="130">
                Performs encryption of Sequence Number using derived key.                
            </javadoc>
            <method name="encryptSeq" type="byte[]" line="133">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="checksum" type="byte[]"/>
                    <param name="plaintext" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="134"/>
                <declaration name="salt" type="byte[]" line="137"/>
                <declaration name="kSeq" type="byte[]" line="138"/>
                <declaration name="cipher" type="Cipher" line="140"/>
                <declaration name="secretKey" type="SecretKeySpec" line="141"/>
                <declaration name="output" type="byte[]" line="143"/>
            </method>
            <javadoc line="146">
                Performs decryption of Sequence Number using derived key.                
            </javadoc>
            <method name="decryptSeq" type="byte[]" line="149">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="checksum" type="byte[]"/>
                    <param name="ciphertext" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="150"/>
                <declaration name="salt" type="byte[]" line="153"/>
                <declaration name="kSeq" type="byte[]" line="154"/>
                <declaration name="cipher" type="Cipher" line="156"/>
                <declaration name="secretKey" type="SecretKeySpec" line="157"/>
                <declaration name="output" type="byte[]" line="159"/>
            </method>
            <javadoc line="162">
                Performs encryption using derived key; adds confounder.                
            </javadoc>
            <method name="encrypt" type="byte[]" line="165">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="ivec" type="byte[]"/>
                    <param name="new_ivec" type="byte[]"/>
                    <param name="plaintext" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="166"/>
                <scope line="169"/>
                <declaration name="confounder" type="byte[]" line="172"/>
                <declaration name="plainSize" type="int" line="173"/>
                <declaration name="toBeEncrypted" type="byte[]" line="174"/>
                <declaration name="k1" type="byte[]" line="177"/>
                <declaration name="salt" type="byte[]" line="179"/>
                <declaration name="k2" type="byte[]" line="180"/>
                <declaration name="checksum" type="byte[]" line="181"/>
                <declaration name="k3" type="byte[]" line="182"/>
                <declaration name="cipher" type="Cipher" line="183"/>
                <declaration name="secretKey" type="SecretKeySpec" line="184"/>
                <declaration name="output" type="byte[]" line="186"/>
                <declaration name="result" type="byte[]" line="187"/>
            </method>
            <javadoc line="192">
                Performs encryption using derived key; does not add confounder.                
            </javadoc>
            <method name="encryptRaw" type="byte[]" line="195">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="seqNum" type="byte[]"/>
                    <param name="plaintext" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="196"/>
                <scope line="199"/>
                <declaration name="klocal" type="byte[]" line="202"/>
                <scope line="203"/>
                <declaration name="salt" type="byte[]" line="206"/>
                <declaration name="kcrypt" type="byte[]" line="207"/>
                <declaration name="cipher" type="Cipher" line="209"/>
                <declaration name="secretKey" type="SecretKeySpec" line="210"/>
                <declaration name="output" type="byte[]" line="212"/>
            </method>
            <javadoc line="215">
                @param baseKey key from which keys are to be derived using usage                
                <param>
                    ciphertext  E(Ke, conf | plaintext | padding, ivec) | H1[1..h]                    
                </param>
            </javadoc>
            <method name="decrypt" type="byte[]" line="219">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="ivec" type="byte[]"/>
                    <param name="ciphertext" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="220"/>
                <scope line="223"/>
                <declaration name="k1" type="byte[]" line="226"/>
                <declaration name="salt" type="byte[]" line="228"/>
                <declaration name="k2" type="byte[]" line="229"/>
                <declaration name="checksum" type="byte[]" line="230"/>
                <declaration name="k3" type="byte[]" line="232"/>
                <declaration name="cipher" type="Cipher" line="233"/>
                <declaration name="secretKey" type="SecretKeySpec" line="234"/>
                <declaration name="plaintext" type="byte[]" line="236"/>
                <declaration name="calculatedHmac" type="byte[]" line="237"/>
                <scope line="238"/>
                <declaration name="cksumFailed" type="boolean" line="242"/>
                <scope line="243">
                    <scope line="244">
                        <scope line="245">
                            <scope line="247"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="254"/>
                <declaration name="output" type="byte[]" line="257"/>
            </method>
            <javadoc line="261">
                Decrypts data using specified key and initial vector.                
                <param>
                    baseKey encryption key to use                    
                </param>
                <param>
                    ciphertext  encrypted data to be decrypted                    
                </param>
                <param>
                    usage ignored                    
                </param>
            </javadoc>
            <method name="decryptRaw" type="byte[]" line="267">
                <params>
                    <param name="baseKey" type="byte[]"/>
                    <param name="usage" type="int"/>
                    <param name="ivec" type="byte[]"/>
                    <param name="ciphertext" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                    <param name="seqNum" type="byte[]"/>
                </params>
                <scope line="268"/>
                <scope line="271"/>
                <declaration name="klocal" type="byte[]" line="274"/>
                <scope line="275"/>
                <declaration name="salt" type="byte[]" line="278"/>
                <declaration name="kcrypt" type="byte[]" line="279"/>
                <declaration name="sequenceNum" type="byte[]" line="280"/>
                <declaration name="cipher" type="Cipher" line="283"/>
                <declaration name="secretKey" type="SecretKeySpec" line="284"/>
                <declaration name="output" type="byte[]" line="286"/>
            </method>
            <method name="getSalt" type="byte[]" line="289">
                <params>
                    <param name="usage" type="int"/>
                </params>
                <declaration name="ms_usage" type="int" line="290"/>
                <declaration name="salt" type="byte[]" line="291"/>
            </method>
            <method name="arcfour_translate_usage" type="int" line="298">
                <params>
                    <param name="usage" type="int"/>
                </params>
            </method>
        </class>
    </source>