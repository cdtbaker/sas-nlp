<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5.internal.ktab">
        <import package="sun.security.krb5.internal"/>
        <import package="sun.security.krb5.internal.util.KrbDataOutputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.io.FileOutputStream"/>
        <import package="java.io.OutputStream"/>
        <import package="java.io.UnsupportedEncodingException"/>
        <class name="KeyTabOutputStream" line="40">
            <extends class="KrbDataOutputStream"/>
            <implements interface="KeyTabConstants"/>
            <javadoc line="40">
                This class implements a buffered input stream. It is used for parsing key table
                  data to memory.                
                <author>
                    Yanni Zhang                    
                </author>
            </javadoc>
            <declaration name="entry" type="KeyTabEntry" line="48"/>
            <declaration name="keyType" type="int" line="49"/>
            <declaration name="keyValue" type="byte[]" line="50"/>
            <declaration name="version" type="int" line="51"/>
            <method name="KeyTabOutputStream" type="constructor" line="53">
                <params>
                    <param name="os" type="OutputStream"/>
                </params>
            </method>
            <method name="writeVersion" type="void" line="57">
                <params>
                    <param name="num" type="int"/>
                </params>
                <comment line="60">
                    we use the standard version.                    
                </comment>
            </method>
            <method name="writeEntry" type="void" line="62">
                <params>
                    <param name="entry" type="KeyTabEntry"/>
                </params>
                <comment line="88">
                    time is long, but we only use 4 bytes to store the data.                    
                </comment>
                <comment line="91">
                    the key version might be a 32 bit extended number.                    
                </comment>
                <comment line="97">
                    if the key version isn&apos;t smaller than 256, it could be saved as
                     extension key version number in 4 bytes. The nonzero extension
                     key version number will be trusted. However, it isn&apos;t standardized
                     yet, we won&apos;t support it.
                     if (entry.keyVersion &gt;= 256) {
                        write32(entry.keyVersion);
                    }                    
                </comment>
                <declaration name="serviceNames" type="String[]" line="64"/>
                <declaration name="comp_num" type="int" line="65"/>
                <scope line="66"/>
                <declaration name="realm" type="byte[]" line="71"/>
                <scope line="72"/>
                <scope line="74"/>
                <scope line="79">
                    <scope line="80"/>
                    <scope line="83"/>
                </scope>
            </method>
        </class>
    </source>