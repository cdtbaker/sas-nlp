<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5">
        <import package="sun.security.krb5.internal"/>
        <import package="sun.security.krb5.internal.crypto"/>
        <import package="java.io.IOException"/>
        <import package="java.net.UnknownHostException"/>
        <class name="KrbTgsReq" line="39">
            <comment line="59">
                Used in CredentialsUtil                
            </comment>
            <comment line="76">
                Called by Credentials, KrbCred                
            </comment>
            <javadoc line="39">
                This class encapsulates a Kerberos TGS-REQ that is sent from the
                  client to the KDC.                
            </javadoc>
            <declaration name="princName" type="PrincipalName" line="45"/>
            <declaration name="servName" type="PrincipalName" line="46"/>
            <declaration name="tgsReqMessg" type="TGSReq" line="47"/>
            <declaration name="ctime" type="KerberosTime" line="48"/>
            <declaration name="secondTicket" type="Ticket" line="49"/>
            <declaration name="useSubkey" type="boolean" line="50"/>
            <declaration name="tgsReqKey" type="EncryptionKey" line="51"/>
            <declaration name="DEBUG" type="boolean" line="53"/>
            <declaration name="obuf" type="byte[]" line="55"/>
            <declaration name="ibuf" type="byte[]" line="56"/>
            <method name="KrbTgsReq" type="constructor" line="61">
                <params>
                    <param name="asCreds" type="Credentials"/>
                    <param name="sname" type="PrincipalName"/>
                </params>
                <comment line="65">
                    KerberosTime from                    
                </comment>
                <comment line="66">
                    KerberosTime till                    
                </comment>
                <comment line="67">
                    KerberosTime rtime                    
                </comment>
                <comment line="68">
                    eTypes, // null, // int[] eTypes                    
                </comment>
                <comment line="69">
                    HostAddresses addresses                    
                </comment>
                <comment line="70">
                    AuthorizationData authorizationData                    
                </comment>
                <comment line="71">
                    Ticket[] additionalTickets                    
                </comment>
                <comment line="72">
                    EncryptionKey subSessionKey                    
                </comment>
            </method>
            <method name="KrbTgsReq" type="constructor" line="87">
                <params>
                    <param name="options" type="KDCOptions"/>
                    <param name="asCreds" type="Credentials"/>
                    <param name="sname" type="PrincipalName"/>
                    <param name="from" type="KerberosTime"/>
                    <param name="till" type="KerberosTime"/>
                    <param name="rtime" type="KerberosTime"/>
                    <param name="eTypes" type="int[]"/>
                    <param name="addresses" type="HostAddresses"/>
                    <param name="authorizationData" type="AuthorizationData"/>
                    <param name="additionalTickets" type="Ticket[]"/>
                    <param name="subKey" type="EncryptionKey"/>
                </params>
                <comment line="94">
                    check if they are valid arguments. The optional fields                    
                </comment>
                <comment line="95">
                    should be  consistent with settings in KDCOptions.                    
                </comment>
                <comment line="136">
                    in TGS_REQ there could be more than one additional                    
                </comment>
                <comment line="137">
                    tickets,  but in file-based credential cache,                    
                </comment>
                <comment line="138">
                    there is only one additional ticket field.                    
                </comment>
                <comment line="163">
                    XXX We need to revisit this to see if can&apos;t move it                    
                </comment>
                <comment line="164">
                    up such that FORWARDED flag set in the options                    
                </comment>
                <comment line="165">
                    is included in the marshaled request.                    
                </comment>
                <comment line="166">
                    If this is based on a forwarded ticket, record that in the
                     options, because the returned TgsRep will contain the
                     FORWARDED flag set.                    
                </comment>
                <scope line="97"/>
                <scope line="100"/>
                <scope line="105"/>
                <scope line="108"/>
                <scope line="113"/>
                <scope line="117"/>
                <scope line="121"/>
                <scope line="124"/>
                <scope line="127"/>
                <scope line="130"/>
                <scope line="133"/>
                <scope line="140"/>
            </method>
            <javadoc line="177">
                Sends a TGS request to the realm of the target.                
                <throws>
                    KrbException                    
                </throws>
                <throws>
                    IOException                    
                </throws>
            </javadoc>
            <method name="send" type="void" line="182">
                <declaration name="realmStr" type="String" line="183"/>
                <declaration name="comm" type="KdcComm" line="186"/>
            </method>
            <method name="getReply" type="KrbTgsRep" line="191"/>
            <javadoc line="195">
                Sends the request, waits for a reply, and returns the Credentials.
                  Used in Credentials, KrbCred, and internal/CredentialsUtil.                
            </javadoc>
            <method name="sendAndGetCreds" type="Credentials" line="199">
                <declaration name="tgs_rep" type="KrbTgsRep" line="200"/>
                <declaration name="kdc" type="String" line="201"/>
            </method>
            <method name="getCtime" type="KerberosTime" line="207"/>
            <method name="createRequest" type="TGSReq" line="228">
                <params>
                    <param name="kdc_options" type="KDCOptions"/>
                    <param name="ticket" type="Ticket"/>
                    <param name="key" type="EncryptionKey"/>
                    <param name="ctime" type="KerberosTime"/>
                    <param name="cname" type="PrincipalName"/>
                    <param name="crealm" type="Realm"/>
                    <param name="sname" type="PrincipalName"/>
                    <param name="from" type="KerberosTime"/>
                    <param name="till" type="KerberosTime"/>
                    <param name="rtime" type="KerberosTime"/>
                    <param name="eTypes" type="int[]"/>
                    <param name="addresses" type="HostAddresses"/>
                    <param name="authorizationData" type="AuthorizationData"/>
                    <param name="additionalTickets" type="Ticket[]"/>
                    <param name="subKey" type="EncryptionKey"/>
                </params>
                <comment line="236">
                    RFC 4120, Section 5.4.2.
                     For KRB_TGS_REP, the ciphertext is encrypted in the
                     sub-session key from the Authenticator, or if absent,
                     the session key from the ticket-granting ticket used
                     in the request.
                    
                     To support this, use tgsReqKey to remember which key to use.                    
                </comment>
                <comment line="264">
                    Key to use to decrypt reply                    
                </comment>
                <comment line="276">
                    crealm,                    
                </comment>
                <comment line="277">
                    TO                    
                </comment>
                <comment line="289">
                    if the checksum type is one of the keyed checksum types,                    
                </comment>
                <comment line="290">
                    use session key.                    
                </comment>
                <comment line="312">
                    Usage will be KeyUsage.KU_PA_TGS_REQ_AUTHENTICATOR                    
                </comment>
                <declaration name="req_till" type="KerberosTime" line="229"/>
                <scope line="230"/>
                <scope line="232"/>
                <declaration name="req_eTypes" type="int[]" line="247"/>
                <scope line="248">
                    <scope line="250"/>
                </scope>
                <scope line="254"/>
                <declaration name="reqKey" type="EncryptionKey" line="258"/>
                <declaration name="encAuthorizationData" type="EncryptedData" line="259"/>
                <scope line="260">
                    <declaration name="ad" type="byte[]" line="261"/>
                    <scope line="262"/>
                </scope>
                <declaration name="reqBody" type="KDCReqBody" line="273"/>
                <declaration name="temp" type="byte[]" line="288"/>
                <declaration name="cksum" type="Checksum" line="291"/>
                <declaration name="tgs_ap_req" type="byte[]" line="314"/>
                <declaration name="tgsPAData" type="PAData[]" line="326"/>
            </method>
            <method name="getMessage" type="TGSReq" line="332"/>
            <method name="getSecondTicket" type="Ticket" line="336"/>
            <method name="debug" type="void" line="340">
                <params>
                    <param name="message" type="String"/>
                </params>
                <comment line="341">
                    System.err.println(&quot;&gt;&gt;&gt; KrbTgsReq: &quot; + message);                    
                </comment>
            </method>
            <method name="usedSubkey" type="boolean" line="344"/>
        </class>
    </source>