<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5.internal.ktab">
        <import package="sun.security.krb5.internal"/>
        <import package="sun.security.krb5.PrincipalName"/>
        <import package="sun.security.krb5.Realm"/>
        <import package="sun.security.krb5.RealmException"/>
        <import package="sun.security.krb5.internal.util.KrbDataInputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.io.InputStream"/>
        <class name="KeyTabInputStream" line="42">
            <extends class="KrbDataInputStream"/>
            <implements interface="KeyTabConstants"/>
            <javadoc line="42">
                This class implements a buffered input stream. It is used for parsing key table
                  data to memory.                
                <author>
                    Yanni Zhang                    
                </author>
            </javadoc>
            <declaration name="DEBUG" type="boolean" line="51"/>
            <declaration name="index" type="int" line="52"/>
            <method name="KeyTabInputStream" type="constructor" line="54">
                <params>
                    <param name="is" type="InputStream"/>
                </params>
            </method>
            <javadoc line="57">
                Reads the number of bytes this entry data occupy.                
            </javadoc>
            <method name="readEntryLength" type="int" line="60"/>
            <method name="readEntry" type="KeyTabEntry" line="65">
                <params>
                    <param name="entryLen" type="int"/>
                    <param name="ktVersion" type="int"/>
                </params>
                <comment line="67">
                    in native implementation, when the last entry is deleted, a byte 0 is left.                    
                </comment>
                <comment line="70">
                    in native implementation, when one of the entries is deleted, the entry length turns to be negative, and                    
                </comment>
                <comment line="71">
                    the fields are left with 0 bytes                    
                </comment>
                <comment line="74">
                    the number of service names.                    
                </comment>
                <comment line="76">
                    V1 includes realm in the count.                    
                </comment>
                <comment line="98">
                    There might be a 32 bit kvno here.                    
                </comment>
                <comment line="99">
                    If index is zero, assume that the 8 bit key version number was                    
                </comment>
                <comment line="100">
                    right, otherwise trust the new nonzero value.                    
                </comment>
                <comment line="109">
                    if index is negative, the keytab format must be wrong.                    
                </comment>
                <comment line="114">
                    ignore the left bytes.                    
                </comment>
                <scope line="67"/>
                <scope line="70"/>
                <declaration name="principalNum" type="int" line="74"/>
                <scope line="76"/>
                <declaration name="realm" type="Realm" line="79"/>
                <declaration name="nameParts" type="String[]" line="80"/>
                <scope line="81"/>
                <declaration name="nameType" type="int" line="84"/>
                <declaration name="service" type="PrincipalName" line="86"/>
                <declaration name="timeStamp" type="KerberosTime" line="88"/>
                <declaration name="keyVersion" type="int" line="90"/>
                <declaration name="keyType" type="int" line="92"/>
                <declaration name="keyLength" type="int" line="94"/>
                <declaration name="keyblock" type="byte[]" line="96"/>
                <scope line="101">
                    <declaration name="extKvno" type="int" line="102"/>
                    <scope line="103"/>
                </scope>
                <scope line="110"/>
            </method>
            <method name="readKey" type="byte[]" line="120">
                <params>
                    <param name="length" type="int"/>
                </params>
                <declaration name="bytes" type="byte[]" line="121"/>
            </method>
            <method name="readTimeStamp" type="KerberosTime" line="126"/>
            <method name="readName" type="String" line="131">
                <comment line="133">
                    length of the realm name or service name                    
                </comment>
                <declaration name="name" type="String" line="132"/>
                <declaration name="length" type="int" line="133"/>
                <declaration name="bytes" type="byte[]" line="135"/>
                <scope line="139"/>
            </method>
        </class>
    </source>