<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5">
        <import package="sun.security.krb5.internal"/>
        <class name="KrbAppMessage" line="35">
            <declaration name="DEBUG" type="boolean" line="37"/>
            <javadoc line="38">
                Common checks for KRB-PRIV and KRB-SAFE                
            </javadoc>
            <method name="check" type="void" line="53">
                <params>
                    <param name="packetTimestamp" type="KerberosTime"/>
                    <param name="packetUsec" type="Integer"/>
                    <param name="packetSeqNumber" type="Integer"/>
                    <param name="packetSAddress" type="HostAddress"/>
                    <param name="packetRAddress" type="HostAddress"/>
                    <param name="seqNumber" type="SeqNumber"/>
                    <param name="sAddress" type="HostAddress"/>
                    <param name="rAddress" type="HostAddress"/>
                    <param name="timestampRequired" type="boolean"/>
                    <param name="seqNumberRequired" type="boolean"/>
                    <param name="packetPrincipal" type="PrincipalName"/>
                    <param name="packetRealm" type="Realm"/>
                </params>
                <comment line="82">
                    XXX check replay cache                    
                </comment>
                <comment line="83">
                    if (rcache.repeated(packetTimestamp, packetUsec, packetSAddress))                    
                </comment>
                <comment line="84">
                    throw new KrbApErrException(Krb5.KRB_AP_ERR_REPEAT);                    
                </comment>
                <comment line="86">
                    XXX consider moving up to api level                    
                </comment>
                <comment line="93">
                    should be done only when no more exceptions are possible                    
                </comment>
                <comment line="101">
                    Must not be relaxed, per RFC 4120                    
                </comment>
                <comment line="105">
                    XXX check replay cache                    
                </comment>
                <comment line="106">
                    rcache.save_identifier(packetTimestamp, packetUsec, packetSAddress,                    
                </comment>
                <comment line="107">
                    packetPrincipal, pcaketRealm);                    
                </comment>
                <scope line="55">
                    <scope line="57">
                        <scope line="58"/>
                        <scope line="61"/>
                    </scope>
                </scope>
                <scope line="68"/>
                <scope line="74"/>
                <scope line="90"/>
                <scope line="95">
                    <scope line="96"/>
                </scope>
            </method>
        </class>
    </source>