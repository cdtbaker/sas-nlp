<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.krb5.internal.rcache">
        <import package="sun.security.krb5.KrbException"/>
        <import package="sun.security.krb5.Config"/>
        <import package="sun.security.krb5.internal.Krb5"/>
        <import package="java.util.LinkedList"/>
        <import package="java.util.ListIterator"/>
        <import package="sun.security.krb5.internal.KerberosTime"/>
        <class name="ReplayCache" line="41">
            <extends class="LinkedList">
                <type_params>
                    <type_param name="AuthTime"/>
                </type_params>
            </extends>
            <comment line="54">
                10 minutes break                
            </comment>
            <javadoc line="41">
                This class provides an efficient caching mechanism to store the timestamp of client authenticators.
                  The cache minimizes the memory usage by doing self-cleanup of expired items in the cache.                
                <author>
                    Yanni Zhang                    
                </author>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="49"/>
            <declaration name="principal" type="String" line="51"/>
            <declaration name="table" type="CacheTable" line="52"/>
            <declaration name="nap" type="int" line="53"/>
            <declaration name="DEBUG" type="boolean" line="54"/>
            <javadoc line="55">
                Constructs a ReplayCache for a client principal in specified &lt;code&gt;CacheTable&lt;/code&gt;.                
                <param>
                    p client principal name.                    
                </param>
                <param>
                    ct CacheTable.                    
                </param>
            </javadoc>
            <method name="ReplayCache" type="constructor" line="60">
                <params>
                    <param name="p" type="String"/>
                    <param name="ct" type="CacheTable"/>
                </params>
            </method>
            <javadoc line="65">
                Puts the authenticator timestamp into the cache in descending order.                
                <param>
                    t <code>AuthTime</code>                    
                </param>
            </javadoc>
            <method name="put" type="void" line="69">
                <params>
                    <param name="t" type="AuthTime"/>
                    <param name="currentTime" type="long"/>
                </params>
                <comment line="77">
                    in most cases, newly received authenticator has                    
                </comment>
                <comment line="78">
                    larger timestamp.                    
                </comment>
                <comment line="87">
                    unless client clock being re-adjusted.                    
                </comment>
                <comment line="94">
                    we always put the bigger timestamp at the front.                    
                </comment>
                <comment line="106">
                    let us cleanup while we are here                    
                </comment>
                <comment line="112">
                    search expired timestamps.                    
                </comment>
                <comment line="121">
                    remove expired timestamps from the list.                    
                </comment>
                <comment line="129">
                    if there are no entries in the replay cache,                    
                </comment>
                <comment line="130">
                    remove the replay cache from the table.                    
                </comment>
                <scope line="71"/>
                <scope line="74">
                    <declaration name="temp" type="AuthTime" line="75"/>
                    <scope line="76"/>
                    <scope line="81">
                        <scope line="82"/>
                    </scope>
                    <scope line="86">
                        <declaration name="it" type="ListIterator&lt;AuthTime&gt;" line="88"/>
                        <scope line="89">
                            <scope line="91"/>
                            <scope line="96">
                                <scope line="97"/>
                            </scope>
                        </scope>
                    </scope>
                </scope>
                <declaration name="timeLimit" type="long" line="107"/>
                <declaration name="it" type="ListIterator&lt;AuthTime&gt;" line="108"/>
                <declaration name="temp" type="AuthTime" line="109"/>
                <declaration name="index" type="int" line="110"/>
                <scope line="111">
                    <scope line="114"/>
                </scope>
                <scope line="119">
                    <scope line="120"/>
                </scope>
                <scope line="125"/>
                <scope line="131"/>
                <scope line="134"/>
            </method>
            <javadoc line="140">
                Printes out the debug message.                
            </javadoc>
            <method name="printList" type="void" line="143">
                <declaration name="total" type="Object[]" line="144"/>
                <scope line="145"/>
            </method>
        </class>
    </source>