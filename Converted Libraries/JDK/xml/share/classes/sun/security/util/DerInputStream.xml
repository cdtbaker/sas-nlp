<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.util">
        <import package="java.io.InputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.io.EOFException"/>
        <import package="java.util.Date"/>
        <import package="java.util.Vector"/>
        <import package="java.math.BigInteger"/>
        <import package="java.io.DataInputStream"/>
        <class name="DerInputStream" line="9">
            <javadoc line="9">
                A DER input stream, used for parsing ASN.1 DER-encoded data such as
                  that found in X.509 certificates.  DER is a subset of BER/1, which has
                  the advantage that it allows only a single encoding of primitive data.
                  (High level data such as dates still support many encodings.)  That is,
                  it uses the &quot;Definite&quot; Encoding Rules (DER) not the &quot;Basic&quot; ones (BER).
                  &lt;P&gt;Note that, like BER/1, DER streams are streams of explicitly
                  tagged data values.  Accordingly, this programming interface does
                  not expose any variant of the java.io.InputStream interface, since
                  that kind of input stream holds untagged data values and using that
                  I/O model could prevent correct parsing of the DER data.
                  &lt;P&gt;At this time, this class supports only a subset of the types of DER
                  data encodings which are defined.  That subset is sufficient for parsing
                  most X.509 certificates.                
                <author>
                    David Brownell                    
                </author>
                <author>
                    Amit Kapoor                    
                </author>
                <author>
                    Hemma Prafullchandra                    
                </author>
            </javadoc>
            <declaration name="buffer" type="DerInputBuffer" line="28"/>
            <declaration name="tag" type="byte" line="29"/>
            <javadoc line="29">
                The DER tag of the value; one of the tag_ constants.                
            </javadoc>
            <javadoc line="33">
                Create a DER input stream from a data buffer.  The buffer is not
                  copied, it is shared.  Accordingly, the buffer should be treated
                  as read-only.                
                <param>
                    data the buffer from which to create the string (CONSUMED)                    
                </param>
            </javadoc>
            <method name="DerInputStream" type="constructor" line="39">
                <params>
                    <param name="data" type="byte[]"/>
                </params>
            </method>
            <javadoc line="42">
                Create a DER input stream from part of a data buffer.
                  The buffer is not copied, it is shared.  Accordingly, the
                  buffer should be treated as read-only.                
                <param>
                    data the buffer from which to create the string (CONSUMED)                    
                </param>
                <param>
                    offset the first index of &lt;em&gt;data&lt;/em&gt; which will
                      be read as DER input in the new stream                    
                </param>
                <param>
                    len how long a chunk of the buffer to use,
                      starting at &quot;offset&quot;                    
                </param>
            </javadoc>
            <method name="DerInputStream" type="constructor" line="52">
                <params>
                    <param name="data" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
            </method>
            <method name="init" type="void" line="55">
                <params>
                    <param name="data" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="56"/>
                <scope line="59">
                    <declaration name="inData" type="byte[]" line="60"/>
                    <declaration name="derIn" type="DerIndefLenConverter" line="62"/>
                </scope>
            </method>
            <method name="DerInputStream" type="constructor" line="68">
                <params>
                    <param name="buf" type="DerInputBuffer"/>
                </params>
            </method>
            <javadoc line="72">
                Creates a new DER input stream from part of this input stream.                
                <param>
                    len how long a chunk of the current input stream to use,
                      starting at the current position.                    
                </param>
                <param>
                    do_skip true if the existing data in the input stream should
                      be skipped.  If this value is false, the next data read
                      on this stream and the newly created stream will be the
                      same.                    
                </param>
            </javadoc>
            <method name="subStream" type="DerInputStream" line="81">
                <params>
                    <param name="len" type="int"/>
                    <param name="do_skip" type="boolean"/>
                </params>
                <declaration name="newbuf" type="DerInputBuffer" line="82"/>
                <scope line="84"/>
            </method>
            <javadoc line="89">
                Return what has been written to this DerInputStream
                  as a byte array. Useful for debugging.                
            </javadoc>
            <method name="toByteArray" type="byte[]" line="93"/>
            <javadoc line="96">
                Get an integer from the input stream as an integer.                
                <return>
                    the integer held in this DER input stream.                    
                </return>
            </javadoc>
            <method name="getInteger" type="int" line="100">
                <scope line="101"/>
            </method>
            <javadoc line="106">
                Get a integer from the input stream as a BigInteger object.                
                <return>
                    the integer held in this DER input stream.                    
                </return>
            </javadoc>
            <method name="getBigInteger" type="BigInteger" line="110">
                <scope line="111"/>
            </method>
            <javadoc line="116">
                Returns an ASN.1 INTEGER value as a positive BigInteger.
                  This is just to deal with implementations that incorrectly encode
                  some values as negative.                
                <return>
                    the integer held in this DER value as a BigInteger.                    
                </return>
            </javadoc>
            <method name="getPositiveBigInteger" type="BigInteger" line="122">
                <scope line="123"/>
            </method>
            <javadoc line="128">
                Get an enumerated from the input stream.                
                <return>
                    the integer held in this DER input stream.                    
                </return>
            </javadoc>
            <method name="getEnumerated" type="int" line="132">
                <scope line="133"/>
            </method>
            <javadoc line="138">
                Get a bit string from the input stream. Padded bits (if any)
                  will be stripped off before the bit string is returned.                
            </javadoc>
            <method name="getBitString" type="byte[]" line="142"/>
            <javadoc line="146">
                Get a bit string from the input stream.  The bit string need
                  not be byte-aligned.                
            </javadoc>
            <method name="getUnalignedBitString" type="BitArray" line="150">
                <declaration name="length" type="int" line="152"/>
                <declaration name="validBits" type="int" line="153"/>
                <declaration name="repn" type="byte[]" line="154"/>
            </method>
            <javadoc line="158">
                Returns an ASN.1 OCTET STRING from the input stream.                
            </javadoc>
            <method name="getOctetString" type="byte[]" line="161">
                <declaration name="length" type="int" line="163"/>
                <declaration name="retval" type="byte[]" line="164"/>
            </method>
            <javadoc line="168">
                Returns the asked number of bytes from the input stream.                
            </javadoc>
            <method name="getBytes" type="void" line="171">
                <params>
                    <param name="val" type="byte[]"/>
                </params>
                <scope line="172"/>
            </method>
            <javadoc line="176">
                Reads an encoded null value from the input stream.                
            </javadoc>
            <method name="getNull" type="void" line="179"/>
            <javadoc line="182">
                Reads an X.200 style Object Identifier from the stream.                
            </javadoc>
            <method name="getOID" type="ObjectIdentifier" line="185"/>
            <javadoc line="188">
                Return a sequence of encoded entities.  ASN.1 sequences are
                  ordered, and they are often used, like a &quot;struct&quot; in C or C++,
                  to group data values.  They may have optional or context
                  specific values.                
                <param>
                    startLen guess about how long the sequence will be
                      (used to initialize an auto-growing data structure)                    
                </param>
                <return>
                    array of the values in the sequence                    
                </return>
            </javadoc>
            <method name="getSequence" type="DerValue[]" line="197">
                <params>
                    <param name="startLen" type="int"/>
                </params>
            </method>
            <javadoc line="202">
                Return a set of encoded entities.  ASN.1 sets are unordered,
                  though DER may specify an order for some kinds of sets (such
                  as the attributes in an X.500 relative distinguished name)
                  to facilitate binary comparisons of encoded values.                
                <param>
                    startLen guess about how large the set will be
                      (used to initialize an auto-growing data structure)                    
                </param>
                <return>
                    array of the values in the sequence                    
                </return>
            </javadoc>
            <method name="getSet" type="DerValue[]" line="211">
                <params>
                    <param name="startLen" type="int"/>
                </params>
            </method>
            <javadoc line="216">
                Return a set of encoded entities.  ASN.1 sets are unordered,
                  though DER may specify an order for some kinds of sets (such
                  as the attributes in an X.500 relative distinguished name)
                  to facilitate binary comparisons of encoded values.                
                <param>
                    startLen guess about how large the set will be
                      (used to initialize an auto-growing data structure)                    
                </param>
                <param>
                    implicit if true tag is assumed implicit.                    
                </param>
                <return>
                    array of the values in the sequence                    
                </return>
            </javadoc>
            <method name="getSet" type="DerValue[]" line="226">
                <params>
                    <param name="startLen" type="int"/>
                    <param name="implicit" type="boolean"/>
                </params>
                <scope line="228">
                    <scope line="229"/>
                </scope>
            </method>
            <method name="readVector" type="DerValue[]" line="235">
                <params>
                    <param name="startLen" type="int"/>
                </params>
                <declaration name="newstr" type="DerInputStream" line="236"/>
                <declaration name="lenByte" type="byte" line="237"/>
                <declaration name="len" type="int" line="238"/>
                <scope line="239">
                    <declaration name="readLen" type="int" line="240"/>
                    <declaration name="offset" type="int" line="241"/>
                    <declaration name="indefData" type="byte[]" line="242"/>
                    <declaration name="dis" type="DataInputStream" line="245"/>
                    <declaration name="derIn" type="DerIndefLenConverter" line="248"/>
                </scope>
                <declaration name="vec" type="Vector&amp;lt;DerValue&amp;gt;" line="256"/>
                <declaration name="value" type="DerValue" line="257"/>
                <scope line="258"/>
                <declaration name="i" type="int" line="264"/>
                <declaration name="retval" type="DerValue[]" line="265"/>
            </method>
            <javadoc line="269">
                Get a single DER-encoded value from the input stream.
                  It can often be useful to pull a value from the stream
                  and defer parsing it.  For example, you can pull a nested
                  sequence out with one call, and only examine its elements
                  later when you really need to.                
            </javadoc>
            <method name="getDerValue" type="DerValue" line="276"/>
            <javadoc line="279">
                Read a string that was encoded as a UTF8String DER value.                
            </javadoc>
            <method name="getUTF8String" type="String" line="282"/>
            <javadoc line="285">
                Read a string that was encoded as a PrintableString DER value.                
            </javadoc>
            <method name="getPrintableString" type="String" line="288"/>
            <javadoc line="291">
                Read a string that was encoded as a T61String DER value.                
            </javadoc>
            <method name="getT61String" type="String" line="294"/>
            <javadoc line="297">
                Read a string that was encoded as a IA5tring DER value.                
            </javadoc>
            <method name="getIA5String" type="String" line="300"/>
            <javadoc line="303">
                Read a string that was encoded as a BMPString DER value.                
            </javadoc>
            <method name="getBMPString" type="String" line="306"/>
            <javadoc line="309">
                Read a string that was encoded as a GeneralString DER value.                
            </javadoc>
            <method name="getGeneralString" type="String" line="312"/>
            <javadoc line="315">
                Private helper routine to read an encoded string from the input
                  stream.                
                <param>
                    stringTag the tag for the type of string to read                    
                </param>
                <param>
                    stringName a name to display in error messages                    
                </param>
                <param>
                    enc the encoder to use to interpret the data. Should
                      correspond to the stringTag above.                    
                </param>
            </javadoc>
            <method name="readString" type="String" line="323">
                <params>
                    <param name="stringTag" type="byte"/>
                    <param name="stringName" type="String"/>
                    <param name="enc" type="String"/>
                </params>
                <declaration name="length" type="int" line="325"/>
                <declaration name="retval" type="byte[]" line="326"/>
            </method>
            <javadoc line="330">
                Get a UTC encoded time value from the input stream.                
            </javadoc>
            <method name="getUTCTime" type="Date" line="333"/>
            <javadoc line="337">
                Get a Generalized encoded time value from the input stream.                
            </javadoc>
            <method name="getGeneralizedTime" type="Date" line="340"/>
            <method name="getByte" type="int" line="344"/>
            <method name="peekByte" type="int" line="347"/>
            <method name="getLength" type="int" line="350"/>
            <method name="getLength" type="int" line="353">
                <params>
                    <param name="in" type="InputStream"/>
                </params>
            </method>
            <method name="getLength" type="int" line="356">
                <params>
                    <param name="lenByte" type="int"/>
                    <param name="in" type="InputStream"/>
                </params>
                <declaration name="value" type="int" line="357"/>
                <scope line="359"/>
                <scope line="362">
                    <scope line="366"/>
                </scope>
            </method>
            <javadoc line="373">
                Mark the current position in the buffer, so that
                  a later call to &lt;code&gt;reset&lt;/code&gt; will return here.                
            </javadoc>
            <method name="mark" type="void" line="377">
                <params>
                    <param name="value" type="int"/>
                </params>
            </method>
            <javadoc line="380">
                Return to the position of the last &lt;code&gt;mark&lt;/code&gt;
                  call.  A mark is implicitly set at the beginning of
                  the stream when it is created.                
            </javadoc>
            <method name="reset" type="void" line="385"/>
            <javadoc line="388">
                Returns the number of bytes available for reading.
                  This is most useful for testing whether the stream is
                  empty.                
            </javadoc>
            <method name="available" type="int" line="393"/>
        </class>
    </source>