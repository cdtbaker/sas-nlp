<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.util">
        <import package="java.io.IOException"/>
        <import package="java.util"/>
        <import package="java.security.Principal"/>
        <import package="java.security.cert"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.ssl.Krb5Helper"/>
        <import package="sun.security.x509.X500Name"/>
        <import package="sun.net.util.IPAddressUtil"/>
        <class name="HostnameChecker" line="41">
            <comment line="49">
                Constant for a HostnameChecker for TLS                
            </comment>
            <comment line="54">
                Constant for a HostnameChecker for LDAP                
            </comment>
            <comment line="59">
                constants for subject alt names of type DNS and IP                
            </comment>
            <comment line="63">
                the algorithm to follow to perform the check. Currently unused.                
            </comment>
            <javadoc line="41">
                Class to check hostnames against the names specified in a certificate as
                  required for TLS and LDAP.                
            </javadoc>
            <declaration name="TYPE_TLS" type="byte" line="49"/>
            <declaration name="INSTANCE_TLS" type="HostnameChecker" line="50"/>
            <declaration name="TYPE_LDAP" type="byte" line="54"/>
            <declaration name="INSTANCE_LDAP" type="HostnameChecker" line="55"/>
            <declaration name="ALTNAME_DNS" type="int" line="59"/>
            <declaration name="ALTNAME_IP" type="int" line="60"/>
            <declaration name="checkType" type="byte" line="63"/>
            <method name="HostnameChecker" type="constructor" line="65">
                <params>
                    <param name="checkType" type="byte"/>
                </params>
            </method>
            <javadoc line="69">
                Get a HostnameChecker instance. checkType should be one of the
                  TYPE_ constants defined in this class.                
            </javadoc>
            <method name="getInstance" type="HostnameChecker" line="73">
                <params>
                    <param name="checkType" type="byte"/>
                </params>
                <scope line="74"/>
                <scope line="76"/>
            </method>
            <javadoc line="82">
                Perform the check.                
                <exception>
                    CertificateException if the name does not match any of
                      the names specified in the certificate                    
                </exception>
            </javadoc>
            <method name="match" type="void" line="89">
                <params>
                    <param name="expectedName" type="String"/>
                    <param name="cert" type="X509Certificate"/>
                </params>
                <scope line="90"/>
                <scope line="92"/>
            </method>
            <javadoc line="97">
                Perform the check for Kerberos.                
            </javadoc>
            <method name="match" type="boolean" line="100">
                <params>
                    <param name="expectedName" type="String"/>
                    <param name="principal" type="Principal"/>
                </params>
                <declaration name="hostName" type="String" line="101"/>
            </method>
            <javadoc line="105">
                Return the Server name from Kerberos principal.                
            </javadoc>
            <method name="getServerName" type="String" line="108">
                <params>
                    <param name="principal" type="Principal"/>
                </params>
            </method>
            <javadoc line="112">
                Test whether the given hostname looks like a literal IPv4 or IPv6
                  address. The hostname does not need to be a fully qualified name.
                  This is not a strict check that performs full input validation.
                  That means if the method returns true, name need not be a correct
                  IP address, rather that it does not represent a valid DNS hostname.
                  Likewise for IP addresses when it returns false.                
            </javadoc>
            <method name="isIpAddress" type="boolean" line="121">
                <params>
                    <param name="name" type="String"/>
                </params>
                <scope line="123"/>
                <scope line="125"/>
            </method>
            <javadoc line="130">
                Check if the certificate allows use of the given IP address.
                  From RFC2818:
                  In some cases, the URI is specified as an IP address rather than a
                  hostname. In this case, the iPAddress subjectAltName must be present
                  in the certificate and must exactly match the IP in the URI.                
            </javadoc>
            <method name="matchIP" type="void" line="139">
                <params>
                    <param name="expectedIP" type="String"/>
                    <param name="cert" type="X509Certificate"/>
                </params>
                <comment line="146">
                    For IP address, it needs to be exact match                    
                </comment>
                <declaration name="subjAltNames" type="Collection&lt;List&lt;?&gt;&gt;" line="140"/>
                <scope line="141"/>
                <scope line="145">
                    <scope line="147">
                        <declaration name="ipAddress" type="String" line="148"/>
                        <scope line="149"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="159">
                Check if the certificate allows use of the given DNS name.
                  From RFC2818:
                  If a subjectAltName extension of type dNSName is present, that MUST
                  be used as the identity. Otherwise, the (most specific) Common Name
                  field in the Subject field of the certificate MUST be used. Although
                  the use of the Common Name is existing practice, it is deprecated and
                  Certification Authorities are encouraged to use the dNSName instead.
                  Matching is performed using the matching rules specified by
                  [RFC2459].  If more than one identity of a given type is present in
                  the certificate (e.g., more than one dNSName name, a match in any one
                  of the set is considered acceptable.)                
            </javadoc>
            <method name="matchDNS" type="void" line="175">
                <params>
                    <param name="expectedName" type="String"/>
                    <param name="cert" type="X509Certificate"/>
                </params>
                <comment line="189">
                    if certificate contains any subject alt names of type DNS                    
                </comment>
                <comment line="190">
                    but none match, reject                    
                </comment>
                <comment line="204">
                    ignore                    
                </comment>
                <declaration name="subjAltNames" type="Collection&lt;List&lt;?&gt;&gt;" line="176"/>
                <scope line="177">
                    <declaration name="foundDNS" type="boolean" line="178"/>
                    <scope line="179">
                        <scope line="180">
                            <declaration name="dnsName" type="String" line="182"/>
                            <scope line="183"/>
                        </scope>
                    </scope>
                    <scope line="188"/>
                </scope>
                <declaration name="subjectName" type="X500Name" line="195"/>
                <declaration name="derValue" type="DerValue" line="196"/>
                <scope line="198">
                    <scope line="199">
                        <scope line="200"/>
                    </scope>
                    <scope line="203"/>
                </scope>
                <declaration name="msg" type="String" line="207"/>
            </method>
            <javadoc line="212">
                Return the subject of a certificate as X500Name, by reparsing if
                  necessary. X500Name should only be used if access to name components
                  is required, in other cases X500Principal is to be prefered.
                  This method is currently used from within JSSE, do not remove.                
            </javadoc>
            <method name="getSubjectX500Name" type="X500Name" line="220">
                <params>
                    <param name="cert" type="X509Certificate"/>
                </params>
                <scope line="221">
                    <declaration name="subjectDN" type="Principal" line="222"/>
                    <scope line="223"/>
                    <scope line="225">
                        <declaration name="subjectX500" type="X500Principal" line="226"/>
                    </scope>
                </scope>
                <scope line="229"/>
            </method>
            <javadoc line="236">
                Returns true if name matches against template.&lt;p&gt;
                  The matching is performed as per RFC 2818 rules for TLS and
                  RFC 2830 rules for LDAP.&lt;p&gt;
                  The &lt;code&gt;name&lt;/code&gt; parameter should represent a DNS name.
                  The &lt;code&gt;template&lt;/code&gt; parameter
                  may contain the wildcard character                
            </javadoc>
            <method name="isMatched" type="boolean" line="246">
                <params>
                    <param name="name" type="String"/>
                    <param name="template" type="String"/>
                </params>
                <scope line="247"/>
                <scope line="249"/>
                <scope line="251"/>
            </method>
            <javadoc line="257">
                Returns true if name matches against template.&lt;p&gt;
                  According to RFC 2818, section 3.1 -
                  Names may contain the wildcard character  which is
                  considered to match any single domain name component
                  or component fragment.
                  E.g., .a.com matches foo.a.com but not
                  bar.foo.a.com. f.com matches foo.com but not bar.com.                
            </javadoc>
            <method name="matchAllWildcards" type="boolean" line="268">
                <params>
                    <param name="name" type="String"/>
                    <param name="template" type="String"/>
                </params>
                <declaration name="nameSt" type="StringTokenizer" line="271"/>
                <declaration name="templateSt" type="StringTokenizer" line="272"/>
                <scope line="274"/>
                <scope line="278">
                    <scope line="280"/>
                </scope>
            </method>
            <javadoc line="288">
                Returns true if name matches against template.&lt;p&gt;
                  As per RFC 2830, section 3.6 -
                  The &quot;&quot; wildcard character is allowed.  If present, it applies only
                  to the left-most name component.
                  E.g. .bar.com would match a.bar.com, b.bar.com, etc. but not
                  bar.com.                
            </javadoc>
            <method name="matchLeftmostWildcard" type="boolean" line="298">
                <params>
                    <param name="name" type="String"/>
                    <param name="template" type="String"/>
                </params>
                <comment line="302">
                    Retreive leftmost component                    
                </comment>
                <comment line="314">
                    match rest of the name                    
                </comment>
                <declaration name="templateIdx" type="int" line="303"/>
                <declaration name="nameIdx" type="int" line="304"/>
                <scope line="312"/>
                <scope line="317"/>
            </method>
            <javadoc line="323">
                Returns true if the name matches against the template that may
                  contain wildcard char  &lt;p&gt;                
            </javadoc>
            <method name="matchWildCards" type="boolean" line="327">
                <params>
                    <param name="name" type="String"/>
                    <param name="template" type="String"/>
                </params>
                <comment line="339">
                    match in sequence the non-wildcard chars in the template.                    
                </comment>
                <comment line="350">
                    update the match scope                    
                </comment>
                <declaration name="wildcardIdx" type="int" line="329"/>
                <declaration name="isBeginning" type="boolean" line="333"/>
                <declaration name="beforeWildcard" type="String" line="334"/>
                <declaration name="afterWildcard" type="String" line="335"/>
                <scope line="337">
                    <declaration name="beforeStartIdx" type="int" line="343"/>
                    <scope line="345"/>
                </scope>
            </method>
        </class>
    </source>