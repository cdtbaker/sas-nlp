<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.util">
        <import package="java.security"/>
        <import package="java.util.HashMap"/>
        <import package="java.io.ByteArrayOutputStream"/>
        <class name="ManifestDigester" line="32">
            <comment line="44">
                key is a UTF-8 string                
            </comment>
            <javadoc line="32">
                This class is used to compute digests on sections of the Manifest.                
            </javadoc>
            <declaration name="MF_MAIN_ATTRS" type="String" line="37"/>
            <declaration name="rawBytes" type="byte" line="39"/>
            <javadoc line="39">
                the raw bytes of the manifest                
            </javadoc>
            <declaration name="entries" type="HashMap&lt;String,Entry&gt;" line="42"/>
            <javadoc line="42">
                the offset/length pair for a section                
            </javadoc>
            <class name="Position" line="45">
                <comment line="48">
                    not including newline character                    
                </comment>
                <comment line="50">
                    end of section, not including the blank line                    
                </comment>
                <comment line="51">
                    between sections                    
                </comment>
                <comment line="52">
                    the start of the next section                    
                </comment>
                <javadoc line="45">
                    state returned by findSection                    
                </javadoc>
                <declaration name="endOfFirstLine" type="int" line="47"/>
                <declaration name="endOfSection" type="int" line="49"/>
                <declaration name="startOfNext" type="int" line="51"/>
            </class>
            <javadoc line="54">
                find a section in the manifest.                
                <param>
                    offset should point to the starting offset with in the
                      raw bytes of the next section.                    
                </param>
                <pos>
                    set by                    
                </pos>
                <returns>
                    false if end of bytes has been reached, otherwise returns
                      true                    
                </returns>
            </javadoc>
            <method name="findSection" type="boolean" line="66">
                <params>
                    <param name="offset" type="int"/>
                    <param name="pos" type="Position"/>
                </params>
                <comment line="94">
                    start of a new line                    
                </comment>
                <declaration name="i" type="int" line="67"/>
                <declaration name="last" type="int" line="68"/>
                <declaration name="next" type="int" line="69"/>
                <declaration name="allBlank" type="boolean" line="70"/>
                <scope line="74">
                    <declaration name="b" type="byte" line="75"/>
                    <scope line="85"/>
                    <scope line="93"/>
                </scope>
            </method>
            <method name="ManifestDigester" type="constructor" line="109">
                <params>
                    <param name="bytes" type="byte"/>
                </params>
                <comment line="118">
                    XXX: exception?                    
                </comment>
                <comment line="120">
                    create an entry for main attributes                    
                </comment>
                <comment line="149">
                    name is wrapped                    
                </comment>
                <comment line="154">
                    XXX: exception?                    
                </comment>
                <declaration name="baos" type="ByteArrayOutputStream" line="113"/>
                <declaration name="pos" type="Position" line="115"/>
                <declaration name="start" type="int" line="124"/>
                <scope line="125">
                    <declaration name="len" type="int" line="126"/>
                    <declaration name="sectionLen" type="int" line="127"/>
                    <declaration name="sectionLenWithBlank" type="int" line="128"/>
                    <scope line="130">
                        <scope line="131">
                            <declaration name="nameBuf" type="StringBuilder" line="132"/>
                            <scope line="134">
                                <declaration name="i" type="int" line="138"/>
                                <scope line="139">
                                    <scope line="140"/>
                                    <scope line="142"/>
                                </scope>
                                <scope line="147">
                                    <scope line="148">
                                        <declaration name="wrapStart" type="int" line="150"/>
                                        <declaration name="wrapLen" type="int" line="155"/>
                                    </scope>
                                    <scope line="163"/>
                                </scope>
                            </scope>
                            <scope line="172"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="isNameAttr" type="boolean" line="183">
                <params>
                    <param name="bytes" type="byte"/>
                    <param name="start" type="int"/>
                </params>
            </method>
            <class name="Entry" line="192">
                <comment line="48">
                    not including newline character                    
                </comment>
                <comment line="50">
                    end of section, not including the blank line                    
                </comment>
                <comment line="51">
                    between sections                    
                </comment>
                <comment line="52">
                    the start of the next section                    
                </comment>
                <declaration name="offset" type="int" line="193"/>
                <declaration name="length" type="int" line="194"/>
                <declaration name="lengthWithBlankLine" type="int" line="195"/>
                <declaration name="rawBytes" type="byte[]" line="196"/>
                <declaration name="oldStyle" type="boolean" line="197"/>
                <method name="Entry" type="constructor" line="201">
                    <params>
                        <param name="offset" type="int"/>
                        <param name="length" type="int"/>
                        <param name="lengthWithBlankLine" type="int"/>
                        <param name="rawBytes" type="byte[]"/>
                    </params>
                </method>
                <method name="digest" type="byte[]" line="209">
                    <params>
                        <param name="md" type="MessageDigest"/>
                    </params>
                    <scope line="211"/>
                    <scope line="213"/>
                </method>
                <method name="doOldStyle" type="void" line="223">
                    <params>
                        <param name="md" type="MessageDigest"/>
                        <param name="bytes" type="byte[]"/>
                        <param name="offset" type="int"/>
                        <param name="length" type="int"/>
                    </params>
                    <comment line="224">
                        this is too gross to even document, but here goes                        
                    </comment>
                    <comment line="225">
                        the 1.1 jar verification code ignored spaces at the                        
                    </comment>
                    <comment line="226">
                        end of lines when calculating digests, so that is                        
                    </comment>
                    <comment line="227">
                        what this code does. It only gets called if we                        
                    </comment>
                    <comment line="228">
                        are parsing a 1.1 signed signature file                        
                    </comment>
                    <declaration name="i" type="int" line="229"/>
                    <declaration name="start" type="int" line="230"/>
                    <declaration name="max" type="int" line="231"/>
                    <declaration name="prev" type="int" line="232"/>
                    <scope line="233">
                        <scope line="234"/>
                    </scope>
                </method>
                <javadoc line="245">
                    Netscape doesn&apos;t include the new line. Intel and JavaSoft do                    
                </javadoc>
                <method name="digestWorkaround" type="byte[]" line="248">
                    <params>
                        <param name="md" type="MessageDigest"/>
                    </params>
                </method>
            </class>
            <method name="get" type="Entry" line="255">
                <params>
                    <param name="name" type="String"/>
                    <param name="oldStyle" type="boolean"/>
                </params>
                <declaration name="e" type="Entry" line="256"/>
            </method>
            <method name="manifestDigest" type="byte[]" line="263">
                <params>
                    <param name="md" type="MessageDigest"/>
                </params>
            </method>
        </class>
    </source>