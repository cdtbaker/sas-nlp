<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.x509">
        <import package="java.io.InputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.security.cert.CRLException"/>
        <import package="java.security.cert.CRLReason"/>
        <import package="java.security.cert.CertificateException"/>
        <import package="java.security.cert.X509CRLEntry"/>
        <import package="java.math.BigInteger"/>
        <import package="java.util.Collection"/>
        <import package="java.util.Date"/>
        <import package="java.util.Enumeration"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.Map"/>
        <import package="java.util.Set"/>
        <import package="java.util.HashSet"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.util"/>
        <import package="sun.misc.HexDumpEncoder"/>
        <class name="X509CRLEntryImpl" line="48">
            <extends class="X509CRLEntry"/>
            <javadoc line="48">
                &lt;p&gt;Abstract class for a revoked certificate in a CRL.
                  This class is for each entry in the &lt;code&gt;revokedCertificates&lt;/code&gt;,
                  so it deals with the inner &lt;em&gt;SEQUENCE&lt;/em&gt;.
                  The ASN.1 definition for this is:
                  &lt;pre&gt;
                  revokedCertificates    SEQUENCE OF SEQUENCE  {
                  userCertificate    CertificateSerialNumber,
                  revocationDate     ChoiceOfTime,
                  crlEntryExtensions Extensions OPTIONAL
                  -- if present, must be v2
                  }  OPTIONAL
                  CertificateSerialNumber  ::=  INTEGER
                  Extensions  ::=  SEQUENCE SIZE (1..MAX) OF Extension
                  Extension  ::=  SEQUENCE  {
                  extnId        OBJECT IDENTIFIER,
                  critical      BOOLEAN DEFAULT FALSE,
                  extnValue     OCTET STRING
                  -- contains a DER encoding of a value
                  -- of the type registered for use with
                  -- the extnId object identifier value
                  }
                  &lt;/pre&gt;                
                <author>
                    Hemma Prafullchandra                    
                </author>
            </javadoc>
            <declaration name="serialNumber" type="SerialNumber" line="80"/>
            <declaration name="revocationDate" type="Date" line="81"/>
            <declaration name="extensions" type="CRLExtensions" line="82"/>
            <declaration name="revokedCert" type="byte[]" line="83"/>
            <declaration name="certIssuer" type="X500Principal" line="84"/>
            <declaration name="isExplicit" type="boolean" line="86"/>
            <declaration name="YR_2050" type="long" line="87"/>
            <javadoc line="89">
                Constructs a revoked certificate entry using the given
                  serial number and revocation date.                
                <param>
                    num the serial number of the revoked certificate.                    
                </param>
                <param>
                    date the Date on which revocation took place.                    
                </param>
            </javadoc>
            <method name="X509CRLEntryImpl" type="constructor" line="96">
                <params>
                    <param name="num" type="BigInteger"/>
                    <param name="date" type="Date"/>
                </params>
            </method>
            <javadoc line="101">
                Constructs a revoked certificate entry using the given
                  serial number, revocation date and the entry
                  extensions.                
                <param>
                    num the serial number of the revoked certificate.                    
                </param>
                <param>
                    date the Date on which revocation took place.                    
                </param>
                <param>
                    crlEntryExts the extensions for this entry.                    
                </param>
            </javadoc>
            <method name="X509CRLEntryImpl" type="constructor" line="111">
                <params>
                    <param name="num" type="BigInteger"/>
                    <param name="date" type="Date"/>
                    <param name="crlEntryExts" type="CRLExtensions"/>
                </params>
            </method>
            <javadoc line="117">
                Unmarshals a revoked certificate from its encoded form.                
                <param>
                    revokedCert the encoded bytes.                    
                </param>
                <exception>
                    CRLException on parsing errors.                    
                </exception>
            </javadoc>
            <method name="X509CRLEntryImpl" type="constructor" line="123">
                <params>
                    <param name="revokedCert" type="byte[]"/>
                </params>
                <scope line="124"/>
                <scope line="126"/>
            </method>
            <javadoc line="132">
                Unmarshals a revoked certificate from its encoded form.                
                <param>
                    derVal the DER value containing the revoked certificate.                    
                </param>
                <exception>
                    CRLException on parsing errors.                    
                </exception>
            </javadoc>
            <method name="X509CRLEntryImpl" type="constructor" line="138">
                <params>
                    <param name="derValue" type="DerValue"/>
                </params>
                <scope line="139"/>
                <scope line="141"/>
            </method>
            <javadoc line="147">
                Returns true if this revoked certificate entry has
                  extensions, otherwise false.                
                <return>
                    true if this CRL entry has extensions, otherwise
                      false.                    
                </return>
            </javadoc>
            <method name="hasExtensions" type="boolean" line="154"/>
            <javadoc line="158">
                Encodes the revoked certificate to an output stream.                
                <param>
                    outStrm an output stream to which the encoded revoked
                      certificate is written.                    
                </param>
                <exception>
                    CRLException on encoding errors.                    
                </exception>
            </javadoc>
            <method name="encode" type="void" line="165">
                <params>
                    <param name="outStrm" type="DerOutputStream"/>
                </params>
                <comment line="169">
                    sequence { serialNumber, revocationDate, extensions }                    
                </comment>
                <scope line="166">
                    <scope line="167">
                        <declaration name="tmp" type="DerOutputStream" line="168"/>
                        <scope line="172"/>
                        <scope line="174"/>
                        <declaration name="seq" type="DerOutputStream" line="181"/>
                    </scope>
                </scope>
                <scope line="187"/>
            </method>
            <javadoc line="192">
                Returns the ASN.1 DER-encoded form of this CRL Entry,
                  which corresponds to the inner SEQUENCE.                
                <exception>
                    CRLException if an encoding error occurs.                    
                </exception>
            </javadoc>
            <method name="getEncoded" type="byte[]" line="198"/>
            <method name="getCertificateIssuer" type="X500Principal" line="205"/>
            <method name="setCertificateIssuer" type="void" line="209">
                <params>
                    <param name="crlIssuer" type="X500Principal"/>
                    <param name="certIssuer" type="X500Principal"/>
                </params>
                <scope line="210"/>
                <scope line="212"/>
            </method>
            <javadoc line="217">
                Gets the serial number from this X509CRLEntry,
                  i.e. the &lt;em&gt;userCertificate&lt;/em&gt;.                
                <return>
                    the serial number.                    
                </return>
            </javadoc>
            <method name="getSerialNumber" type="BigInteger" line="223"/>
            <javadoc line="227">
                Gets the revocation date from this X509CRLEntry,
                  the &lt;em&gt;revocationDate&lt;/em&gt;.                
                <return>
                    the revocation date.                    
                </return>
            </javadoc>
            <method name="getRevocationDate" type="Date" line="233"/>
            <javadoc line="237">
                This method is the overridden implementation of the getRevocationReason
                  method in X509CRLEntry. It is better performance-wise since it returns
                  cached values.                
            </javadoc>
            <method name="getRevocationReason" type="CRLReason" line="243">
                <declaration name="ext" type="Extension" line="244"/>
                <scope line="245"/>
                <declaration name="rcExt" type="CRLReasonCodeExtension" line="248"/>
            </method>
            <javadoc line="252">
                This static method is the default implementation of the
                  getRevocationReason method in X509CRLEntry.                
            </javadoc>
            <method name="getRevocationReason" type="CRLReason" line="256">
                <params>
                    <param name="crlEntry" type="X509CRLEntry"/>
                </params>
                <scope line="257">
                    <declaration name="ext" type="byte[]" line="258"/>
                    <scope line="259"/>
                    <declaration name="val" type="DerValue" line="262"/>
                    <declaration name="data" type="byte[]" line="263"/>
                    <declaration name="rcExt" type="CRLReasonCodeExtension" line="265"/>
                </scope>
                <scope line="268"/>
            </method>
            <javadoc line="273">
                get Reason Code from CRL entry.                
                <returns>
                    Integer or null, if no such extension                    
                </returns>
                <throws>
                    IOException on error                    
                </throws>
            </javadoc>
            <method name="getReasonCode" type="Integer" line="279">
                <declaration name="obj" type="Object" line="280"/>
                <declaration name="reasonCode" type="CRLReasonCodeExtension" line="283"/>
            </method>
            <javadoc line="287">
                Returns a printable string of this revoked certificate.                
                <return>
                    value of this revoked certificate in a printable form.                    
                </return>
            </javadoc>
            <method name="toString" type="String" line="293">
                <comment line="323">
                    sub-class exists                    
                </comment>
                <declaration name="sb" type="StringBuilder" line="294"/>
                <scope line="298"/>
                <scope line="301">
                    <declaration name="allEntryExts" type="Collection" line="302"/>
                    <declaration name="objs" type="Object[]" line="303"/>
                    <scope line="306">
                        <declaration name="ext" type="Extension" line="308"/>
                        <scope line="309">
                            <scope line="310">
                                <declaration name="extValue" type="byte[]" line="312"/>
                                <scope line="313">
                                    <declaration name="out" type="DerOutputStream" line="314"/>
                                    <declaration name="enc" type="HexDumpEncoder" line="317"/>
                                </scope>
                            </scope>
                        </scope>
                        <scope line="324"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="333">
                Return true if a critical extension is found that is
                  not supported, otherwise return false.                
            </javadoc>
            <method name="hasUnsupportedCriticalExtension" type="boolean" line="337"/>
            <javadoc line="343">
                Gets a Set of the extension(s) marked CRITICAL in this
                  X509CRLEntry.  In the returned set, each extension is
                  represented by its OID string.                
                <return>
                    a set of the extension oid strings in the
                      Object that are marked critical.                    
                </return>
            </javadoc>
            <method name="getCriticalExtensionOIDs" type="Set<String>" line="351">
                <scope line="352"/>
                <declaration name="extSet" type="Set&lt;String&gt;" line="355"/>
                <scope line="356">
                    <scope line="357"/>
                </scope>
            </method>
            <javadoc line="364">
                Gets a Set of the extension(s) marked NON-CRITICAL in this
                  X509CRLEntry. In the returned set, each extension is
                  represented by its OID string.                
                <return>
                    a set of the extension oid strings in the
                      Object that are marked critical.                    
                </return>
            </javadoc>
            <method name="getNonCriticalExtensionOIDs" type="Set<String>" line="372">
                <scope line="373"/>
                <declaration name="extSet" type="Set&lt;String&gt;" line="376"/>
                <scope line="377">
                    <scope line="378"/>
                </scope>
            </method>
            <javadoc line="385">
                Gets the DER encoded OCTET string for the extension value
                  (&lt;em&gt;extnValue&lt;/em&gt;) identified by the passed in oid String.
                  The &lt;code&gt;oid&lt;/code&gt; string is
                  represented by a set of positive whole number separated
                  by &quot;.&quot;, that means,&lt;br&gt;
                  &amp;lt;positive whole number&amp;gt;.&amp;lt;positive whole number&amp;gt;.&amp;lt;positive
                  whole number&amp;gt;.&amp;lt;...&amp;gt;                
                <param>
                    oid the Object Identifier value for the extension.                    
                </param>
                <return>
                    the DER encoded octet string of the extension value.                    
                </return>
            </javadoc>
            <method name="getExtensionValue" type="byte[]" line="397">
                <params>
                    <param name="oid" type="String"/>
                </params>
                <comment line="404">
                    may be unknown                    
                </comment>
                <scope line="400">
                    <declaration name="extAlias" type="String" line="401"/>
                    <declaration name="crlExt" type="Extension" line="402"/>
                    <scope line="404">
                        <declaration name="findOID" type="ObjectIdentifier" line="405"/>
                        <declaration name="ex" type="Extension" line="406"/>
                        <declaration name="inCertOID" type="ObjectIdentifier" line="407"/>
                        <scope line="409">
                            <scope line="412"/>
                        </scope>
                    </scope>
                    <declaration name="extData" type="byte[]" line="421"/>
                    <declaration name="out" type="DerOutputStream" line="425"/>
                </scope>
                <scope line="428"/>
            </method>
            <javadoc line="433">
                get an extension                
                <param>
                    oid ObjectIdentifier of extension desired                    
                </param>
                <returns>
                    Extension of type <extension> or null, if not found                    
                </returns>
            </javadoc>
            <method name="getExtension" type="Extension" line="439">
                <params>
                    <param name="oid" type="ObjectIdentifier"/>
                </params>
                <comment line="443">
                    following returns null if no such OID in map                    
                </comment>
                <comment line="444">
                    XXX consider cloning this                    
                </comment>
            </method>
            <method name="parse" type="void" line="449">
                <params>
                    <param name="derVal" type="DerValue"/>
                </params>
                <comment line="459">
                    serial number                    
                </comment>
                <comment line="464">
                    revocationDate                    
                </comment>
                <comment line="474">
                    no extensions                    
                </comment>
                <comment line="476">
                    crlEntryExtensions                    
                </comment>
                <scope line="451"/>
                <declaration name="in" type="DerInputStream" line="460"/>
                <declaration name="val" type="DerValue" line="461"/>
                <declaration name="nextByte" type="int" line="465"/>
                <scope line="466"/>
                <scope line="468"/>
            </method>
            <javadoc line="480">
                Utility method to convert an arbitrary instance of X509CRLEntry
                  to a X509CRLEntryImpl. Does a cast if possible, otherwise reparses
                  the encoding.                
            </javadoc>
            <method name="toImpl" type="X509CRLEntryImpl" line="486">
                <params>
                    <param name="entry" type="X509CRLEntry"/>
                </params>
                <scope line="487"/>
                <scope line="489"/>
            </method>
            <javadoc line="494">
                Returns the CertificateIssuerExtension                
                <return>
                    the CertificateIssuerExtension, or null if it does not exist                    
                </return>
            </javadoc>
            <method name="getCertificateIssuerExtension" type="CertificateIssuerExtension" line="499"/>
            <method name="getExtensions" type="Map<String,java.security.cert.Extension>" line="504">
                <declaration name="exts" type="Collection&lt;Extension&gt;" line="505"/>
                <declaration name="map" type="HashMap&lt;String,java.security.cert.Extension&gt;" line="506"/>
                <scope line="508"/>
            </method>
        </class>
    </source>