<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.x509">
        <import package="java.io"/>
        <import package="java.util"/>
        <import package="sun.security.util"/>
        <class name="GeneralSubtrees" line="33">
            <comment line="52">
                Private variables                
            </comment>
            <implements interface="Cloneable"/>
            <javadoc line="33">
                Represent the GeneralSubtrees ASN.1 object.
                  &lt;p&gt;
                  The ASN.1 for this is
                  &lt;pre&gt;
                  GeneralSubtrees ::= SEQUENCE SIZE (1..MAX) OF GeneralSubtree
                  &lt;/pre&gt;
                  &lt;/p&gt;                
                <author>
                    Amit Kapoor                    
                </author>
                <author>
                    Hemma Prafullchandra                    
                </author>
                <author>
                    Andreas Sterbenz                    
                </author>
            </javadoc>
            <declaration name="trees" type="List&lt;GeneralSubtree&gt;" line="49"/>
            <declaration name="NAME_DIFF_TYPE" type="int" line="52"/>
            <declaration name="NAME_MATCH" type="int" line="53"/>
            <declaration name="NAME_NARROWS" type="int" line="54"/>
            <declaration name="NAME_WIDENS" type="int" line="55"/>
            <declaration name="NAME_SAME_TYPE" type="int" line="56"/>
            <javadoc line="58">
                The default constructor for the class.                
            </javadoc>
            <method name="GeneralSubtrees" type="constructor" line="61"/>
            <method name="GeneralSubtrees" type="constructor" line="65">
                <params>
                    <param name="source" type="GeneralSubtrees"/>
                </params>
            </method>
            <javadoc line="69">
                Create the object from the passed DER encoded form.                
                <param>
                    val the DER encoded form of the same.                    
                </param>
            </javadoc>
            <method name="GeneralSubtrees" type="constructor" line="74">
                <params>
                    <param name="val" type="DerValue"/>
                </params>
                <scope line="76"/>
                <scope line="79">
                    <declaration name="opt" type="DerValue" line="80"/>
                    <declaration name="tree" type="GeneralSubtree" line="81"/>
                </scope>
            </method>
            <method name="get" type="GeneralSubtree" line="86">
                <params>
                    <param name="index" type="int"/>
                </params>
            </method>
            <method name="remove" type="void" line="90">
                <params>
                    <param name="index" type="int"/>
                </params>
            </method>
            <method name="add" type="void" line="94">
                <params>
                    <param name="tree" type="GeneralSubtree"/>
                </params>
                <scope line="95"/>
            </method>
            <method name="contains" type="boolean" line="101">
                <params>
                    <param name="tree" type="GeneralSubtree"/>
                </params>
                <scope line="102"/>
            </method>
            <method name="size" type="int" line="108"/>
            <method name="iterator" type="Iterator<GeneralSubtree>" line="112"/>
            <method name="trees" type="List<GeneralSubtree>" line="116"/>
            <method name="clone" type="Object" line="120"/>
            <javadoc line="124">
                Return a printable string of the GeneralSubtree.                
            </javadoc>
            <method name="toString" type="String" line="127">
                <declaration name="s" type="String" line="128"/>
            </method>
            <javadoc line="132">
                Encode the GeneralSubtrees.                
                <params>
                    out the DerOutputStrean to encode this object to.                    
                </params>
            </javadoc>
            <method name="encode" type="void" line="137">
                <params>
                    <param name="out" type="DerOutputStream"/>
                </params>
                <declaration name="seq" type="DerOutputStream" line="138"/>
                <scope line="140"/>
            </method>
            <javadoc line="146">
                Compare two general subtrees by comparing the subtrees
                  of each.                
                <param>
                    other GeneralSubtrees to compare to this                    
                </param>
                <returns>
                    true if match                    
                </returns>
            </javadoc>
            <method name="equals" type="boolean" line="153">
                <params>
                    <param name="obj" type="Object"/>
                </params>
                <scope line="154"/>
                <scope line="157"/>
                <declaration name="other" type="GeneralSubtrees" line="160"/>
            </method>
            <method name="hashCode" type="int" line="164"/>
            <javadoc line="168">
                Return the GeneralNameInterface form of the GeneralName in one of
                  the GeneralSubtrees.                
                <param>
                    ndx index of the GeneralSubtree from which to obtain the name                    
                </param>
            </javadoc>
            <method name="getGeneralNameInterface" type="GeneralNameInterface" line="174">
                <params>
                    <param name="ndx" type="int"/>
                </params>
            </method>
            <method name="getGeneralNameInterface" type="GeneralNameInterface" line="178">
                <params>
                    <param name="gs" type="GeneralSubtree"/>
                </params>
                <declaration name="gn" type="GeneralName" line="179"/>
                <declaration name="gni" type="GeneralNameInterface" line="180"/>
            </method>
            <javadoc line="184">
                minimize this GeneralSubtrees by removing all redundant entries.
                  Internal method used by intersect and reduce.                
            </javadoc>
            <method name="minimize" type="void" line="188">
                <comment line="191">
                    Algorithm: compare each entry n to all subsequent entries in
                     the list: if any subsequent entry matches or widens entry n,
                     remove entry n. If any subsequent entries narrow entry n, remove
                     the subsequent entries.                    
                </comment>
                <comment line="199">
                                        
                </comment>
                <comment line="204">
                                        
                </comment>
                <comment line="207">
                                        
                </comment>
                <comment line="211">
                                        
                </comment>
                <comment line="212">
                                        
                </comment>
                <comment line="214">
                                        
                </comment>
                <comment line="217">
                                        
                </comment>
                <comment line="218">
                                        
                </comment>
                <comment line="222">
                                        
                </comment>
                <comment line="226">
                                        
                </comment>
                <comment line="230">
                                        
                </comment>
                <scope line="194">
                    <declaration name="current" type="GeneralNameInterface" line="195"/>
                    <declaration name="remove1" type="boolean" line="196"/>
                    <scope line="199">
                        <declaration name="subsequent" type="GeneralNameInterface" line="200"/>
                    </scope>
                    <scope line="227"/>
                </scope>
            </method>
            <javadoc line="235">
                create a subtree containing an instance of the input
                  name type that widens all other names of that type.                
                <params>
                    name GeneralNameInterface name                    
                </params>
                <returns>
                    GeneralSubtree containing widest name of that type                    
                </returns>
                <throws>
                    RuntimeException on error (should not occur)                    
                </throws>
            </javadoc>
            <method name="createWidestSubtree" type="GeneralSubtree" line="243">
                <params>
                    <param name="name" type="GeneralNameInterface"/>
                </params>
                <comment line="249">
                    Create new OtherName with same OID as baseName, but
                     empty value                    
                </comment>
                <scope line="244">
                    <declaration name="newName" type="GeneralName" line="245"/>
                    <declaration name="otherOID" type="ObjectIdentifier" line="250"/>
                </scope>
                <scope line="283"/>
            </method>
            <javadoc line="288">
                intersect this GeneralSubtrees with other.  This function
                  is used in merging permitted NameConstraints.  The operation
                  is performed as follows:
                  &lt;ul&gt;
                  &lt;li&gt;If a name in other narrows all names of the same type in this,
                  the result will contain the narrower name and none of the
                  names it narrows.
                  &lt;li&gt;If a name in other widens all names of the same type in this,
                  the result will not contain the wider name.
                  &lt;li&gt;If a name in other does not share the same subtree with any name
                  of the same type in this, then the name is added to the list
                  of GeneralSubtrees returned.  These names should be added to
                  the list of names that are specifically excluded.  The reason
                  is that, if the intersection is empty, then no names of that
                  type are permitted, and the only way to express this in
                  NameConstraints is to include the name in excludedNames.
                  &lt;li&gt;If a name in this has no name of the same type in other, then
                  the result contains the name in this.  No name of a given type
                  means the name type is completely permitted.
                  &lt;li&gt;If a name in other has no name of the same type in this, then
                  the result contains the name in other.  This means that
                  the name is now constrained in some way, whereas before it was
                  completely permitted.
                  &lt;ul&gt;                
                <param>
                    other GeneralSubtrees to be intersected with this                    
                </param>
                <returns>
                    GeneralSubtrees to be merged with excluded; these are
                      empty-valued name types corresponding to entries that were
                      of the same type but did not share the same subtree between
                      this and other. Returns null if no such.                    
                </returns>
            </javadoc>
            <method name="intersect" type="GeneralSubtrees" line="320">
                <params>
                    <param name="other" type="GeneralSubtrees"/>
                </params>
                <comment line="330">
                    Step 1: If this is empty, just add everything in other to this and
                     return no new excluded entries                    
                </comment>
                <comment line="337">
                    Step 2: For ease of checking the subtrees, minimize them by
                     constructing versions that contain only the widest instance of
                     each type                    
                </comment>
                <comment line="343">
                    Step 3: Check each entry in this to see whether we keep it or
                     remove it, and whether we add anything to newExcluded or newThis.
                     We keep an entry in this unless it is narrowed by all entries in
                     other.  We add an entry to newExcluded if there is at least one
                     entry of the same nameType in other, but this entry does
                     not share the same subtree with any of the entries in other.
                     We add an entry from other to newThis if there is no name of the
                     same type in this.                    
                </comment>
                <comment line="355">
                    Step 3a: If the widest name of this type in other narrows
                     thisEntry, remove thisEntry and add widest other to newThis.
                     Simultaneously, check for situation where there is a name of
                     this type in other, but no name in other matches, narrows,
                     or widens thisEntry.                    
                </comment>
                <comment line="386">
                    Step 3b: If sameType is still true, we have the situation
                     where there was a name of the same type as thisEntry in
                     other, but no name in other widened, matched, or narrowed
                     thisEntry.                    
                </comment>
                <comment line="392">
                    Step 3b.1: See if there are any entries in this and other
                     with this type that match, widen, or narrow each other.
                     If not, then we need to add a &quot;widest subtree&quot; of this
                     type to excluded.                    
                </comment>
                <comment line="427">
                    Step 3b.2: Remove thisEntry from this                    
                </comment>
                <comment line="433">
                    Step 4: Add all entries in newThis to this                    
                </comment>
                <comment line="438">
                    Step 5: Add all entries in other that do not have any entry of the
                     same type in this to this                    
                </comment>
                <comment line="449">
                    continue to see if we find something later of the
                     same type                    
                </comment>
                <comment line="456">
                    we found an entry of the same type                    
                </comment>
                <comment line="457">
                    break because we know we won&apos;t be adding it to
                     this now                    
                </comment>
                <comment line="470">
                    Step 6: Return the newExcluded GeneralSubtrees                    
                </comment>
                <scope line="322"/>
                <declaration name="newThis" type="GeneralSubtrees" line="326"/>
                <declaration name="newExcluded" type="GeneralSubtrees" line="327"/>
                <scope line="331"/>
                <scope line="350">
                    <declaration name="thisEntry" type="GeneralNameInterface" line="351"/>
                    <declaration name="removeThisEntry" type="boolean" line="352"/>
                    <declaration name="sameType" type="boolean" line="359"/>
                    <scope line="360">
                        <declaration name="otherEntryGS" type="GeneralSubtree" line="361"/>
                        <declaration name="otherEntry" type="GeneralNameInterface" line="362"/>
                    </scope>
                    <scope line="389">
                        <declaration name="intersection" type="boolean" line="395"/>
                        <scope line="396">
                            <declaration name="thisAltEntry" type="GeneralNameInterface" line="397"/>
                            <scope line="399">
                                <scope line="400">
                                    <declaration name="othAltEntry" type="GeneralNameInterface" line="401"/>
                                    <declaration name="constraintType" type="int" line="404"/>
                                    <scope line="408"/>
                                </scope>
                            </scope>
                        </scope>
                        <scope line="415">
                            <scope line="416"/>
                            <declaration name="widestSubtree" type="GeneralSubtree" line="419"/>
                            <scope line="421"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="433"/>
                <scope line="439">
                    <declaration name="otherEntryGS" type="GeneralSubtree" line="440"/>
                    <declaration name="otherEntry" type="GeneralNameInterface" line="441"/>
                    <declaration name="diffType" type="boolean" line="442"/>
                    <scope line="443">
                        <declaration name="thisEntry" type="GeneralNameInterface" line="444"/>
                    </scope>
                    <scope line="464"/>
                </scope>
            </method>
            <javadoc line="473">
                construct union of this GeneralSubtrees with other.                
                <param>
                    other GeneralSubtrees to be united with this                    
                </param>
            </javadoc>
            <method name="union" type="void" line="478">
                <params>
                    <param name="other" type="GeneralSubtrees"/>
                </params>
                <comment line="484">
                    Minimize this                    
                </comment>
                <scope line="479">
                    <scope line="480"/>
                </scope>
            </method>
            <javadoc line="488">
                reduce this GeneralSubtrees by contents of another.  This function
                  is used in merging excluded NameConstraints with permitted NameConstraints
                  to obtain a minimal form of permitted NameConstraints.  It is an
                  optimization, and does not affect correctness of the results.                
                <param>
                    excluded GeneralSubtrees                    
                </param>
            </javadoc>
            <method name="reduce" type="void" line="496">
                <params>
                    <param name="excluded" type="GeneralSubtrees"/>
                </params>
                <comment line="513">
                                        
                </comment>
                <comment line="518">
                                        
                </comment>
                <comment line="523">
                                        
                </comment>
                <comment line="524">
                                        
                </comment>
                <scope line="497"/>
                <scope line="500">
                    <declaration name="excludedName" type="GeneralNameInterface" line="501"/>
                    <scope line="502">
                        <declaration name="permitted" type="GeneralNameInterface" line="503"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>