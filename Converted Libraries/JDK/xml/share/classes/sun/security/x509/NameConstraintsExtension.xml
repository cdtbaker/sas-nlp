<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.x509">
        <import package="java.io.IOException"/>
        <import package="java.io.OutputStream"/>
        <import package="java.security.Principal"/>
        <import package="java.security.cert.CertificateEncodingException"/>
        <import package="java.security.cert.CertificateException"/>
        <import package="java.security.cert.CertificateParsingException"/>
        <import package="java.security.cert.X509Certificate"/>
        <import package="java.util"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.util"/>
        <import package="sun.security.pkcs.PKCS9Attribute"/>
        <class name="NameConstraintsExtension" line="13">
            <extends class="Extension"/>
            <implements interface="CertAttrSet">
                <type_params>
                    <type_param name="String"/>
                </type_params>
            </implements>
            <implements interface="Cloneable"/>
            <javadoc line="13">
                This class defines the Name Constraints Extension.
                  &lt;p&gt;
                  The name constraints extension provides permitted and excluded
                  subtrees that place restrictions on names that may be included within
                  a certificate issued by a given CA.  Restrictions may apply to the
                  subject distinguished name or subject alternative names.  Any name
                  matching a restriction in the excluded subtrees field is invalid
                  regardless of information appearing in the permitted subtrees.
                  &lt;p&gt;
                  The ASN.1 syntax for this is:
                  &lt;pre&gt;
                  NameConstraints ::= SEQUENCE {
                  permittedSubtrees [0]  GeneralSubtrees OPTIONAL,
                  excludedSubtrees  [1]  GeneralSubtrees OPTIONAL
                  }
                  GeneralSubtrees ::= SEQUENCE SIZE (1..MAX) OF GeneralSubtree
                  &lt;/pre&gt;                
                <author>
                    Amit Kapoor                    
                </author>
                <author>
                    Hemma Prafullchandra                    
                </author>
                <see>
                    Extension                    
                </see>
                <see>
                    CertAttrSet                    
                </see>
            </javadoc>
            <declaration name="IDENT" type="String" line="37"/>
            <javadoc line="37">
                Identifier for this attribute, to be used with the
                  get, set, delete methods of Certificate, x509 type.                
            </javadoc>
            <declaration name="NAME" type="String" line="42"/>
            <javadoc line="42">
                Attribute names.                
            </javadoc>
            <declaration name="PERMITTED_SUBTREES" type="String" line="46"/>
            <declaration name="EXCLUDED_SUBTREES" type="String" line="47"/>
            <declaration name="TAG_PERMITTED" type="byte" line="48"/>
            <declaration name="TAG_EXCLUDED" type="byte" line="49"/>
            <declaration name="permitted" type="GeneralSubtrees" line="50"/>
            <declaration name="excluded" type="GeneralSubtrees" line="51"/>
            <declaration name="hasMin" type="boolean" line="52"/>
            <declaration name="hasMax" type="boolean" line="53"/>
            <declaration name="minMaxValid" type="boolean" line="54"/>
            <method name="calcMinMax" type="void" line="55">
                <scope line="58">
                    <scope line="59">
                        <declaration name="subtree" type="GeneralSubtree" line="60"/>
                    </scope>
                </scope>
                <scope line="65">
                    <scope line="66">
                        <declaration name="subtree" type="GeneralSubtree" line="67"/>
                    </scope>
                </scope>
            </method>
            <method name="encodeThis" type="void" line="74">
                <scope line="76"/>
                <declaration name="seq" type="DerOutputStream" line="80"/>
                <declaration name="tagged" type="DerOutputStream" line="81"/>
                <scope line="82">
                    <declaration name="tmp" type="DerOutputStream" line="83"/>
                </scope>
                <scope line="87">
                    <declaration name="tmp" type="DerOutputStream" line="88"/>
                </scope>
            </method>
            <javadoc line="95">
                The default constructor for this class. Both parameters
                  are optional and can be set to null.  The extension criticality
                  is set to true.                
                <param>
                    permitted the permitted GeneralSubtrees (null for optional).                    
                </param>
                <param>
                    excluded the excluded GeneralSubtrees (null for optional).                    
                </param>
            </javadoc>
            <method name="NameConstraintsExtension" type="constructor" line="102">
                <params>
                    <param name="permitted" type="GeneralSubtrees"/>
                    <param name="excluded" type="GeneralSubtrees"/>
                </params>
            </method>
            <javadoc line="109">
                Create the extension from the passed DER encoded value.                
                <param>
                    critical true if the extension is to be treated as critical.                    
                </param>
                <param>
                    value an array of DER encoded bytes of the actual value.                    
                </param>
                <exception>
                    ClassCastException if value is not an array of bytes                    
                </exception>
                <exception>
                    IOException on error.                    
                </exception>
            </javadoc>
            <method name="NameConstraintsExtension" type="constructor" line="116">
                <params>
                    <param name="critical" type="Boolean"/>
                    <param name="value" type="Object"/>
                </params>
                <declaration name="val" type="DerValue" line="120"/>
                <scope line="121"/>
                <scope line="125">
                    <declaration name="opt" type="DerValue" line="126"/>
                    <scope line="127">
                        <scope line="128"/>
                    </scope>
                    <scope line="134">
                        <scope line="135"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="145">
                Return the printable string.                
            </javadoc>
            <method name="toString" type="String" line="148"/>
            <javadoc line="151">
                Write the extension to the OutputStream.                
                <param>
                    out the OutputStream to write the extension to.                    
                </param>
                <exception>
                    IOException on encoding errors.                    
                </exception>
            </javadoc>
            <method name="encode" type="void" line="156">
                <params>
                    <param name="out" type="OutputStream"/>
                </params>
                <declaration name="tmp" type="DerOutputStream" line="157"/>
                <scope line="158"/>
            </method>
            <javadoc line="166">
                Set the attribute value.                
            </javadoc>
            <method name="set" type="void" line="169">
                <params>
                    <param name="name" type="String"/>
                    <param name="obj" type="Object"/>
                </params>
                <scope line="170">
                    <scope line="171"/>
                </scope>
                <scope line="176">
                    <scope line="177"/>
                </scope>
                <scope line="182"/>
            </method>
            <javadoc line="187">
                Get the attribute value.                
            </javadoc>
            <method name="get" type="Object" line="190">
                <params>
                    <param name="name" type="String"/>
                </params>
                <scope line="191"/>
                <scope line="194"/>
                <scope line="197"/>
            </method>
            <javadoc line="201">
                Delete the attribute value.                
            </javadoc>
            <method name="delete" type="void" line="204">
                <params>
                    <param name="name" type="String"/>
                </params>
                <scope line="205"/>
                <scope line="208"/>
                <scope line="211"/>
            </method>
            <javadoc line="216">
                Return an enumeration of names of attributes existing within this
                  attribute.                
            </javadoc>
            <method name="getElements" type="Enumeration&lt;String&gt;" line="220">
                <declaration name="elements" type="AttributeNameEnumeration" line="221"/>
            </method>
            <javadoc line="226">
                Return the name of this attribute.                
            </javadoc>
            <method name="getName" type="String" line="229"/>
            <javadoc line="232">
                Merge additional name constraints with existing ones.
                  This function is used in certification path processing
                  to accumulate name constraints from successive certificates
                  in the path.  Note that NameConstraints can never be
                  expanded by a merge, just remain constant or become more
                  limiting.
                  &lt;p&gt;
                  IETF RFC2459 specifies the processing of Name Constraints as
                  follows:
                  &lt;p&gt;
                  (j)  If permittedSubtrees is present in the certificate, set the
                  constrained subtrees state variable to the intersection of its
                  previous value and the value indicated in the extension field.
                  &lt;p&gt;
                  (k)  If excludedSubtrees is present in the certificate, set the
                  excluded subtrees state variable to the union of its previous
                  value and the value indicated in the extension field.
                  &lt;p&gt;                
                <param>
                    newConstraints additional NameConstraints to be applied                    
                </param>
                <throws>
                    IOException on error                    
                </throws>
            </javadoc>
            <method name="merge" type="void" line="254">
                <params>
                    <param name="newConstraints" type="NameConstraintsExtension"/>
                </params>
                <scope line="255"/>
                <declaration name="newExcluded" type="GeneralSubtrees" line="258"/>
                <scope line="259"/>
                <scope line="262">
                    <scope line="263"/>
                </scope>
                <declaration name="newPermitted" type="GeneralSubtrees" line="267"/>
                <scope line="268"/>
                <scope line="271">
                    <scope line="272">
                        <scope line="274">
                            <scope line="275"/>
                            <scope line="278"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="284"/>
            </method>
            <javadoc line="289">
                check whether a certificate conforms to these NameConstraints.
                  This involves verifying that the subject name and subjectAltName
                  extension (critical or noncritical) is consistent with the permitted
                  subtrees state variables.  Also verify that the subject name and
                  subjectAltName extension (critical or noncritical) is consistent with
                  the excluded subtrees state variables.                
                <param>
                    cert X509Certificate to be verified                    
                </param>
                <returns>
                    true if certificate verifies successfully                    
                </returns>
                <throws>
                    IOException on error                    
                </throws>
            </javadoc>
            <method name="verify" type="boolean" line="300">
                <params>
                    <param name="cert" type="X509Certificate"/>
                </params>
                <scope line="301"/>
                <scope line="304"/>
                <scope line="307"/>
                <scope line="310"/>
                <declaration name="subjectPrincipal" type="X500Principal" line="313"/>
                <declaration name="subject" type="X500Name" line="314"/>
                <scope line="315">
                    <scope line="316"/>
                </scope>
                <declaration name="altNames" type="GeneralNames" line="320"/>
                <scope line="321">
                    <declaration name="certImpl" type="X509CertImpl" line="322"/>
                    <declaration name="altNameExt" type="SubjectAlternativeNameExtension" line="323"/>
                    <scope line="324"/>
                </scope>
                <scope line="328"/>
                <scope line="331"/>
                <scope line="334">
                    <declaration name="altGNI" type="GeneralNameInterface" line="335"/>
                    <scope line="336"/>
                </scope>
            </method>
            <javadoc line="342">
                check whether a name conforms to these NameConstraints.
                  This involves verifying that the name is consistent with the
                  permitted and excluded subtrees variables.                
                <param>
                    name GeneralNameInterface name to be verified                    
                </param>
                <returns>
                    true if certificate verifies successfully                    
                </returns>
                <throws>
                    IOException on error                    
                </throws>
            </javadoc>
            <method name="verify" type="boolean" line="350">
                <params>
                    <param name="name" type="GeneralNameInterface"/>
                </params>
                <scope line="351"/>
                <scope line="354">
                    <scope line="355">
                        <declaration name="gs" type="GeneralSubtree" line="356"/>
                        <declaration name="gn" type="GeneralName" line="358"/>
                        <declaration name="exName" type="GeneralNameInterface" line="360"/>
                    </scope>
                </scope>
                <scope line="373">
                    <declaration name="sameType" type="boolean" line="374"/>
                    <scope line="375">
                        <declaration name="gs" type="GeneralSubtree" line="376"/>
                        <declaration name="gn" type="GeneralName" line="378"/>
                        <declaration name="perName" type="GeneralNameInterface" line="380"/>
                    </scope>
                    <scope line="394"/>
                </scope>
            </method>
            <javadoc line="400">
                Perform the RFC 822 special case check. We have a certificate
                  that does not contain any subject alternative names. Check that
                  any EMAILADDRESS attributes in its subject name conform to these
                  NameConstraints.                
                <param>
                    subject the certificate&apos;s subject name                    
                </param>
                <returns>
                    true if certificate verifies successfully                    
                </returns>
                <throws>
                    IOException on error                    
                </throws>
            </javadoc>
            <method name="verifyRFC822SpecialCase" type="boolean" line="409">
                <params>
                    <param name="subject" type="X500Name"/>
                </params>
                <scope line="410">
                    <declaration name="ava" type="AVA" line="411"/>
                    <declaration name="attrOID" type="ObjectIdentifier" line="412"/>
                    <scope line="413">
                        <declaration name="attrValue" type="String" line="414"/>
                        <scope line="415">
                            <declaration name="emailName" type="RFC822Name" line="416"/>
                            <scope line="417"/>
                            <scope line="420"/>
                            <scope line="423"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="431">
                Clone all objects that may be modified during certificate validation.                
            </javadoc>
            <method name="clone" type="Object" line="434">
                <scope line="435">
                    <declaration name="newNCE" type="NameConstraintsExtension" line="436"/>
                    <scope line="437"/>
                    <scope line="440"/>
                </scope>
                <scope line="445"/>
            </method>
        </class>
    </source>