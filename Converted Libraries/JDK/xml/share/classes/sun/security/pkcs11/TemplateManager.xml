<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.util"/>
        <import package="java.util.concurrent"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="TemplateManager" line="34">
            <comment line="60">
                constant for any operation (either O_IMPORT or O_GENERATE)                
            </comment>
            <comment line="62">
                constant for operation create (&quot;importing&quot; existing key material)                
            </comment>
            <comment line="64">
                constant for operation generate (generating new key material)                
            </comment>
            <comment line="77">
                primitive templates contains the individual template configuration                
            </comment>
            <comment line="78">
                entries from the configuration file                
            </comment>
            <comment line="81">
                composite templates is a cache of the exact configuration template for                
            </comment>
            <comment line="82">
                each specific TemplateKey (no wildcards). the entries are created                
            </comment>
            <comment line="83">
                on demand during first use by compositing all applicable                
            </comment>
            <comment line="84">
                primitive template entries. the result is then stored in this map                
            </comment>
            <comment line="85">
                for performance                
            </comment>
            <comment line="93">
                add a template. Called by Config.                
            </comment>
            <comment line="113">
                Get the attributes for the requested op and combine them with attrs.                
            </comment>
            <comment line="114">
                This is the method called by the implementation to obtain the                
            </comment>
            <comment line="115">
                attributes.                
            </comment>
            <comment line="127">
                build a composite template for the given key                
            </comment>
            <javadoc line="34">
                TemplateManager class.
                  Not all PKCS#11 tokens are created equal. One token may require that one
                  value is specified when creating a certain type of object. Another token
                  may require a different value. Yet another token may only work if the
                  attribute is not specified at all.
                  In order to allow an application to work unmodified with all those
                  different tokens, the SunPKCS11 provider makes the attributes that are
                  specified and their value configurable. Hence, only the SunPKCS11
                  configuration file has to be tweaked at deployment time to allow all
                  existing applications to be used.
                  The template manager is responsible for reading the attribute configuration
                  information and to make it available to the various internal components
                  of the SunPKCS11 provider.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="DEBUG" type="boolean" line="57"/>
            <declaration name="O_ANY" type="String" line="60"/>
            <declaration name="O_IMPORT" type="String" line="62"/>
            <declaration name="O_GENERATE" type="String" line="64"/>
            <class name="KeyAndTemplate" line="66">
                <declaration name="key" type="TemplateKey" line="67"/>
                <declaration name="template" type="Template" line="68"/>
                <method name="KeyAndTemplate" type="constructor" line="70">
                    <params>
                        <param name="key" type="TemplateKey"/>
                        <param name="template" type="Template"/>
                    </params>
                </method>
            </class>
            <declaration name="primitiveTemplates" type="List&lt;KeyAndTemplate&gt;" line="78"/>
            <declaration name="compositeTemplates" type="Map&lt;TemplateKey,Template&gt;" line="85"/>
            <method name="TemplateManager" type="constructor" line="87"/>
            <method name="addTemplate" type="void" line="94">
                <params>
                    <param name="op" type="String"/>
                    <param name="objectClass" type="long"/>
                    <param name="keyAlgorithm" type="long"/>
                    <param name="attrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <declaration name="key" type="TemplateKey" line="95"/>
                <declaration name="template" type="Template" line="96"/>
                <scope line="97"/>
            </method>
            <method name="getTemplate" type="Template" line="103">
                <params>
                    <param name="key" type="TemplateKey"/>
                </params>
                <declaration name="template" type="Template" line="104"/>
                <scope line="105"/>
            </method>
            <method name="getAttributes" type="CK_ATTRIBUTE[]" line="116">
                <params>
                    <param name="op" type="String"/>
                    <param name="type" type="long"/>
                    <param name="alg" type="long"/>
                    <param name="attrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <declaration name="key" type="TemplateKey" line="117"/>
                <declaration name="template" type="Template" line="118"/>
                <declaration name="newAttrs" type="CK_ATTRIBUTE[]" line="119"/>
                <scope line="120"/>
            </method>
            <method name="buildCompositeTemplate" type="Template" line="127">
                <params>
                    <param name="key" type="TemplateKey"/>
                </params>
                <comment line="129">
                    iterate through primitive templates and add all that apply                    
                </comment>
                <declaration name="comp" type="Template" line="128"/>
                <scope line="130">
                    <scope line="131"/>
                </scope>
            </method>
            <class name="TemplateKey" line="138">
                <javadoc line="138">
                    Nested class representing a template identifier.                    
                </javadoc>
                <declaration name="operation" type="String" line="142"/>
                <declaration name="keyType" type="long" line="143"/>
                <declaration name="keyAlgorithm" type="long" line="144"/>
                <method name="TemplateKey" type="constructor" line="145">
                    <params>
                        <param name="operation" type="String"/>
                        <param name="keyType" type="long"/>
                        <param name="keyAlgorithm" type="long"/>
                    </params>
                </method>
                <method name="equals" type="boolean" line="150">
                    <params>
                        <param name="obj" type="Object"/>
                    </params>
                    <scope line="151"/>
                    <scope line="154"/>
                    <declaration name="other" type="TemplateKey" line="157"/>
                    <declaration name="match" type="boolean" line="158"/>
                </method>
                <method name="hashCode" type="int" line="163"/>
                <method name="appliesTo" type="boolean" line="166">
                    <params>
                        <param name="key" type="TemplateKey"/>
                    </params>
                    <scope line="167">
                        <scope line="168">
                            <scope line="170"/>
                        </scope>
                    </scope>
                </method>
                <method name="toString" type="String" line="177"/>
            </class>
            <class name="Template" line="184">
                <javadoc line="184">
                    Nested class representing template attributes.                    
                </javadoc>
                <declaration name="A0" type="CK_ATTRIBUTE[]" line="189"/>
                <declaration name="attributes" type="CK_ATTRIBUTE[]" line="191"/>
                <method name="Template" type="constructor" line="193"/>
                <method name="Template" type="constructor" line="197">
                    <params>
                        <param name="attributes" type="CK_ATTRIBUTE[]"/>
                    </params>
                </method>
                <method name="add" type="void" line="201">
                    <params>
                        <param name="template" type="Template"/>
                    </params>
                </method>
                <method name="getAttributes" type="CK_ATTRIBUTE[]" line="205">
                    <params>
                        <param name="attrs" type="CK_ATTRIBUTE[]"/>
                    </params>
                </method>
                <javadoc line="209">
                    Combine two sets of attributes. The second set has precedence
                      over the first and overrides its settings.                    
                </javadoc>
                <method name="combine" type="CK_ATTRIBUTE[]" line="214">
                    <params>
                        <param name="attrs1" type="CK_ATTRIBUTE[]"/>
                        <param name="attrs2" type="CK_ATTRIBUTE[]"/>
                    </params>
                    <declaration name="attrs" type="List&lt;CK_ATTRIBUTE&gt;" line="215"/>
                    <scope line="216">
                        <scope line="217"/>
                    </scope>
                    <scope line="221">
                        <declaration name="type" type="long" line="222"/>
                        <scope line="223">
                            <scope line="224"/>
                        </scope>
                        <scope line="228"/>
                    </scope>
                </method>
                <method name="toString" type="String" line="235"/>
            </class>
        </class>
    </source>