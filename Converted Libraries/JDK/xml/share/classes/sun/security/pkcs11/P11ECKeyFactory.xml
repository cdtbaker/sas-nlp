<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.io.IOException"/>
        <import package="java.math.BigInteger"/>
        <import package="java.security"/>
        <import package="java.security.interfaces"/>
        <import package="java.security.spec"/>
        <import package="sun.security.ec.ECPublicKeyImpl"/>
        <import package="sun.security.ec.ECParameters"/>
        <import package="sun.security.ec.NamedCurve"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <import package="sun.security.util.DerValue"/>
        <class name="P11ECKeyFactory" line="45">
            <extends class="P11KeyFactory"/>
            <comment line="66">
                Check that spec is a known supported curve and convert it to our                
            </comment>
            <comment line="67">
                ECParameterSpec subclass. If not possible, return null.                
            </comment>
            <comment line="84">
                Used by ECDH KeyAgreement                
            </comment>
            <comment line="145">
                see JCA spec                
            </comment>
            <comment line="175">
                see JCA spec                
            </comment>
            <javadoc line="45">
                EC KeyFactory implemenation.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <method name="P11ECKeyFactory" type="constructor" line="53">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                </params>
            </method>
            <method name="getECParameterSpec" type="ECParameterSpec" line="57">
                <params>
                    <param name="name" type="String"/>
                </params>
            </method>
            <method name="getECParameterSpec" type="ECParameterSpec" line="61">
                <params>
                    <param name="keySize" type="int"/>
                </params>
            </method>
            <method name="getECParameterSpec" type="ECParameterSpec" line="67">
                <params>
                    <param name="spec" type="ECParameterSpec"/>
                </params>
            </method>
            <method name="decodeParameters" type="ECParameterSpec" line="71">
                <params>
                    <param name="params" type="byte[]"/>
                </params>
            </method>
            <method name="encodeParameters" type="byte[]" line="75">
                <params>
                    <param name="params" type="ECParameterSpec"/>
                </params>
            </method>
            <method name="decodePoint" type="ECPoint" line="79">
                <params>
                    <param name="encoded" type="byte[]"/>
                    <param name="curve" type="EllipticCurve"/>
                </params>
            </method>
            <method name="getEncodedPublicValue" type="byte[]" line="84">
                <params>
                    <param name="key" type="PublicKey"/>
                </params>
                <comment line="93">
                    should never occur                    
                </comment>
                <scope line="85"/>
                <scope line="87">
                    <declaration name="ecKey" type="ECPublicKey" line="88"/>
                    <declaration name="w" type="ECPoint" line="89"/>
                    <declaration name="params" type="ECParameterSpec" line="90"/>
                </scope>
                <scope line="92"/>
            </method>
            <method name="implTranslatePublicKey" type="PublicKey" line="99">
                <params>
                    <param name="key" type="PublicKey"/>
                </params>
                <comment line="108">
                    let Sun provider parse for us, then recurse                    
                </comment>
                <scope line="100">
                    <scope line="101">
                        <declaration name="ecKey" type="ECPublicKey" line="102"/>
                    </scope>
                    <scope line="107">
                        <declaration name="encoded" type="byte[]" line="109"/>
                    </scope>
                    <scope line="112"/>
                </scope>
                <scope line="116"/>
            </method>
            <method name="implTranslatePrivateKey" type="PrivateKey" line="122">
                <params>
                    <param name="key" type="PrivateKey"/>
                </params>
                <comment line="131">
                    let Sun provider parse for us, then recurse                    
                </comment>
                <scope line="123">
                    <scope line="124">
                        <declaration name="ecKey" type="ECPrivateKey" line="125"/>
                    </scope>
                    <scope line="130">
                        <declaration name="encoded" type="byte[]" line="132"/>
                    </scope>
                    <scope line="135"/>
                </scope>
                <scope line="139"/>
            </method>
            <method name="engineGeneratePublic" type="PublicKey" line="146">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="148">
                    <scope line="149">
                        <declaration name="encoded" type="byte[]" line="150"/>
                        <declaration name="key" type="PublicKey" line="151"/>
                    </scope>
                    <scope line="153"/>
                </scope>
                <scope line="158"/>
                <scope line="162">
                    <declaration name="ec" type="ECPublicKeySpec" line="163"/>
                </scope>
                <scope line="168"/>
            </method>
            <method name="engineGeneratePrivate" type="PrivateKey" line="176">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="178">
                    <scope line="179">
                        <declaration name="encoded" type="byte[]" line="180"/>
                        <declaration name="key" type="PrivateKey" line="181"/>
                    </scope>
                    <scope line="183"/>
                </scope>
                <scope line="188"/>
                <scope line="192">
                    <declaration name="ec" type="ECPrivateKeySpec" line="193"/>
                </scope>
                <scope line="198"/>
            </method>
            <method name="generatePublic" type="PublicKey" line="204">
                <params>
                    <param name="point" type="ECPoint"/>
                    <param name="params" type="ECParameterSpec"/>
                </params>
                <declaration name="encodedParams" type="byte[]" line="205"/>
                <declaration name="encodedPoint" type="byte[]" line="206"/>
                <declaration name="pkECPoint" type="DerValue" line="207"/>
                <scope line="210"/>
                <scope line="212"/>
                <declaration name="attributes" type="CK_ATTRIBUTE[]" line="216"/>
                <declaration name="session" type="Session" line="224"/>
                <scope line="225">
                    <declaration name="keyID" type="long" line="227"/>
                </scope>
                <scope line="230"/>
            </method>
            <method name="generatePrivate" type="PrivateKey" line="235">
                <params>
                    <param name="s" type="BigInteger"/>
                    <param name="params" type="ECParameterSpec"/>
                </params>
                <declaration name="encodedParams" type="byte[]" line="236"/>
                <declaration name="attributes" type="CK_ATTRIBUTE[]" line="237"/>
                <declaration name="session" type="Session" line="245"/>
                <scope line="246">
                    <declaration name="keyID" type="long" line="248"/>
                </scope>
                <scope line="251"/>
            </method>
            <method name="implGetPublicKeySpec" type="KeySpec" line="257">
                <params>
                    <param name="key" type="P11Key"/>
                    <param name="keySpec" type="Class"/>
                    <param name="session" type="Session[]"/>
                </params>
                <comment line="272">
                    X.509 handled in superclass                    
                </comment>
                <scope line="258">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="260"/>
                    <scope line="265">
                        <declaration name="params" type="ECParameterSpec" line="266"/>
                        <declaration name="point" type="ECPoint" line="267"/>
                    </scope>
                    <scope line="269"/>
                </scope>
                <scope line="272"/>
            </method>
            <method name="implGetPrivateKeySpec" type="KeySpec" line="279">
                <params>
                    <param name="key" type="P11Key"/>
                    <param name="keySpec" type="Class"/>
                    <param name="session" type="Session[]"/>
                </params>
                <comment line="293">
                    PKCS#8 handled in superclass                    
                </comment>
                <scope line="280">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="282"/>
                    <scope line="287">
                        <declaration name="params" type="ECParameterSpec" line="288"/>
                    </scope>
                    <scope line="290"/>
                </scope>
                <scope line="293"/>
            </method>
            <method name="implGetSoftwareFactory" type="KeyFactory" line="299"/>
        </class>
    </source>