<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.security"/>
        <import package="java.security.interfaces.ECPublicKey"/>
        <import package="java.security.spec.AlgorithmParameterSpec"/>
        <import package="javax.crypto"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11ECDHKeyAgreement" line="38">
            <extends class="KeyAgreementSpi"/>
            <comment line="47">
                token instance                
            </comment>
            <comment line="50">
                algorithm name                
            </comment>
            <comment line="53">
                mechanism id                
            </comment>
            <comment line="56">
                private key, if initialized                
            </comment>
            <comment line="59">
                encoded public point, non-null between doPhase() and generateSecret() only                
            </comment>
            <comment line="62">
                length of the secret to be derived                
            </comment>
            <comment line="72">
                see JCE spec                
            </comment>
            <comment line="83">
                see JCE spec                
            </comment>
            <comment line="94">
                see JCE spec                
            </comment>
            <comment line="118">
                see JCE spec                
            </comment>
            <comment line="152">
                see JCE spec                
            </comment>
            <comment line="164">
                see JCE spec                
            </comment>
            <javadoc line="38">
                KeyAgreement implementation for ECDH.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="47"/>
            <declaration name="algorithm" type="String" line="50"/>
            <declaration name="mechanism" type="long" line="53"/>
            <declaration name="privateKey" type="P11Key" line="56"/>
            <declaration name="publicValue" type="byte[]" line="59"/>
            <declaration name="secretLen" type="int" line="62"/>
            <method name="P11ECDHKeyAgreement" type="constructor" line="64">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
            </method>
            <method name="engineInit" type="void" line="73">
                <params>
                    <param name="key" type="Key"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="74"/>
            </method>
            <method name="engineInit" type="void" line="85">
                <params>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="86"/>
            </method>
            <method name="engineDoPhase" type="Key" line="95">
                <params>
                    <param name="key" type="Key"/>
                    <param name="lastPhase" type="boolean"/>
                </params>
                <scope line="96"/>
                <scope line="99"/>
                <scope line="102"/>
                <scope line="106"/>
                <declaration name="ecKey" type="ECPublicKey" line="110"/>
                <declaration name="keyLenBits" type="int" line="111"/>
            </method>
            <method name="engineGenerateSecret" type="byte[]" line="118">
                <scope line="119"/>
                <declaration name="session" type="Session" line="122"/>
                <scope line="123">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="125"/>
                    <declaration name="ckParams" type="CK_ECDH1_DERIVE_PARAMS" line="129"/>
                    <declaration name="keyID" type="long" line="133"/>
                    <declaration name="secret" type="byte[]" line="140"/>
                </scope>
                <scope line="143"/>
                <scope line="145"/>
            </method>
            <method name="engineGenerateSecret" type="int" line="153">
                <params>
                    <param name="sharedSecret" type="byte[]"/>
                    <param name="offset" type="int"/>
                </params>
                <scope line="154"/>
                <declaration name="secret" type="byte[]" line="158"/>
            </method>
            <method name="engineGenerateSecret" type="SecretKey" line="166">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <scope line="167"/>
                <scope line="170"/>
            </method>
            <method name="nativeGenerateSecret" type="SecretKey" line="179">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <scope line="180"/>
                <declaration name="keyType" type="long" line="183"/>
                <declaration name="session" type="Session" line="184"/>
                <scope line="185">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="187"/>
                    <declaration name="ckParams" type="CK_ECDH1_DERIVE_PARAMS" line="191"/>
                    <declaration name="keyID" type="long" line="195"/>
                    <declaration name="lenAttributes" type="CK_ATTRIBUTE[]" line="198"/>
                    <declaration name="keyLen" type="int" line="202"/>
                    <declaration name="key" type="SecretKey" line="203"/>
                </scope>
                <scope line="206"/>
                <scope line="208"/>
            </method>
        </class>
    </source>