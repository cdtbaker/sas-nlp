<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.spec"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11SecretKeyFactory" line="10">
            <extends class="SecretKeyFactorySpi"/>
            <javadoc line="10">
                SecretKeyFactory implementation class. This class currently supports
                  DES, DESede, AES, ARCFOUR, and Blowfish.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="17"/>
            <declaration name="algorithm" type="String" line="18"/>
            <method name="P11SecretKeyFactory" type="constructor" line="19">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                </params>
            </method>
            <declaration name="keyTypes" type="Map&lt;String,Long&gt;" line="24"/>
            <scope line="25"/>
            <method name="addKeyType" type="void" line="40">
                <params>
                    <param name="name" type="String"/>
                    <param name="id" type="long"/>
                </params>
                <declaration name="l" type="Long" line="41"/>
            </method>
            <method name="getKeyType" type="long" line="45">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <declaration name="l" type="Long" line="46"/>
                <scope line="47">
                    <scope line="50">
                        <scope line="51"/>
                        <scope line="54"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="61">
                Convert an arbitrary key of algorithm into a P11Key of provider.
                  Used in engineTranslateKey(), P11Cipher.init(), and P11Mac.init().                
            </javadoc>
            <method name="convertKey" type="P11Key" line="65">
                <params>
                    <param name="token" type="Token"/>
                    <param name="key" type="Key"/>
                    <param name="algo" type="String"/>
                </params>
            </method>
            <javadoc line="68">
                Convert an arbitrary key of algorithm w/ custom attributes into a
                  P11Key of provider.
                  Used in P11KeyStore.storeSkey.                
            </javadoc>
            <method name="convertKey" type="P11Key" line="73">
                <params>
                    <param name="token" type="Token"/>
                    <param name="key" type="Key"/>
                    <param name="algo" type="String"/>
                    <param name="extraAttrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <scope line="75"/>
                <scope line="78"/>
                <declaration name="algoType" type="long" line="81"/>
                <scope line="82"/>
                <scope line="86">
                    <declaration name="keyAlgorithmType" type="long" line="88"/>
                    <scope line="89">
                        <scope line="90"/>
                        <scope line="92"/>
                    </scope>
                </scope>
                <scope line="97">
                    <declaration name="p11Key" type="P11Key" line="98"/>
                    <scope line="99">
                        <scope line="100">
                            <declaration name="session" type="Session" line="101"/>
                            <scope line="102">
                                <declaration name="newKeyID" type="long" line="104"/>
                            </scope>
                            <scope line="107"/>
                            <scope line="110"/>
                        </scope>
                    </scope>
                </scope>
                <declaration name="p11Key" type="P11Key" line="117"/>
                <scope line="118"/>
                <scope line="121"/>
                <declaration name="encoded" type="byte[]" line="124"/>
            </method>
            <method name="fixDESParity" type="void" line="129">
                <params>
                    <param name="key" type="byte[]"/>
                    <param name="offset" type="int"/>
                </params>
                <scope line="130">
                    <declaration name="b" type="int" line="131"/>
                </scope>
            </method>
            <method name="createKey" type="P11Key" line="136">
                <params>
                    <param name="token" type="Token"/>
                    <param name="encoded" type="byte[]"/>
                    <param name="algorithm" type="String"/>
                    <param name="keyType" type="long"/>
                    <param name="extraAttrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <declaration name="n" type="int" line="137"/>
                <declaration name="keyLength" type="int" line="138"/>
                <scope line="139">
                    <scope line="149"/>
                    <scope line="152"/>
                    <scope line="174"/>
                </scope>
                <scope line="183"/>
                <scope line="186"/>
                <declaration name="session" type="Session" line="189"/>
                <scope line="190">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="191"/>
                    <scope line="192"/>
                    <scope line="196"/>
                    <declaration name="keyID" type="long" line="204"/>
                    <declaration name="p11Key" type="P11Key" line="205"/>
                </scope>
                <scope line="208"/>
                <scope line="211"/>
            </method>
            <method name="engineGenerateSecret" type="SecretKey" line="215">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="217"/>
                <scope line="220">
                    <scope line="221">
                        <declaration name="key" type="Key" line="222"/>
                    </scope>
                    <scope line="225"/>
                </scope>
                <scope line="229">
                    <scope line="230">
                        <declaration name="keyBytes" type="byte[]" line="231"/>
                    </scope>
                </scope>
                <scope line="236">
                    <scope line="237">
                        <declaration name="keyBytes" type="byte[]" line="238"/>
                    </scope>
                </scope>
            </method>
            <method name="getKeyBytes" type="byte[]" line="245">
                <params>
                    <param name="key" type="SecretKey"/>
                </params>
                <scope line="246">
                    <scope line="248"/>
                    <declaration name="k" type="byte[]" line="251"/>
                </scope>
                <scope line="254"/>
            </method>
            <method name="engineGetKeySpec" type="KeySpec" line="258">
                <params>
                    <param name="key" type="SecretKey"/>
                    <param name="keySpec" type="Class"/>
                </params>
                <scope line="260"/>
                <scope line="263"/>
                <scope line="266">
                    <scope line="267">
                        <scope line="268"/>
                    </scope>
                    <scope line="272"/>
                </scope>
                <scope line="276">
                    <scope line="277">
                        <scope line="278"/>
                    </scope>
                    <scope line="282"/>
                </scope>
            </method>
            <method name="engineTranslateKey" type="SecretKey" line="288">
                <params>
                    <param name="key" type="SecretKey"/>
                </params>
            </method>
        </class>
    </source>