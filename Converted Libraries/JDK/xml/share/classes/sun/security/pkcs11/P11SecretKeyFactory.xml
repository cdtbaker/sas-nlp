<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.spec"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11SecretKeyFactory" line="40">
            <extends class="SecretKeyFactorySpi"/>
            <comment line="50">
                token instance                
            </comment>
            <comment line="53">
                algorithm name                
            </comment>
            <comment line="277">
                see JCE spec                
            </comment>
            <comment line="322">
                see JCE spec                
            </comment>
            <comment line="353">
                see JCE spec                
            </comment>
            <javadoc line="40">
                SecretKeyFactory implementation class. This class currently supports
                  DES, DESede, AES, ARCFOUR, and Blowfish.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="50"/>
            <declaration name="algorithm" type="String" line="53"/>
            <method name="P11SecretKeyFactory" type="constructor" line="55">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                </params>
            </method>
            <declaration name="keyTypes" type="Map&lt;String,Long&gt;" line="61"/>
            <scope line="63"/>
            <method name="addKeyType" type="void" line="83">
                <params>
                    <param name="name" type="String"/>
                    <param name="id" type="long"/>
                </params>
                <declaration name="l" type="Long" line="84"/>
            </method>
            <method name="getKeyType" type="long" line="89">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <declaration name="l" type="Long" line="90"/>
                <scope line="91">
                    <scope line="94">
                        <scope line="95"/>
                        <scope line="97"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="105">
                Convert an arbitrary key of algorithm into a P11Key of provider.
                  Used in engineTranslateKey(), P11Cipher.init(), and P11Mac.init().                
            </javadoc>
            <method name="convertKey" type="P11Key" line="110">
                <params>
                    <param name="token" type="Token"/>
                    <param name="key" type="Key"/>
                    <param name="algo" type="String"/>
                </params>
            </method>
            <javadoc line="114">
                Convert an arbitrary key of algorithm w/ custom attributes into a
                  P11Key of provider.
                  Used in P11KeyStore.storeSkey.                
            </javadoc>
            <method name="convertKey" type="P11Key" line="121">
                <params>
                    <param name="token" type="Token"/>
                    <param name="key" type="Key"/>
                    <param name="algo" type="String"/>
                    <param name="extraAttrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <comment line="139">
                    ignore key algorithm for MACs                    
                </comment>
                <scope line="123"/>
                <scope line="126"/>
                <declaration name="algoType" type="long" line="129"/>
                <scope line="130"/>
                <scope line="133">
                    <declaration name="keyAlgorithmType" type="long" line="135"/>
                    <scope line="136">
                        <scope line="137"/>
                        <scope line="139"/>
                    </scope>
                </scope>
                <scope line="145">
                    <declaration name="p11Key" type="P11Key" line="146"/>
                    <scope line="147">
                        <scope line="148">
                            <declaration name="session" type="Session" line="149"/>
                            <scope line="150">
                                <declaration name="newKeyID" type="long" line="152"/>
                            </scope>
                            <scope line="157"/>
                            <scope line="160"/>
                        </scope>
                    </scope>
                </scope>
                <declaration name="p11Key" type="P11Key" line="167"/>
                <scope line="168"/>
                <scope line="171"/>
                <declaration name="encoded" type="byte[]" line="174"/>
            </method>
            <method name="fixDESParity" type="void" line="180">
                <params>
                    <param name="key" type="byte[]"/>
                    <param name="offset" type="int"/>
                </params>
                <scope line="181">
                    <declaration name="b" type="int" line="182"/>
                </scope>
            </method>
            <method name="createKey" type="P11Key" line="190">
                <params>
                    <param name="token" type="Token"/>
                    <param name="encoded" type="byte[]"/>
                    <param name="algorithm" type="String"/>
                    <param name="keyType" type="long"/>
                    <param name="extraAttrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <declaration name="n" type="int" line="191"/>
                <declaration name="keyLength" type="int" line="192"/>
                <scope line="193">
                    <scope line="205"/>
                    <scope line="207"/>
                    <scope line="233"/>
                </scope>
                <scope line="243"/>
                <scope line="246"/>
                <declaration name="session" type="Session" line="249"/>
                <scope line="250">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="251"/>
                    <scope line="252"/>
                    <scope line="256"/>
                    <declaration name="keyID" type="long" line="265"/>
                    <declaration name="p11Key" type="P11Key" line="266"/>
                </scope>
                <scope line="269"/>
                <scope line="271"/>
            </method>
            <method name="engineGenerateSecret" type="SecretKey" line="278">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="280"/>
                <scope line="283">
                    <scope line="284">
                        <declaration name="key" type="Key" line="285"/>
                    </scope>
                    <scope line="287"/>
                </scope>
                <scope line="290">
                    <scope line="291">
                        <declaration name="keyBytes" type="byte[]" line="292"/>
                    </scope>
                </scope>
                <scope line="296">
                    <scope line="297">
                        <declaration name="keyBytes" type="byte[]" line="298"/>
                    </scope>
                </scope>
            </method>
            <method name="getKeyBytes" type="byte[]" line="307">
                <params>
                    <param name="key" type="SecretKey"/>
                </params>
                <scope line="308">
                    <scope line="310"/>
                    <declaration name="k" type="byte[]" line="314"/>
                </scope>
                <scope line="316"/>
            </method>
            <method name="engineGetKeySpec" type="KeySpec" line="323">
                <params>
                    <param name="key" type="SecretKey"/>
                    <param name="keySpec" type="Class"/>
                </params>
                <scope line="325"/>
                <scope line="329"/>
                <scope line="331">
                    <scope line="332">
                        <scope line="333"/>
                    </scope>
                    <scope line="336"/>
                </scope>
                <scope line="339">
                    <scope line="340">
                        <scope line="341"/>
                    </scope>
                    <scope line="344"/>
                </scope>
            </method>
            <method name="engineTranslateKey" type="SecretKey" line="354">
                <params>
                    <param name="key" type="SecretKey"/>
                </params>
            </method>
        </class>
    </source>