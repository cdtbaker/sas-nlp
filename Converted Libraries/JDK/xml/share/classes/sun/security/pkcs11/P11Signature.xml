<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.io.IOException"/>
        <import package="java.math.BigInteger"/>
        <import package="java.nio.ByteBuffer"/>
        <import package="java.security"/>
        <import package="java.security.interfaces"/>
        <import package="sun.nio.ch.DirectBuffer"/>
        <import package="sun.security.util"/>
        <import package="sun.security.x509.AlgorithmId"/>
        <import package="sun.security.rsa.RSASignature"/>
        <import package="sun.security.rsa.RSAPadding"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11Signature" line="14">
            <extends class="SignatureSpi"/>
            <javadoc line="14">
                Signature implementation class. This class currently supports the
                  following algorithms:
                  . DSA
                  . NONEwithDSA (RawDSA)
                  . SHA1withDSA
                  . RSA:
                  . MD2withRSA
                  . MD5withRSA
                  . SHA1withRSA
                  . SHA256withRSA
                  . SHA384withRSA
                  . SHA512withRSA
                  . ECDSA
                  . NONEwithECDSA
                  . SHA1withECDSA
                  . SHA256withECDSA
                  . SHA384withECDSA
                  . SHA512withECDSA
                  Note that the underlying PKCS#11 token may support complete signature
                  algorithm (e.g. CKM_DSA_SHA1, CKM_MD5_RSA_PKCS), or it may just
                  implement the signature algorithm without hashing (e.g. CKM_DSA, CKM_PKCS),
                  or it may only implement the raw public key operation (CKM_RSA_X_509).
                  This class uses what is available and adds whatever extra processing
                  is needed.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="43"/>
            <declaration name="algorithm" type="String" line="44"/>
            <declaration name="keyAlgorithm" type="String" line="45"/>
            <declaration name="mechanism" type="long" line="46"/>
            <declaration name="digestOID" type="ObjectIdentifier" line="47"/>
            <declaration name="type" type="int" line="48"/>
            <declaration name="p11Key" type="P11Key" line="49"/>
            <declaration name="md" type="MessageDigest" line="50"/>
            <declaration name="session" type="Session" line="51"/>
            <declaration name="mode" type="int" line="52"/>
            <declaration name="initialized" type="boolean" line="53"/>
            <declaration name="buffer" type="byte[]" line="54"/>
            <declaration name="bytesProcessed" type="int" line="55"/>
            <declaration name="M_SIGN" type="int" line="56"/>
            <declaration name="M_VERIFY" type="int" line="57"/>
            <declaration name="T_DIGEST" type="int" line="58"/>
            <declaration name="T_UPDATE" type="int" line="59"/>
            <declaration name="T_RAW" type="int" line="60"/>
            <declaration name="RAW_ECDSA_MAX" type="int" line="61"/>
            <method name="P11Signature" type="constructor" line="62">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
                <declaration name="buffer" type="byte[]" line="67"/>
                <declaration name="digestOID" type="ObjectIdentifier" line="68"/>
                <declaration name="md" type="MessageDigest" line="69"/>
                <scope line="93"/>
                <scope line="97"/>
                <scope line="101"/>
                <scope line="107"/>
                <scope line="111">
                    <declaration name="digestAlg" type="String" line="112"/>
                    <scope line="113"/>
                    <scope line="116"/>
                    <scope line="119"/>
                    <scope line="122"/>
                    <scope line="125"/>
                </scope>
                <scope line="136"/>
                <scope line="140"/>
                <scope line="144"/>
                <scope line="148"/>
                <scope line="152"/>
                <scope line="156"/>
                <scope line="160"/>
            </method>
            <method name="ensureInitialized" type="void" line="171">
                <scope line="173"/>
            </method>
            <method name="cancelOperation" type="void" line="177">
                <scope line="179"/>
                <scope line="183"/>
                <scope line="186"/>
                <scope line="190">
                    <scope line="191">
                        <scope line="192"/>
                        <scope line="195">
                            <declaration name="digest" type="byte[]" line="196"/>
                            <scope line="197"/>
                            <scope line="200"/>
                        </scope>
                    </scope>
                    <scope line="206"/>
                </scope>
                <scope line="210">
                    <scope line="211">
                        <declaration name="signature" type="byte[]" line="212"/>
                        <scope line="213"/>
                        <scope line="216"/>
                        <scope line="219"/>
                        <scope line="222">
                            <declaration name="digest" type="byte[]" line="223"/>
                            <scope line="224"/>
                            <scope line="227"/>
                        </scope>
                    </scope>
                    <scope line="233"/>
                </scope>
            </method>
            <method name="initialize" type="void" line="237">
                <scope line="238">
                    <scope line="239"/>
                    <scope line="242"/>
                    <scope line="245"/>
                </scope>
                <scope line="250"/>
                <scope line="253">
                    <scope line="255"/>
                </scope>
            </method>
            <method name="checkRSAKeyLength" type="void" line="260">
                <params>
                    <param name="len" type="int"/>
                </params>
                <declaration name="padding" type="RSAPadding" line="261"/>
                <scope line="262"/>
                <scope line="265"/>
                <declaration name="maxDataSize" type="int" line="268"/>
                <declaration name="encodedLength" type="int" line="269"/>
                <scope line="270"/>
                <scope line="273"/>
                <scope line="276"/>
                <scope line="279"/>
                <scope line="282"/>
                <scope line="285"/>
                <scope line="288"/>
            </method>
            <method name="engineInitVerify" type="void" line="292">
                <params>
                    <param name="publicKey" type="PublicKey"/>
                </params>
                <scope line="293"/>
                <scope line="296">
                    <declaration name="keyLen" type="int" line="297"/>
                    <scope line="298"/>
                    <scope line="301"/>
                </scope>
            </method>
            <method name="engineInitSign" type="void" line="311">
                <params>
                    <param name="privateKey" type="PrivateKey"/>
                </params>
                <scope line="312"/>
                <scope line="315">
                    <declaration name="keyLen" type="int" line="316"/>
                    <scope line="317"/>
                    <scope line="320"/>
                </scope>
            </method>
            <method name="engineUpdate" type="void" line="330">
                <params>
                    <param name="b" type="byte"/>
                </params>
                <scope line="342"/>
            </method>
            <method name="engineUpdate" type="void" line="352">
                <params>
                    <param name="b" type="byte[]"/>
                    <param name="ofs" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="354"/>
                <scope line="359">
                    <scope line="360"/>
                    <scope line="363"/>
                </scope>
                <scope line="368"/>
                <scope line="377"/>
            </method>
            <method name="engineUpdate" type="void" line="388">
                <params>
                    <param name="byteBuffer" type="ByteBuffer"/>
                </params>
                <declaration name="len" type="int" line="390"/>
                <scope line="391"/>
                <scope line="396"/>
                <declaration name="addr" type="long" line="400"/>
                <declaration name="ofs" type="int" line="401"/>
                <scope line="402">
                    <scope line="403"/>
                    <scope line="406"/>
                </scope>
                <scope line="412"/>
                <scope line="421"/>
            </method>
            <method name="engineSign" type="byte[]" line="432">
                <scope line="434">
                    <declaration name="signature" type="byte[]" line="435"/>
                    <scope line="436">
                        <declaration name="len" type="int" line="437"/>
                    </scope>
                    <scope line="440">
                        <declaration name="digest" type="byte[]" line="441"/>
                        <scope line="442"/>
                        <scope line="445">
                            <scope line="446">
                                <scope line="447"/>
                            </scope>
                            <scope line="452">
                                <scope line="453"/>
                            </scope>
                        </scope>
                        <scope line="460"/>
                        <scope line="463">
                            <declaration name="data" type="byte[]" line="464"/>
                            <scope line="465"/>
                        </scope>
                    </scope>
                    <scope line="471"/>
                    <scope line="474"/>
                </scope>
                <scope line="478"/>
                <scope line="481"/>
            </method>
            <method name="engineVerify" type="boolean" line="486">
                <params>
                    <param name="signature" type="byte[]"/>
                </params>
                <scope line="488">
                    <scope line="489"/>
                    <scope line="492"/>
                    <scope line="495"/>
                    <scope line="498">
                        <declaration name="digest" type="byte[]" line="499"/>
                        <scope line="500"/>
                        <scope line="503">
                            <scope line="504">
                                <scope line="505"/>
                            </scope>
                            <scope line="510">
                                <scope line="511"/>
                            </scope>
                        </scope>
                        <scope line="518"/>
                        <scope line="521">
                            <declaration name="data" type="byte[]" line="522"/>
                            <scope line="523"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="531">
                    <declaration name="errorCode" type="long" line="532"/>
                    <scope line="533"/>
                    <scope line="536"/>
                    <scope line="539"/>
                </scope>
                <scope line="544"/>
            </method>
            <method name="pkcs1Pad" type="byte[]" line="549">
                <params>
                    <param name="data" type="byte[]"/>
                </params>
                <scope line="550">
                    <declaration name="len" type="int" line="551"/>
                    <declaration name="padding" type="RSAPadding" line="552"/>
                    <declaration name="padded" type="byte[]" line="553"/>
                </scope>
                <scope line="556"/>
            </method>
            <method name="encodeSignature" type="byte[]" line="560">
                <params>
                    <param name="digest" type="byte[]"/>
                </params>
                <scope line="561"/>
                <scope line="564"/>
            </method>
            <method name="dsaToASN1" type="byte[]" line="568">
                <params>
                    <param name="signature" type="byte[]"/>
                </params>
                <declaration name="n" type="int" line="569"/>
                <declaration name="r" type="BigInteger" line="570"/>
                <declaration name="s" type="BigInteger" line="571"/>
                <scope line="572">
                    <declaration name="outseq" type="DerOutputStream" line="573"/>
                    <declaration name="result" type="DerValue" line="576"/>
                </scope>
                <scope line="579"/>
            </method>
            <method name="asn1ToDSA" type="byte[]" line="583">
                <params>
                    <param name="signature" type="byte[]"/>
                </params>
                <scope line="584">
                    <declaration name="in" type="DerInputStream" line="585"/>
                    <declaration name="values" type="DerValue[]" line="586"/>
                    <declaration name="r" type="BigInteger" line="587"/>
                    <declaration name="s" type="BigInteger" line="588"/>
                    <declaration name="br" type="byte[]" line="589"/>
                    <declaration name="bs" type="byte[]" line="590"/>
                    <scope line="591"/>
                </scope>
                <scope line="596"/>
                <scope line="599"/>
            </method>
            <method name="asn1ToECDSA" type="byte[]" line="603">
                <params>
                    <param name="signature" type="byte[]"/>
                </params>
                <scope line="604">
                    <declaration name="in" type="DerInputStream" line="605"/>
                    <declaration name="values" type="DerValue[]" line="606"/>
                    <declaration name="r" type="BigInteger" line="607"/>
                    <declaration name="s" type="BigInteger" line="608"/>
                    <declaration name="br" type="byte[]" line="609"/>
                    <declaration name="bs" type="byte[]" line="610"/>
                    <declaration name="k" type="int" line="611"/>
                    <declaration name="res" type="byte[]" line="612"/>
                </scope>
                <scope line="617"/>
            </method>
            <method name="toByteArray" type="byte[]" line="621">
                <params>
                    <param name="bi" type="BigInteger"/>
                    <param name="len" type="int"/>
                </params>
                <declaration name="b" type="byte[]" line="622"/>
                <declaration name="n" type="int" line="623"/>
                <scope line="624"/>
                <scope line="627">
                    <declaration name="t" type="byte[]" line="628"/>
                </scope>
                <scope line="632"/>
                <declaration name="t" type="byte[]" line="635"/>
            </method>
            <method name="engineSetParameter" type="void" line="639">
                <params>
                    <param name="param" type="String"/>
                    <param name="value" type="Object"/>
                </params>
            </method>
            <method name="engineGetParameter" type="Object" line="642">
                <params>
                    <param name="param" type="String"/>
                </params>
            </method>
        </class>
    </source>