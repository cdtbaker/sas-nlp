<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.spec.AlgorithmParameterSpec"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.spec"/>
        <import package="sun.security.internal.spec"/>
        <import package="sun.security.internal.interfaces.TlsMasterSecret"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11TlsKeyMaterialGenerator" line="43">
            <extends class="KeyGeneratorSpi"/>
            <comment line="56">
                token instance                
            </comment>
            <comment line="59">
                algorithm name                
            </comment>
            <comment line="62">
                mechanism id                
            </comment>
            <comment line="65">
                parameter spec                
            </comment>
            <comment line="68">
                master secret as a P11Key                
            </comment>
            <comment line="71">
                version, e.g. 0x0301                
            </comment>
            <javadoc line="43">
                KeyGenerator to calculate the SSL/TLS key material (cipher keys and ivs,
                  mac keys) from the master secret.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <declaration name="MSG" type="String" line="52"/>
            <declaration name="token" type="Token" line="56"/>
            <declaration name="algorithm" type="String" line="59"/>
            <declaration name="mechanism" type="long" line="62"/>
            <declaration name="spec" type="TlsKeyMaterialParameterSpec" line="65"/>
            <declaration name="p11Key" type="P11Key" line="68"/>
            <declaration name="version" type="int" line="71"/>
            <method name="P11TlsKeyMaterialGenerator" type="constructor" line="74">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
            </method>
            <method name="engineInit" type="void" line="81">
                <params>
                    <param name="random" type="SecureRandom"/>
                </params>
            </method>
            <method name="engineInit" type="void" line="86">
                <params>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <comment line="102">
                    we assume the token supports both the CKM_SSL3_* and the CKM_TLS_*                    
                </comment>
                <comment line="103">
                    mechanisms                    
                </comment>
                <scope line="87"/>
                <scope line="91"/>
                <scope line="94"/>
                <scope line="98"/>
            </method>
            <method name="engineInit" type="void" line="106">
                <params>
                    <param name="keysize" type="int"/>
                    <param name="random" type="SecureRandom"/>
                </params>
            </method>
            <method name="engineGenerateKey" type="SecretKey" line="110">
                <comment line="142">
                    NULL encryption ciphersuites                    
                </comment>
                <comment line="158">
                    ciphersuites with NULL ciphers                    
                </comment>
                <comment line="163">
                    the returned keyID is a dummy, ignore                    
                </comment>
                <comment line="168">
                    Note that the MAC keys do not inherit all attributes from the                    
                </comment>
                <comment line="169">
                    template, but they do inherit the sensitive/extractable/token                    
                </comment>
                <comment line="170">
                    flags, which is all P11Key cares about.                    
                </comment>
                <scope line="111"/>
                <declaration name="macBits" type="int" line="117"/>
                <declaration name="ivBits" type="int" line="118"/>
                <declaration name="expandedKeyBits" type="int" line="120"/>
                <declaration name="keyBits" type="int" line="121"/>
                <declaration name="isExportable" type="boolean" line="122"/>
                <scope line="123"/>
                <scope line="125"/>
                <declaration name="random" type="CK_SSL3_RANDOM_DATA" line="130"/>
                <declaration name="params" type="CK_SSL3_KEY_MAT_PARAMS" line="132"/>
                <declaration name="cipherAlgorithm" type="String" line="135"/>
                <declaration name="keyType" type="long" line="136"/>
                <scope line="137">
                    <scope line="138"/>
                    <scope line="141"/>
                </scope>
                <declaration name="session" type="Session" line="147"/>
                <scope line="148">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="150"/>
                    <scope line="151"/>
                    <scope line="157"/>
                    <declaration name="keyID" type="long" line="164"/>
                    <declaration name="out" type="CK_SSL3_KEY_MAT_OUT" line="167"/>
                    <declaration name="clientMacKey" type="SecretKey" line="171"/>
                    <declaration name="serverMacKey" type="SecretKey" line="173"/>
                    <declaration name="clientCipherKey" type="SecretKey" line="175"/>
                    <scope line="176"/>
                    <scope line="181"/>
                    <declaration name="clientIv" type="IvParameterSpec" line="185"/>
                    <declaration name="serverIv" type="IvParameterSpec" line="187"/>
                </scope>
                <scope line="193"/>
                <scope line="195"/>
            </method>
        </class>
    </source>