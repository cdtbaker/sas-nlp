<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.math.BigInteger"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.interfaces"/>
        <import package="javax.crypto.spec"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11KeyAgreement" line="11">
            <extends class="KeyAgreementSpi"/>
            <javadoc line="11">
                KeyAgreement implementation class. This class currently supports
                  DH.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="18"/>
            <declaration name="algorithm" type="String" line="19"/>
            <declaration name="mechanism" type="long" line="20"/>
            <declaration name="privateKey" type="P11Key" line="21"/>
            <declaration name="publicValue" type="BigInteger" line="22"/>
            <declaration name="secretLen" type="int" line="23"/>
            <declaration name="multiPartyAgreement" type="KeyAgreement" line="24"/>
            <method name="P11KeyAgreement" type="constructor" line="25">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
            </method>
            <method name="engineInit" type="void" line="31">
                <params>
                    <param name="key" type="Key"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="32"/>
            </method>
            <method name="engineInit" type="void" line="39">
                <params>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="40"/>
            </method>
            <method name="engineDoPhase" type="Key" line="45">
                <params>
                    <param name="key" type="Key"/>
                    <param name="lastPhase" type="boolean"/>
                </params>
                <scope line="46"/>
                <scope line="49"/>
                <scope line="52">
                    <scope line="53">
                        <scope line="54"/>
                        <scope line="58"/>
                    </scope>
                </scope>
                <scope line="64"/>
                <declaration name="p" type="BigInteger" line="67"/>
                <scope line="68">
                    <declaration name="dhKey" type="DHPublicKey" line="69"/>
                    <declaration name="params" type="DHParameterSpec" line="71"/>
                </scope>
                <scope line="75">
                    <declaration name="kf" type="P11DHKeyFactory" line="76"/>
                    <scope line="77">
                        <declaration name="spec" type="DHPublicKeySpec" line="78"/>
                    </scope>
                    <scope line="83"/>
                </scope>
                <scope line="87">
                    <declaration name="dhKey" type="DHPrivateKey" line="88"/>
                    <declaration name="params" type="DHParameterSpec" line="89"/>
                    <scope line="90"/>
                </scope>
            </method>
            <method name="engineGenerateSecret" type="byte[]" line="98">
                <scope line="99">
                    <declaration name="val" type="byte[]" line="100"/>
                </scope>
                <scope line="104"/>
                <declaration name="session" type="Session" line="107"/>
                <scope line="108">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="110"/>
                    <declaration name="keyID" type="long" line="112"/>
                    <declaration name="secret" type="byte[]" line="115"/>
                </scope>
                <scope line="119"/>
                <scope line="122"/>
            </method>
            <method name="engineGenerateSecret" type="int" line="127">
                <params>
                    <param name="sharedSecret" type="byte[]"/>
                    <param name="offset" type="int"/>
                </params>
                <scope line="128">
                    <declaration name="n" type="int" line="129"/>
                </scope>
                <scope line="133"/>
                <declaration name="secret" type="byte[]" line="136"/>
            </method>
            <method name="engineGenerateSecret" type="SecretKey" line="140">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <scope line="141">
                    <declaration name="key" type="SecretKey" line="142"/>
                </scope>
                <scope line="146"/>
                <scope line="149"/>
                <declaration name="secret" type="byte[]" line="152"/>
                <declaration name="keyLen" type="int" line="153"/>
                <scope line="154"/>
                <scope line="157"/>
                <scope line="160"/>
                <scope line="163"/>
                <scope line="166"/>
                <scope line="169"/>
                <scope line="172">
                    <scope line="173"/>
                </scope>
            </method>
            <method name="nativeGenerateSecret" type="SecretKey" line="179">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <scope line="180"/>
                <declaration name="keyType" type="long" line="183"/>
                <declaration name="session" type="Session" line="184"/>
                <scope line="185">
                    <declaration name="attributes" type="CK_ATTRIBUTE[]" line="187"/>
                    <declaration name="keyID" type="long" line="189"/>
                    <declaration name="lenAttributes" type="CK_ATTRIBUTE[]" line="190"/>
                    <declaration name="keyLen" type="int" line="192"/>
                    <declaration name="key" type="SecretKey" line="193"/>
                    <scope line="194">
                        <declaration name="keyBytes" type="byte[]" line="195"/>
                        <declaration name="newBytes" type="byte[]" line="196"/>
                        <scope line="197"/>
                    </scope>
                </scope>
                <scope line="203"/>
                <scope line="206"/>
            </method>
        </class>
    </source>