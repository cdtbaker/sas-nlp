<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.nio.ByteBuffer"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.Locale"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.spec"/>
        <import package="sun.nio.ch.DirectBuffer"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11Cipher" line="12">
            <extends class="CipherSpi"/>
            <javadoc line="12">
                Cipher implementation class. This class currently supports
                  DES, DESede, AES, ARCFOUR, and Blowfish.
                  This class is designed to support ECB, CBC, CTR with NoPadding
                  and ECB, CBC with PKCS5Padding. It will use its own padding impl
                  if the native mechanism does not support padding.
                  Note that PKCS#11 currently only supports ECB, CBC, and CTR.
                  There are no provisions for other modes such as CFB, OFB, and PCBC.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="MODE_ECB" type="int" line="24"/>
            <declaration name="MODE_CBC" type="int" line="25"/>
            <declaration name="MODE_CTR" type="int" line="26"/>
            <declaration name="PAD_NONE" type="int" line="27"/>
            <declaration name="PAD_PKCS5" type="int" line="28"/>
            <interface name="Padding">
                <method name="setPaddingBytes" type="int" line="30"/>
                <method name="unpad" type="int" line="31"/>
            </interface>
            <class name="PKCS5Padding" line="33">
                <implements interface="Padding"/>
                <declaration name="blockSize" type="int" line="34"/>
                <method name="PKCS5Padding" type="constructor" line="35">
                    <params>
                        <param name="blockSize" type="int"/>
                    </params>
                    <scope line="36"/>
                </method>
                <method name="setPaddingBytes" type="int" line="41">
                    <params>
                        <param name="paddingBuffer" type="byte[]"/>
                        <param name="padLen" type="int"/>
                    </params>
                </method>
                <method name="unpad" type="int" line="45">
                    <params>
                        <param name="paddedData" type="byte[]"/>
                        <param name="len" type="int"/>
                    </params>
                    <scope line="46"/>
                    <declaration name="padValue" type="byte" line="49"/>
                    <scope line="50"/>
                    <declaration name="padStartIndex" type="int" line="53"/>
                    <scope line="54">
                        <scope line="55"/>
                    </scope>
                </method>
            </class>
            <declaration name="token" type="Token" line="62"/>
            <declaration name="algorithm" type="String" line="63"/>
            <declaration name="keyAlgorithm" type="String" line="64"/>
            <declaration name="mechanism" type="long" line="65"/>
            <declaration name="session" type="Session" line="66"/>
            <declaration name="p11Key" type="P11Key" line="67"/>
            <declaration name="initialized" type="boolean" line="68"/>
            <declaration name="encrypt" type="boolean" line="69"/>
            <declaration name="blockMode" type="int" line="70"/>
            <declaration name="blockSize" type="int" line="71"/>
            <declaration name="paddingType" type="int" line="72"/>
            <declaration name="paddingObj" type="Padding" line="73"/>
            <declaration name="padBuffer" type="byte[]" line="74"/>
            <declaration name="padBufferLen" type="int" line="75"/>
            <declaration name="iv" type="byte[]" line="76"/>
            <declaration name="bytesBuffered" type="int" line="77"/>
            <method name="P11Cipher" type="constructor" line="78">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
                <declaration name="algoParts" type="String" line="83"/>
                <scope line="85"/>
                <scope line="88"/>
                <scope line="91"/>
                <declaration name="defPadding" type="String" line="95"/>
                <declaration name="paddingStr" type="String" line="96"/>
                <scope line="97"/>
                <scope line="100"/>
            </method>
            <method name="engineSetMode" type="void" line="104">
                <params>
                    <param name="mode" type="String"/>
                </params>
            </method>
            <method name="parseMode" type="int" line="107">
                <params>
                    <param name="mode" type="String"/>
                </params>
                <declaration name="result" type="int" line="109"/>
                <scope line="110"/>
                <scope line="113">
                    <scope line="114"/>
                </scope>
                <scope line="119"/>
                <scope line="122"/>
            </method>
            <method name="engineSetPadding" type="void" line="127">
                <params>
                    <param name="padding" type="String"/>
                </params>
                <scope line="131"/>
                <scope line="134">
                    <scope line="135"/>
                    <scope line="139"/>
                </scope>
                <scope line="144"/>
            </method>
            <method name="engineGetBlockSize" type="int" line="148"/>
            <method name="engineGetOutputSize" type="int" line="151">
                <params>
                    <param name="inputLen" type="int"/>
                </params>
            </method>
            <method name="engineGetIV" type="byte[]" line="154"/>
            <method name="engineGetParameters" type="AlgorithmParameters" line="157">
                <scope line="158"/>
                <declaration name="ivSpec" type="IvParameterSpec" line="161"/>
                <scope line="162">
                    <declaration name="params" type="AlgorithmParameters" line="163"/>
                </scope>
                <scope line="167"/>
            </method>
            <method name="engineInit" type="void" line="171">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="172"/>
                <scope line="175"/>
            </method>
            <method name="engineInit" type="void" line="179">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <declaration name="ivValue" type="byte[]" line="180"/>
                <scope line="181">
                    <scope line="182"/>
                    <declaration name="ivSpec" type="IvParameterSpec" line="185"/>
                </scope>
                <scope line="188"/>
            </method>
            <method name="engineInit" type="void" line="193">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameters"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <declaration name="ivValue" type="byte[]" line="194"/>
                <scope line="195">
                    <scope line="196">
                        <declaration name="ivSpec" type="IvParameterSpec" line="197"/>
                    </scope>
                    <scope line="200"/>
                </scope>
                <scope line="204"/>
            </method>
            <method name="implInit" type="void" line="209">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="iv" type="byte[]"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="221">
                    <scope line="222">
                        <scope line="223"/>
                        <scope line="226"/>
                    </scope>
                </scope>
                <scope line="231">
                    <scope line="232">
                        <scope line="233">
                            <declaration name="exMsg" type="String" line="234"/>
                        </scope>
                        <scope line="237"/>
                    </scope>
                    <scope line="243">
                        <scope line="244"/>
                    </scope>
                </scope>
                <scope line="251"/>
                <scope line="254"/>
            </method>
            <method name="cancelOperation" type="void" line="258">
                <scope line="259"/>
                <scope line="263"/>
                <declaration name="bufLen" type="int" line="266"/>
                <declaration name="buffer" type="byte[]" line="267"/>
                <scope line="268">
                    <scope line="269"/>
                    <scope line="272"/>
                </scope>
                <scope line="276"/>
                <scope line="279"/>
            </method>
            <method name="ensureInitialized" type="void" line="283">
                <scope line="284"/>
            </method>
            <method name="initialize" type="void" line="288">
                <scope line="289"/>
                <declaration name="mechParams" type="CK_MECHANISM" line="292"/>
                <scope line="293">
                    <scope line="294"/>
                    <scope line="297"/>
                </scope>
                <scope line="301"/>
            </method>
            <method name="updateLength" type="int" line="309">
                <params>
                    <param name="inLen" type="int"/>
                </params>
                <scope line="310"/>
                <declaration name="result" type="int" line="313"/>
                <scope line="314"/>
            </method>
            <method name="doFinalLength" type="int" line="319">
                <params>
                    <param name="inLen" type="int"/>
                </params>
                <scope line="320"/>
                <declaration name="result" type="int" line="323"/>
                <scope line="324"/>
            </method>
            <method name="reset" type="void" line="329">
                <scope line="333"/>
            </method>
            <method name="engineUpdate" type="byte[]" line="337">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="inLen" type="int"/>
                </params>
                <scope line="338">
                    <declaration name="out" type="byte[]" line="339"/>
                    <declaration name="n" type="int" line="340"/>
                </scope>
                <scope line="343"/>
            </method>
            <method name="engineUpdate" type="int" line="347">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="inLen" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                </params>
                <declaration name="outLen" type="int" line="348"/>
            </method>
            <method name="engineUpdate" type="int" line="351">
                <params>
                    <param name="inBuffer" type="ByteBuffer"/>
                    <param name="outBuffer" type="ByteBuffer"/>
                </params>
            </method>
            <method name="engineDoFinal" type="byte[]" line="354">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="inLen" type="int"/>
                </params>
                <scope line="355">
                    <declaration name="out" type="byte[]" line="356"/>
                    <declaration name="n" type="int" line="357"/>
                </scope>
                <scope line="360"/>
            </method>
            <method name="engineDoFinal" type="int" line="364">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="inLen" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                </params>
                <declaration name="n" type="int" line="365"/>
                <scope line="366"/>
            </method>
            <method name="engineDoFinal" type="int" line="373">
                <params>
                    <param name="inBuffer" type="ByteBuffer"/>
                    <param name="outBuffer" type="ByteBuffer"/>
                </params>
                <declaration name="n" type="int" line="374"/>
            </method>
            <method name="implUpdate" type="int" line="378">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="inLen" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                    <param name="outLen" type="int"/>
                </params>
                <scope line="379"/>
                <scope line="382">
                    <declaration name="k" type="int" line="384"/>
                    <scope line="385"/>
                    <scope line="388">
                        <declaration name="newPadBufferLen" type="int" line="389"/>
                        <scope line="390">
                            <scope line="391">
                                <scope line="392">
                                    <declaration name="bufCapacity" type="int" line="393"/>
                                    <scope line="394"/>
                                    <scope line="399"/>
                                </scope>
                            </scope>
                            <scope line="408"/>
                        </scope>
                        <scope line="413"/>
                        <scope line="416"/>
                    </scope>
                </scope>
                <scope line="423">
                    <scope line="424"/>
                </scope>
            </method>
            <method name="implUpdate" type="int" line="431">
                <params>
                    <param name="inBuffer" type="ByteBuffer"/>
                    <param name="outBuffer" type="ByteBuffer"/>
                </params>
                <declaration name="inLen" type="int" line="432"/>
                <scope line="433"/>
                <declaration name="outLen" type="int" line="436"/>
                <scope line="437"/>
                <declaration name="origPos" type="int" line="440"/>
                <scope line="441">
                    <declaration name="inAddr" type="long" line="443"/>
                    <declaration name="inOfs" type="int" line="444"/>
                    <declaration name="inArray" type="byte[]" line="445"/>
                    <scope line="446"/>
                    <scope line="450"/>
                    <declaration name="outAddr" type="long" line="454"/>
                    <declaration name="outOfs" type="int" line="455"/>
                    <declaration name="outArray" type="byte[]" line="456"/>
                    <scope line="457"/>
                    <scope line="461">
                        <scope line="462"/>
                        <scope line="466"/>
                    </scope>
                    <declaration name="k" type="int" line="470"/>
                    <scope line="471">
                        <scope line="472"/>
                        <scope line="476"/>
                    </scope>
                    <scope line="481">
                        <declaration name="newPadBufferLen" type="int" line="482"/>
                        <scope line="483">
                            <scope line="484">
                                <scope line="485">
                                    <declaration name="bufCapacity" type="int" line="486"/>
                                    <scope line="487"/>
                                    <scope line="492"/>
                                </scope>
                            </scope>
                            <scope line="501"/>
                        </scope>
                        <scope line="506">
                            <scope line="507"/>
                            <scope line="511"/>
                        </scope>
                        <scope line="516"/>
                    </scope>
                    <scope line="521"/>
                    <scope line="524"/>
                </scope>
                <scope line="529">
                    <scope line="531"/>
                </scope>
            </method>
            <method name="implDoFinal" type="int" line="538">
                <params>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                    <param name="outLen" type="int"/>
                </params>
                <declaration name="requiredOutLen" type="int" line="539"/>
                <scope line="540"/>
                <scope line="543">
                    <declaration name="k" type="int" line="545"/>
                    <scope line="546">
                        <scope line="547">
                            <declaration name="actualPadLen" type="int" line="548"/>
                        </scope>
                    </scope>
                    <scope line="553">
                        <scope line="554">
                            <scope line="555"/>
                            <declaration name="actualPadLen" type="int" line="559"/>
                        </scope>
                        <scope line="563"/>
                    </scope>
                </scope>
                <scope line="569"/>
                <scope line="573"/>
            </method>
            <method name="implDoFinal" type="int" line="577">
                <params>
                    <param name="outBuffer" type="ByteBuffer"/>
                </params>
                <declaration name="outLen" type="int" line="578"/>
                <declaration name="requiredOutLen" type="int" line="579"/>
                <scope line="580"/>
                <scope line="583">
                    <declaration name="outAddr" type="long" line="585"/>
                    <declaration name="outArray" type="byte[]" line="586"/>
                    <declaration name="outOfs" type="int" line="587"/>
                    <scope line="588"/>
                    <scope line="592">
                        <scope line="593"/>
                        <scope line="597"/>
                    </scope>
                    <declaration name="k" type="int" line="601"/>
                    <scope line="602">
                        <scope line="603">
                            <declaration name="actualPadLen" type="int" line="604"/>
                        </scope>
                    </scope>
                    <scope line="609">
                        <scope line="610">
                            <scope line="611"/>
                            <declaration name="actualPadLen" type="int" line="616"/>
                        </scope>
                        <scope line="621"/>
                    </scope>
                    <scope line="625"/>
                    <scope line="628"/>
                </scope>
                <scope line="633"/>
                <scope line="637"/>
            </method>
            <method name="handleException" type="void" line="641">
                <params>
                    <param name="e" type="PKCS11Exception"/>
                </params>
                <declaration name="errorCode" type="long" line="642"/>
                <scope line="643"/>
                <scope line="646"/>
            </method>
            <method name="engineWrap" type="byte[]" line="650">
                <params>
                    <param name="key" type="Key"/>
                </params>
            </method>
            <method name="engineUnwrap" type="Key" line="653">
                <params>
                    <param name="wrappedKey" type="byte[]"/>
                    <param name="wrappedKeyAlgorithm" type="String"/>
                    <param name="wrappedKeyType" type="int"/>
                </params>
            </method>
            <method name="engineGetKeySize" type="int" line="656">
                <params>
                    <param name="key" type="Key"/>
                </params>
                <declaration name="n" type="int" line="657"/>
            </method>
            <method name="bufferInputBytes" type="void" line="660">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="len" type="int"/>
                </params>
            </method>
            <method name="bufferInputBytes" type="void" line="665">
                <params>
                    <param name="inBuffer" type="ByteBuffer"/>
                    <param name="len" type="int"/>
                </params>
            </method>
        </class>
    </source>