<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.util"/>
        <import package="java.io"/>
        <import package="java.lang.ref"/>
        <import package="java.security"/>
        <import package="javax.security.auth.login.LoginException"/>
        <import package="sun.security.jca.JCAUtil"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="Token" line="10">
            <implements interface="Serializable"/>
            <javadoc line="10">
                PKCS#11 token.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="16"/>
            <declaration name="CHECK_INTERVAL" type="long" line="17"/>
            <declaration name="provider" type="SunPKCS11" line="18"/>
            <declaration name="p11" type="PKCS11" line="19"/>
            <declaration name="config" type="Config" line="20"/>
            <declaration name="tokenInfo" type="CK_TOKEN_INFO" line="21"/>
            <declaration name="sessionManager" type="SessionManager" line="22"/>
            <declaration name="templateManager" type="TemplateManager" line="23"/>
            <declaration name="explicitCancel" type="boolean" line="24"/>
            <declaration name="secretCache" type="KeyCache" line="25"/>
            <declaration name="privateCache" type="KeyCache" line="26"/>
            <declaration name="rsaFactory" type="P11KeyFactory" line="27"/>
            <declaration name="mechInfoMap" type="Map&lt;Long,CK_MECHANISM_INFO&gt;" line="28"/>
            <declaration name="secureRandom" type="P11SecureRandom" line="29"/>
            <declaration name="keyStore" type="P11KeyStore" line="30"/>
            <declaration name="removable" type="boolean" line="31"/>
            <declaration name="valid" type="boolean" line="32"/>
            <declaration name="lastPresentCheck" type="long" line="33"/>
            <declaration name="tokenId" type="byte[]" line="34"/>
            <declaration name="writeProtected" type="boolean" line="35"/>
            <declaration name="loggedIn" type="boolean" line="36"/>
            <declaration name="lastLoginCheck" type="long" line="37"/>
            <declaration name="CHECK_LOCK" type="Object" line="38"/>
            <declaration name="INVALID_MECH" type="CK_MECHANISM_INFO" line="39"/>
            <method name="Token" type="constructor" line="40">
                <params>
                    <param name="provider" type="SunPKCS11"/>
                </params>
                <declaration name="sessionManager" type="SessionManager" line="48"/>
                <scope line="49">
                    <declaration name="s" type="Session" line="51"/>
                </scope>
                <scope line="54">
                    <scope line="55"/>
                    <declaration name="s" type="Session" line="60"/>
                </scope>
            </method>
            <method name="isWriteProtected" type="boolean" line="70"/>
            <method name="isLoggedIn" type="boolean" line="73">
                <params>
                    <param name="session" type="Session"/>
                </params>
                <declaration name="loggedIn" type="boolean" line="74"/>
                <declaration name="time" type="long" line="75"/>
                <scope line="76"/>
            </method>
            <method name="isLoggedInNow" type="boolean" line="82">
                <params>
                    <param name="session" type="Session"/>
                </params>
                <declaration name="allocSession" type="boolean" line="83"/>
                <scope line="84">
                    <scope line="85"/>
                    <declaration name="info" type="CK_SESSION_INFO" line="88"/>
                    <declaration name="loggedIn" type="boolean" line="89"/>
                </scope>
                <scope line="93">
                    <scope line="94"/>
                </scope>
            </method>
            <method name="ensureLoggedIn" type="void" line="99">
                <params>
                    <param name="session" type="Session"/>
                </params>
                <scope line="100"/>
            </method>
            <method name="isValid" type="boolean" line="104">
                <scope line="105"/>
            </method>
            <method name="ensureValid" type="void" line="110">
                <scope line="111"/>
            </method>
            <method name="isPresent" type="boolean" line="115">
                <params>
                    <param name="session" type="Session"/>
                </params>
                <scope line="116"/>
                <scope line="119"/>
                <declaration name="time" type="long" line="122"/>
                <scope line="123">
                    <scope line="124">
                        <scope line="125">
                            <declaration name="ok" type="boolean" line="126"/>
                            <scope line="127">
                                <declaration name="slotInfo" type="CK_SLOT_INFO" line="128"/>
                                <scope line="129">
                                    <declaration name="sessInfo" type="CK_SESSION_INFO" line="130"/>
                                </scope>
                            </scope>
                            <scope line="134"/>
                            <scope line="138"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="destroy" type="void" line="146"/>
            <method name="getObjSession" type="Session" line="150"/>
            <method name="getOpSession" type="Session" line="153"/>
            <method name="releaseSession" type="Session" line="156">
                <params>
                    <param name="session" type="Session"/>
                </params>
            </method>
            <method name="killSession" type="Session" line="159">
                <params>
                    <param name="session" type="Session"/>
                </params>
            </method>
            <method name="getAttributes" type="CK_ATTRIBUTE[]" line="162">
                <params>
                    <param name="op" type="String"/>
                    <param name="type" type="long"/>
                    <param name="alg" type="long"/>
                    <param name="attrs" type="CK_ATTRIBUTE[]"/>
                </params>
                <declaration name="newAttrs" type="CK_ATTRIBUTE[]" line="163"/>
                <scope line="164">
                    <scope line="165">
                        <scope line="166">
                            <scope line="167"/>
                            <scope line="170"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="getKeyFactory" type="P11KeyFactory" line="179">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <declaration name="f" type="P11KeyFactory" line="180"/>
                <scope line="181">
                    <scope line="183"/>
                </scope>
                <scope line="188">
                    <scope line="190"/>
                </scope>
                <scope line="195">
                    <scope line="197"/>
                </scope>
                <scope line="202">
                    <scope line="204"/>
                </scope>
                <scope line="209"/>
            </method>
            <method name="getRandom" type="P11SecureRandom" line="214">
                <scope line="215"/>
            </method>
            <method name="getKeyStore" type="P11KeyStore" line="220">
                <scope line="221"/>
            </method>
            <method name="getMechanismInfo" type="CK_MECHANISM_INFO" line="226">
                <params>
                    <param name="mechanism" type="long"/>
                </params>
                <declaration name="result" type="CK_MECHANISM_INFO" line="227"/>
                <scope line="228">
                    <scope line="229"/>
                    <scope line="233">
                        <scope line="234"/>
                        <scope line="237"/>
                    </scope>
                </scope>
                <scope line="242"/>
            </method>
            <method name="getTokenId" type="byte[]" line="247">
                <scope line="248">
                    <declaration name="random" type="SecureRandom" line="249"/>
                </scope>
            </method>
            <declaration name="serializedTokens" type="List&lt;Reference&lt;Token&gt;&gt;" line="256"/>
            <method name="writeReplace" type="Object" line="257">
                <scope line="258"/>
            </method>
            <class name="TokenRep" line="263">
                <implements interface="Serializable"/>
                <declaration name="serialVersionUID" type="long" line="264"/>
                <declaration name="tokenId" type="byte[]" line="265"/>
                <method name="TokenRep" type="constructor" line="266">
                    <params>
                        <param name="token" type="Token"/>
                    </params>
                </method>
                <method name="readResolve" type="Object" line="269">
                    <scope line="270">
                        <declaration name="token" type="Token" line="271"/>
                        <scope line="272">
                            <scope line="273"/>
                        </scope>
                    </scope>
                </method>
            </class>
        </class>
    </source>