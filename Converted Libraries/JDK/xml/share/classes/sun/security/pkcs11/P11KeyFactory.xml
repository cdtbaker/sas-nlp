<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Exception"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <class name="P11KeyFactory" line="34">
            <extends class="KeyFactorySpi"/>
            <comment line="48">
                token instance                
            </comment>
            <comment line="51">
                algorithm name, currently one of RSA, DSA, DH                
            </comment>
            <comment line="69">
                see JCA spec                
            </comment>
            <comment line="107">
                see JCA spec                
            </comment>
            <javadoc line="34">
                KeyFactory base class. Provides common infrastructure for the RSA, DSA,
                  and DH implementations.
                  The subclasses support conversion between keys and keyspecs
                  using X.509, PKCS#8, and their individual algorithm specific formats,
                  assuming keys are extractable.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="48"/>
            <declaration name="algorithm" type="String" line="51"/>
            <method name="P11KeyFactory" type="constructor" line="53">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                </params>
            </method>
            <javadoc line="59">
                Convert an arbitrary key of algorithm into a P11Key of token.
                  Used by P11Signature.init() and RSACipher.init().                
            </javadoc>
            <method name="convertKey" type="P11Key" line="64">
                <params>
                    <param name="token" type="Token"/>
                    <param name="key" type="Key"/>
                    <param name="algorithm" type="String"/>
                </params>
            </method>
            <method name="engineGetKeySpec" type="T" line="70">
                <params>
                    <param name="key" type="Key"/>
                    <param name="keySpec" type="Class<T>"/>
                </params>
                <comment line="76">
                    delegate to our Java based providers for PKCS#8 and X.509                    
                </comment>
                <comment line="85">
                    first translate into a key of this token, if it is not already                    
                </comment>
                <scope line="72"/>
                <scope line="78">
                    <scope line="79"/>
                    <scope line="81"/>
                </scope>
                <declaration name="p11Key" type="P11Key" line="86"/>
                <scope line="87"/>
                <scope line="89"/>
                <declaration name="session" type="Session[]" line="92"/>
                <scope line="93">
                    <scope line="94"/>
                    <scope line="96"/>
                </scope>
                <scope line="99"/>
                <scope line="101"/>
            </method>
            <method name="engineTranslateKey" type="Key" line="107">
                <params>
                    <param name="key" type="Key"/>
                </params>
                <comment line="119">
                    already a key of this token, no need to translate                    
                </comment>
                <scope line="109"/>
                <scope line="112"/>
                <scope line="116">
                    <declaration name="p11Key" type="P11Key" line="117"/>
                    <scope line="118"/>
                </scope>
                <declaration name="p11Key" type="P11Key" line="123"/>
                <scope line="124"/>
                <scope line="127">
                    <declaration name="publicKey" type="PublicKey" line="128"/>
                </scope>
                <scope line="131">
                    <declaration name="privateKey" type="PrivateKey" line="132"/>
                </scope>
                <scope line="135"/>
            </method>
            <method name="implGetPublicKeySpec" type="KeySpec" line="141"/>
            <method name="implGetPrivateKeySpec" type="KeySpec" line="144"/>
            <method name="implTranslatePublicKey" type="PublicKey" line="147"/>
            <method name="implTranslatePrivateKey" type="PrivateKey" line="150"/>
            <method name="implGetSoftwareFactory" type="KeyFactory" line="153"/>
        </class>
    </source>