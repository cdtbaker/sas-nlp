<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.math.BigInteger"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto.spec.DHParameterSpec"/>
        <import package="sun.security.provider.ParameterCache"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <import package="sun.security.rsa.RSAKeyFactory"/>
        <class name="P11KeyPairGenerator" line="11">
            <extends class="KeyPairGeneratorSpi"/>
            <javadoc line="11">
                KeyPairGenerator implementation class. This class currently supports
                  RSA, DSA, DH, and EC.
                  Note that for DSA and DH we rely on the Sun and SunJCE providers to
                  obtain the parameters from.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="20"/>
            <declaration name="algorithm" type="String" line="21"/>
            <declaration name="mechanism" type="long" line="22"/>
            <declaration name="keySize" type="int" line="23"/>
            <declaration name="params" type="AlgorithmParameterSpec" line="24"/>
            <declaration name="rsaPublicExponent" type="BigInteger" line="25"/>
            <declaration name="random" type="SecureRandom" line="26"/>
            <method name="P11KeyPairGenerator" type="constructor" line="27">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
                <scope line="32"/>
                <scope line="35"/>
            </method>
            <method name="initialize" type="void" line="39">
                <params>
                    <param name="keySize" type="int"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="41"/>
                <scope line="44"/>
                <scope line="50">
                    <scope line="52"/>
                </scope>
            </method>
            <method name="initialize" type="void" line="57">
                <params>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="59">
                    <scope line="60"/>
                    <declaration name="dhParams" type="DHParameterSpec" line="63"/>
                    <declaration name="tmpKeySize" type="int" line="64"/>
                </scope>
                <scope line="69">
                    <scope line="70"/>
                    <declaration name="rsaParams" type="RSAKeyGenParameterSpec" line="73"/>
                    <declaration name="tmpKeySize" type="int" line="74"/>
                </scope>
                <scope line="80">
                    <scope line="81"/>
                    <declaration name="dsaParams" type="DSAParameterSpec" line="84"/>
                    <declaration name="tmpKeySize" type="int" line="85"/>
                </scope>
                <scope line="90">
                    <declaration name="ecParams" type="ECParameterSpec" line="91"/>
                    <scope line="92">
                        <scope line="94"/>
                    </scope>
                    <scope line="98">
                        <declaration name="name" type="String" line="99"/>
                        <scope line="101"/>
                    </scope>
                    <scope line="105"/>
                    <declaration name="tmpKeySize" type="int" line="108"/>
                </scope>
                <scope line="113"/>
            </method>
            <method name="checkKeySize" type="void" line="118">
                <params>
                    <param name="keySize" type="int"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                </params>
                <scope line="119">
                    <scope line="120"/>
                    <scope line="123"/>
                </scope>
                <scope line="128">
                    <declaration name="tmpExponent" type="BigInteger" line="129"/>
                    <scope line="130"/>
                    <scope line="133"/>
                    <scope line="136"/>
                </scope>
                <scope line="141"/>
                <scope line="144">
                    <scope line="145"/>
                </scope>
                <scope line="149">
                    <scope line="150"/>
                </scope>
            </method>
            <method name="generateKeyPair" type="KeyPair" line="155">
                <declaration name="publicKeyTemplate" type="CK_ATTRIBUTE[]" line="157"/>
                <declaration name="privateKeyTemplate" type="CK_ATTRIBUTE[]" line="158"/>
                <declaration name="keyType" type="long" line="159"/>
                <scope line="160"/>
                <scope line="165">
                    <declaration name="dsaParams" type="DSAParameterSpec" line="167"/>
                    <scope line="168">
                        <scope line="169"/>
                        <scope line="172"/>
                    </scope>
                    <scope line="176"/>
                </scope>
                <scope line="182">
                    <declaration name="dhParams" type="DHParameterSpec" line="184"/>
                    <declaration name="privateBits" type="int" line="185"/>
                    <scope line="186">
                        <scope line="187"/>
                        <scope line="190"/>
                    </scope>
                    <scope line="195"/>
                    <scope line="199"/>
                </scope>
                <scope line="205">
                    <declaration name="encodedParams" type="byte[]" line="207"/>
                </scope>
                <scope line="211"/>
                <declaration name="session" type="Session" line="214"/>
                <scope line="215">
                    <declaration name="keyIDs" type="long[]" line="219"/>
                    <declaration name="publicKey" type="PublicKey" line="220"/>
                    <declaration name="privateKey" type="PrivateKey" line="221"/>
                </scope>
                <scope line="224"/>
                <scope line="227"/>
            </method>
        </class>
    </source>