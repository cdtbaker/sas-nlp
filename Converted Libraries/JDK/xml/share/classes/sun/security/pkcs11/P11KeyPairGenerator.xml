<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.pkcs11">
        <import package="java.math.BigInteger"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto.spec.DHParameterSpec"/>
        <import package="sun.security.provider.ParameterCache"/>
        <import package="sun.security.pkcs11.TemplateManager"/>
        <import package="sun.security.pkcs11.wrapper"/>
        <import package="sun.security.pkcs11.wrapper.PKCS11Constants"/>
        <import package="sun.security.rsa.RSAKeyFactory"/>
        <class name="P11KeyPairGenerator" line="43">
            <extends class="KeyPairGeneratorSpi"/>
            <comment line="56">
                token instance                
            </comment>
            <comment line="59">
                algorithm name                
            </comment>
            <comment line="62">
                mechanism id                
            </comment>
            <comment line="65">
                selected or default key size, always valid                
            </comment>
            <comment line="68">
                parameters specified via init, if any                
            </comment>
            <comment line="71">
                for RSA, selected or default value of public exponent, always valid                
            </comment>
            <comment line="74">
                SecureRandom instance, if specified in init                
            </comment>
            <comment line="90">
                see JCA spec                
            </comment>
            <comment line="111">
                see JCA spec                
            </comment>
            <comment line="230">
                see JCA spec                
            </comment>
            <javadoc line="43">
                KeyPairGenerator implementation class. This class currently supports
                  RSA, DSA, DH, and EC.
                  Note that for DSA and DH we rely on the Sun and SunJCE providers to
                  obtain the parameters from.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="token" type="Token" line="56"/>
            <declaration name="algorithm" type="String" line="59"/>
            <declaration name="mechanism" type="long" line="62"/>
            <declaration name="keySize" type="int" line="65"/>
            <declaration name="params" type="AlgorithmParameterSpec" line="68"/>
            <declaration name="rsaPublicExponent" type="BigInteger" line="71"/>
            <declaration name="random" type="SecureRandom" line="74"/>
            <method name="P11KeyPairGenerator" type="constructor" line="77">
                <params>
                    <param name="token" type="Token"/>
                    <param name="algorithm" type="String"/>
                    <param name="mechanism" type="long"/>
                </params>
                <scope line="82"/>
                <scope line="84"/>
            </method>
            <method name="initialize" type="void" line="90">
                <params>
                    <param name="keySize" type="int"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="92"/>
                <scope line="94"/>
                <scope line="100">
                    <scope line="102"/>
                </scope>
            </method>
            <method name="initialize" type="void" line="112">
                <params>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <comment line="124">
                    XXX sanity check params                    
                </comment>
                <comment line="136">
                    XXX sanity check params                    
                </comment>
                <comment line="147">
                    XXX sanity check params                    
                </comment>
                <scope line="114">
                    <scope line="115"/>
                    <declaration name="dhParams" type="DHParameterSpec" line="119"/>
                    <declaration name="tmpKeySize" type="int" line="120"/>
                </scope>
                <scope line="125">
                    <scope line="126"/>
                    <declaration name="rsaParams" type="RSAKeyGenParameterSpec" line="130"/>
                    <declaration name="tmpKeySize" type="int" line="131"/>
                </scope>
                <scope line="137">
                    <scope line="138"/>
                    <declaration name="dsaParams" type="DSAParameterSpec" line="142"/>
                    <declaration name="tmpKeySize" type="int" line="143"/>
                </scope>
                <scope line="148">
                    <declaration name="ecParams" type="ECParameterSpec" line="149"/>
                    <scope line="150">
                        <scope line="153"/>
                    </scope>
                    <scope line="157">
                        <declaration name="name" type="String" line="158"/>
                        <scope line="160"/>
                    </scope>
                    <scope line="164"/>
                    <declaration name="tmpKeySize" type="int" line="168"/>
                </scope>
                <scope line="172"/>
            </method>
            <method name="checkKeySize" type="void" line="179">
                <params>
                    <param name="keySize" type="int"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                </params>
                <comment line="186">
                    sanity check, nobody really wants keys this large                    
                </comment>
                <comment line="194">
                    Already tested for instanceof RSAKeyGenParameterSpec above                    
                </comment>
                <comment line="199">
                    This provider supports 64K or less.                    
                </comment>
                <comment line="213">
                    sanity check, nobody really wants keys this large                    
                </comment>
                <comment line="219">
                    this restriction is in the spec for DSA                    
                </comment>
                <comment line="220">
                    since we currently use DSA parameters for DH as well,                    
                </comment>
                <comment line="221">
                    it also applies to DH if no parameters are specified                    
                </comment>
                <scope line="180">
                    <scope line="181"/>
                    <scope line="185"/>
                </scope>
                <scope line="191">
                    <declaration name="tmpExponent" type="BigInteger" line="192"/>
                    <scope line="193"/>
                    <scope line="198"/>
                    <scope line="202"/>
                </scope>
                <scope line="208"/>
                <scope line="212">
                    <scope line="214"/>
                </scope>
                <scope line="218">
                    <scope line="222"/>
                </scope>
            </method>
            <method name="generateKeyPair" type="KeyPair" line="230">
                <comment line="242">
                    empty                    
                </comment>
                <comment line="264">
                    empty                    
                </comment>
                <comment line="284">
                    XXX find better defaults                    
                </comment>
                <comment line="302">
                    empty                    
                </comment>
                <declaration name="publicKeyTemplate" type="CK_ATTRIBUTE[]" line="232"/>
                <declaration name="privateKeyTemplate" type="CK_ATTRIBUTE[]" line="233"/>
                <declaration name="keyType" type="long" line="234"/>
                <scope line="235"/>
                <scope line="244">
                    <declaration name="dsaParams" type="DSAParameterSpec" line="246"/>
                    <scope line="247">
                        <scope line="248"/>
                        <scope line="251"/>
                    </scope>
                    <scope line="255"/>
                </scope>
                <scope line="266">
                    <declaration name="dhParams" type="DHParameterSpec" line="268"/>
                    <declaration name="privateBits" type="int" line="269"/>
                    <scope line="270">
                        <scope line="271"/>
                        <scope line="274"/>
                    </scope>
                    <scope line="279"/>
                    <scope line="283"/>
                </scope>
                <scope line="294">
                    <declaration name="encodedParams" type="byte[]" line="296"/>
                </scope>
                <scope line="304"/>
                <declaration name="session" type="Session" line="307"/>
                <scope line="308">
                    <declaration name="keyIDs" type="long[]" line="314"/>
                    <declaration name="publicKey" type="PublicKey" line="317"/>
                    <declaration name="privateKey" type="PrivateKey" line="319"/>
                </scope>
                <scope line="322"/>
                <scope line="324"/>
            </method>
        </class>
    </source>