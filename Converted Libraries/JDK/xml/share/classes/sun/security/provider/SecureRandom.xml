<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.provider">
        <import package="java.io.IOException"/>
        <import package="java.security.MessageDigest"/>
        <import package="java.security.SecureRandomSpi"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <class name="SecureRandom" line="33">
            <extends class="SecureRandomSpi"/>
            <comment line="235">
                readObject is called to restore the state of the random object from
                 a stream.  We have to create a new instance of MessageDigest, because
                 it is not included in the stream (it is marked &quot;transient&quot;).
                
                 Note that the engineNextBytes() method invoked on the restored random
                 object will yield the exact same (random) bytes as the original.
                 If you do not want this behaviour, you should re-seed the restored
                 random object, using engineSetSeed().                
            </comment>
            <implements interface="java.io.Serializable"/>
            <javadoc line="33">
                &lt;p&gt;This class provides a crytpographically strong pseudo-random number
                  generator based on the SHA-1 hash algorithm.
                  &lt;p&gt;Note that if a seed is not provided, we attempt to provide sufficient
                  seed bytes to completely randomize the internal state of the generator
                  (20 bytes).  However, our seed generation algorithm has not been thoroughly
                  studied or widely deployed.
                  &lt;p&gt;Also note that when a random object is deserialized,
                  &lt;a href=&quot;#engineNextBytes(byte[])&quot;&gt;engineNextBytes&lt;/a&gt; invoked on the
                  restored random object will yield the exact same (random) bytes as the
                  original object.  If this behaviour is not desired, the restored random
                  object should be seeded, using
                  &lt;a href=&quot;#engineSetSeed(byte[])&quot;&gt;engineSetSeed&lt;/a&gt;.                
                <author>
                    Benjamin Renaud                    
                </author>
                <author>
                    Josh Bloch                    
                </author>
                <author>
                    Gadi Guy                    
                </author>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="57"/>
            <declaration name="seeder" type="SecureRandom" line="59"/>
            <javadoc line="59">
                This static object will be seeded by SeedGenerator, and used
                  to seed future instances of SecureRandom                
            </javadoc>
            <declaration name="DIGEST_SIZE" type="int" line="65"/>
            <declaration name="digest" type="MessageDigest" line="66"/>
            <declaration name="state" type="byte[]" line="67"/>
            <declaration name="remainder" type="byte[]" line="68"/>
            <declaration name="remCount" type="int" line="69"/>
            <javadoc line="71">
                This empty constructor automatically seeds the generator.  We attempt
                  to provide sufficient seed bytes to completely randomize the internal
                  state of the generator (20 bytes).  Note, however, that our seed
                  generation algorithm has not been thoroughly studied or widely deployed.
                  &lt;p&gt;The first time this constructor is called in a given Virtual Machine,
                  it may take several seconds of CPU time to seed the generator, depending
                  on the underlying hardware.  Successive calls run quickly because they
                  rely on the same (internal) pseudo-random number generator for their
                  seed bits.                
            </javadoc>
            <method name="SecureRandom" type="constructor" line="83"/>
            <javadoc line="87">
                This constructor is used to instatiate the private seeder object
                  with a given seed from the SeedGenerator.                
                <param>
                    seed the seed.                    
                </param>
            </javadoc>
            <method name="SecureRandom" type="constructor" line="93">
                <params>
                    <param name="seed" type="byte"/>
                </params>
            </method>
            <javadoc line="97">
                This call, used by the constructors, instantiates the SHA digest
                  and sets the seed, if given.                
            </javadoc>
            <method name="init" type="void" line="101">
                <params>
                    <param name="seed" type="byte[]"/>
                </params>
                <scope line="102"/>
                <scope line="104"/>
                <scope line="108"/>
            </method>
            <javadoc line="113">
                Returns the given number of seed bytes, computed using the seed
                  generation algorithm that this class uses to seed itself.  This
                  call may be used to seed other random number generators.  While
                  we attempt to return a &quot;truly random&quot; sequence of bytes, we do not
                  know exactly how random the bytes returned by this call are.  (See
                  the empty constructor &lt;a href = &quot;#SecureRandom&quot;&gt;SecureRandom&lt;/a&gt;
                  for a brief description of the underlying algorithm.)
                  The prudent user will err on the side of caution and get extra
                  seed bytes, although it should be noted that seed generation is
                  somewhat costly.                
                <param>
                    numBytes the number of seed bytes to generate.                    
                </param>
                <return>
                    the seed bytes.                    
                </return>
            </javadoc>
            <method name="engineGenerateSeed" type="byte[]" line="129">
                <params>
                    <param name="numBytes" type="int"/>
                </params>
                <declaration name="b" type="byte[]" line="130"/>
            </method>
            <javadoc line="135">
                Reseeds this random object. The given seed supplements, rather than
                  replaces, the existing seed. Thus, repeated calls are guaranteed
                  never to reduce randomness.                
                <param>
                    seed the seed.                    
                </param>
            </javadoc>
            <method name="engineSetSeed" type="void" line="142">
                <params>
                    <param name="seed" type="byte[]"/>
                </params>
                <scope line="143"/>
            </method>
            <method name="updateState" type="void" line="151">
                <params>
                    <param name="state" type="byte[]"/>
                    <param name="output" type="byte[]"/>
                </params>
                <comment line="157">
                    state(n + 1) = (state(n) + output(n) + 1) % 2^160;                    
                </comment>
                <comment line="159">
                    Add two bytes                    
                </comment>
                <comment line="161">
                    Result is lower 8 bits                    
                </comment>
                <comment line="163">
                    Store result. Check for state collision.                    
                </comment>
                <comment line="166">
                    High 8 bits are carry. Store for next iteration.                    
                </comment>
                <comment line="170">
                    Make sure at least one bit changes!                    
                </comment>
                <declaration name="last" type="int" line="152"/>
                <declaration name="v" type="int" line="153"/>
                <declaration name="t" type="byte" line="154"/>
                <declaration name="zf" type="boolean" line="155"/>
                <scope line="158"/>
            </method>
            <javadoc line="175">
                Generates a user-specified number of random bytes.                
                <param>
                    bytes the array to be filled in with random bytes.                    
                </param>
            </javadoc>
            <method name="engineNextBytes" type="void" line="180">
                <params>
                    <param name="result" type="byte[]"/>
                </params>
                <comment line="196">
                    Use remainder from last time                    
                </comment>
                <comment line="199">
                    How many bytes?                    
                </comment>
                <comment line="202">
                    Copy the bytes, zero the buffer                    
                </comment>
                <comment line="211">
                    If we need more bytes, make them.                    
                </comment>
                <comment line="213">
                    Step the state                    
                </comment>
                <comment line="218">
                    How many bytes?                    
                </comment>
                <comment line="221">
                    Copy the bytes, zero the buffer                    
                </comment>
                <comment line="229">
                    Store remainder for next time                    
                </comment>
                <declaration name="index" type="int" line="181"/>
                <declaration name="todo" type="int" line="182"/>
                <declaration name="output" type="byte[]" line="183"/>
                <scope line="185">
                    <scope line="186"/>
                    <declaration name="seed" type="byte[]" line="191"/>
                </scope>
                <declaration name="r" type="int" line="197"/>
                <scope line="198">
                    <scope line="203"/>
                </scope>
                <scope line="212">
                    <scope line="222"/>
                </scope>
            </method>
            <method name="readObject" type="void" line="245">
                <params>
                    <param name="s" type="java.io.ObjectInputStream"/>
                </params>
                <scope line="249"/>
                <scope line="251"/>
            </method>
        </class>
    </source>