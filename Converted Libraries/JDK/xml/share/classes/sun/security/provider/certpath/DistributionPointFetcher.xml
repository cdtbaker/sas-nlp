<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.provider.certpath">
        <import package="java.io"/>
        <import package="java.net.URI"/>
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.cert"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.action.GetBooleanAction"/>
        <import package="sun.security.util.Debug"/>
        <import package="sun.security.util.DerOutputStream"/>
        <import package="sun.security.x509"/>
        <class name="DistributionPointFetcher" line="12">
            <javadoc line="12">
                Class to obtain CRLs via the CRLDistributionPoints extension.
                  Note that the functionality of this class must be explicitly enabled
                  via a system property, see the USE_CRLDP variable below.
                  This class uses the URICertStore class to fetch CRLs. The URICertStore
                  class also implements CRL caching: see the class description for more
                  information.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <author>
                    Sean Mullan                    
                </author>
                <since>
                    1.4.2                    
                </since>
            </javadoc>
            <declaration name="debug" type="Debug" line="24"/>
            <declaration name="ALL_REASONS" type="boolean[]" line="25"/>
            <declaration name="USE_CRLDP" type="boolean" line="26"/>
            <javadoc line="26">
                Flag indicating whether support for the CRL distribution point
                  extension shall be enabled. Currently disabled by default for
                  compatibility and legal reasons.                
            </javadoc>
            <declaration name="INSTANCE" type="DistributionPointFetcher" line="32"/>
            <javadoc line="33">
                Private instantiation only.                
            </javadoc>
            <method name="DistributionPointFetcher" type="constructor" line="36"/>
            <javadoc line="38">
                Return a DistributionPointFetcher instance.                
            </javadoc>
            <method name="getInstance" type="DistributionPointFetcher" line="41"/>
            <javadoc line="44">
                Return the X509CRLs matching this selector. The selector must be
                  an X509CRLSelector with certificateChecking set.
                  If CRLDP support is disabled, this method always returns an
                  empty set.                
            </javadoc>
            <method name="getCRLs" type="Collection<X509CRL>" line="50">
                <params>
                    <param name="selector" type="X509CRLSelector"/>
                    <param name="signFlag" type="boolean"/>
                    <param name="prevKey" type="PublicKey"/>
                    <param name="provider" type="String"/>
                    <param name="certStores" type="List<CertStore>"/>
                    <param name="reasonsMask" type="boolean[]"/>
                    <param name="trustAnchors" type="Set<TrustAnchor>"/>
                    <param name="validity" type="Date"/>
                </params>
                <scope line="51"/>
                <declaration name="cert" type="X509Certificate" line="54"/>
                <scope line="55"/>
                <scope line="58">
                    <declaration name="certImpl" type="X509CertImpl" line="59"/>
                    <scope line="60"/>
                    <declaration name="ext" type="CRLDistributionPointsExtension" line="63"/>
                    <scope line="64">
                        <scope line="65"/>
                    </scope>
                    <declaration name="points" type="List&lt;DistributionPoint&gt;" line="70"/>
                    <declaration name="results" type="Set&lt;X509CRL&gt;" line="71"/>
                    <scope line="72">
                        <declaration name="point" type="DistributionPoint" line="73"/>
                        <declaration name="crls" type="Collection&lt;X509CRL&gt;" line="74"/>
                    </scope>
                    <scope line="77"/>
                </scope>
                <scope line="82"/>
                <scope line="85"/>
            </method>
            <javadoc line="89">
                Download CRLs from the given distribution point, verify and return them.
                  See the top of the class for current limitations.                
            </javadoc>
            <method name="getCRLs" type="Collection<X509CRL>" line="93">
                <params>
                    <param name="selector" type="X509CRLSelector"/>
                    <param name="certImpl" type="X509CertImpl"/>
                    <param name="point" type="DistributionPoint"/>
                    <param name="reasonsMask" type="boolean[]"/>
                    <param name="signFlag" type="boolean"/>
                    <param name="prevKey" type="PublicKey"/>
                    <param name="provider" type="String"/>
                    <param name="certStores" type="List<CertStore>"/>
                    <param name="trustAnchors" type="Set<TrustAnchor>"/>
                    <param name="validity" type="Date"/>
                </params>
                <declaration name="fullName" type="GeneralNames" line="94"/>
                <scope line="95">
                    <declaration name="relativeName" type="RDN" line="96"/>
                    <scope line="97"/>
                    <scope line="100">
                        <declaration name="crlIssuers" type="GeneralNames" line="101"/>
                        <scope line="102"/>
                        <scope line="105">
                            <scope line="106"/>
                            <scope line="109"/>
                        </scope>
                    </scope>
                    <scope line="114"/>
                </scope>
                <declaration name="possibleCRLs" type="Collection&lt;X509CRL&gt;" line="118"/>
                <declaration name="crls" type="Collection&lt;X509CRL&gt;" line="119"/>
                <scope line="120">
                    <declaration name="name" type="GeneralName" line="121"/>
                    <scope line="122">
                        <declaration name="x500Name" type="X500Name" line="123"/>
                    </scope>
                    <scope line="126">
                        <declaration name="uriName" type="URIName" line="127"/>
                        <declaration name="crl" type="X509CRL" line="128"/>
                        <scope line="129"/>
                    </scope>
                </scope>
                <scope line="134">
                    <scope line="135">
                        <scope line="137"/>
                    </scope>
                    <scope line="141">
                        <scope line="142"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="150">
                Download CRL from given URI.                
            </javadoc>
            <method name="getCRL" type="X509CRL" line="153">
                <params>
                    <param name="name" type="URIName"/>
                </params>
                <declaration name="uri" type="URI" line="154"/>
                <scope line="155"/>
                <scope line="158">
                    <declaration name="ucs" type="CertStore" line="159"/>
                    <declaration name="crls" type="Collection&lt;? extends CRL&gt;" line="160"/>
                    <scope line="161"/>
                    <scope line="164"/>
                </scope>
                <scope line="168">
                    <scope line="169"/>
                </scope>
            </method>
            <javadoc line="176">
                Fetch CRLs from certStores.                
            </javadoc>
            <method name="getCRLs" type="Collection<X509CRL>" line="179">
                <params>
                    <param name="name" type="X500Name"/>
                    <param name="certIssuer" type="X500Principal"/>
                    <param name="certStores" type="List<CertStore>"/>
                </params>
                <scope line="180"/>
                <declaration name="xcs" type="X509CRLSelector" line="183"/>
                <declaration name="crls" type="Collection&lt;X509CRL&gt;" line="186"/>
                <scope line="187">
                    <scope line="188">
                        <scope line="189"/>
                    </scope>
                    <scope line="193">
                        <scope line="194"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="202">
                Verifies a CRL for the given certificate&apos;s Distribution Point to
                  ensure it is appropriate for checking the revocation status.                
                <param>
                    certImpl the certificate whose revocation status is being checked                    
                </param>
                <param>
                    point one of the distribution points of the certificate                    
                </param>
                <param>
                    crl the CRL                    
                </param>
                <param>
                    reasonsMask the interim reasons mask                    
                </param>
                <param>
                    signFlag true if prevKey can be used to verify the CRL                    
                </param>
                <param>
                    prevKey the public key that verifies the certificate's signature                    
                </param>
                <param>
                    provider the Signature provider to use                    
                </param>
                <param>
                    trustAnchors a {@code Set} of {@code TrustAnchor}s                    
                </param>
                <param>
                    certStores a {@code List} of {@code CertStore}s to be used in
                      finding certificates and CRLs                    
                </param>
                <param>
                    validity the time for which the validity of the CRL issuer's
                      certification path should be determined                    
                </param>
                <return>
                    true if ok, false if not                    
                </return>
            </javadoc>
            <method name="verifyCRL" type="boolean" line="219">
                <params>
                    <param name="certImpl" type="X509CertImpl"/>
                    <param name="point" type="DistributionPoint"/>
                    <param name="crl" type="X509CRL"/>
                    <param name="reasonsMask" type="boolean[]"/>
                    <param name="signFlag" type="boolean"/>
                    <param name="prevKey" type="PublicKey"/>
                    <param name="provider" type="String"/>
                    <param name="trustAnchors" type="Set<TrustAnchor>"/>
                    <param name="certStores" type="List<CertStore>"/>
                    <param name="validity" type="Date"/>
                </params>
                <declaration name="indirectCRL" type="boolean" line="220"/>
                <declaration name="crlImpl" type="X509CRLImpl" line="221"/>
                <declaration name="idpExt" type="IssuingDistributionPointExtension" line="222"/>
                <declaration name="certIssuer" type="X500Name" line="223"/>
                <declaration name="crlIssuer" type="X500Name" line="224"/>
                <declaration name="pointCrlIssuers" type="GeneralNames" line="225"/>
                <declaration name="pointCrlIssuer" type="X500Name" line="226"/>
                <scope line="227">
                    <scope line="228"/>
                    <declaration name="match" type="boolean" line="231"/>
                    <scope line="232">
                        <declaration name="name" type="GeneralNameInterface" line="233"/>
                        <scope line="234"/>
                    </scope>
                    <scope line="239"/>
                    <scope line="242"/>
                    <scope line="245"/>
                </scope>
                <scope line="249">
                    <scope line="250"/>
                </scope>
                <scope line="255">
                    <declaration name="certAKID" type="byte[]" line="256"/>
                    <declaration name="crlAKID" type="byte[]" line="257"/>
                    <scope line="258">
                        <scope line="259"/>
                    </scope>
                    <scope line="263">
                        <scope line="264"/>
                        <scope line="267"/>
                    </scope>
                </scope>
                <scope line="272"/>
                <scope line="275">
                    <declaration name="idpPoint" type="DistributionPointName" line="276"/>
                    <scope line="277">
                        <declaration name="idpNames" type="GeneralNames" line="278"/>
                        <scope line="279">
                            <declaration name="relativeName" type="RDN" line="280"/>
                            <scope line="281">
                                <scope line="282"/>
                            </scope>
                            <scope line="287"/>
                        </scope>
                        <scope line="292">
                            <declaration name="pointNames" type="GeneralNames" line="293"/>
                            <scope line="294">
                                <declaration name="relativeName" type="RDN" line="295"/>
                                <scope line="296">
                                    <scope line="297"/>
                                </scope>
                                <scope line="302"/>
                                <scope line="305">
                                    <scope line="306">
                                        <scope line="307"/>
                                    </scope>
                                </scope>
                                <scope line="314"/>
                            </scope>
                            <declaration name="match" type="boolean" line="318"/>
                            <scope line="319">
                                <declaration name="idpName" type="GeneralNameInterface" line="320"/>
                                <scope line="321"/>
                                <scope line="324">
                                    <declaration name="pointName" type="GeneralNameInterface" line="325"/>
                                    <scope line="326"/>
                                </scope>
                            </scope>
                            <scope line="332">
                                <scope line="333"/>
                            </scope>
                        </scope>
                        <scope line="339">
                            <declaration name="match" type="boolean" line="340"/>
                            <scope line="341">
                                <declaration name="crlIssuerName" type="GeneralNameInterface" line="342"/>
                                <scope line="343">
                                    <declaration name="idpName" type="GeneralNameInterface" line="344"/>
                                </scope>
                            </scope>
                            <scope line="348"/>
                        </scope>
                    </scope>
                    <declaration name="b" type="Boolean" line="353"/>
                    <scope line="354">
                        <scope line="355"/>
                    </scope>
                    <scope line="361">
                        <scope line="362"/>
                    </scope>
                    <scope line="368">
                        <scope line="369"/>
                    </scope>
                </scope>
                <declaration name="interimReasonsMask" type="boolean[]" line="375"/>
                <declaration name="reasons" type="ReasonFlags" line="376"/>
                <scope line="377"/>
                <declaration name="pointReasonFlags" type="boolean[]" line="380"/>
                <scope line="381">
                    <scope line="382">
                        <declaration name="idpReasonFlags" type="boolean[]" line="383"/>
                        <scope line="384">
                            <scope line="385"/>
                        </scope>
                    </scope>
                    <scope line="390"/>
                </scope>
                <scope line="394">
                    <scope line="395"/>
                    <scope line="398"/>
                </scope>
                <declaration name="oneOrMore" type="boolean" line="403"/>
                <scope line="404">
                    <scope line="405"/>
                </scope>
                <scope line="409"/>
                <scope line="412">
                    <declaration name="certSel" type="X509CertSelector" line="413"/>
                    <declaration name="crlSign" type="boolean[]" line="415"/>
                    <declaration name="akidext" type="AuthorityKeyIdentifierExtension" line="417"/>
                    <scope line="418">
                        <declaration name="akid" type="KeyIdentifier" line="419"/>
                        <scope line="420">
                            <declaration name="derout" type="DerOutputStream" line="421"/>
                        </scope>
                        <declaration name="asn" type="SerialNumber" line="425"/>
                        <scope line="426"/>
                    </scope>
                    <declaration name="newTrustAnchors" type="Set&lt;TrustAnchor&gt;" line="430"/>
                    <scope line="431">
                        <declaration name="principal" type="X500Principal" line="432"/>
                        <declaration name="temporary" type="TrustAnchor" line="433"/>
                    </scope>
                    <declaration name="params" type="PKIXBuilderParameters" line="436"/>
                    <scope line="437"/>
                    <scope line="440"/>
                    <scope line="446">
                        <declaration name="builder" type="CertPathBuilder" line="447"/>
                        <declaration name="result" type="PKIXCertPathBuilderResult" line="448"/>
                    </scope>
                    <scope line="451"/>
                </scope>
                <scope line="455"/>
                <scope line="458">
                    <scope line="459"/>
                </scope>
                <scope line="464"/>
                <scope line="467">
                    <scope line="468"/>
                </scope>
                <declaration name="unresCritExts" type="Set&lt;String&gt;" line="473"/>
                <scope line="474">
                    <scope line="476">
                        <scope line="477">
                            <declaration name="i" type="Iterator&lt;String&gt;" line="479"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="485">
                    <scope line="486"/>
                </scope>
            </method>
            <javadoc line="492">
                Append relative name to the issuer name and return a new
                  GeneralNames object.                
            </javadoc>
            <method name="getFullNames" type="GeneralNames" line="496">
                <params>
                    <param name="issuer" type="X500Name"/>
                    <param name="rdn" type="RDN"/>
                </params>
                <declaration name="rdns" type="List&lt;RDN&gt;" line="497"/>
                <declaration name="fullName" type="X500Name" line="499"/>
                <declaration name="fullNames" type="GeneralNames" line="500"/>
            </method>
            <javadoc line="504">
                Verifies whether a CRL is issued by a certain certificate                
                <param>
                    cert the certificate                    
                </param>
                <param>
                    crl the CRL to be verified                    
                </param>
                <param>
                    provider the name of the signature provider                    
                </param>
            </javadoc>
            <method name="issues" type="boolean" line="510">
                <params>
                    <param name="cert" type="X509CertImpl"/>
                    <param name="crl" type="X509CRLImpl"/>
                    <param name="provider" type="String"/>
                </params>
                <declaration name="matched" type="boolean" line="511"/>
                <declaration name="issuerSelector" type="AdaptableX509CertSelector" line="512"/>
                <declaration name="usages" type="boolean[]" line="513"/>
                <scope line="514"/>
                <declaration name="crlIssuer" type="X500Principal" line="518"/>
                <declaration name="crlAKID" type="AuthorityKeyIdentifierExtension" line="520"/>
                <scope line="521"/>
                <scope line="525">
                    <scope line="526"/>
                    <scope line="530"/>
                </scope>
            </method>
        </class>
    </source>