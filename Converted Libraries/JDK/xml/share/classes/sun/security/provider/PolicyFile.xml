<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.provider">
        <import package="java.io"/>
        <import package="java.lang.RuntimePermission"/>
        <import package="java.lang.reflect"/>
        <import package="java.lang.ref"/>
        <import package="java.net.MalformedURLException"/>
        <import package="java.net.URL"/>
        <import package="java.net.URI"/>
        <import package="java.util"/>
        <import package="java.util.Enumeration"/>
        <import package="java.util.Hashtable"/>
        <import package="java.util.List"/>
        <import package="java.util.StringTokenizer"/>
        <import package="java.util.PropertyPermission"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.ListIterator"/>
        <import package="java.util.WeakHashMap"/>
        <import package="java.text.MessageFormat"/>
        <import package="com.sun.security.auth.PrincipalComparator"/>
        <import package="java.security"/>
        <import package="java.security.cert.Certificate"/>
        <import package="java.security.cert.X509Certificate"/>
        <import package="javax.security.auth.PrivateCredentialPermission"/>
        <import package="javax.security.auth.Subject"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="java.io.FilePermission"/>
        <import package="java.net.SocketPermission"/>
        <import package="java.net.NetPermission"/>
        <import package="java.util.PropertyPermission"/>
        <import package="java.util.concurrent.atomic.AtomicReference"/>
        <import package="sun.misc.JavaSecurityProtectionDomainAccess"/>
        <import package="sun.misc.JavaSecurityProtectionDomainAccess.ProtectionDomainCache"/>
        <import package="sun.misc.SharedSecrets"/>
        <import package="sun.security.util.Password"/>
        <import package="sun.security.util.PolicyUtil"/>
        <import package="sun.security.util.PropertyExpander"/>
        <import package="sun.security.util.Debug"/>
        <import package="sun.security.util.ResourcesMgr"/>
        <import package="sun.security.util.SecurityConstants"/>
        <import package="sun.net.www.ParseUtil"/>
        <class name="PolicyFile" line="41">
            <extends class="java.security.Policy"/>
            <javadoc line="41">
                This class represents a default implementation for
                  &lt;code&gt;java.security.Policy&lt;/code&gt;.
                  Note:
                  For backward compatibility with JAAS 1.0 it loads
                  both java.auth.policy and java.policy. However it
                  is recommended that java.auth.policy be not used
                  and the java.policy contain all grant entries including
                  that contain principal-based entries.
                  &lt;p&gt; This object stores the policy for entire Java runtime,
                  and is the amalgamation of multiple static policy
                  configurations that resides in files.
                  The algorithm for locating the policy file(s) and reading their
                  information into this &lt;code&gt;Policy&lt;/code&gt; object is:
                  &lt;ol&gt;
                  &lt;li&gt;
                  Loop through the &lt;code&gt;java.security.Security&lt;/code&gt; properties,
                  &lt;i&gt;policy.url.1&lt;/i&gt;, &lt;i&gt;policy.url.2&lt;/i&gt;, ...,
                  &lt;i&gt;policy.url.X&lt;/i&gt;&quot; and
                  &lt;i&gt;auth.policy.url.1&lt;/i&gt;, &lt;i&gt;auth.policy.url.2&lt;/i&gt;, ...,
                  &lt;i&gt;auth.policy.url.X&lt;/i&gt;&quot;.  These properties are set
                  in the Java security properties file, which is located in the file named
                  &amp;lt;JAVA_HOME&amp;gt;/lib/security/java.security.
                  &amp;lt;JAVA_HOME&amp;gt; refers to the value of the java.home system property,
                  and specifies the directory where the JRE is installed.
                  Each property value specifies a &lt;code&gt;URL&lt;/code&gt; pointing to a
                  policy file to be loaded.  Read in and load each policy.
                  &lt;i&gt;auth.policy.url&lt;/i&gt; is supported only for backward compatibility.
                  &lt;li&gt;
                  The &lt;code&gt;java.lang.System&lt;/code&gt; property &lt;i&gt;java.security.policy&lt;/i&gt;
                  may also be set to a &lt;code&gt;URL&lt;/code&gt; pointing to another policy file
                  (which is the case when a user uses the -D switch at runtime).
                  If this property is defined, and its use is allowed by the
                  security property file (the Security property,
                  &lt;i&gt;policy.allowSystemProperty&lt;/i&gt; is set to &lt;i&gt;true&lt;/i&gt;),
                  also load that policy.
                  &lt;li&gt;
                  The &lt;code&gt;java.lang.System&lt;/code&gt; property
                  &lt;i&gt;java.security.auth.policy&lt;/i&gt; may also be set to a
                  &lt;code&gt;URL&lt;/code&gt; pointing to another policy file
                  (which is the case when a user uses the -D switch at runtime).
                  If this property is defined, and its use is allowed by the
                  security property file (the Security property,
                  &lt;i&gt;policy.allowSystemProperty&lt;/i&gt; is set to &lt;i&gt;true&lt;/i&gt;),
                  also load that policy.
                  &lt;i&gt;java.security.auth.policy&lt;/i&gt; is supported only for backward
                  compatibility.
                  If the  &lt;i&gt;java.security.policy&lt;/i&gt; or
                  &lt;i&gt;java.security.auth.policy&lt;/i&gt; property is defined using
                  &quot;==&quot; (rather than &quot;=&quot;), then ignore all other specified
                  policies and only load this policy.
                  &lt;/ol&gt;
                  Each policy file consists of one or more grant entries, each of
                  which consists of a number of permission entries.
                  &lt;pre&gt;
                  grant signedBy &quot;&lt;b&gt;alias&lt;/b&gt;&quot;, codeBase &quot;&lt;b&gt;URL&lt;/b&gt;&quot;,
                  principal &lt;b&gt;principalClass&lt;/b&gt; &quot;&lt;b&gt;principalName&lt;/b&gt;&quot;,
                  principal &lt;b&gt;principalClass&lt;/b&gt; &quot;&lt;b&gt;principalName&lt;/b&gt;&quot;,
                  ... {
                  permission &lt;b&gt;Type&lt;/b&gt; &quot;&lt;b&gt;name&lt;/b&gt; &quot;&lt;b&gt;action&lt;/b&gt;&quot;,
                  signedBy &quot;&lt;b&gt;alias&lt;/b&gt;&quot;;
                  permission &lt;b&gt;Type&lt;/b&gt; &quot;&lt;b&gt;name&lt;/b&gt; &quot;&lt;b&gt;action&lt;/b&gt;&quot;,
                  signedBy &quot;&lt;b&gt;alias&lt;/b&gt;&quot;;
                  ....
                  };
                  &lt;/pre&gt;
                  All non-bold items above must appear as is (although case
                  doesn&apos;t matter and some are optional, as noted below).
                  principal entries are optional and need not be present.
                  Italicized items represent variable values.
                  &lt;p&gt; A grant entry must begin with the word &lt;code&gt;grant&lt;/code&gt;.
                  The &lt;code&gt;signedBy&lt;/code&gt;,&lt;code&gt;codeBase&lt;/code&gt; and &lt;code&gt;principal&lt;/code&gt;
                  name/value pairs are optional.
                  If they are not present, then any signer (including unsigned code)
                  will match, and any codeBase will match.
                  Note that the &lt;i&gt;principalClass&lt;/i&gt;
                  may be set to the wildcard value, , which allows it to match
                  any &lt;code&gt;Principal&lt;/code&gt; class.  In addition, the &lt;i&gt;principalName&lt;/i&gt;
                  may also be set to the wildcard value, , allowing it to match
                  any &lt;code&gt;Principal&lt;/code&gt; name.  When setting the &lt;i&gt;principalName&lt;/i&gt;
                  to the , do not surround the  with quotes.
                  &lt;p&gt; A permission entry must begin with the word &lt;code&gt;permission&lt;/code&gt;.
                  The word &lt;code&gt;&lt;i&gt;Type&lt;/i&gt;&lt;/code&gt; in the template above is
                  a specific permission type, such as &lt;code&gt;java.io.FilePermission&lt;/code&gt;
                  or &lt;code&gt;java.lang.RuntimePermission&lt;/code&gt;.
                  &lt;p&gt; The &quot;&lt;i&gt;action&lt;/i&gt;&quot; is required for
                  many permission types, such as &lt;code&gt;java.io.FilePermission&lt;/code&gt;
                  (where it specifies what type of file access that is permitted).
                  It is not required for categories such as
                  &lt;code&gt;java.lang.RuntimePermission&lt;/code&gt;
                  where it is not necessary - you either have the
                  permission specified by the &lt;code&gt;&quot;&lt;i&gt;name&lt;/i&gt;&quot;&lt;/code&gt;
                  value following the type name or you don&apos;t.
                  &lt;p&gt; The &lt;code&gt;signedBy&lt;/code&gt; name/value pair for a permission entry
                  is optional. If present, it indicates a signed permission. That is,
                  the permission class itself must be signed by the given alias in
                  order for it to be granted. For example,
                  suppose you have the following grant entry:
                  &lt;pre&gt;
                  grant principal foo.com.Principal &quot;Duke&quot; {
                  permission Foo &quot;foobar&quot;, signedBy &quot;FooSoft&quot;;
                  }
                  &lt;/pre&gt;
                  &lt;p&gt; Then this permission of type &lt;i&gt;Foo&lt;/i&gt; is granted if the
                  &lt;code&gt;Foo.class&lt;/code&gt; permission has been signed by the
                  &quot;FooSoft&quot; alias, or if XXX &lt;code&gt;Foo.class&lt;/code&gt; is a
                  system class (i.e., is found on the CLASSPATH).
                  &lt;p&gt; Items that appear in an entry must appear in the specified order
                  (&lt;code&gt;permission&lt;/code&gt;, &lt;i&gt;Type&lt;/i&gt;, &quot;&lt;i&gt;name&lt;/i&gt;&quot;, and
                  &quot;&lt;i&gt;action&lt;/i&gt;&quot;). An entry is terminated with a semicolon.
                  &lt;p&gt; Case is unimportant for the identifiers (&lt;code&gt;permission&lt;/code&gt;,
                  &lt;code&gt;signedBy&lt;/code&gt;, &lt;code&gt;codeBase&lt;/code&gt;, etc.) but is
                  significant for the &lt;i&gt;Type&lt;/i&gt;
                  or for any string that is passed in as a value. &lt;p&gt;
                  &lt;p&gt; An example of two entries in a policy configuration file is
                  &lt;pre&gt;
                  // if the code is comes from &quot;foo.com&quot; and is running as &quot;Duke&quot;,
                  // grant it read/write to all files in /tmp.
                  grant codeBase &quot;foo.com&quot;, principal foo.com.Principal &quot;Duke&quot; {
                  permission java.io.FilePermission &quot;/tmp/&quot;, &quot;read,write&quot;;
                  };
                  // grant any code running as &quot;Duke&quot; permission to read
                  // the &quot;java.vendor&quot; Property.
                  grant principal foo.com.Principal &quot;Duke&quot; {
                  permission java.util.PropertyPermission &quot;java.vendor&quot;;
                  &lt;/pre&gt;
                  This Policy implementation supports special handling of any
                  permission that contains the string, &quot;&lt;b&gt;${{self}}&lt;/b&gt;&quot;, as part of
                  its target name.  When such a permission is evaluated
                  (such as during a security check), &lt;b&gt;${{self}}&lt;/b&gt; is replaced
                  with one or more Principal class/name pairs.  The exact
                  replacement performed depends upon the contents of the
                  grant clause to which the permission belongs.
                  &lt;p&gt;
                  If the grant clause does not contain any principal information,
                  the permission will be ignored (permissions containing
                  &lt;b&gt;${{self}}&lt;/b&gt; in their target names are only valid in the context
                  of a principal-based grant clause).  For example, BarPermission
                  will always be ignored in the following grant clause:
                  &lt;pre&gt;
                  grant codebase &quot;www.foo.com&quot;, signedby &quot;duke&quot; {
                  permission BarPermission &quot;... ${{self}} ...&quot;;
                  };
                  &lt;/pre&gt;
                  If the grant clause contains principal information, &lt;b&gt;${{self}}&lt;/b&gt;
                  will be replaced with that same principal information.
                  For example, &lt;b&gt;${{self}}&lt;/b&gt; in BarPermission will be replaced by
                  &lt;b&gt;javax.security.auth.x500.X500Principal &quot;cn=Duke&quot;&lt;/b&gt;
                  in the following grant clause:
                  &lt;pre&gt;
                  grant principal javax.security.auth.x500.X500Principal &quot;cn=Duke&quot; {
                  permission BarPermission &quot;... ${{self}} ...&quot;;
                  };
                  &lt;/pre&gt;
                  If there is a comma-separated list of principals in the grant
                  clause, then &lt;b&gt;${{self}}&lt;/b&gt; will be replaced by the same
                  comma-separated list or principals.
                  In the case where both the principal class and name are
                  wildcarded in the grant clause, &lt;b&gt;${{self}}&lt;/b&gt; is replaced
                  with all the principals associated with the &lt;code&gt;Subject&lt;/code&gt;
                  in the current &lt;code&gt;AccessControlContext&lt;/code&gt;.
                  &lt;p&gt; For PrivateCredentialPermissions, you can also use &quot;&lt;b&gt;self&lt;/b&gt;&quot;
                  instead of &quot;&lt;b&gt;${{self}}&lt;/b&gt;&quot;. However the use of &quot;&lt;b&gt;self&lt;/b&gt;&quot; is
                  deprecated in favour of &quot;&lt;b&gt;${{self}}&lt;/b&gt;&quot;.                
                <see>
                    java.security.CodeSource                    
                </see>
                <see>
                    java.security.Permissions                    
                </see>
                <see>
                    java.security.ProtectionDomain                    
                </see>
            </javadoc>
            <declaration name="debug" type="Debug" line="210"/>
            <declaration name="NONE" type="String" line="211"/>
            <declaration name="P11KEYSTORE" type="String" line="212"/>
            <declaration name="SELF" type="String" line="213"/>
            <declaration name="X500PRINCIPAL" type="String" line="214"/>
            <declaration name="POLICY" type="String" line="215"/>
            <declaration name="SECURITY_MANAGER" type="String" line="216"/>
            <declaration name="POLICY_URL" type="String" line="217"/>
            <declaration name="AUTH_POLICY" type="String" line="218"/>
            <declaration name="AUTH_POLICY_URL" type="String" line="219"/>
            <declaration name="DEFAULT_CACHE_SIZE" type="int" line="220"/>
            <declaration name="policyInfo" type="AtomicReference&lt;PolicyInfo&gt;" line="221"/>
            <declaration name="constructed" type="boolean" line="222"/>
            <declaration name="expandProperties" type="boolean" line="223"/>
            <declaration name="ignoreIdentityScope" type="boolean" line="224"/>
            <declaration name="allowSystemProperties" type="boolean" line="225"/>
            <declaration name="notUtf8" type="boolean" line="226"/>
            <declaration name="url" type="URL" line="227"/>
            <declaration name="PARAMS0" type="Class[]" line="228"/>
            <declaration name="PARAMS1" type="Class[]" line="229"/>
            <declaration name="PARAMS2" type="Class[]" line="230"/>
            <javadoc line="231">
                Initializes the Policy object and reads the default policy
                  configuration file(s) into the Policy object.                
            </javadoc>
            <method name="PolicyFile" type="constructor" line="235"/>
            <javadoc line="238">
                Initializes the Policy object and reads the default policy
                  from the specified URL only.                
            </javadoc>
            <method name="PolicyFile" type="constructor" line="242">
                <params>
                    <param name="url" type="URL"/>
                </params>
            </method>
            <javadoc line="246">
                Initializes the Policy object and reads the default policy
                  configuration file(s) into the Policy object.
                  The algorithm for locating the policy file(s) and reading their
                  information into the Policy object is:
                  &lt;pre&gt;
                  loop through the Security Properties named &quot;policy.url.1&quot;,
                  &quot;&quot;policy.url.2&quot;, &quot;auth.policy.url.1&quot;,  &quot;auth.policy.url.2&quot; etc, until
                  you don&apos;t find one. Each of these specify a policy file.
                  if none of these could be loaded, use a builtin static policy
                  equivalent to the default lib/security/java.policy file.
                  if the system property &quot;java.policy&quot; or &quot;java.auth.policy&quot; is defined
                  (which is the
                  case when the user uses the -D switch at runtime), and
                  its use is allowed by the security property file,
                  also load it.
                  &lt;/pre&gt;
                  Each policy file consists of one or more grant entries, each of
                  which consists of a number of permission entries.
                  &lt;pre&gt;
                  grant signedBy &quot;&lt;i&gt;alias&lt;/i&gt;&quot;, codeBase &quot;&lt;i&gt;URL&lt;/i&gt;&quot; {
                  permission &lt;i&gt;Type&lt;/i&gt; &quot;&lt;i&gt;name&lt;/i&gt;&quot;, &quot;&lt;i&gt;action&lt;/i&gt;&quot;,
                  signedBy &quot;&lt;i&gt;alias&lt;/i&gt;&quot;;
                  ....
                  permission &lt;i&gt;Type&lt;/i&gt; &quot;&lt;i&gt;name&lt;/i&gt;&quot;, &quot;&lt;i&gt;action&lt;/i&gt;&quot;,
                  signedBy &quot;&lt;i&gt;alias&lt;/i&gt;&quot;;
                  };
                  &lt;/pre&gt;
                  All non-italicized items above must appear as is (although case
                  doesn&apos;t matter and some are optional, as noted below).
                  Italicized items represent variable values.
                  &lt;p&gt; A grant entry must begin with the word &lt;code&gt;grant&lt;/code&gt;.
                  The &lt;code&gt;signedBy&lt;/code&gt; and &lt;code&gt;codeBase&lt;/code&gt; name/value
                  pairs are optional.
                  If they are not present, then any signer (including unsigned code)
                  will match, and any codeBase will match.
                  &lt;p&gt; A permission entry must begin with the word &lt;code&gt;permission&lt;/code&gt;.
                  The word &lt;code&gt;&lt;i&gt;Type&lt;/i&gt;&lt;/code&gt; in the template above would actually
                  be a specific permission type, such as
                  &lt;code&gt;java.io.FilePermission&lt;/code&gt; or
                  &lt;code&gt;java.lang.RuntimePermission&lt;/code&gt;.
                  &lt;p&gt;The &quot;&lt;i&gt;action&lt;/i&gt;&quot; is required for
                  many permission types, such as &lt;code&gt;java.io.FilePermission&lt;/code&gt;
                  (where it specifies what type of file access is permitted).
                  It is not required for categories such as
                  &lt;code&gt;java.lang.RuntimePermission&lt;/code&gt;
                  where it is not necessary - you either have the
                  permission specified by the &lt;code&gt;&quot;&lt;i&gt;name&lt;/i&gt;&quot;&lt;/code&gt;
                  value following the type name or you don&apos;t.
                  &lt;p&gt;The &lt;code&gt;signedBy&lt;/code&gt; name/value pair for a permission entry
                  is optional. If present, it indicates a signed permission. That is,
                  the permission class itself must be signed by the given alias in
                  order for it to be granted. For example,
                  suppose you have the following grant entry:
                  &lt;pre&gt;
                  grant {
                  permission Foo &quot;foobar&quot;, signedBy &quot;FooSoft&quot;;
                  }
                  &lt;/pre&gt;
                  &lt;p&gt;Then this permission of type &lt;i&gt;Foo&lt;/i&gt; is granted if the
                  &lt;code&gt;Foo.class&lt;/code&gt; permission has been signed by the
                  &quot;FooSoft&quot; alias, or if &lt;code&gt;Foo.class&lt;/code&gt; is a
                  system class (i.e., is found on the CLASSPATH).
                  &lt;p&gt;Items that appear in an entry must appear in the specified order
                  (&lt;code&gt;permission&lt;/code&gt;, &lt;i&gt;Type&lt;/i&gt;, &quot;&lt;i&gt;name&lt;/i&gt;&quot;, and
                  &quot;&lt;i&gt;action&lt;/i&gt;&quot;). An entry is terminated with a semicolon.
                  &lt;p&gt;Case is unimportant for the identifiers (&lt;code&gt;permission&lt;/code&gt;,
                  &lt;code&gt;signedBy&lt;/code&gt;, &lt;code&gt;codeBase&lt;/code&gt;, etc.) but is
                  significant for the &lt;i&gt;Type&lt;/i&gt;
                  or for any string that is passed in as a value. &lt;p&gt;
                  &lt;p&gt;An example of two entries in a policy configuration file is
                  &lt;pre&gt;
                  //  if the code is signed by &quot;Duke&quot;, grant it read/write to all
                  // files in /tmp.
                  grant signedBy &quot;Duke&quot; {
                  permission java.io.FilePermission &quot;/tmp/&quot;, &quot;read,write&quot;;
                  };
                  &lt;p&gt;
                  // grant everyone the following permission
                  grant {
                  permission java.util.PropertyPermission &quot;java.vendor&quot;;
                  };
                  &lt;/pre&gt;                
            </javadoc>
            <method name="init" type="void" line="330">
                <params>
                    <param name="url" type="URL"/>
                </params>
                <anonymous_class line="331">
                    <method name="run" type="String" line="332"/>
                </anonymous_class>
                <declaration name="numCacheStr" type="String" line="331"/>
                <declaration name="numCaches" type="int" line="341"/>
                <scope line="342">
                    <scope line="343"/>
                    <scope line="346"/>
                </scope>
                <scope line="350"/>
                <declaration name="newInfo" type="PolicyInfo" line="353"/>
            </method>
            <method name="initPolicyFile" type="void" line="357">
                <params>
                    <param name="newInfo" type="PolicyInfo"/>
                    <param name="url" type="URL"/>
                </params>
                <scope line="358">
                    <scope line="359"/>
                    <anonymous_class line="362">
                        <method name="run" type="Void" line="363">
                            <scope line="364"/>
                        </method>
                    </anonymous_class>
                </scope>
                <scope line="372">
                    <declaration name="loaded_one" type="boolean" line="373"/>
                    <scope line="374"/>
                </scope>
            </method>
            <method name="initPolicyFile" type="boolean" line="380">
                <params>
                    <param name="propname" type="String"/>
                    <param name="urlname" type="String"/>
                    <param name="newInfo" type="PolicyInfo"/>
                </params>
                <anonymous_class line="381">
                    <method name="run" type="Boolean" line="382">
                        <declaration name="loaded_policy" type="boolean" line="383"/>
                        <scope line="384">
                            <declaration name="extra_policy" type="String" line="385"/>
                            <scope line="386">
                                <declaration name="overrideAll" type="boolean" line="387"/>
                                <scope line="388"/>
                                <scope line="392">
                                    <declaration name="policyURL" type="URL" line="394"/>
                                    <declaration name="policyFile" type="File" line="395"/>
                                    <scope line="396"/>
                                    <scope line="399"/>
                                </scope>
                                <scope line="405">
                                    <scope line="406"/>
                                </scope>
                                <scope line="410">
                                    <scope line="411"/>
                                </scope>
                            </scope>
                        </scope>
                        <declaration name="n" type="int" line="418"/>
                        <declaration name="policy_uri" type="String" line="419"/>
                        <scope line="420">
                            <scope line="421">
                                <declaration name="policy_url" type="URL" line="422"/>
                                <declaration name="expanded_uri" type="String" line="423"/>
                                <scope line="424"/>
                                <scope line="427"/>
                            </scope>
                            <scope line="433">
                                <scope line="434"/>
                            </scope>
                        </scope>
                    </method>
                </anonymous_class>
                <declaration name="loadedPolicy" type="Boolean" line="381"/>
            </method>
            <javadoc line="447">
                Reads a policy configuration into the Policy object using a
                  Reader object.                
                <param>
                    policyFile the policy Reader object.                    
                </param>
            </javadoc>
            <method name="init" type="boolean" line="452">
                <params>
                    <param name="policy" type="URL"/>
                    <param name="newInfo" type="PolicyInfo"/>
                </params>
                <declaration name="success" type="boolean" line="453"/>
                <declaration name="pp" type="PolicyParser" line="454"/>
                <declaration name="isr" type="InputStreamReader" line="455"/>
                <scope line="456">
                    <scope line="457"/>
                    <scope line="460"/>
                    <declaration name="keyStore" type="KeyStore" line="464"/>
                    <scope line="465"/>
                    <scope line="468">
                        <scope line="469"/>
                    </scope>
                    <declaration name="enum_" type="Enumeration&lt;PolicyParser.GrantEntry&gt;" line="473"/>
                    <scope line="474">
                        <declaration name="ge" type="PolicyParser.GrantEntry" line="475"/>
                    </scope>
                </scope>
                <scope line="479">
                    <declaration name="form" type="MessageFormat" line="480"/>
                    <declaration name="source" type="Object[]" line="481"/>
                </scope>
                <scope line="485">
                    <scope line="486"/>
                </scope>
                <scope line="492">
                    <scope line="493">
                        <scope line="494"/>
                        <scope line="498"/>
                    </scope>
                    <scope line="501"/>
                </scope>
            </method>
            <method name="initStaticPolicy" type="void" line="507">
                <params>
                    <param name="newInfo" type="PolicyInfo"/>
                </params>
                <anonymous_class line="508">
                    <method name="run" type="Void" line="509">
                        <declaration name="pe" type="PolicyEntry" line="510"/>
                        <declaration name="extCodebases" type="String[]" line="532"/>
                        <scope line="533">
                            <scope line="534">
                                <scope line="535"/>
                                <scope line="540"/>
                            </scope>
                        </scope>
                    </method>
                </anonymous_class>
            </method>
            <javadoc line="549">
                Given a GrantEntry, create a codeSource.                
                <return>
                    null if signedBy alias is not recognized                    
                </return>
            </javadoc>
            <method name="getCodeSource" type="CodeSource" line="553">
                <params>
                    <param name="ge" type="PolicyParser.GrantEntry"/>
                    <param name="keyStore" type="KeyStore"/>
                    <param name="newInfo" type="PolicyInfo"/>
                </params>
                <declaration name="certs" type="Certificate[]" line="554"/>
                <scope line="555">
                    <scope line="557">
                        <scope line="558"/>
                    </scope>
                </scope>
                <declaration name="location" type="URL" line="564"/>
            </method>
            <javadoc line="569">
                Add one policy entry to the list.                
            </javadoc>
            <method name="addGrantEntry" type="void" line="572">
                <params>
                    <param name="ge" type="PolicyParser.GrantEntry"/>
                    <param name="keyStore" type="KeyStore"/>
                    <param name="newInfo" type="PolicyInfo"/>
                </params>
                <scope line="573">
                    <scope line="577">
                        <declaration name="li" type="ListIterator&lt;PolicyParser.PrincipalEntry&gt;" line="578"/>
                        <scope line="579">
                            <declaration name="pppe" type="PolicyParser.PrincipalEntry" line="580"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="585">
                    <declaration name="codesource" type="CodeSource" line="586"/>
                    <declaration name="entry" type="PolicyEntry" line="589"/>
                    <declaration name="enum_" type="Enumeration&lt;PolicyParser.PermissionEntry&gt;" line="590"/>
                    <scope line="591">
                        <declaration name="pe" type="PolicyParser.PermissionEntry" line="592"/>
                        <scope line="593">
                            <declaration name="perm" type="Permission" line="595"/>
                            <scope line="596"/>
                            <scope line="599">
                                <declaration name="certs" type="Certificate" line="600"/>
                                <scope line="601"/>
                                <scope line="604"/>
                            </scope>
                            <scope line="609"/>
                            <scope line="613"/>
                        </scope>
                        <scope line="617">
                            <declaration name="certs" type="Certificate" line="618"/>
                            <scope line="619"/>
                            <scope line="622"/>
                            <scope line="625">
                                <declaration name="perm" type="Permission" line="626"/>
                                <scope line="628"/>
                            </scope>
                        </scope>
                        <scope line="633">
                            <declaration name="form" type="MessageFormat" line="634"/>
                            <declaration name="source" type="Object[]" line="635"/>
                        </scope>
                        <scope line="638">
                            <declaration name="form" type="MessageFormat" line="639"/>
                            <declaration name="source" type="Object[]" line="640"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="646">
                    <declaration name="form" type="MessageFormat" line="647"/>
                    <declaration name="source" type="Object[]" line="648"/>
                </scope>
            </method>
            <javadoc line="653">
                Returns a new Permission object of the given Type. The Permission is
                  created by getting the
                  Class object using the &lt;code&gt;Class.forName&lt;/code&gt; method, and using
                  the reflection API to invoke the (String name, String actions)
                  constructor on the
                  object.                
                <param>
                    type the type of Permission being created.                    
                </param>
                <param>
                    name the name of the Permission being created.                    
                </param>
                <param>
                    actions the actions of the Permission being created.                    
                </param>
                <exception>
                    ClassNotFoundException  if the particular Permission
                      class could not be found.                    
                </exception>
                <exception>
                    IllegalAccessException  if the class or initializer is
                      not accessible.                    
                </exception>
                <exception>
                    InstantiationException  if getInstance tries to
                      instantiate an abstract class or an interface, or if the
                      instantiation fails for some other reason.                    
                </exception>
                <exception>
                    NoSuchMethodException if the (String, String) constructor
                      is not found.                    
                </exception>
                <exception>
                    InvocationTargetException if the underlying Permission
                      constructor throws an exception.                    
                </exception>
            </javadoc>
            <method name="getInstance" type="Permission" line="675">
                <params>
                    <param name="type" type="String"/>
                    <param name="name" type="String"/>
                    <param name="actions" type="String"/>
                </params>
                <declaration name="pc" type="Class&lt;?&gt;" line="676"/>
                <declaration name="answer" type="Permission" line="677"/>
                <scope line="678"/>
                <scope line="681">
                    <scope line="682">
                        <declaration name="c" type="Constructor&lt;?&gt;" line="683"/>
                    </scope>
                    <scope line="686">
                        <scope line="687">
                            <declaration name="c" type="Constructor&lt;?&gt;" line="688"/>
                        </scope>
                        <scope line="691">
                            <declaration name="c" type="Constructor&lt;?&gt;" line="692"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="697">
                    <scope line="698">
                        <scope line="699">
                            <declaration name="c" type="Constructor&lt;?&gt;" line="700"/>
                        </scope>
                        <scope line="703">
                            <declaration name="c" type="Constructor&lt;?&gt;" line="704"/>
                        </scope>
                    </scope>
                    <scope line="708">
                        <declaration name="c" type="Constructor&lt;?&gt;" line="709"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="714">
                Creates one of the well-known permissions directly instead of
                  via reflection. Keep list short to not penalize non-JDK-defined
                  permissions.                
            </javadoc>
            <method name="getKnownInstance" type="Permission" line="719">
                <params>
                    <param name="claz" type="Class"/>
                    <param name="name" type="String"/>
                    <param name="actions" type="String"/>
                </params>
                <scope line="720"/>
                <scope line="723"/>
                <scope line="726"/>
                <scope line="729"/>
                <scope line="732"/>
                <scope line="735"/>
                <scope line="738"/>
            </method>
            <javadoc line="742">
                Fetch all certs associated with this alias.                
            </javadoc>
            <method name="getCertificates" type="Certificate[]" line="745">
                <params>
                    <param name="keyStore" type="KeyStore"/>
                    <param name="aliases" type="String"/>
                    <param name="newInfo" type="PolicyInfo"/>
                </params>
                <declaration name="vcerts" type="List&lt;Certificate&gt;" line="746"/>
                <declaration name="st" type="StringTokenizer" line="747"/>
                <declaration name="n" type="int" line="748"/>
                <scope line="749">
                    <declaration name="alias" type="String" line="750"/>
                    <declaration name="cert" type="Certificate" line="752"/>
                    <scope line="753">
                        <scope line="755">
                            <scope line="756"/>
                            <scope line="759"/>
                            <scope line="761"/>
                        </scope>
                    </scope>
                    <scope line="767"/>
                </scope>
                <scope line="772">
                    <declaration name="certs" type="Certificate[]" line="773"/>
                </scope>
                <scope line="777"/>
            </method>
            <javadoc line="781">
                Refreshes the policy object by re-reading all the policy files.                
            </javadoc>
            <method name="refresh" type="void" line="784"/>
            <javadoc line="787">
                Evaluates the the global policy for the permissions granted to
                  the ProtectionDomain and tests whether the permission is
                  granted.                
                <param>
                    domain the ProtectionDomain to test                    
                </param>
                <param>
                    permission the Permission object to be tested for implication.                    
                </param>
                <return>
                    true if "permission" is a proper subset of a permission
                      granted to this ProtectionDomain.                    
                </return>
                <see>
                    java.security.ProtectionDomain                    
                </see>
            </javadoc>
            <method name="implies" type="boolean" line="797">
                <params>
                    <param name="pd" type="ProtectionDomain"/>
                    <param name="p" type="Permission"/>
                </params>
                <declaration name="pi" type="PolicyInfo" line="798"/>
                <declaration name="pdMap" type="ProtectionDomainCache" line="799"/>
                <declaration name="pc" type="PermissionCollection" line="800"/>
                <scope line="801"/>
                <scope line="805"/>
            </method>
            <javadoc line="811">
                Examines this &lt;code&gt;Policy&lt;/code&gt; and returns the permissions granted
                  to the specified &lt;code&gt;ProtectionDomain&lt;/code&gt;.  This includes
                  the permissions currently associated with the domain as well
                  as the policy permissions granted to the domain&apos;s
                  CodeSource, ClassLoader, and Principals.
                  &lt;p&gt; Note that this &lt;code&gt;Policy&lt;/code&gt; implementation has
                  special handling for PrivateCredentialPermissions.
                  When this method encounters a &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;
                  which specifies &quot;self&quot; as the &lt;code&gt;Principal&lt;/code&gt; class and name,
                  it does not add that &lt;code&gt;Permission&lt;/code&gt; to the returned
                  &lt;code&gt;PermissionCollection&lt;/code&gt;.  Instead, it builds
                  a new &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;
                  for each &lt;code&gt;Principal&lt;/code&gt; associated with the provided
                  &lt;code&gt;Subject&lt;/code&gt;.  Each new &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;
                  contains the same Credential class as specified in the
                  originally granted permission, as well as the Class and name
                  for the respective &lt;code&gt;Principal&lt;/code&gt;.
                  &lt;p&gt;                
                <param>
                    domain the Permissions granted to this
                      <code>ProtectionDomain</code> are returned.                    
                </param>
                <return>
                    the Permissions granted to the provided
                      <code>ProtectionDomain</code>.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="PermissionCollection" line="835">
                <params>
                    <param name="domain" type="ProtectionDomain"/>
                </params>
                <declaration name="perms" type="Permissions" line="836"/>
                <declaration name="pc" type="PermissionCollection" line="839"/>
                <scope line="840">
                    <scope line="841">
                        <declaration name="e" type="Enumeration&lt;Permission&gt;" line="842"/>
                        <scope line="843"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="850">
                Examines this Policy and creates a PermissionCollection object with
                  the set of permissions for the specified CodeSource.                
                <param>
                    CodeSource the codesource associated with the caller.
                      This encapsulates the original location of the code (where the code
                      came from) and the public key(s) of its signer.                    
                </param>
                <return>
                    the set of permissions according to the policy.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="PermissionCollection" line="858">
                <params>
                    <param name="codesource" type="CodeSource"/>
                </params>
            </method>
            <javadoc line="861">
                Examines the global policy and returns the provided Permissions
                  object with additional permissions granted to the specified
                  ProtectionDomain.                
                <param>
                    perm the Permissions to populate                    
                </param>
                <param>
                    pd the ProtectionDomain associated with the caller.                    
                </param>
                <return>
                    the set of Permissions according to the policy.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="PermissionCollection" line="869">
                <params>
                    <param name="perms" type="Permissions"/>
                    <param name="pd" type="ProtectionDomain"/>
                </params>
                <scope line="870"/>
                <declaration name="cs" type="CodeSource" line="873"/>
                <anonymous_class line="875">
                    <method name="run" type="CodeSource" line="876"/>
                </anonymous_class>
                <declaration name="canonCodeSource" type="CodeSource" line="875"/>
            </method>
            <javadoc line="883">
                Examines the global policy and returns the provided Permissions
                  object with additional permissions granted to the specified
                  CodeSource.                
                <param>
                    permissions the permissions to populate                    
                </param>
                <param>
                    codesource the codesource associated with the caller.
                      This encapsulates the original location of the code (where the code
                      came from) and the public key(s) of its signer.                    
                </param>
                <return>
                    the set of permissions according to the policy.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="PermissionCollection" line="893">
                <params>
                    <param name="perms" type="Permissions"/>
                    <param name="cs" type="CodeSource"/>
                </params>
                <anonymous_class line="894">
                    <method name="run" type="CodeSource" line="895"/>
                </anonymous_class>
                <declaration name="canonCodeSource" type="CodeSource" line="894"/>
            </method>
            <method name="getPermissions" type="Permissions" line="902">
                <params>
                    <param name="perms" type="Permissions"/>
                    <param name="cs" type="CodeSource"/>
                    <param name="principals" type="Principal[]"/>
                </params>
                <declaration name="pi" type="PolicyInfo" line="903"/>
                <scope line="904"/>
                <scope line="907">
                    <scope line="908"/>
                </scope>
                <scope line="912">
                    <declaration name="certs" type="Certificate" line="913"/>
                    <scope line="914">
                        <scope line="915">
                            <declaration name="idMap" type="Object" line="916"/>
                            <scope line="917"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="addPermissions" type="void" line="925">
                <params>
                    <param name="perms" type="Permissions"/>
                    <param name="cs" type="CodeSource"/>
                    <param name="principals" type="Principal[]"/>
                    <param name="entry" type="PolicyEntry"/>
                </params>
                <scope line="926"/>
                <anonymous_class line="929">
                    <method name="run" type="Boolean" line="930"/>
                </anonymous_class>
                <declaration name="imp" type="Boolean" line="929"/>
                <scope line="935">
                    <scope line="936"/>
                </scope>
                <declaration name="entryPs" type="List&lt;PolicyParser.PrincipalEntry&gt;" line="941"/>
                <scope line="942">
                    <declaration name="accPs" type="ArrayList&lt;PolicyParser.PrincipalEntry&gt;" line="943"/>
                    <scope line="944">
                        <scope line="945"/>
                    </scope>
                </scope>
                <scope line="951">
                    <scope line="953"/>
                </scope>
                <scope line="958">
                    <scope line="959"/>
                </scope>
                <scope line="964">
                    <declaration name="pppe" type="PolicyParser.PrincipalEntry" line="965"/>
                    <scope line="966">
                        <declaration name="pClass" type="Class&lt;?&gt;" line="967"/>
                        <scope line="968">
                            <scope line="969">
                                <scope line="970"/>
                            </scope>
                        </scope>
                        <scope line="976">
                            <declaration name="c" type="Constructor&lt;?&gt;" line="977"/>
                            <declaration name="pc" type="PrincipalComparator" line="978"/>
                            <scope line="979"/>
                            <declaration name="pSet" type="Set&lt;Principal&gt;" line="982"/>
                            <scope line="983"/>
                            <declaration name="subject" type="Subject" line="986"/>
                            <scope line="987">
                                <scope line="988"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="995">
                        <scope line="996"/>
                        <scope line="999">
                            <scope line="1000"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="1007"/>
            </method>
            <method name="addPerms" type="void" line="1012">
                <params>
                    <param name="perms" type="Permissions"/>
                    <param name="accPs" type="Principal[]"/>
                    <param name="entry" type="PolicyEntry"/>
                </params>
                <scope line="1013">
                    <declaration name="p" type="Permission" line="1014"/>
                    <scope line="1015"/>
                    <scope line="1018"/>
                    <scope line="1021"/>
                </scope>
            </method>
            <javadoc line="1026">
                This method returns, true, if the principal in the policy entry,
                  pppe, is part of the current thread&apos;s principal array, pList.
                  This method also returns, true, if the policy entry&apos;s principal
                  is appropriately wildcarded.
                  Note that the provided &lt;i&gt;pppe&lt;/i&gt; argument may have
                  wildcards () for both the &lt;code&gt;Principal&lt;/code&gt; class and name.                
                <param>
                    pList an array of principals from the current thread's
                      AccessControlContext.                    
                </param>
                <param>
                    pppe a Principal specified in a policy grant entry.                    
                </param>
                <return>
                    true if the current thread's pList "contains" the
                      principal in the policy entry, pppe.  This method
                      also returns true if the policy entry's principal
                      appropriately wildcarded.                    
                </return>
            </javadoc>
            <method name="checkEntryPs" type="boolean" line="1041">
                <params>
                    <param name="pList" type="Principal[]"/>
                    <param name="pppe" type="PolicyParser.PrincipalEntry"/>
                </params>
                <scope line="1042">
                    <scope line="1043">
                        <scope line="1044"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="1051">
                &lt;p&gt;                
                <param>
                    sp the SelfPermission that needs to be expanded <p>                    
                </param>
                <param>
                    entryPs list of principals for the Policy entry.                    
                </param>
                <param>
                    pdp Principal array from the current ProtectionDomain.                    
                </param>
                <param>
                    perms the PermissionCollection where the individual
                      Permissions will be added after expansion.                    
                </param>
            </javadoc>
            <method name="expandSelf" type="void" line="1059">
                <params>
                    <param name="sp" type="SelfPermission"/>
                    <param name="entryPs" type="List<PolicyParser.PrincipalEntry>"/>
                    <param name="pdp" type="Principal[]"/>
                    <param name="perms" type="Permissions"/>
                </params>
                <scope line="1060">
                    <scope line="1061"/>
                </scope>
                <declaration name="startIndex" type="int" line="1066"/>
                <declaration name="v" type="int" line="1067"/>
                <declaration name="sb" type="StringBuilder" line="1068"/>
                <scope line="1069">
                    <declaration name="pli" type="ListIterator&lt;PolicyParser.PrincipalEntry&gt;" line="1071"/>
                    <scope line="1072">
                        <declaration name="pppe" type="PolicyParser.PrincipalEntry" line="1073"/>
                        <declaration name="principalInfo" type="String[][]" line="1074"/>
                        <scope line="1075">
                            <scope line="1076"/>
                        </scope>
                        <scope line="1081"/>
                    </scope>
                </scope>
                <scope line="1088"/>
                <scope line="1091"/>
                <scope line="1094">
                    <declaration name="pc" type="Class&lt;?&gt;" line="1095"/>
                    <scope line="1096">
                        <declaration name="e" type="Enumeration&lt;Permission&gt;" line="1097"/>
                        <scope line="1098">
                            <declaration name="pElement" type="Permission" line="1099"/>
                            <scope line="1100"/>
                        </scope>
                    </scope>
                    <scope line="1106"/>
                    <scope line="1109">
                        <scope line="1110">
                            <declaration name="c" type="Constructor&lt;?&gt;" line="1111"/>
                            <scope line="1112">
                                <scope line="1113"/>
                                <scope line="1117"/>
                            </scope>
                            <scope line="1122"/>
                        </scope>
                        <scope line="1127">
                            <scope line="1128"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="1134">
                    <scope line="1135"/>
                </scope>
            </method>
            <javadoc line="1140">
                return the principal class/name pair in the 2D array.
                  array[x][y]:     x corresponds to the array length.
                  if (y == 0), it&apos;s the principal class.
                  if (y == 1), it&apos;s the principal name.                
            </javadoc>
            <method name="getPrincipalInfo" type="String[][]" line="1146">
                <params>
                    <param name="pe" type="PolicyParser.PrincipalEntry"/>
                    <param name="pdp" type="Principal[]"/>
                </params>
                <scope line="1147">
                    <declaration name="info" type="String[][]" line="1148"/>
                </scope>
                <scope line="1153">
                    <declaration name="plist" type="List&lt;Principal&gt;" line="1154"/>
                    <scope line="1155"/>
                    <declaration name="info" type="String[][]" line="1158"/>
                    <declaration name="i" type="int" line="1159"/>
                    <declaration name="pIterator" type="java.util.Iterator&lt;Principal&gt;" line="1160"/>
                    <scope line="1161">
                        <declaration name="p" type="Principal" line="1162"/>
                    </scope>
                </scope>
                <scope line="1169">
                    <declaration name="info" type="String[][]" line="1170"/>
                    <scope line="1171"/>
                </scope>
            </method>
            <method name="getSignerCertificates" type="Certificate[]" line="1178">
                <params>
                    <param name="cs" type="CodeSource"/>
                </params>
                <declaration name="certs" type="Certificate[]" line="1179"/>
                <scope line="1181"/>
                <declaration name="i" type="int" line="1184"/>
                <declaration name="count" type="int" line="1185"/>
                <scope line="1186">
                    <scope line="1188"/>
                </scope>
                <declaration name="userCertList" type="ArrayList&lt;Certificate&gt;" line="1194"/>
                <scope line="1196">
                    <scope line="1198"/>
                </scope>
                <declaration name="userCerts" type="Certificate[]" line="1203"/>
            </method>
            <method name="canonicalizeCodebase" type="CodeSource" line="1207">
                <params>
                    <param name="cs" type="CodeSource"/>
                    <param name="extractSignerCerts" type="boolean"/>
                </params>
                <declaration name="path" type="String" line="1208"/>
                <declaration name="canonCs" type="CodeSource" line="1209"/>
                <declaration name="u" type="URL" line="1210"/>
                <scope line="1211">
                    <scope line="1212">
                        <declaration name="spec" type="String" line="1213"/>
                        <declaration name="separator" type="int" line="1214"/>
                        <scope line="1215">
                            <scope line="1216"/>
                            <scope line="1219"/>
                        </scope>
                    </scope>
                    <scope line="1223">
                        <declaration name="isLocalFile" type="boolean" line="1224"/>
                        <declaration name="host" type="String" line="1225"/>
                        <scope line="1227"/>
                    </scope>
                </scope>
                <scope line="1233">
                    <scope line="1234">
                        <declaration name="csUrl" type="URL" line="1235"/>
                        <scope line="1238"/>
                        <scope line="1241"/>
                    </scope>
                    <scope line="1245">
                        <scope line="1246"/>
                    </scope>
                </scope>
                <scope line="1251">
                    <scope line="1252"/>
                </scope>
            </method>
            <method name="canonPath" type="String" line="1258">
                <params>
                    <param name="path" type="String"/>
                </params>
                <scope line="1259"/>
                <scope line="1264"/>
            </method>
            <method name="printPD" type="String" line="1268">
                <params>
                    <param name="pd" type="ProtectionDomain"/>
                </params>
                <declaration name="principals" type="Principal[]" line="1269"/>
                <declaration name="pals" type="String" line="1270"/>
                <scope line="1271">
                    <declaration name="palBuf" type="StringBuilder" line="1272"/>
                    <scope line="1273"/>
                </scope>
            </method>
            <javadoc line="1282">
                return true if no replacement was performed,
                  or if replacement succeeded.                
            </javadoc>
            <method name="replacePrincipals" type="boolean" line="1286">
                <params>
                    <param name="principals" type="List<PolicyParser.PrincipalEntry>"/>
                    <param name="keystore" type="KeyStore"/>
                </params>
                <declaration name="i" type="ListIterator&lt;PolicyParser.PrincipalEntry&gt;" line="1288"/>
                <scope line="1289">
                    <declaration name="pppe" type="PolicyParser.PrincipalEntry" line="1290"/>
                    <scope line="1291">
                        <declaration name="name" type="String" line="1292"/>
                        <scope line="1293"/>
                        <scope line="1296"/>
                    </scope>
                </scope>
            </method>
            <method name="expandPermissionName" type="void" line="1305">
                <params>
                    <param name="pe" type="PolicyParser.PermissionEntry"/>
                    <param name="keystore" type="KeyStore"/>
                </params>
                <scope line="1306"/>
                <declaration name="startIndex" type="int" line="1309"/>
                <declaration name="b" type="int" line="1310"/>
                <declaration name="sb" type="StringBuilder" line="1311"/>
                <scope line="1312">
                    <scope line="1314"/>
                    <declaration name="value" type="String" line="1318"/>
                    <declaration name="colonIndex" type="int" line="1319"/>
                    <declaration name="prefix" type="String" line="1320"/>
                    <declaration name="suffix" type="String" line="1321"/>
                    <scope line="1322"/>
                    <scope line="1325"/>
                    <scope line="1330">
                        <scope line="1331">
                            <declaration name="form" type="MessageFormat" line="1332"/>
                            <declaration name="source" type="Object[]" line="1333"/>
                        </scope>
                        <scope line="1337">
                            <declaration name="form" type="MessageFormat" line="1338"/>
                            <declaration name="source" type="Object[]" line="1339"/>
                        </scope>
                    </scope>
                    <scope line="1345">
                        <declaration name="form" type="MessageFormat" line="1346"/>
                        <declaration name="source" type="Object[]" line="1347"/>
                    </scope>
                </scope>
                <scope line="1352"/>
            </method>
            <method name="getDN" type="String" line="1357">
                <params>
                    <param name="alias" type="String"/>
                    <param name="keystore" type="KeyStore"/>
                </params>
                <declaration name="cert" type="Certificate" line="1358"/>
                <scope line="1359"/>
                <scope line="1362">
                    <scope line="1363"/>
                </scope>
                <scope line="1368">
                    <scope line="1369"/>
                </scope>
                <scope line="1374">
                    <declaration name="x509Cert" type="X509Certificate" line="1375"/>
                    <declaration name="p" type="X500Principal" line="1376"/>
                </scope>
            </method>
            <javadoc line="1380">
                Checks public key. If it is marked as trusted in
                  the identity database, add it to the policy
                  with the AllPermission.                
            </javadoc>
            <method name="checkForTrustedIdentity" type="boolean" line="1385">
                <params>
                    <param name="cert" type="Certificate"/>
                    <param name="myInfo" type="PolicyInfo"/>
                </params>
            </method>
            <class name="PolicyEntry" line="1388">
                <javadoc line="1388">
                    Each entry in the policy configuration file is represented by a
                      PolicyEntry object.  &lt;p&gt;
                      A PolicyEntry is a (CodeSource,Permission) pair.  The
                      CodeSource contains the (URL, PublicKey) that together identify
                      where the Java bytecodes come from and who (if anyone) signed
                      them.  The URL could refer to localhost.  The URL could also be
                      null, meaning that this policy entry is given to all comers, as
                      long as they match the signer field.  The signer could be null,
                      meaning the code is not signed. &lt;p&gt;
                      The Permission contains the (Type, Name, Action) triplet. &lt;p&gt;
                      For now, the Policy object retrieves the public key from the
                      X.509 certificate on disk that corresponds to the signedBy
                      alias specified in the Policy config file.  For reasons of
                      efficiency, the Policy object keeps a hashtable of certs already
                      read in.  This could be replaced by a secure internal key
                      store.
                      &lt;p&gt;
                      For example, the entry
                      &lt;pre&gt;
                      permission java.io.File &quot;/tmp&quot;, &quot;read,write&quot;,
                      signedBy &quot;Duke&quot;;
                      &lt;/pre&gt;
                      is represented internally
                      &lt;pre&gt;
                      FilePermission f = new FilePermission(&quot;/tmp&quot;, &quot;read,write&quot;);
                      PublicKey p = publickeys.get(&quot;Duke&quot;);
                      URL u = InetAddress.getLocalHost();
                      CodeBase c = new CodeBase( p, u );
                      pe = new PolicyEntry(f, c);
                      &lt;/pre&gt;                    
                    <author>
                        Marianne Mueller                        
                    </author>
                    <author>
                        Roland Schemers                        
                    </author>
                    <see>
                        java.security.CodeSource                        
                    </see>
                    <see>
                        java.security.Policy                        
                    </see>
                    <see>
                        java.security.Permissions                        
                    </see>
                    <see>
                        java.security.ProtectionDomain                        
                    </see>
                </javadoc>
                <declaration name="codesource" type="CodeSource" line="1427"/>
                <declaration name="permissions" type="List&lt;Permission&gt;" line="1428"/>
                <declaration name="principals" type="List&lt;PolicyParser.PrincipalEntry&gt;" line="1429"/>
                <javadoc line="1430">
                    Given a Permission and a CodeSource, create a policy entry.
                      XXX Decide if/how to add validity fields and &quot;purpose&quot; fields to
                      XXX policy entries                    
                    <param>
                        cs the CodeSource, which encapsulates the URL and the
                          public key
                          attributes from the policy config file. Validity checks
                          are performed on the public key before PolicyEntry is
                          called.                        
                    </param>
                </javadoc>
                <method name="PolicyEntry" type="constructor" line="1440">
                    <params>
                        <param name="cs" type="CodeSource"/>
                        <param name="principals" type="List<PolicyParser.PrincipalEntry>"/>
                    </params>
                </method>
                <method name="PolicyEntry" type="constructor" line="1445">
                    <params>
                        <param name="cs" type="CodeSource"/>
                    </params>
                </method>
                <method name="getPrincipals" type="List<PolicyParser.PrincipalEntry>" line="1448"/>
                <javadoc line="1451">
                    add a Permission object to this entry.
                      No need to sync add op because perms are added to entry only
                      while entry is being initialized                    
                </javadoc>
                <method name="add" type="void" line="1456">
                    <params>
                        <param name="p" type="Permission"/>
                    </params>
                </method>
                <javadoc line="1459">
                    Return the CodeSource for this policy entry                    
                </javadoc>
                <method name="getCodeSource" type="CodeSource" line="1462"/>
                <method name="toString" type="String" line="1465">
                    <declaration name="sb" type="StringBuilder" line="1466"/>
                    <scope line="1470">
                        <declaration name="p" type="Permission" line="1471"/>
                    </scope>
                </method>
            </class>
            <class name="SelfPermission" line="1482">
                <extends class="Permission"/>
                <declaration name="serialVersionUID" type="long" line="1483"/>
                <declaration name="type" type="String" line="1484"/>
                <javadoc line="1484">
                    The class name of the Permission class that will be
                      created when this self permission is expanded .                    
                    <serial>
                                                
                    </serial>
                </javadoc>
                <declaration name="name" type="String" line="1490"/>
                <javadoc line="1490">
                    The permission name.                    
                    <serial>
                                                
                    </serial>
                </javadoc>
                <declaration name="actions" type="String" line="1495"/>
                <javadoc line="1495">
                    The actions of the permission.                    
                    <serial>
                                                
                    </serial>
                </javadoc>
                <declaration name="certs" type="Certificate" line="1500"/>
                <javadoc line="1500">
                    The certs of the permission.                    
                    <serial>
                                                
                    </serial>
                </javadoc>
                <javadoc line="1505">
                    Creates a new SelfPermission containing the permission
                      information needed later to expand the self                    
                    <param>
                        type the class name of the Permission class that will be
                          created when this permission is expanded and if necessary resolved.                        
                    </param>
                    <param>
                        name the name of the permission.                        
                    </param>
                    <param>
                        actions the actions of the permission.                        
                    </param>
                    <param>
                        certs the certificates the permission's class was signed with.
                          This is a list of certificate chains, where each chain is composed of
                          a signer certificate and optionally its supporting certificate chain.
                          Each chain is ordered bottom-to-top (i.e., with the signer
                          certificate first and the (root) certificate authority last).                        
                    </param>
                </javadoc>
                <method name="SelfPermission" type="constructor" line="1518">
                    <params>
                        <param name="type" type="String"/>
                        <param name="name" type="String"/>
                        <param name="actions" type="String"/>
                        <param name="certs" type="Certificate"/>
                    </params>
                    <scope line="1520"/>
                    <scope line="1526">
                        <scope line="1527">
                            <scope line="1528"/>
                        </scope>
                        <scope line="1533">
                            <declaration name="i" type="int" line="1534"/>
                            <declaration name="count" type="int" line="1535"/>
                            <scope line="1536">
                                <scope line="1538"/>
                            </scope>
                            <scope line="1543"/>
                            <scope line="1546">
                                <declaration name="signerCerts" type="ArrayList&lt;Certificate&gt;" line="1547"/>
                                <scope line="1549">
                                    <scope line="1551"/>
                                </scope>
                            </scope>
                        </scope>
                    </scope>
                </method>
                <javadoc line="1562">
                    This method always returns false for SelfPermission permissions.
                      That is, an SelfPermission never considered to
                      imply another permission.                    
                    <param>
                        p the permission to check against.                        
                    </param>
                    <return>
                        false.                        
                    </return>
                </javadoc>
                <method name="implies" type="boolean" line="1569">
                    <params>
                        <param name="p" type="Permission"/>
                    </params>
                </method>
                <javadoc line="1572">
                    Checks two SelfPermission objects for equality.
                      Checks that &lt;i&gt;obj&lt;/i&gt; is an SelfPermission, and has
                      the same type (class) name, permission name, actions, and
                      certificates as this object.                    
                    <param>
                        obj the object we are testing for equality with this object.                        
                    </param>
                    <return>
                        true if obj is an SelfPermission, and has the same
                          type (class) name, permission name, actions, and
                          certificates as this object.                        
                    </return>
                </javadoc>
                <method name="equals" type="boolean" line="1582">
                    <params>
                        <param name="obj" type="Object"/>
                    </params>
                    <declaration name="that" type="SelfPermission" line="1585"/>
                    <declaration name="i" type="int" line="1588"/>
                    <declaration name="match" type="boolean" line="1589"/>
                    <scope line="1590">
                        <scope line="1592">
                            <scope line="1593"/>
                        </scope>
                    </scope>
                    <scope line="1600">
                        <scope line="1602">
                            <scope line="1603"/>
                        </scope>
                    </scope>
                </method>
                <javadoc line="1612">
                    Returns the hash code value for this object.                    
                    <return>
                        a hash code value for this object.                        
                    </return>
                </javadoc>
                <method name="hashCode" type="int" line="1616">
                    <declaration name="hash" type="int" line="1617"/>
                </method>
                <javadoc line="1622">
                    Returns the canonical string representation of the actions,
                      which currently is the empty string &quot;&quot;, since there are no actions
                      for an SelfPermission. That is, the actions for the
                      permission that will be created when this SelfPermission
                      is resolved may be non-null, but an SelfPermission
                      itself is never considered to have any actions.                    
                    <return>
                        the empty string "".                        
                    </return>
                </javadoc>
                <method name="getActions" type="String" line="1631"/>
                <method name="getSelfType" type="String" line="1634"/>
                <method name="getSelfName" type="String" line="1637"/>
                <method name="getSelfActions" type="String" line="1640"/>
                <method name="getCerts" type="Certificate[]" line="1643"/>
                <javadoc line="1646">
                    Returns a string describing this SelfPermission.  The convention
                      is to specify the class name, the permission name, and the actions,
                      in the following format: &apos;(unresolved &quot;ClassName&quot; &quot;name&quot; &quot;actions&quot;)&apos;.                    
                    <return>
                        information about this SelfPermission.                        
                    </return>
                </javadoc>
                <method name="toString" type="String" line="1652"/>
            </class>
            <class name="PolicyInfo" line="1656">
                <javadoc line="1656">
                    holds policy information that we need to synch on                    
                </javadoc>
                <declaration name="verbose" type="boolean" line="1660"/>
                <declaration name="policyEntries" type="List&lt;PolicyEntry&gt;" line="1661"/>
                <declaration name="identityPolicyEntries" type="List&lt;PolicyEntry&gt;" line="1662"/>
                <declaration name="aliasMapping" type="Map" line="1663"/>
                <declaration name="pdMapping" type="ProtectionDomainCache[]" line="1664"/>
                <declaration name="random" type="java.util.Random" line="1665"/>
                <method name="PolicyInfo" type="constructor" line="1666">
                    <params>
                        <param name="numCaches" type="int"/>
                    </params>
                    <declaration name="jspda" type="JavaSecurityProtectionDomainAccess" line="1671"/>
                    <scope line="1672"/>
                    <scope line="1675"/>
                </method>
                <method name="getPdMapping" type="ProtectionDomainCache" line="1679">
                    <scope line="1680"/>
                    <scope line="1683">
                        <declaration name="i" type="int" line="1684"/>
                    </scope>
                </method>
            </class>
        </class>
    </source>