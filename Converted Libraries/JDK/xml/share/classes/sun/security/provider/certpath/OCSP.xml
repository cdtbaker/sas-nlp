<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.provider.certpath">
        <import package="java.io.InputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.io.OutputStream"/>
        <import package="java.net.URI"/>
        <import package="java.net.URL"/>
        <import package="java.net.HttpURLConnection"/>
        <import package="java.security.cert.CertificateException"/>
        <import package="java.security.cert.CertPathValidatorException"/>
        <import package="java.security.cert.CRLReason"/>
        <import package="java.security.cert.Extension"/>
        <import package="java.security.cert.X509Certificate"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.Collections"/>
        <import package="java.util.Date"/>
        <import package="java.util.List"/>
        <import package="java.util.Map"/>
        <import package="sun.security.provider.certpath.OCSPResponse"/>
        <import package="sun.security.util.Debug"/>
        <import package="sun.security.x509.AccessDescription"/>
        <import package="sun.security.x509.AuthorityInfoAccessExtension"/>
        <import package="sun.security.x509.GeneralName"/>
        <import package="sun.security.x509.GeneralNameInterface"/>
        <import package="sun.security.x509.URIName"/>
        <import package="sun.security.x509.X509CertImpl"/>
        <class name="OCSP" line="53">
            <comment line="68">
                15 seconds                
            </comment>
            <javadoc line="53">
                This is a class that checks the revocation status of a certificate(s) using
                  OCSP. It is not a PKIXCertPathChecker and therefore can be used outside of
                  the CertPathValidator framework. It is useful when you want to
                  just check the revocation status of a certificate, and you don&apos;t want to
                  incur the overhead of validating all of the certificates in the
                  associated certificate chain.                
                <author>
                    Sean Mullan                    
                </author>
            </javadoc>
            <declaration name="debug" type="Debug" line="65"/>
            <declaration name="CONNECT_TIMEOUT" type="int" line="67"/>
            <method name="OCSP" type="constructor" line="69"/>
            <javadoc line="71">
                Obtains the revocation status of a certificate using OCSP using the most
                  common defaults. The OCSP responder URI is retrieved from the
                  certificate&apos;s AIA extension. The OCSP responder certificate is assumed
                  to be the issuer&apos;s certificate (or issued by the issuer CA).                
                <param>
                    cert the certificate to be checked                    
                </param>
                <param>
                    issuerCert the issuer certificate                    
                </param>
                <return>
                    the RevocationStatus                    
                </return>
                <throws>
                    IOException if there is an exception connecting to or
                      communicating with the OCSP responder                    
                </throws>
                <throws>
                    CertPathValidatorException if an exception occurs while
                      encoding the OCSP Request or validating the OCSP Response                    
                </throws>
            </javadoc>
            <method name="check" type="RevocationStatus" line="87">
                <params>
                    <param name="cert" type="X509Certificate"/>
                    <param name="issuerCert" type="X509Certificate"/>
                </params>
                <declaration name="certId" type="CertId" line="88"/>
                <declaration name="responderURI" type="URI" line="89"/>
                <scope line="90">
                    <declaration name="certImpl" type="X509CertImpl" line="91"/>
                    <scope line="93"/>
                </scope>
                <scope line="98"/>
                <scope line="101"/>
                <declaration name="ocspResponse" type="OCSPResponse" line="105"/>
            </method>
            <javadoc line="110">
                Obtains the revocation status of a certificate using OCSP.                
                <param>
                    cert the certificate to be checked                    
                </param>
                <param>
                    issuerCert the issuer certificate                    
                </param>
                <param>
                    responderURI the URI of the OCSP responder                    
                </param>
                <param>
                    responderCert the OCSP responder&apos;s certificate                    
                </param>
                <param>
                    date the time the validity of the OCSP responder&apos;s certificate
                      should be checked against. If null, the current time is used.                    
                </param>
                <return>
                    the RevocationStatus                    
                </return>
                <throws>
                    IOException if there is an exception connecting to or
                      communicating with the OCSP responder                    
                </throws>
                <throws>
                    CertPathValidatorException if an exception occurs while
                      encoding the OCSP Request or validating the OCSP Response                    
                </throws>
            </javadoc>
            <method name="check" type="RevocationStatus" line="128">
                <params>
                    <param name="cert" type="X509Certificate"/>
                    <param name="issuerCert" type="X509Certificate"/>
                    <param name="responderURI" type="URI"/>
                    <param name="responderCert" type="X509Certificate"/>
                    <param name="date" type="Date"/>
                </params>
                <declaration name="certId" type="CertId" line="129"/>
                <scope line="130">
                    <declaration name="certImpl" type="X509CertImpl" line="131"/>
                </scope>
                <scope line="133"/>
                <scope line="136"/>
                <declaration name="ocspResponse" type="OCSPResponse" line="140"/>
            </method>
            <javadoc line="145">
                Checks the revocation status of a list of certificates using OCSP.                
                <param>
                    certs the CertIds to be checked                    
                </param>
                <param>
                    responderURI the URI of the OCSP responder                    
                </param>
                <param>
                    responderCert the OCSP responder&apos;s certificate                    
                </param>
                <param>
                    date the time the validity of the OCSP responder&apos;s certificate
                      should be checked against. If null, the current time is used.                    
                </param>
                <return>
                    the OCSPResponse                    
                </return>
                <throws>
                    IOException if there is an exception connecting to or
                      communicating with the OCSP responder                    
                </throws>
                <throws>
                    CertPathValidatorException if an exception occurs while
                      encoding the OCSP Request or validating the OCSP Response                    
                </throws>
            </javadoc>
            <method name="check" type="OCSPResponse" line="161">
                <params>
                    <param name="certIds" type="List<CertId>"/>
                    <param name="responderURI" type="URI"/>
                    <param name="responderCert" type="X509Certificate"/>
                    <param name="date" type="Date"/>
                </params>
                <comment line="194">
                    Check the response                    
                </comment>
                <comment line="239">
                    response decoding exception                    
                </comment>
                <comment line="247">
                    Check that the response includes a response for all of the
                     certs that were supplied in the request                    
                </comment>
                <declaration name="bytes" type="byte[]" line="163"/>
                <scope line="164">
                    <declaration name="request" type="OCSPRequest" line="165"/>
                </scope>
                <scope line="167"/>
                <declaration name="in" type="InputStream" line="172"/>
                <declaration name="out" type="OutputStream" line="173"/>
                <declaration name="response" type="byte[]" line="174"/>
                <scope line="175">
                    <declaration name="url" type="URL" line="176"/>
                    <scope line="177"/>
                    <declaration name="con" type="HttpURLConnection" line="180"/>
                    <scope line="195"/>
                    <declaration name="contentLength" type="int" line="200"/>
                    <scope line="201"/>
                    <declaration name="total" type="int" line="205"/>
                    <scope line="206">
                        <declaration name="count" type="int" line="207"/>
                        <scope line="212"/>
                    </scope>
                </scope>
                <scope line="217">
                    <scope line="218">
                        <scope line="219"/>
                        <scope line="221"/>
                    </scope>
                    <scope line="225">
                        <scope line="226"/>
                        <scope line="228"/>
                    </scope>
                </scope>
                <declaration name="ocspResponse" type="OCSPResponse" line="234"/>
                <scope line="235"/>
                <scope line="237"/>
                <scope line="241"/>
                <scope line="248">
                    <declaration name="sr" type="SingleResponse" line="249"/>
                    <scope line="250">
                        <scope line="251"/>
                    </scope>
                    <scope line="258"/>
                </scope>
            </method>
            <javadoc line="266">
                Returns the URI of the OCSP Responder as specified in the
                  certificate&apos;s Authority Information Access extension, or null if
                  not specified.                
                <param>
                    cert the certificate                    
                </param>
                <return>
                    the URI of the OCSP Responder, or null if not specified                    
                </return>
            </javadoc>
            <method name="getResponderURI" type="URI" line="274">
                <params>
                    <param name="cert" type="X509Certificate"/>
                </params>
                <comment line="279">
                    treat this case as if the cert had no extension                    
                </comment>
                <scope line="275"/>
                <scope line="277"/>
            </method>
            <method name="getResponderURI" type="URI" line="283">
                <params>
                    <param name="certImpl" type="X509CertImpl"/>
                </params>
                <comment line="286">
                    Examine the certificate&apos;s AuthorityInfoAccess extension                    
                </comment>
                <declaration name="aia" type="AuthorityInfoAccessExtension" line="286"/>
                <scope line="288"/>
                <declaration name="descriptions" type="List&lt;AccessDescription&gt;" line="292"/>
                <scope line="293">
                    <scope line="295">
                        <declaration name="generalName" type="GeneralName" line="297"/>
                        <scope line="298">
                            <declaration name="uri" type="URIName" line="299"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <interface name="RevocationStatus">
                <javadoc line="307">
                    The Revocation Status of a certificate.                    
                </javadoc>
                <method name="getCertStatus" type="CertStatus" line="313"/>
                <javadoc line="313">
                    Returns the revocation status.                    
                </javadoc>
                <method name="getRevocationTime" type="Date" line="317"/>
                <javadoc line="317">
                    Returns the time when the certificate was revoked, or null
                      if it has not been revoked.                    
                </javadoc>
                <method name="getRevocationReason" type="CRLReason" line="322"/>
                <javadoc line="322">
                    Returns the reason the certificate was revoked, or null if it
                      has not been revoked.                    
                </javadoc>
                <method name="getSingleExtensions" type="Map<String,Extension>" line="328"/>
                <javadoc line="328">
                    Returns a Map of additional extensions.                    
                </javadoc>
            </interface>
        </class>
    </source>