<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.acl">
        <import package="java.io"/>
        <import package="java.util"/>
        <import package="java.security.Principal"/>
        <import package="java.security.acl"/>
        <class name="AclImpl" line="33">
            <extends class="OwnerImpl"/>
            <comment line="39">
                Maintain four tables. one each for positive and negative
                 ACLs. One each depending on whether the entity is a group
                 or principal.                
            </comment>
            <comment line="268">
                Find the table that this entry belongs to. There are 4
                 tables that are maintained. One each for postive and
                 negative ACLs and one each for groups and users.
                 This method figures out which
                 table is the one that this AclEntry belongs to.                
            </comment>
            <comment line="293">
                returns the set e1 U e2.                
            </comment>
            <comment line="312">
                returns the set e1 - e2.                
            </comment>
            <implements interface="Acl"/>
            <javadoc line="33">
                An Access Control List (ACL) is encapsulated by this class.                
                <author>
                    Satish Dharmaraj                    
                </author>
            </javadoc>
            <declaration name="allowedUsersTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="43"/>
            <declaration name="allowedGroupsTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="45"/>
            <declaration name="deniedUsersTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="47"/>
            <declaration name="deniedGroupsTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="49"/>
            <declaration name="aclName" type="String" line="51"/>
            <declaration name="zeroSet" type="Vector&lt;Permission&gt;" line="52"/>
            <javadoc line="55">
                Constructor for creating an empty ACL.                
            </javadoc>
            <method name="AclImpl" type="constructor" line="58">
                <params>
                    <param name="owner" type="Principal"/>
                    <param name="name" type="String"/>
                </params>
                <scope line="60"/>
                <scope line="62"/>
            </method>
            <javadoc line="65">
                Sets the name of the ACL.                
                <param>
                    caller the principal who is invoking this method.                    
                </param>
                <param>
                    name the name of the ACL.                    
                </param>
                <exception>
                    NotOwnerException if the caller principal is
                      not on the owners list of the Acl.                    
                </exception>
            </javadoc>
            <method name="setName" type="void" line="74">
                <params>
                    <param name="caller" type="Principal"/>
                    <param name="name" type="String"/>
                </params>
            </method>
            <javadoc line="81">
                Returns the name of the ACL.                
                <return>
                    the name of the ACL.                    
                </return>
            </javadoc>
            <method name="getName" type="String" line="85"/>
            <javadoc line="89">
                Adds an ACL entry to this ACL. An entry associates a
                  group or a principal with a set of permissions. Each
                  user or group can have one positive ACL entry and one
                  negative ACL entry. If there is one of the type (negative
                  or positive) already in the table, a false value is returned.
                  The caller principal must be a part of the owners list of
                  the ACL in order to invoke this method.                
                <param>
                    caller the principal who is invoking this method.                    
                </param>
                <param>
                    entry the ACL entry that must be added to the ACL.                    
                </param>
                <return>
                    true on success, false if the entry is already present.                    
                </return>
                <exception>
                    NotOwnerException if the caller principal
                      is not on the owners list of the Acl.                    
                </exception>
            </javadoc>
            <method name="addEntry" type="boolean" line="105">
                <params>
                    <param name="caller" type="Principal"/>
                    <param name="entry" type="AclEntry"/>
                </params>
                <declaration name="aclTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="109"/>
                <declaration name="key" type="Principal" line="110"/>
            </method>
            <javadoc line="119">
                Removes an ACL entry from this ACL.
                  The caller principal must be a part of the owners list of the ACL
                  in order to invoke this method.                
                <param>
                    caller the principal who is invoking this method.                    
                </param>
                <param>
                    entry the ACL entry that must be removed from the ACL.                    
                </param>
                <return>
                    true on success, false if the entry is not part of the ACL.                    
                </return>
                <exception>
                    NotOwnerException if the caller principal is not
                      the owners list of the Acl.                    
                </exception>
            </javadoc>
            <method name="removeEntry" type="boolean" line="131">
                <params>
                    <param name="caller" type="Principal"/>
                    <param name="entry" type="AclEntry"/>
                </params>
                <declaration name="aclTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="135"/>
                <declaration name="key" type="Principal" line="136"/>
                <declaration name="o" type="AclEntry" line="138"/>
            </method>
            <javadoc line="142">
                This method returns the set of allowed permissions for the
                  specified principal. This set of allowed permissions is calculated
                  as follows:
                  If there is no entry for a group or a principal an empty permission
                  set is assumed.
                  The group positive permission set is the union of all
                  the positive permissions of each group that the individual belongs to.
                  The group negative permission set is the union of all
                  the negative permissions of each group that the individual belongs to.
                  If there is a specific permission that occurs in both
                  the postive permission set and the negative permission set,
                  it is removed from both. The group positive and negatoive permission
                  sets are calculated.
                  The individial positive permission set and the individual negative
                  permission set is then calculated. Again abscence of an entry means
                  the empty set.
                  The set of permissions granted to the principal is then calculated using
                  the simple rule: Individual permissions always override the Group permissions.
                  Specifically, individual negative permission set (specific
                  denial of permissions) overrides the group positive permission set.
                  And the individual positive permission set override the group negative
                  permission set.                
                <param>
                    user the principal for which the ACL entry is returned.                    
                </param>
                <return>
                    The resulting permission set that the principal is allowed.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="Enumeration<Permission>" line="173">
                <params>
                    <param name="user" type="Principal"/>
                </params>
                <comment line="181">
                    canonicalize the sets. That is remove common permissions from
                     positive and negative sets.                    
                </comment>
                <comment line="194">
                    net positive permissions is individual positive permissions
                     plus (group positive - individual negative).                    
                </comment>
                <comment line="203">
                    recalculate the enumeration since we lost it in performing the
                     subtraction                    
                </comment>
                <comment line="211">
                    net negative permissions is individual negative permissions
                     plus (group negative - individual positive).                    
                </comment>
                <declaration name="individualPositive" type="Enumeration&lt;Permission&gt;" line="175"/>
                <declaration name="individualNegative" type="Enumeration&lt;Permission&gt;" line="176"/>
                <declaration name="groupPositive" type="Enumeration&lt;Permission&gt;" line="177"/>
                <declaration name="groupNegative" type="Enumeration&lt;Permission&gt;" line="178"/>
                <declaration name="temp1" type="Enumeration&lt;Permission&gt;" line="197"/>
                <declaration name="netPositive" type="Enumeration&lt;Permission&gt;" line="199"/>
                <declaration name="netNegative" type="Enumeration&lt;Permission&gt;" line="215"/>
            </method>
            <javadoc line="220">
                This method checks whether or not the specified principal
                  has the required permission. If permission is denied
                  permission false is returned, a true value is returned otherwise.
                  This method does not authenticate the principal. It presumes that
                  the principal is a valid authenticated principal.                
                <param>
                    principal the name of the authenticated principal                    
                </param>
                <param>
                    permission the permission that the principal must have.                    
                </param>
                <return>
                    true of the principal has the permission desired, false
                      otherwise.                    
                </return>
            </javadoc>
            <method name="checkPermission" type="boolean" line="232">
                <params>
                    <param name="principal" type="Principal"/>
                    <param name="permission" type="Permission"/>
                </params>
                <declaration name="permSet" type="Enumeration&lt;Permission&gt;" line="233"/>
                <scope line="234">
                    <declaration name="p" type="Permission" line="235"/>
                </scope>
            </method>
            <javadoc line="242">
                returns an enumeration of the entries in this ACL.                
            </javadoc>
            <method name="entries" type="Enumeration<AclEntry>" line="245"/>
            <javadoc line="251">
                return a stringified version of the
                  ACL.                
            </javadoc>
            <method name="toString" type="String" line="255">
                <declaration name="sb" type="StringBuffer" line="256"/>
                <declaration name="entries" type="Enumeration&lt;AclEntry&gt;" line="257"/>
                <scope line="258">
                    <declaration name="entry" type="AclEntry" line="259"/>
                </scope>
            </method>
            <method name="findTable" type="Hashtable<Principal,AclEntry>" line="274">
                <params>
                    <param name="entry" type="AclEntry"/>
                </params>
                <declaration name="aclTable" type="Hashtable&lt;Principal,AclEntry&gt;" line="275"/>
                <declaration name="p" type="Principal" line="277"/>
                <scope line="278"/>
                <scope line="283"/>
            </method>
            <method name="union" type="Enumeration<Permission>" line="296">
                <params>
                    <param name="e1" type="Enumeration<Permission>"/>
                    <param name="e2" type="Enumeration<Permission>"/>
                </params>
                <declaration name="v" type="Vector&lt;Permission&gt;" line="297"/>
                <scope line="302">
                    <declaration name="o" type="Permission" line="303"/>
                </scope>
            </method>
            <method name="subtract" type="Enumeration<Permission>" line="315">
                <params>
                    <param name="e1" type="Enumeration<Permission>"/>
                    <param name="e2" type="Enumeration<Permission>"/>
                </params>
                <declaration name="v" type="Vector&lt;Permission&gt;" line="316"/>
                <scope line="321">
                    <declaration name="o" type="Permission" line="322"/>
                </scope>
            </method>
            <method name="getGroupPositive" type="Enumeration<Permission>" line="330">
                <params>
                    <param name="user" type="Principal"/>
                </params>
                <declaration name="groupPositive" type="Enumeration&lt;Permission&gt;" line="331"/>
                <declaration name="e" type="Enumeration&lt;Principal&gt;" line="332"/>
                <scope line="333">
                    <declaration name="g" type="Group" line="334"/>
                    <scope line="335">
                        <declaration name="ae" type="AclEntry" line="336"/>
                    </scope>
                </scope>
            </method>
            <method name="getGroupNegative" type="Enumeration<Permission>" line="343">
                <params>
                    <param name="user" type="Principal"/>
                </params>
                <declaration name="groupNegative" type="Enumeration&lt;Permission&gt;" line="344"/>
                <declaration name="e" type="Enumeration&lt;Principal&gt;" line="345"/>
                <scope line="346">
                    <declaration name="g" type="Group" line="347"/>
                    <scope line="348">
                        <declaration name="ae" type="AclEntry" line="349"/>
                    </scope>
                </scope>
            </method>
            <method name="getIndividualPositive" type="Enumeration<Permission>" line="356">
                <params>
                    <param name="user" type="Principal"/>
                </params>
                <declaration name="individualPositive" type="Enumeration&lt;Permission&gt;" line="357"/>
                <declaration name="ae" type="AclEntry" line="358"/>
            </method>
            <method name="getIndividualNegative" type="Enumeration<Permission>" line="364">
                <params>
                    <param name="user" type="Principal"/>
                </params>
                <declaration name="individualNegative" type="Enumeration&lt;Permission&gt;" line="365"/>
                <declaration name="ae" type="AclEntry" line="366"/>
            </method>
        </class>
        <class name="AclEnumerator" line="373">
            <comment line="39">
                Maintain four tables. one each for positive and negative
                 ACLs. One each depending on whether the entity is a group
                 or principal.                
            </comment>
            <comment line="268">
                Find the table that this entry belongs to. There are 4
                 tables that are maintained. One each for postive and
                 negative ACLs and one each for groups and users.
                 This method figures out which
                 table is the one that this AclEntry belongs to.                
            </comment>
            <comment line="293">
                returns the set e1 U e2.                
            </comment>
            <comment line="312">
                returns the set e1 - e2.                
            </comment>
            <implements interface="Enumeration">
                <type_params>
                    <type_param name="AclEntry"/>
                </type_params>
            </implements>
            <declaration name="acl" type="Acl" line="374"/>
            <declaration name="u1" type="Enumeration&lt;AclEntry&gt;" line="375"/>
            <method name="AclEnumerator" type="constructor" line="378">
                <params>
                    <param name="acl" type="Acl"/>
                    <param name="u1" type="Hashtable<?,AclEntry>"/>
                    <param name="g1" type="Hashtable<?,AclEntry>"/>
                    <param name="u2" type="Hashtable<?,AclEntry>"/>
                    <param name="g2" type="Hashtable<?,AclEntry>"/>
                </params>
            </method>
            <method name="hasMoreElements" type="boolean" line="386"/>
            <method name="nextElement" type="AclEntry" line="394">
                <declaration name="o" type="AclEntry" line="395"/>
                <scope line="396"/>
            </method>
        </class>
    </source>