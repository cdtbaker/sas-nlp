<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss">
        <import package="org.ietf.jgss"/>
        <import package="sun.security.jgss.spi"/>
        <import package="sun.security.util.ObjectIdentifier"/>
        <import package="java.io.InputStream"/>
        <import package="java.io.OutputStream"/>
        <import package="java.io.ByteArrayInputStream"/>
        <import package="java.io.ByteArrayOutputStream"/>
        <import package="java.io.IOException"/>
        <import package="com.sun.security.jgss"/>
        <class name="GSSContextImpl" line="38">
            <comment line="96">
                private flags for the context state                
            </comment>
            <comment line="102">
                instance variables                
            </comment>
            <comment line="635">
                ExtendedGSSContext methods:                
            </comment>
            <implements interface="ExtendedGSSContext"/>
            <javadoc line="38">
                This class represents the JGSS security context and its associated
                  operations.  JGSS security contexts are established between
                  peers using locally established credentials.  Multiple contexts
                  may exist simultaneously between a pair of peers, using the same
                  or different set of credentials.  The JGSS is independent of
                  the underlying transport protocols and depends on its callers to
                  transport the tokens between peers.
                  &lt;p&gt;
                  The context object can be thought of as having 3 implicit states:
                  before it is established, during its context establishment, and
                  after a fully established context exists.
                  &lt;p&gt;
                  Before the context establishment phase is initiated, the context
                  initiator may request specific characteristics desired of the
                  established context. These can be set using the set methods. After the
                  context is established, the caller can check the actual characteristic
                  and services offered by the context using the query methods.
                  &lt;p&gt;
                  The context establishment phase begins with the first call to the
                  initSecContext method by the context initiator. During this phase the
                  initSecContext and acceptSecContext methods will produce GSS-API
                  authentication tokens which the calling application needs to send to its
                  peer. The initSecContext and acceptSecContext methods may
                  return a CONTINUE_NEEDED code which indicates that a token is needed
                  from its peer in order to continue the context establishment phase. A
                  return code of COMPLETE signals that the local end of the context is
                  established. This may still require that a token be sent to the peer,
                  depending if one is produced by GSS-API. The isEstablished method can
                  also be used to determine if the local end of the context has been
                  fully established. During the context establishment phase, the
                  isProtReady method may be called to determine if the context can be
                  used for the per-message operations. This allows implementation to
                  use per-message operations on contexts which aren&apos;t fully established.
                  &lt;p&gt;
                  After the context has been established or the isProtReady method
                  returns &quot;true&quot;, the query routines can be invoked to determine the actual
                  characteristics and services of the established context. The
                  application can also start using the per-message methods of wrap and
                  getMIC to obtain cryptographic operations on application supplied data.
                  &lt;p&gt;
                  When the context is no longer needed, the application should call
                  dispose to release any system resources the context may be using.
                  &lt;DL&gt;&lt;DT&gt;&lt;B&gt;RFC 2078&lt;/b&gt;
                  &lt;DD&gt;This class corresponds to the context level calls together with
                  the per message calls of RFC 2078. The gss_init_sec_context and
                  gss_accept_sec_context calls have been made simpler by only taking
                  required parameters.  The context can have its properties set before
                  the first call to initSecContext. The supplementary status codes for the
                  per-message operations are returned in an instance of the MessageProp
                  class, which is used as an argument in these calls.&lt;/dl&gt;                
            </javadoc>
            <declaration name="gssManager" type="GSSManagerImpl" line="92"/>
            <declaration name="initiator" type="boolean" line="93"/>
            <declaration name="PRE_INIT" type="int" line="96"/>
            <declaration name="IN_PROGRESS" type="int" line="97"/>
            <declaration name="READY" type="int" line="98"/>
            <declaration name="DELETED" type="int" line="99"/>
            <declaration name="currentState" type="int" line="102"/>
            <declaration name="mechCtxt" type="GSSContextSpi" line="104"/>
            <declaration name="mechOid" type="Oid" line="105"/>
            <declaration name="objId" type="ObjectIdentifier" line="106"/>
            <declaration name="myCred" type="GSSCredentialImpl" line="108"/>
            <declaration name="srcName" type="GSSNameImpl" line="110"/>
            <declaration name="targName" type="GSSNameImpl" line="111"/>
            <declaration name="reqLifetime" type="int" line="113"/>
            <declaration name="channelBindings" type="ChannelBinding" line="114"/>
            <declaration name="reqConfState" type="boolean" line="116"/>
            <declaration name="reqIntegState" type="boolean" line="117"/>
            <declaration name="reqMutualAuthState" type="boolean" line="118"/>
            <declaration name="reqReplayDetState" type="boolean" line="119"/>
            <declaration name="reqSequenceDetState" type="boolean" line="120"/>
            <declaration name="reqCredDelegState" type="boolean" line="121"/>
            <declaration name="reqAnonState" type="boolean" line="122"/>
            <declaration name="reqDelegPolicyState" type="boolean" line="123"/>
            <javadoc line="125">
                Creates a GSSContextImp on the context initiator&apos;s side.                
            </javadoc>
            <method name="GSSContextImpl" type="constructor" line="130">
                <params>
                    <param name="gssManager" type="GSSManagerImpl"/>
                    <param name="peer" type="GSSName"/>
                    <param name="mech" type="Oid"/>
                    <param name="myCred" type="GSSCredential"/>
                    <param name="lifetime" type="int"/>
                </params>
                <comment line="138">
                    XXX Check first                    
                </comment>
                <scope line="131"/>
            </method>
            <javadoc line="144">
                Creates a GSSContextImpl on the context acceptor&apos;s side.                
            </javadoc>
            <method name="GSSContextImpl" type="constructor" line="148">
                <params>
                    <param name="gssManager" type="GSSManagerImpl"/>
                    <param name="myCred" type="GSSCredential"/>
                </params>
                <comment line="151">
                    XXX Check first                    
                </comment>
            </method>
            <javadoc line="154">
                Creates a GSSContextImpl out of a previously exported
                  GSSContext.                
                <see>
                    #isTransferable                    
                </see>
            </javadoc>
            <method name="GSSContextImpl" type="constructor" line="161">
                <params>
                    <param name="gssManager" type="GSSManagerImpl"/>
                    <param name="interProcessToken" type="byte[]"/>
                </params>
            </method>
            <method name="initSecContext" type="byte[]" line="169">
                <params>
                    <param name="inputBuf" type="byte"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <comment line="171">
                    Size of ByteArrayOutputStream will double each time that extra
                     bytes are to be written. Usually, without delegation, a GSS
                     initial token containing the Kerberos AP-REQ is between 400 and
                     600 bytes.                    
                </comment>
                <declaration name="bos" type="ByteArrayOutputStream" line="176"/>
                <declaration name="bin" type="ByteArrayInputStream" line="177"/>
                <declaration name="size" type="int" line="179"/>
            </method>
            <method name="initSecContext" type="int" line="184">
                <params>
                    <param name="inStream" type="InputStream"/>
                    <param name="outStream" type="OutputStream"/>
                </params>
                <comment line="234">
                    do not parse GSS header for native provider or SPNEGO
                     mech                    
                </comment>
                <comment line="237">
                    parse GSS header                    
                </comment>
                <comment line="257">
                    do not add GSS header for native provider or SPNEGO
                     except for the first SPNEGO token                    
                </comment>
                <comment line="260">
                    add GSS header                    
                </comment>
                <scope line="186"/>
                <declaration name="gssHeader" type="GSSHeader" line="191"/>
                <declaration name="inTokenLen" type="int" line="192"/>
                <declaration name="credElement" type="GSSCredentialSpi" line="193"/>
                <declaration name="firstToken" type="boolean" line="194"/>
                <scope line="196">
                    <scope line="197">
                        <scope line="198">
                            <scope line="199"/>
                            <scope line="201">
                                <scope line="203"/>
                                <scope line="206"/>
                            </scope>
                        </scope>
                        <declaration name="nameElement" type="GSSNameSpi" line="211"/>
                    </scope>
                    <scope line="230">
                        <scope line="232"/>
                        <scope line="235"/>
                    </scope>
                    <declaration name="obuf" type="byte[]" line="248"/>
                    <declaration name="retVal" type="int" line="250"/>
                    <scope line="252">
                        <scope line="255"/>
                        <scope line="258"/>
                    </scope>
                </scope>
                <scope line="271"/>
            </method>
            <method name="acceptSecContext" type="byte[]" line="278">
                <params>
                    <param name="inTok" type="byte"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <comment line="281">
                    Usually initial GSS token containing a Kerberos AP-REP is less
                     than 100 bytes.                    
                </comment>
                <declaration name="bos" type="ByteArrayOutputStream" line="284"/>
                <declaration name="out" type="byte[]" line="287"/>
            </method>
            <method name="acceptSecContext" type="void" line="292">
                <params>
                    <param name="inStream" type="InputStream"/>
                    <param name="outStream" type="OutputStream"/>
                </params>
                <comment line="306">
                    mechOid will be null for an acceptor&apos;s context                    
                </comment>
                <comment line="310">
                    Convert ObjectIdentifier to Oid                    
                </comment>
                <comment line="315">
                    System.out.println(&quot;Entered GSSContextImpl.acceptSecContext&quot;
                                          + &quot; with mechanism = &quot; + mechOid);                    
                </comment>
                <comment line="329">
                    do not parse GSS header for native provider and SPNEGO                    
                </comment>
                <comment line="331">
                    parse GSS Header                    
                </comment>
                <comment line="349">
                    do not add GSS header for native provider and SPNEGO                    
                </comment>
                <comment line="351">
                    add GSS header                    
                </comment>
                <scope line="294"/>
                <declaration name="gssHeader" type="GSSHeader" line="299"/>
                <declaration name="inTokenLen" type="int" line="300"/>
                <declaration name="credElement" type="GSSCredentialSpi" line="301"/>
                <scope line="303">
                    <scope line="304">
                        <scope line="316"/>
                    </scope>
                    <scope line="325">
                        <scope line="327"/>
                        <scope line="329"/>
                    </scope>
                    <declaration name="obuf" type="byte[]" line="342"/>
                    <scope line="344">
                        <declaration name="retVal" type="int" line="345"/>
                        <scope line="347"/>
                        <scope line="349"/>
                    </scope>
                    <scope line="357"/>
                </scope>
                <scope line="360"/>
            </method>
            <method name="isEstablished" type="boolean" line="366"/>
            <method name="getWrapSizeLimit" type="int" line="374">
                <params>
                    <param name="qop" type="int"/>
                    <param name="confReq" type="boolean"/>
                    <param name="maxTokenSize" type="int"/>
                </params>
            </method>
            <method name="wrap" type="byte[]" line="383">
                <params>
                    <param name="inBuf" type="byte"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="wrap" type="void" line="392">
                <params>
                    <param name="inStream" type="InputStream"/>
                    <param name="outStream" type="OutputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="unwrap" type="byte[]" line="401">
                <params>
                    <param name="inBuf" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="unwrap" type="void" line="410">
                <params>
                    <param name="inStream" type="InputStream"/>
                    <param name="outStream" type="OutputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="getMIC" type="byte[]" line="419">
                <params>
                    <param name="inMsg" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="getMIC" type="void" line="428">
                <params>
                    <param name="inStream" type="InputStream"/>
                    <param name="outStream" type="OutputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="verifyMIC" type="void" line="438">
                <params>
                    <param name="inTok" type="byte[]"/>
                    <param name="tokOffset" type="int"/>
                    <param name="tokLen" type="int"/>
                    <param name="inMsg" type="byte[]"/>
                    <param name="msgOffset" type="int"/>
                    <param name="msgLen" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="verifyMIC" type="void" line="448">
                <params>
                    <param name="tokStream" type="InputStream"/>
                    <param name="msgStream" type="InputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
            </method>
            <method name="export" type="byte[]" line="456">
                <comment line="458">
                    Defaults to null to match old behavior                    
                </comment>
                <comment line="460">
                    Only allow context export from native provider since JGSS
                     still has not defined its own interprocess token format                    
                </comment>
                <declaration name="result" type="byte[]" line="458"/>
                <scope line="462"/>
            </method>
            <method name="requestMutualAuth" type="void" line="468">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestReplayDet" type="void" line="473">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestSequenceDet" type="void" line="478">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestCredDeleg" type="void" line="483">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestAnonymity" type="void" line="488">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestConf" type="void" line="493">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestInteg" type="void" line="498">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="requestLifetime" type="void" line="503">
                <params>
                    <param name="lifetime" type="int"/>
                </params>
            </method>
            <method name="setChannelBinding" type="void" line="509">
                <params>
                    <param name="channelBindings" type="ChannelBinding"/>
                </params>
            </method>
            <method name="getCredDelegState" type="boolean" line="516"/>
            <method name="getMutualAuthState" type="boolean" line="523"/>
            <method name="getReplayDetState" type="boolean" line="530"/>
            <method name="getSequenceDetState" type="boolean" line="537"/>
            <method name="getAnonymityState" type="boolean" line="544"/>
            <method name="isTransferable" type="boolean" line="551"/>
            <method name="isProtReady" type="boolean" line="558"/>
            <method name="getConfState" type="boolean" line="565"/>
            <method name="getIntegState" type="boolean" line="572"/>
            <method name="getLifetime" type="int" line="579"/>
            <method name="getSrcName" type="GSSName" line="586">
                <scope line="587"/>
            </method>
            <method name="getTargName" type="GSSName" line="594">
                <scope line="595"/>
            </method>
            <method name="getMech" type="Oid" line="602">
                <scope line="603"/>
            </method>
            <method name="getDelegCred" type="GSSCredential" line="609">
                <declaration name="delCredElement" type="GSSCredentialSpi" line="614"/>
            </method>
            <method name="isInitiator" type="boolean" line="619"/>
            <method name="dispose" type="void" line="623">
                <scope line="625"/>
            </method>
            <method name="inquireSecContext" type="Object" line="637">
                <params>
                    <param name="type" type="InquireType"/>
                </params>
                <declaration name="security" type="SecurityManager" line="638"/>
                <scope line="639"/>
                <scope line="642"/>
            </method>
            <method name="requestDelegPolicy" type="void" line="649">
                <params>
                    <param name="state" type="boolean"/>
                </params>
            </method>
            <method name="getDelegPolicyState" type="boolean" line="655"/>
        </class>
    </source>