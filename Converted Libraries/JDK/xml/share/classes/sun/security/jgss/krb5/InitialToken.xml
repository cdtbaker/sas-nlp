<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss.krb5">
        <import package="org.ietf.jgss"/>
        <import package="javax.security.auth.kerberos.DelegationPermission"/>
        <import package="java.io.IOException"/>
        <import package="java.net.InetAddress"/>
        <import package="java.net.Inet4Address"/>
        <import package="java.net.Inet6Address"/>
        <import package="java.security.MessageDigest"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <import package="java.util.Arrays"/>
        <import package="sun.security.krb5"/>
        <import package="sun.security.krb5.internal.Krb5"/>
        <class name="InitialToken" line="40">
            <extends class="Krb5Token"/>
            <declaration name="CHECKSUM_TYPE" type="int" line="42"/>
            <declaration name="CHECKSUM_LENGTH_SIZE" type="int" line="44"/>
            <declaration name="CHECKSUM_BINDINGS_SIZE" type="int" line="45"/>
            <declaration name="CHECKSUM_FLAGS_SIZE" type="int" line="46"/>
            <declaration name="CHECKSUM_DELEG_OPT_SIZE" type="int" line="47"/>
            <declaration name="CHECKSUM_DELEG_LGTH_SIZE" type="int" line="48"/>
            <declaration name="CHECKSUM_DELEG_FLAG" type="int" line="50"/>
            <declaration name="CHECKSUM_MUTUAL_FLAG" type="int" line="51"/>
            <declaration name="CHECKSUM_REPLAY_FLAG" type="int" line="52"/>
            <declaration name="CHECKSUM_SEQUENCE_FLAG" type="int" line="53"/>
            <declaration name="CHECKSUM_CONF_FLAG" type="int" line="54"/>
            <declaration name="CHECKSUM_INTEG_FLAG" type="int" line="55"/>
            <declaration name="CHECKSUM_FIRST_BYTES" type="byte[]" line="57"/>
            <declaration name="CHANNEL_BINDING_AF_INET" type="int" line="60"/>
            <declaration name="CHANNEL_BINDING_AF_INET6" type="int" line="61"/>
            <declaration name="CHANNEL_BINDING_AF_NULL_ADDR" type="int" line="62"/>
            <declaration name="Inet4_ADDRSZ" type="int" line="64"/>
            <declaration name="Inet6_ADDRSZ" type="int" line="65"/>
            <class name="OverloadedChecksum" line="67">
                <comment line="302">
                    check if KRB-CRED message should use NULL_KEY for encryption                    
                </comment>
                <comment line="320">
                    Only called by acceptor                    
                </comment>
                <declaration name="checksumBytes" type="byte[]" line="69"/>
                <declaration name="delegCreds" type="Credentials" line="70"/>
                <declaration name="flags" type="int" line="71"/>
                <javadoc line="73">
                    Called on the initiator side when creating the
                      InitSecContextToken.                    
                </javadoc>
                <method name="OverloadedChecksum" type="constructor" line="80">
                    <params>
                        <param name="context" type="Krb5Context"/>
                        <param name="tgt" type="Credentials"/>
                        <param name="serviceTicket" type="Credentials"/>
                    </params>
                    <comment line="94">
                        delegation not permitted by server policy, mark it                        
                    </comment>
                    <comment line="136">
                        System.out.println(&quot;ChannelBinding hash: &quot;
                                 + getHexBytes(localBindingsBytes));                        
                    </comment>
                    <comment line="166">
                        Cannot use &apos;\&quot;&apos; instead of &quot;\&quot;&quot; in constructor because
                         it is interpreted as suggested length!                        
                    </comment>
                    <comment line="181">
                        Write 1 in little endian but in two bytes
                         for DlgOpt                        
                    </comment>
                    <comment line="189">
                        Write the length of the delegated credential in little
                         endian but in two bytes for Dlgth                        
                    </comment>
                    <declaration name="krbCredMessage" type="byte[]" line="82"/>
                    <declaration name="pos" type="int" line="83"/>
                    <declaration name="size" type="int" line="84"/>
                    <scope line="87"/>
                    <scope line="90">
                        <scope line="91">
                            <scope line="92"/>
                        </scope>
                    </scope>
                    <scope line="97">
                        <scope line="98"/>
                        <scope line="100"/>
                    </scope>
                    <scope line="105">
                        <declaration name="krbCred" type="KrbCred" line="106"/>
                        <declaration name="cipherHelper" type="CipherHelper" line="107"/>
                        <scope line="109"/>
                        <scope line="112"/>
                    </scope>
                    <declaration name="localBindings" type="ChannelBinding" line="129"/>
                    <scope line="130">
                        <declaration name="localBindingsBytes" type="byte[]" line="131"/>
                    </scope>
                    <declaration name="temp" type="byte[]" line="154"/>
                    <scope line="161">
                        <declaration name="delegateTo" type="PrincipalName" line="163"/>
                        <declaration name="buf" type="StringBuffer" line="167"/>
                        <declaration name="realm" type="String" line="169"/>
                        <declaration name="sm" type="SecurityManager" line="172"/>
                        <scope line="173">
                            <declaration name="perm" type="DelegationPermission" line="174"/>
                        </scope>
                    </scope>
                </method>
                <javadoc line="206">
                    Called on the acceptor side when reading an InitSecContextToken.                    
                </javadoc>
                <method name="OverloadedChecksum" type="constructor" line="215">
                    <params>
                        <param name="context" type="Krb5Context"/>
                        <param name="checksum" type="Checksum"/>
                        <param name="key" type="EncryptionKey"/>
                        <param name="subKey" type="EncryptionKey"/>
                    </params>
                    <comment line="210">
                        XXX Passing in Checksum is not required. byte[] can
                         be passed in if this checksum type denotes a
                         raw_checksum. In that case, make Checksum class krb5
                         internal.                        
                    </comment>
                    <comment line="238">
                        Ignore remote channel binding info when not requested at
                         local side (RFC 4121 4.1.1.2: the acceptor MAY ignore...).
                        
                         All major krb5 implementors implement this &quot;MAY&quot;,
                         and some applications depend on it as a workaround
                         for not having a way to negotiate the use of channel
                         binding -- the initiator application always uses CB
                         and hopes the acceptor will ignore the CB if the
                         acceptor doesn&apos;t support CB.                        
                    </comment>
                    <comment line="271">
                        XXX
                         if ((checksumBytes[24] != (byte)0x01) &amp;&amp;
                         (checksumBytes[25] != (byte)0x00))                        
                    </comment>
                    <declaration name="pos" type="int" line="217"/>
                    <scope line="219">
                        <declaration name="ge" type="GSSException" line="220"/>
                    </scope>
                    <scope line="230"/>
                    <declaration name="localBindings" type="ChannelBinding" line="235"/>
                    <scope line="246">
                        <declaration name="remoteBindingBytes" type="byte[]" line="247"/>
                        <declaration name="noBindings" type="byte[]" line="251"/>
                        <scope line="252">
                            <declaration name="localBindingsBytes" type="byte[]" line="253"/>
                            <scope line="256"/>
                        </scope>
                        <scope line="260"/>
                    </scope>
                    <scope line="268">
                        <declaration name="credLen" type="int" line="276"/>
                        <declaration name="credBytes" type="byte[]" line="277"/>
                        <declaration name="cipherHelper" type="CipherHelper" line="280"/>
                        <scope line="281"/>
                        <scope line="285">
                            <declaration name="cred" type="KrbCred" line="286"/>
                            <scope line="287"/>
                            <scope line="289">
                                <scope line="290"/>
                                <scope line="292"/>
                            </scope>
                        </scope>
                    </scope>
                </method>
                <method name="useNullKey" type="boolean" line="302">
                    <params>
                        <param name="ch" type="CipherHelper"/>
                    </params>
                    <comment line="305">
                        for &quot;newer&quot; etypes and RC4-HMAC do not use NULL KEY                        
                    </comment>
                    <declaration name="flag" type="boolean" line="303"/>
                    <scope line="305"/>
                </method>
                <method name="getChecksum" type="Checksum" line="311"/>
                <method name="getDelegatedCreds" type="Credentials" line="315"/>
                <method name="setContextFlags" type="void" line="320">
                    <params>
                        <param name="context" type="Krb5Context"/>
                    </params>
                    <comment line="322">
                        default for cred delegation is false                        
                    </comment>
                    <comment line="325">
                        default for the following are true                        
                    </comment>
                    <scope line="325"/>
                    <scope line="328"/>
                    <scope line="331"/>
                    <scope line="334"/>
                    <scope line="337"/>
                </method>
            </class>
            <method name="getAddrType" type="int" line="343">
                <params>
                    <param name="addr" type="InetAddress"/>
                </params>
                <declaration name="addressType" type="int" line="344"/>
            </method>
            <method name="getAddrBytes" type="byte[]" line="353">
                <params>
                    <param name="addr" type="InetAddress"/>
                </params>
                <declaration name="addressType" type="int" line="354"/>
                <declaration name="addressBytes" type="byte[]" line="355"/>
                <scope line="356">
                    <scope line="359"/>
                    <scope line="365"/>
                </scope>
            </method>
            <method name="computeChannelBinding" type="byte[]" line="379">
                <params>
                    <param name="channelBinding" type="ChannelBinding"/>
                </params>
                <comment line="420">
                    Write length 0                    
                </comment>
                <comment line="434">
                    Write length 0                    
                </comment>
                <comment line="445">
                    Write 0                    
                </comment>
                <declaration name="initiatorAddress" type="InetAddress" line="381"/>
                <declaration name="acceptorAddress" type="InetAddress" line="382"/>
                <declaration name="size" type="int" line="383"/>
                <declaration name="initiatorAddressType" type="int" line="385"/>
                <declaration name="acceptorAddressType" type="int" line="386"/>
                <declaration name="initiatorAddressBytes" type="byte[]" line="388"/>
                <scope line="389"/>
                <declaration name="acceptorAddressBytes" type="byte[]" line="394"/>
                <scope line="395"/>
                <declaration name="appDataBytes" type="byte[]" line="400"/>
                <scope line="401"/>
                <declaration name="data" type="byte[]" line="405"/>
                <declaration name="pos" type="int" line="407"/>
                <scope line="412"/>
                <scope line="418"/>
                <scope line="426"/>
                <scope line="432"/>
                <scope line="437"/>
                <scope line="443"/>
                <scope line="448">
                    <declaration name="md5" type="MessageDigest" line="449"/>
                </scope>
                <scope line="451"/>
            </method>
            <method name="encode" type="byte[]" line="458"/>
        </class>
    </source>