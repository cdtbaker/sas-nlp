<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss">
        <import package="com.sun.security.auth.callback.TextCallbackHandler"/>
        <import package="javax.security.auth.Subject"/>
        <import package="javax.security.auth.kerberos.KerberosPrincipal"/>
        <import package="javax.security.auth.kerberos.KerberosTicket"/>
        <import package="javax.security.auth.kerberos.KerberosKey"/>
        <import package="org.ietf.jgss"/>
        <import package="sun.security.jgss.spi.GSSNameSpi"/>
        <import package="sun.security.jgss.spi.GSSCredentialSpi"/>
        <import package="sun.security.action.GetPropertyAction"/>
        <import package="sun.security.jgss.krb5.Krb5NameElement"/>
        <import package="sun.security.jgss.spnego.SpNegoCredElement"/>
        <import package="java.util.Set"/>
        <import package="java.util.HashSet"/>
        <import package="java.util.Vector"/>
        <import package="java.util.Iterator"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.AccessControlContext"/>
        <import package="java.security.PrivilegedExceptionAction"/>
        <import package="java.security.PrivilegedActionException"/>
        <import package="javax.security.auth.callback.CallbackHandler"/>
        <import package="javax.security.auth.login.LoginContext"/>
        <import package="javax.security.auth.login.LoginException"/>
        <import package="sun.security.action.GetBooleanAction"/>
        <class name="GSSUtil" line="25">
            <javadoc line="25">
                The GSSUtilImplementation that knows how to work with the internals of
                  the GSS-API.                
            </javadoc>
            <declaration name="GSS_KRB5_MECH_OID" type="Oid" line="30"/>
            <declaration name="GSS_KRB5_MECH_OID2" type="Oid" line="31"/>
            <declaration name="GSS_SPNEGO_MECH_OID" type="Oid" line="32"/>
            <declaration name="NT_GSS_KRB5_PRINCIPAL" type="Oid" line="33"/>
            <declaration name="DEFAULT_HANDLER" type="String" line="34"/>
            <declaration name="DEBUG" type="boolean" line="35"/>
            <scope line="36"/>
            <method name="debug" type="void" line="39">
                <params>
                    <param name="message" type="String"/>
                </params>
                <scope line="40"/>
            </method>
            <method name="createOid" type="Oid" line="45">
                <params>
                    <param name="oidStr" type="String"/>
                </params>
                <scope line="46"/>
                <scope line="49"/>
            </method>
            <method name="isSpNegoMech" type="boolean" line="54">
                <params>
                    <param name="oid" type="Oid"/>
                </params>
            </method>
            <method name="isKerberosMech" type="boolean" line="57">
                <params>
                    <param name="oid" type="Oid"/>
                </params>
            </method>
            <method name="getMechStr" type="String" line="60">
                <params>
                    <param name="oid" type="Oid"/>
                </params>
                <scope line="61"/>
                <scope line="64"/>
                <scope line="67"/>
            </method>
            <javadoc line="71">
                Note: The current impl only works with Sun&apos;s impl of
                  GSSName and GSSCredential since it depends on package
                  private APIs.                
            </javadoc>
            <method name="getSubject" type="Subject" line="76">
                <params>
                    <param name="name" type="GSSName"/>
                    <param name="creds" type="GSSCredential"/>
                </params>
                <declaration name="privCredentials" type="HashSet&lt;Object&gt;" line="77"/>
                <declaration name="pubCredentials" type="HashSet&lt;Object&gt;" line="78"/>
                <declaration name="gssCredentials" type="Set&lt;GSSCredentialSpi&gt;" line="79"/>
                <declaration name="krb5Principals" type="Set&lt;KerberosPrincipal&gt;" line="80"/>
                <scope line="81">
                    <scope line="82">
                        <declaration name="ne" type="GSSNameSpi" line="83"/>
                        <declaration name="krbName" type="String" line="84"/>
                        <scope line="85"/>
                        <declaration name="krbPrinc" type="KerberosPrincipal" line="88"/>
                    </scope>
                    <scope line="91"/>
                </scope>
                <scope line="95"/>
                <scope line="100"/>
            </method>
            <javadoc line="109">
                Populates the set credentials with elements from gssCredentials. At
                  the same time, it converts any subclasses of KerberosTicket
                  into KerberosTicket instances and any subclasses of KerberosKey into
                  KerberosKey instances. (It is not desirable to expose the customer
                  to sun.security.jgss.krb5.Krb5InitCredential which extends
                  KerberosTicket and sun.security.jgss.krb5.Kbr5AcceptCredential which
                  extends KerberosKey.)                
            </javadoc>
            <method name="populateCredentials" type="void" line="118">
                <params>
                    <param name="credentials" type="Set<Object>"/>
                    <param name="gssCredentials" type="Set<?>"/>
                </params>
                <declaration name="cred" type="Object" line="119"/>
                <declaration name="elements" type="Iterator&lt;?&gt;" line="120"/>
                <scope line="121">
                    <scope line="123"/>
                    <scope line="126">
                        <scope line="127">
                            <declaration name="tempTkt" type="KerberosTicket" line="128"/>
                        </scope>
                    </scope>
                    <scope line="133">
                        <scope line="134">
                            <declaration name="tempKey" type="KerberosKey" line="135"/>
                        </scope>
                    </scope>
                    <scope line="140"/>
                </scope>
            </method>
            <javadoc line="145">
                Authenticate using the login module from the specified
                  configuration entry.                
                <param>
                    caller the caller of JAAS Login                    
                </param>
                <param>
                    mech the mech to be used                    
                </param>
                <return>
                    the authenticated subject                    
                </return>
            </javadoc>
            <method name="login" type="Subject" line="152">
                <params>
                    <param name="caller" type="GSSCaller"/>
                    <param name="mech" type="Oid"/>
                </params>
                <declaration name="cb" type="CallbackHandler" line="153"/>
                <scope line="154"/>
                <scope line="157">
                    <declaration name="defaultHandler" type="String" line="158"/>
                    <scope line="159"/>
                    <scope line="162"/>
                </scope>
                <declaration name="lc" type="LoginContext" line="166"/>
            </method>
            <javadoc line="170">
                Determines if the application doesn&apos;t mind if the mechanism obtains
                  the required credentials from outside of the current Subject. Our
                  Kerberos v5 mechanism would do a JAAS login on behalf of the
                  application if this were the case.
                  The application indicates this by explicitly setting the system
                  property javax.security.auth.useSubjectCredsOnly to false.                
            </javadoc>
            <method name="useSubjectCredsOnly" type="boolean" line="178">
                <params>
                    <param name="caller" type="GSSCaller"/>
                </params>
                <scope line="179"/>
                <declaration name="propValue" type="String" line="182"/>
            </method>
            <javadoc line="185">
                Determines the SPNEGO interoperability mode with Microsoft;
                  by default it is set to true.
                  To disable it, the application indicates this by explicitly setting
                  the system property sun.security.spnego.interop to false.                
            </javadoc>
            <method name="useMSInterop" type="boolean" line="191">
                <declaration name="propValue" type="String" line="192"/>
            </method>
            <javadoc line="195">
                Searches the private credentials of current Subject with the
                  specified criteria and returns the matching GSSCredentialSpi
                  object out of Sun&apos;s impl of GSSCredential. Returns null if
                  no Subject present or a Vector which contains 0 or more
                  matching GSSCredentialSpi objects.                
            </javadoc>
            <method name="searchSubject" type="Vector" line="202">
                <params>
                    <param name="name" type="GSSNameSpi"/>
                    <param name="mech" type="Oid"/>
                    <param name="initiate" type="boolean"/>
                    <param name="credCls" type="Class"/>
                </params>
                <declaration name="acc" type="AccessControlContext" line="204"/>
                <scope line="205">
                    <anonymous_class line="206">
                        <method name="run" type="Vector" line="207">
                            <declaration name="accSubj" type="Subject" line="208"/>
                            <declaration name="result" type="Vector&lt;GSSCredentialSpi&gt;" line="209"/>
                            <scope line="210">
                                <declaration name="iterator" type="Iterator&lt;GSSCredentialImpl&gt;" line="212"/>
                                <scope line="213">
                                    <declaration name="cred" type="GSSCredentialImpl" line="214"/>
                                    <scope line="216">
                                        <declaration name="ce" type="GSSCredentialSpi" line="217"/>
                                        <scope line="219"/>
                                        <scope line="222"/>
                                    </scope>
                                    <scope line="226"/>
                                </scope>
                            </scope>
                        </method>
                    </anonymous_class>
                    <declaration name="creds" type="Vector" line="206"/>
                </scope>
                <scope line="238"/>
            </method>
        </class>
    </source>