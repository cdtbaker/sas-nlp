<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss.spnego">
        <import package="com.sun.security.jgss.ExtendedGSSContext"/>
        <import package="com.sun.security.jgss.InquireType"/>
        <import package="java.io"/>
        <import package="java.security.Provider"/>
        <import package="org.ietf.jgss"/>
        <import package="sun.security.jgss"/>
        <import package="sun.security.jgss.spi"/>
        <import package="sun.security.util"/>
        <class name="SpNegoContext" line="10">
            <implements interface="GSSContextSpi"/>
            <javadoc line="10">
                Implements the mechanism specific context class for SPNEGO
                  GSS-API mechanism                
                <author>
                    Seema Malkani                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <declaration name="STATE_NEW" type="int" line="17"/>
            <declaration name="STATE_IN_PROCESS" type="int" line="18"/>
            <declaration name="STATE_DONE" type="int" line="19"/>
            <declaration name="STATE_DELETED" type="int" line="20"/>
            <declaration name="state" type="int" line="21"/>
            <declaration name="credDelegState" type="boolean" line="22"/>
            <declaration name="mutualAuthState" type="boolean" line="23"/>
            <declaration name="replayDetState" type="boolean" line="24"/>
            <declaration name="sequenceDetState" type="boolean" line="25"/>
            <declaration name="confState" type="boolean" line="26"/>
            <declaration name="integState" type="boolean" line="27"/>
            <declaration name="delegPolicyState" type="boolean" line="28"/>
            <declaration name="peerName" type="GSSNameSpi" line="29"/>
            <declaration name="myName" type="GSSNameSpi" line="30"/>
            <declaration name="myCred" type="SpNegoCredElement" line="31"/>
            <declaration name="mechContext" type="GSSContext" line="32"/>
            <declaration name="DER_mechTypes" type="byte[]" line="33"/>
            <declaration name="lifetime" type="int" line="34"/>
            <declaration name="channelBinding" type="ChannelBinding" line="35"/>
            <declaration name="initiator" type="boolean" line="36"/>
            <declaration name="internal_mech" type="Oid" line="37"/>
            <declaration name="factory" type="SpNegoMechFactory" line="38"/>
            <declaration name="DEBUG" type="boolean" line="39"/>
            <javadoc line="40">
                Constructor for SpNegoContext to be called on the context initiator&apos;s
                  side.                
            </javadoc>
            <method name="SpNegoContext" type="constructor" line="44">
                <params>
                    <param name="factory" type="SpNegoMechFactory"/>
                    <param name="peerName" type="GSSNameSpi"/>
                    <param name="myCred" type="GSSCredentialSpi"/>
                    <param name="lifetime" type="int"/>
                </params>
                <scope line="46"/>
            </method>
            <javadoc line="55">
                Constructor for SpNegoContext to be called on the context acceptor&apos;s
                  side.                
            </javadoc>
            <method name="SpNegoContext" type="constructor" line="59">
                <params>
                    <param name="factory" type="SpNegoMechFactory"/>
                    <param name="myCred" type="GSSCredentialSpi"/>
                </params>
                <scope line="60"/>
            </method>
            <javadoc line="67">
                Constructor for SpNegoContext to import a previously exported context.                
            </javadoc>
            <method name="SpNegoContext" type="constructor" line="70">
                <params>
                    <param name="factory" type="SpNegoMechFactory"/>
                    <param name="interProcessToken" type="byte[]"/>
                </params>
            </method>
            <javadoc line="73">
                Requests that confidentiality be available.                
            </javadoc>
            <method name="requestConf" type="void" line="76">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <javadoc line="79">
                Is confidentiality available?                
            </javadoc>
            <method name="getConfState" type="boolean" line="82"/>
            <javadoc line="85">
                Requests that integrity be available.                
            </javadoc>
            <method name="requestInteg" type="void" line="88">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <javadoc line="91">
                Requests that deleg policy be respected.                
            </javadoc>
            <method name="requestDelegPolicy" type="void" line="94">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <javadoc line="97">
                Is integrity available?                
            </javadoc>
            <method name="getIntegState" type="boolean" line="100"/>
            <javadoc line="103">
                Is deleg policy respected?                
            </javadoc>
            <method name="getDelegPolicyState" type="boolean" line="106">
                <scope line="107"/>
                <scope line="110"/>
            </method>
            <javadoc line="114">
                Requests that credential delegation be done during context
                  establishment.                
            </javadoc>
            <method name="requestCredDeleg" type="void" line="118">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <javadoc line="121">
                Is credential delegation enabled?                
            </javadoc>
            <method name="getCredDelegState" type="boolean" line="124">
                <scope line="125"/>
                <scope line="128"/>
            </method>
            <javadoc line="132">
                Requests that mutual authentication be done during context
                  establishment. Since this is fromm the client&apos;s perspective, it
                  essentially requests that the server be authenticated.                
            </javadoc>
            <method name="requestMutualAuth" type="void" line="137">
                <params>
                    <param name="value" type="boolean"/>
                </params>
                <scope line="138"/>
            </method>
            <javadoc line="142">
                Is mutual authentication enabled? Since this is from the client&apos;s
                  perspective, it essentially meas that the server is being
                  authenticated.                
            </javadoc>
            <method name="getMutualAuthState" type="boolean" line="147"/>
            <javadoc line="150">
                Returns the mechanism oid.                
                <return>
                    the Oid of this context                    
                </return>
            </javadoc>
            <method name="getMech" type="Oid" line="154">
                <scope line="155"/>
            </method>
            <method name="getNegotiatedMech" type="Oid" line="160"/>
            <method name="getProvider" type="Provider" line="163"/>
            <method name="dispose" type="void" line="166"/>
            <javadoc line="170">
                Tests if this is the initiator side of the context.                
                <return>
                    boolean indicating if this is initiator (true)
                      or target (false)                    
                </return>
            </javadoc>
            <method name="isInitiator" type="boolean" line="175"/>
            <javadoc line="178">
                Tests if the context can be used for per-message service.
                  Context may allow the calls to the per-message service
                  functions before being fully established.                
                <return>
                    boolean indicating if per-message methods can
                      be called.                    
                </return>
            </javadoc>
            <method name="isProtReady" type="boolean" line="185"/>
            <javadoc line="188">
                Initiator context establishment call. This method may be
                  required to be called several times. A CONTINUE_NEEDED return
                  call indicates that more calls are needed after the next token
                  is received from the peer.                
                <param>
                    is contains the token received from the peer. On the
                      first call it will be ignored.                    
                </param>
                <return>
                    any token required to be sent to the peer
                      It is responsibility of the caller to send the token
                      to its peer for processing.                    
                </return>
                <exception>
                    GSSException                    
                </exception>
            </javadoc>
            <method name="initSecContext" type="byte[]" line="200">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="mechTokenSize" type="int"/>
                </params>
                <declaration name="retVal" type="byte[]" line="201"/>
                <declaration name="initToken" type="NegTokenInit" line="202"/>
                <declaration name="mechToken" type="byte[]" line="203"/>
                <declaration name="errorCode" type="int" line="204"/>
                <scope line="205"/>
                <scope line="208"/>
                <scope line="211">
                    <scope line="212">
                        <declaration name="mechList" type="Oid[]" line="215"/>
                        <scope line="221"/>
                    </scope>
                    <scope line="226">
                        <scope line="228"/>
                        <declaration name="server_token" type="byte[]" line="232"/>
                        <scope line="234"/>
                        <declaration name="targToken" type="NegTokenTarg" line="237"/>
                        <scope line="238"/>
                        <scope line="242"/>
                        <declaration name="negoResult" type="SpNegoToken.NegoResult" line="245"/>
                        <declaration name="result" type="int" line="246"/>
                        <scope line="265"/>
                        <scope line="269">
                            <declaration name="accept_token" type="byte[]" line="270"/>
                            <scope line="271">
                                <scope line="272"/>
                            </scope>
                            <scope line="276"/>
                            <scope line="279">
                                <declaration name="micToken" type="byte[]" line="280"/>
                                <scope line="281"/>
                            </scope>
                            <scope line="285">
                                <scope line="288"/>
                            </scope>
                            <scope line="292">
                                <scope line="294"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="301">
                        <scope line="302"/>
                    </scope>
                    <scope line="306">
                        <scope line="307"/>
                    </scope>
                </scope>
                <scope line="312">
                    <declaration name="gssException" type="GSSException" line="313"/>
                </scope>
                <scope line="317">
                    <declaration name="gssException" type="GSSException" line="318"/>
                </scope>
            </method>
            <javadoc line="324">
                Acceptor&apos;s context establishment call. This method may be
                  required to be called several times. A CONTINUE_NEEDED return
                  call indicates that more calls are needed after the next token
                  is received from the peer.                
                <param>
                    is contains the token received from the peer.                    
                </param>
                <return>
                    any token required to be sent to the peer
                      It is responsibility of the caller to send the token
                      to its peer for processing.                    
                </return>
                <exception>
                    GSSException                    
                </exception>
            </javadoc>
            <method name="acceptSecContext" type="byte[]" line="335">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="mechTokenSize" type="int"/>
                </params>
                <declaration name="retVal" type="byte[]" line="336"/>
                <declaration name="negoResult" type="SpNegoToken.NegoResult" line="337"/>
                <declaration name="valid" type="boolean" line="338"/>
                <scope line="339"/>
                <scope line="342"/>
                <scope line="345">
                    <scope line="346">
                        <declaration name="token" type="byte[]" line="348"/>
                        <scope line="350"/>
                        <declaration name="initToken" type="NegTokenInit" line="353"/>
                        <scope line="354"/>
                        <declaration name="mechList" type="Oid[]" line="357"/>
                        <scope line="359"/>
                        <declaration name="mechToken" type="byte[]" line="362"/>
                        <declaration name="supported_mechSet" type="Oid[]" line="363"/>
                        <declaration name="mech_wanted" type="Oid" line="364"/>
                        <scope line="365"/>
                        <declaration name="accept_token" type="byte[]" line="369"/>
                        <scope line="370"/>
                        <scope line="373">
                            <scope line="374">
                                <scope line="378"/>
                            </scope>
                            <scope line="382"/>
                        </scope>
                        <scope line="387"/>
                        <scope line="391"/>
                        <declaration name="targToken" type="NegTokenTarg" line="395"/>
                        <scope line="396"/>
                    </scope>
                    <scope line="401">
                        <declaration name="client_token" type="byte[]" line="402"/>
                        <declaration name="accept_token" type="byte[]" line="404"/>
                        <scope line="405"/>
                        <scope line="408">
                            <scope line="409"/>
                            <scope line="413"/>
                        </scope>
                        <scope line="418"/>
                        <declaration name="targToken" type="NegTokenTarg" line="422"/>
                        <scope line="423"/>
                    </scope>
                    <scope line="428">
                        <scope line="429"/>
                    </scope>
                    <scope line="433"/>
                </scope>
                <scope line="437">
                    <declaration name="gssException" type="GSSException" line="438"/>
                </scope>
                <scope line="442"/>
            </method>
            <javadoc line="447">
                obtain the available mechanisms                
            </javadoc>
            <method name="getAvailableMechs" type="Oid[]" line="450">
                <scope line="451">
                    <declaration name="mechs" type="Oid[]" line="452"/>
                </scope>
                <scope line="456"/>
            </method>
            <javadoc line="460">
                get ther DER encoded MechList                
            </javadoc>
            <method name="getEncodedMechs" type="byte[]" line="463">
                <params>
                    <param name="mechSet" type="Oid[]"/>
                </params>
                <declaration name="mech" type="DerOutputStream" line="464"/>
                <scope line="465">
                    <declaration name="mechType" type="byte[]" line="466"/>
                </scope>
                <declaration name="mechTypeList" type="DerOutputStream" line="469"/>
                <declaration name="encoded" type="byte[]" line="471"/>
            </method>
            <javadoc line="474">
                get the context flags                
            </javadoc>
            <method name="getContextFlags" type="BitArray" line="477">
                <declaration name="out" type="BitArray" line="478"/>
            </method>
            <method name="setContextFlags" type="void" line="487">
                <scope line="488">
                    <scope line="489"/>
                    <scope line="492"/>
                    <scope line="495"/>
                    <scope line="498"/>
                    <scope line="501"/>
                    <scope line="504"/>
                </scope>
            </method>
            <javadoc line="509">
                verify MIC on MechList                
            </javadoc>
            <method name="verifyMechListMIC" type="boolean" line="512">
                <params>
                    <param name="mechTypes" type="byte[]"/>
                    <param name="token" type="byte[]"/>
                </params>
                <scope line="513">
                    <scope line="514"/>
                </scope>
                <scope line="519">
                    <scope line="520"/>
                </scope>
                <declaration name="valid" type="boolean" line="525"/>
                <scope line="526">
                    <declaration name="prop" type="MessageProp" line="527"/>
                </scope>
                <scope line="531">
                    <scope line="533"/>
                </scope>
            </method>
            <javadoc line="539">
                call gss_init_sec_context for the corresponding underlying mechanism                
            </javadoc>
            <method name="GSS_initSecContext" type="byte[]" line="542">
                <params>
                    <param name="token" type="byte[]"/>
                </params>
                <declaration name="tok" type="byte[]" line="543"/>
                <scope line="544">
                    <declaration name="serverName" type="GSSName" line="545"/>
                    <declaration name="cred" type="GSSCredential" line="546"/>
                    <scope line="547"/>
                    <scope line="557"/>
                </scope>
                <scope line="561"/>
                <scope line="564"/>
                <declaration name="init_token" type="byte[]" line="567"/>
            </method>
            <javadoc line="570">
                call gss_accept_sec_context for the corresponding underlying mechanism                
            </javadoc>
            <method name="GSS_acceptSecContext" type="byte[]" line="573">
                <params>
                    <param name="token" type="byte[]"/>
                </params>
                <scope line="574">
                    <declaration name="cred" type="GSSCredential" line="575"/>
                    <scope line="576"/>
                </scope>
                <declaration name="accept_token" type="byte[]" line="581"/>
            </method>
            <javadoc line="584">
                This routine compares the recieved mechset to the mechset that
                  this server can support. It looks sequentially through the mechset
                  and the first one that matches what the server can support is
                  chosen as the negotiated mechanism. If one is found, negResult
                  is set to ACCEPT_COMPLETE, otherwise we return NULL and negResult
                  is set to REJECT.                
            </javadoc>
            <method name="negotiate_mech_type" type="Oid" line="592">
                <params>
                    <param name="supported_mechSet" type="Oid[]"/>
                    <param name="mechSet" type="Oid[]"/>
                </params>
                <scope line="593">
                    <scope line="594">
                        <scope line="595">
                            <scope line="596"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="isEstablished" type="boolean" line="605"/>
            <method name="isMechContextEstablished" type="boolean" line="608">
                <scope line="609"/>
                <scope line="612">
                    <scope line="613"/>
                </scope>
            </method>
            <method name="export" type="byte[]" line="619"/>
            <javadoc line="622">
                Sets the channel bindings to be used during context
                  establishment.                
            </javadoc>
            <method name="setChannelBinding" type="void" line="626">
                <params>
                    <param name="channelBinding" type="ChannelBinding"/>
                </params>
            </method>
            <method name="getChannelBinding" type="ChannelBinding" line="629"/>
            <method name="requestAnonymity" type="void" line="632">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <method name="getAnonymityState" type="boolean" line="634"/>
            <javadoc line="637">
                Requests the desired lifetime. Can only be used on the context
                  initiator&apos;s side.                
            </javadoc>
            <method name="requestLifetime" type="void" line="641">
                <params>
                    <param name="lifetime" type="int"/>
                </params>
            </method>
            <javadoc line="644">
                The lifetime remaining for this context.                
            </javadoc>
            <method name="getLifetime" type="int" line="647">
                <scope line="648"/>
                <scope line="651"/>
            </method>
            <method name="isTransferable" type="boolean" line="655"/>
            <javadoc line="658">
                Requests that sequence checking be done on the GSS wrap and MIC
                  tokens.                
            </javadoc>
            <method name="requestSequenceDet" type="void" line="662">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <javadoc line="665">
                Is sequence checking enabled on the GSS Wrap and MIC tokens?
                  We enable sequence checking if replay detection is enabled.                
            </javadoc>
            <method name="getSequenceDetState" type="boolean" line="669"/>
            <javadoc line="672">
                Requests that replay detection be done on the GSS wrap and MIC
                  tokens.                
            </javadoc>
            <method name="requestReplayDet" type="void" line="676">
                <params>
                    <param name="value" type="boolean"/>
                </params>
            </method>
            <javadoc line="679">
                Is replay detection enabled on the GSS wrap and MIC tokens?
                  We enable replay detection if sequence checking is enabled.                
            </javadoc>
            <method name="getReplayDetState" type="boolean" line="683"/>
            <method name="getTargName" type="GSSNameSpi" line="686">
                <scope line="687">
                    <declaration name="targName" type="GSSNameImpl" line="688"/>
                </scope>
                <scope line="692">
                    <scope line="693"/>
                </scope>
            </method>
            <method name="getSrcName" type="GSSNameSpi" line="699">
                <scope line="700">
                    <declaration name="srcName" type="GSSNameImpl" line="701"/>
                </scope>
                <scope line="705">
                    <scope line="706"/>
                </scope>
            </method>
            <javadoc line="712">
                Returns the delegated credential for the context. This
                  is an optional feature of contexts which not all
                  mechanisms will support. A context can be requested to
                  support credential delegation by using the &lt;b&gt;CRED_DELEG&lt;/b&gt;.
                  This is only valid on the acceptor side of the context.                
                <return>
                    GSSCredentialSpi object for the delegated credential                    
                </return>
                <exception>
                    GSSException                    
                </exception>
                <see>
                    GSSContext#getDelegCredState                    
                </see>
            </javadoc>
            <method name="getDelegCred" type="GSSCredentialSpi" line="722">
                <scope line="724">
                    <declaration name="delegCred" type="GSSCredentialImpl" line="725"/>
                    <declaration name="initiate" type="boolean" line="726"/>
                    <scope line="727"/>
                    <declaration name="mechCred" type="GSSCredentialSpi" line="730"/>
                    <declaration name="cred" type="SpNegoCredElement" line="731"/>
                </scope>
                <scope line="734"/>
            </method>
            <method name="getWrapSizeLimit" type="int" line="738">
                <params>
                    <param name="qop" type="int"/>
                    <param name="confReq" type="boolean"/>
                    <param name="maxTokSize" type="int"/>
                </params>
                <scope line="739"/>
                <scope line="742"/>
            </method>
            <method name="wrap" type="byte[]" line="746">
                <params>
                    <param name="inBuf" type="byte"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="747"/>
                <scope line="750"/>
            </method>
            <method name="wrap" type="void" line="754">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="os" type="OutputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="755"/>
                <scope line="758"/>
            </method>
            <method name="unwrap" type="byte[]" line="762">
                <params>
                    <param name="inBuf" type="byte"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="763"/>
                <scope line="766"/>
            </method>
            <method name="unwrap" type="void" line="770">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="os" type="OutputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="771"/>
                <scope line="774"/>
            </method>
            <method name="getMIC" type="byte[]" line="778">
                <params>
                    <param name="inMsg" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="779"/>
                <scope line="782"/>
            </method>
            <method name="getMIC" type="void" line="786">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="os" type="OutputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="787"/>
                <scope line="790"/>
            </method>
            <method name="verifyMIC" type="void" line="794">
                <params>
                    <param name="inTok" type="byte[]"/>
                    <param name="tokOffset" type="int"/>
                    <param name="tokLen" type="int"/>
                    <param name="inMsg" type="byte[]"/>
                    <param name="msgOffset" type="int"/>
                    <param name="msgLen" type="int"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="795"/>
                <scope line="798"/>
            </method>
            <method name="verifyMIC" type="void" line="802">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="msgStr" type="InputStream"/>
                    <param name="msgProp" type="MessageProp"/>
                </params>
                <scope line="803"/>
                <scope line="806"/>
            </method>
            <method name="printState" type="String" line="810">
                <params>
                    <param name="state" type="int"/>
                </params>
            </method>
            <javadoc line="824">
                Retrieve attribute of the context for {@code type}.                
            </javadoc>
            <method name="inquireSecContext" type="Object" line="827">
                <params>
                    <param name="type" type="InquireType"/>
                </params>
                <scope line="828"/>
                <scope line="831"/>
                <scope line="834"/>
            </method>
        </class>
    </source>