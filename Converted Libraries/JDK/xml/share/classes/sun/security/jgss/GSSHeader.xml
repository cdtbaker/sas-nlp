<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss">
        <import package="org.ietf.jgss.GSSException"/>
        <import package="java.io.InputStream"/>
        <import package="java.io.OutputStream"/>
        <import package="java.io.IOException"/>
        <import package="sun.security.util"/>
        <class name="GSSHeader" line="7">
            <javadoc line="7">
                This class represents the mechanism independent part of a GSS-API
                  context establishment token. Some mechanisms may choose to encode
                  all subsequent tokens as well such that they start with an encoding
                  of an instance of this class. e.g., The Kerberos v5 GSS-API Mechanism
                  uses this header for all GSS-API tokens.
                  &lt;p&gt;
                  The format is specified in RFC 2743 section 3.1.                
                <author>
                    Mayank Upadhyay                    
                </author>
            </javadoc>
            <declaration name="mechOid" type="ObjectIdentifier" line="18"/>
            <declaration name="mechOidBytes" type="byte[]" line="19"/>
            <declaration name="mechTokenLength" type="int" line="20"/>
            <declaration name="TOKEN_ID" type="int" line="21"/>
            <javadoc line="21">
                The tag defined in the GSS-API mechanism independent token
                  format.                
            </javadoc>
            <javadoc line="26">
                Creates a GSSHeader instance whose encoding can be used as the
                  prefix for a particular mechanism token.                
                <param>
                    mechOid the Oid of the mechanism which generated the token                    
                </param>
                <param>
                    mechTokenLength the length of the subsequent portion that
                      the mechanism will be adding.                    
                </param>
            </javadoc>
            <method name="GSSHeader" type="constructor" line="33">
                <params>
                    <param name="mechOid" type="ObjectIdentifier"/>
                    <param name="mechTokenLength" type="int"/>
                </params>
                <declaration name="temp" type="DerOutputStream" line="35"/>
            </method>
            <javadoc line="40">
                Reads in a GSSHeader from an InputStream. Typically this would be
                  used as part of reading the complete token from an InputStream
                  that is obtained from a socket.                
            </javadoc>
            <method name="GSSHeader" type="constructor" line="45">
                <params>
                    <param name="is" type="InputStream"/>
                </params>
                <declaration name="tag" type="int" line="46"/>
                <declaration name="length" type="int" line="48"/>
                <declaration name="temp" type="DerValue" line="49"/>
            </method>
            <javadoc line="54">
                Used to obtain the Oid stored in this GSSHeader instance.                
                <return>
                    the Oid of the mechanism.                    
                </return>
            </javadoc>
            <method name="getOid" type="ObjectIdentifier" line="58"/>
            <javadoc line="61">
                Used to obtain the length of the mechanism specific token that
                  will follow the encoding of this GSSHeader instance.                
                <return>
                    the length of the mechanism specific token portion that
                      will follow this GSSHeader.                    
                </return>
            </javadoc>
            <method name="getMechTokenLength" type="int" line="67"/>
            <javadoc line="70">
                Used to obtain the length of the encoding of this GSSHeader.                
                <return>
                    the lenght of the encoding of this GSSHeader instance.                    
                </return>
            </javadoc>
            <method name="getLength" type="int" line="74">
                <declaration name="lenField" type="int" line="75"/>
            </method>
            <javadoc line="78">
                Used to determine what the maximum possible mechanism token
                  size is if the complete GSSToken returned to the application
                  (including a GSSHeader) is not to exceed some pre-determined
                  value in size.                
                <param>
                    mechOid the Oid of the mechanism that will generate
                      this GSS-API token                    
                </param>
                <param>
                    maxTotalSize the pre-determined value that serves as a
                      maximum size for the complete GSS-API token (including a
                      GSSHeader)                    
                </param>
                <return>
                    the maximum size of mechanism token that can be used
                      so as to not exceed maxTotalSize with the GSS-API token                    
                </return>
            </javadoc>
            <method name="getMaxMechTokenSize" type="int" line="91">
                <params>
                    <param name="mechOid" type="ObjectIdentifier"/>
                    <param name="maxTotalSize" type="int"/>
                </params>
                <declaration name="mechOidBytesSize" type="int" line="92"/>
                <scope line="93">
                    <declaration name="temp" type="DerOutputStream" line="94"/>
                </scope>
                <scope line="98"/>
            </method>
            <javadoc line="104">
                Used to determine the number of bytes that will be need to encode
                  the length field of the GSSHeader.                
            </javadoc>
            <method name="getLenFieldSize" type="int" line="108">
                <params>
                    <param name="len" type="int"/>
                </params>
                <declaration name="retVal" type="int" line="109"/>
                <scope line="110"/>
                <scope line="113"/>
                <scope line="116"/>
                <scope line="119"/>
                <scope line="122"/>
            </method>
            <javadoc line="127">
                Encodes this GSSHeader instance onto the provided OutputStream.                
                <param>
                    os the OutputStream to which the token should be written.                    
                </param>
                <return>
                    the number of bytes that are output as a result of this
                      encoding                    
                </return>
            </javadoc>
            <method name="encode" type="int" line="133">
                <params>
                    <param name="os" type="OutputStream"/>
                </params>
                <declaration name="retVal" type="int" line="134"/>
                <declaration name="length" type="int" line="136"/>
            </method>
            <javadoc line="141">
                Get a length from the input stream, allowing for at most 32 bits of
                  encoding to be used. (Not the same as getting a tagged integer!)                
                <return>
                    the length or -1 if indefinite length found.                    
                </return>
                <exception>
                    IOException on parsing error or unsupported lengths.                    
                </exception>
            </javadoc>
            <method name="getLength" type="int" line="147">
                <params>
                    <param name="in" type="InputStream"/>
                </params>
            </method>
            <javadoc line="150">
                Get a length from the input stream, allowing for at most 32 bits of
                  encoding to be used. (Not the same as getting a tagged integer!)                
                <return>
                    the length or -1 if indefinite length found.                    
                </return>
                <exception>
                    IOException on parsing error or unsupported lengths.                    
                </exception>
            </javadoc>
            <method name="getLength" type="int" line="156">
                <params>
                    <param name="lenByte" type="int"/>
                    <param name="in" type="InputStream"/>
                </params>
                <declaration name="value" type="int" line="157"/>
                <scope line="159"/>
                <scope line="162">
                    <scope line="166"/>
                </scope>
            </method>
            <javadoc line="173">
                Put the encoding of the length in the specified stream.                
                <params>
                    len the length of the attribute.                    
                </params>
                <param>
                    out the outputstream to write the length to                    
                </param>
                <return>
                    the number of bytes written                    
                </return>
                <exception>
                    IOException on writing errors.                    
                </exception>
            </javadoc>
            <method name="putLength" type="int" line="180">
                <params>
                    <param name="len" type="int"/>
                    <param name="out" type="OutputStream"/>
                </params>
                <declaration name="retVal" type="int" line="181"/>
                <scope line="182"/>
                <scope line="186"/>
                <scope line="191"/>
                <scope line="197"/>
                <scope line="204"/>
            </method>
            <method name="debug" type="void" line="214">
                <params>
                    <param name="str" type="String"/>
                </params>
            </method>
            <method name="getHexBytes" type="String" line="217">
                <params>
                    <param name="bytes" type="byte[]"/>
                    <param name="len" type="int"/>
                </params>
                <declaration name="sb" type="StringBuffer" line="218"/>
                <scope line="219">
                    <declaration name="b1" type="int" line="220"/>
                    <declaration name="b2" type="int" line="221"/>
                </scope>
            </method>
        </class>
    </source>