<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss">
        <import package="java.lang.reflect.InvocationTargetException"/>
        <import package="org.ietf.jgss"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.Provider"/>
        <import package="java.security.Security"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.HashSet"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.Enumeration"/>
        <import package="java.util.Iterator"/>
        <import package="sun.security.jgss.spi"/>
        <import package="sun.security.jgss.wrapper.NativeGSSFactory"/>
        <import package="sun.security.jgss.wrapper.SunNativeProvider"/>
        <import package="sun.security.action.GetPropertyAction"/>
        <class name="ProviderList" line="43">
            <comment line="97">
                Undocumented property?                
            </comment>
            <comment line="168">
                So the existing code do not have to be changed                
            </comment>
            <comment line="328">
                Only used by getMechFactoryImpl                
            </comment>
            <javadoc line="43">
                This class stores the list of providers that this
                  GSS-Implementation is configured to use. The GSSManagerImpl class
                  queries this class whenever it needs a mechanism&apos;s factory.&lt;p&gt;
                  This class stores an ordered list of pairs of the form
                  &lt;provider, oid&gt;. When it attempts to instantiate a mechanism
                  defined by oid o, it steps through the list looking for an entry
                  with oid=o, or with oid=null. (An entry with oid=null matches all
                  mechanisms.) When it finds such an entry, the corresponding
                  provider is approached for the mechanism&apos;s factory class.
                  At instantiation time this list in initialized to contain those
                  system wide providers that contain a property of the form
                  &quot;GssApiMechanism.x.y.z...&quot; where &quot;x.y.z...&quot; is a numeric object
                  identifier with numbers x, y, z, etc. Such a property is defined
                  to map to that provider&apos;s implementation of the MechanismFactory
                  interface for the mechanism x.y.z...
                  As and when a MechanismFactory is instantiated, it is
                  cached for future use. &lt;p&gt;
                  An application can cause more providers to be added by means of
                  the addProviderAtFront and addProviderAtEnd methods on
                  GSSManager which get delegated to this class. The
                  addProviderAtFront method can also cause a change in the ordering
                  of the providers without adding any new providers, by causing a
                  provider to move up in a list. The method addProviderAtEnd can
                  only add providers at the end of the list if they are not already
                  in the list. The rationale is that an application will call
                  addProviderAtFront when it wants a provider to be used in
                  preference over the default ones. And it will call
                  addProviderAtEnd when it wants a provider to be used in case
                  the system ones don&apos;t suffice.&lt;p&gt;
                  If a mechanism&apos;s factory is being obtained from a provider as a
                  result of encountering a entryof the form &lt;provider, oid&gt; where
                  oid is non-null, then the assumption is that the application added
                  this entry and it wants this mechanism to be obtained from this
                  provider. Thus is the provider does not actually contain the
                  requested mechanism, an exception will be thrown. However, if the
                  entry were of the form &lt;provider, null&gt;, then it is viewed more
                  liberally and is simply skipped over if the provider does not claim to
                  support the requested mechanism.                
            </javadoc>
            <declaration name="PROV_PROP_PREFIX" type="String" line="89"/>
            <declaration name="PROV_PROP_PREFIX_LEN" type="int" line="90"/>
            <declaration name="SPI_MECH_FACTORY_TYPE" type="String" line="93"/>
            <declaration name="DEFAULT_MECH_PROP" type="String" line="97"/>
            <declaration name="DEFAULT_MECH_OID" type="Oid" line="100"/>
            <scope line="102">
                <declaration name="defOid" type="Oid" line="108"/>
                <declaration name="defaultOidStr" type="String" line="109"/>
                <scope line="111"/>
            </scope>
            <declaration name="preferences" type="ArrayList&lt;PreferencesEntry&gt;" line="118"/>
            <declaration name="factories" type="HashMap&lt;PreferencesEntry,MechanismFactory&gt;" line="120"/>
            <declaration name="mechs" type="HashSet&lt;Oid&gt;" line="122"/>
            <declaration name="caller" type="GSSCaller" line="124"/>
            <method name="ProviderList" type="constructor" line="126">
                <params>
                    <param name="caller" type="GSSCaller"/>
                    <param name="useNative" type="boolean"/>
                </params>
                <comment line="141">
                    Move on to the next provider                    
                </comment>
                <comment line="145">
                    End of for loop                    
                </comment>
                <declaration name="provList" type="Provider[]" line="128"/>
                <scope line="129"/>
                <scope line="132"/>
                <scope line="136">
                    <declaration name="prov" type="Provider" line="137"/>
                    <scope line="138"/>
                    <scope line="140"/>
                </scope>
            </method>
            <javadoc line="148">
                Determines if the given provider property represents a GSS-API
                  Oid to MechanismFactory mapping.                
                <return>
                    true if this is a GSS-API property, false otherwise.                    
                </return>
            </javadoc>
            <method name="isMechFactoryProperty" type="boolean" line="153">
                <params>
                    <param name="prop" type="String"/>
                </params>
                <comment line="155">
                    Try ignoring case                    
                </comment>
            </method>
            <method name="getOidFromMechFactoryProperty" type="Oid" line="161">
                <params>
                    <param name="prop" type="String"/>
                </params>
                <declaration name="oidPart" type="String" line="163"/>
            </method>
            <method name="getMechFactory" type="MechanismFactory" line="169">
                <params>
                    <param name="mechOid" type="Oid"/>
                </params>
            </method>
            <javadoc line="174">
                Obtains a MechanismFactory for a given mechanism. If the
                  specified provider is not null, then the impl from the
                  provider is used. Otherwise, the most preferred impl based
                  on the configured preferences is used.                
                <param>
                    mechOid the oid of the desired mechanism                    
                </param>
                <return>
                    a MechanismFactory for the desired mechanism.                    
                </return>
                <throws>
                    GSSException when the specified provider does not
                      support the desired mechanism, or when no provider supports
                      the desired mechanism.                    
                </throws>
            </javadoc>
            <method name="getMechFactory" type="MechanismFactory" line="187">
                <params>
                    <param name="mechOid" type="Oid"/>
                    <param name="p" type="Provider"/>
                </params>
                <comment line="192">
                    Iterate thru all preferences to find right provider                    
                </comment>
                <comment line="203">
                    end of while loop                    
                </comment>
                <comment line="206">
                    Use the impl from the specified provider; return null if the                    
                </comment>
                <comment line="207">
                    the mech is unsupported by the specified provider.                    
                </comment>
                <scope line="191">
                    <declaration name="className" type="String" line="193"/>
                    <declaration name="entry" type="PreferencesEntry" line="194"/>
                    <declaration name="list" type="Iterator&lt;PreferencesEntry&gt;" line="196"/>
                    <scope line="197">
                        <scope line="199">
                            <declaration name="retVal" type="MechanismFactory" line="200"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="205">
                    <declaration name="entry" type="PreferencesEntry" line="208"/>
                </scope>
            </method>
            <javadoc line="213">
                Helper routine that uses a preferences entry to obtain an
                  implementation of a MechanismFactory from it.                
                <param>
                    e the preferences entry that contains the provider and
                      either a null of an explicit oid that matched the oid of the
                      desired mechanism.                    
                </param>
                <param>
                    mechOid the oid of the desired mechanism                    
                </param>
                <throws>
                    GSSException If the application explicitly requested
                      this entry's provider to be used for the desired mechanism but
                      some problem is encountered                    
                </throws>
            </javadoc>
            <method name="getMechFactory" type="MechanismFactory" line="225">
                <params>
                    <param name="e" type="PreferencesEntry"/>
                    <param name="mechOid" type="Oid"/>
                </params>
                <comment line="228">
                    See if a MechanismFactory was previously instantiated for
                     this provider and mechanism combination.                    
                </comment>
                <comment line="235">
                    Apparently not. Now try to instantiate this class from
                     the provider.                    
                </comment>
                <comment line="245">
                    This provider does not support this mechanism.
                     If the application explicitly requested that
                     this provider be used for this mechanism, then
                     throw an exception                    
                </comment>
                <declaration name="p" type="Provider" line="226"/>
                <declaration name="searchEntry" type="PreferencesEntry" line="232"/>
                <declaration name="retVal" type="MechanismFactory" line="233"/>
                <scope line="234">
                    <declaration name="prop" type="String" line="239"/>
                    <declaration name="className" type="String" line="240"/>
                    <scope line="241"/>
                    <scope line="244">
                        <scope line="251"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="261">
                Helper routine to obtain a MechanismFactory implementation
                  from the same class loader as the provider of this
                  implementation.                
                <param>
                    p the provider whose classloader must be used for
                      instantiating the desired MechanismFactory                    
                </param>
                <>
                    param className the name of the MechanismFactory class                    
                </>
                <throws>
                    GSSException If some error occurs when trying to
                      instantiate this MechanismFactory.                    
                </throws>
            </javadoc>
            <method name="getMechFactoryImpl" type="MechanismFactory" line="275">
                <params>
                    <param name="p" type="Provider"/>
                    <param name="className" type="String"/>
                    <param name="mechOid" type="Oid"/>
                    <param name="caller" type="GSSCaller"/>
                </params>
                <comment line="280">
                    Load the implementation class with the same class loader
                     that was used to load the provider.
                     In order to get the class loader of a class, the
                     caller&apos;s class loader must be the same as or an ancestor of
                     the class loader being returned. Otherwise, the caller must
                     have &quot;getClassLoader&quot; permission, or a SecurityException
                     will be thrown.                    
                </comment>
                <scope line="277">
                    <declaration name="baseClass" type="Class&lt;?&gt;" line="278"/>
                    <declaration name="cl" type="ClassLoader" line="290"/>
                    <declaration name="implClass" type="Class&lt;?&gt;" line="291"/>
                    <scope line="292"/>
                    <scope line="294"/>
                    <scope line="298">
                        <declaration name="c" type="java.lang.reflect.Constructor&lt;?&gt;" line="300"/>
                        <declaration name="mf" type="MechanismFactory" line="302"/>
                        <scope line="304"/>
                    </scope>
                    <scope line="308"/>
                </scope>
                <scope line="312"/>
                <scope line="314"/>
                <scope line="316"/>
                <scope line="318"/>
                <scope line="320"/>
                <scope line="322"/>
            </method>
            <method name="createGSSException" type="GSSException" line="331">
                <params>
                    <param name="p" type="Provider"/>
                    <param name="className" type="String"/>
                    <param name="trailingMsg" type="String"/>
                    <param name="cause" type="Exception"/>
                </params>
                <declaration name="errClassInfo" type="String" line="332"/>
            </method>
            <method name="getMechs" type="Oid[]" line="339"/>
            <method name="addProviderAtFront" type="void" line="344">
                <params>
                    <param name="p" type="Provider"/>
                    <param name="mechOid" type="Oid"/>
                </params>
                <declaration name="newEntry" type="PreferencesEntry" line="346"/>
                <declaration name="oldEntry" type="PreferencesEntry" line="347"/>
                <declaration name="foundSomeMech" type="boolean" line="348"/>
                <declaration name="list" type="Iterator&lt;PreferencesEntry&gt;" line="350"/>
                <scope line="351"/>
                <scope line="357"/>
                <scope line="359">
                    <declaration name="oidStr" type="String" line="360"/>
                </scope>
                <scope line="370"/>
            </method>
            <method name="addProviderAtEnd" type="void" line="376">
                <params>
                    <param name="p" type="Provider"/>
                    <param name="mechOid" type="Oid"/>
                </params>
                <comment line="389">
                    System.out.println(&quot;addProviderAtEnd: No it is not redundant&quot;);                    
                </comment>
                <declaration name="newEntry" type="PreferencesEntry" line="378"/>
                <declaration name="oldEntry" type="PreferencesEntry" line="379"/>
                <declaration name="foundSomeMech" type="boolean" line="380"/>
                <declaration name="list" type="Iterator&lt;PreferencesEntry&gt;" line="382"/>
                <scope line="383"/>
                <scope line="393">
                    <declaration name="oidStr" type="String" line="394"/>
                </scope>
                <scope line="404"/>
            </method>
            <javadoc line="409">
                Helper routine to go through all properties contined in a
                  provider and add its mechanisms to the list of supported
                  mechanisms. If no default mechanism has been assinged so far,
                  it sets the default MechanismFactory and Oid as well.                
                <param>
                    p the provider to query                    
                </param>
                <return>
                    true if there is at least one mechanism that this
                      provider contributed, false otherwise                    
                </return>
            </javadoc>
            <method name="addAllMechsFromProvider" type="boolean" line="418">
                <params>
                    <param name="p" type="Provider"/>
                </params>
                <comment line="423">
                    Get all props for this provider                    
                </comment>
                <comment line="426">
                    See if there are any GSS prop&apos;s                    
                </comment>
                <comment line="430">
                    Ok! This is a GSS provider!                    
                </comment>
                <comment line="436">
                    Skip to next property                    
                </comment>
                <comment line="440">
                    Processed GSS property                    
                </comment>
                <comment line="441">
                    while loop                    
                </comment>
                <declaration name="prop" type="String" line="420"/>
                <declaration name="retVal" type="boolean" line="421"/>
                <declaration name="props" type="Enumeration&lt;Object&gt;" line="424"/>
                <scope line="427">
                    <scope line="429">
                        <scope line="431">
                            <declaration name="mechOid" type="Oid" line="432"/>
                        </scope>
                        <scope line="435"/>
                    </scope>
                </scope>
            </method>
            <class name="PreferencesEntry" line="447">
                <comment line="538">
                    For debugging                    
                </comment>
                <javadoc line="447">
                    Stores a provider and a mechanism oid indicating that the
                      provider should be used for the mechanism. If the mechanism
                      Oid is null, then it indicates that this preference holds for
                      any mechanism.&lt;p&gt;
                      The ProviderList maintains an ordered list of
                      PreferencesEntry&apos;s and iterates thru them as it tries to
                      instantiate MechanismFactory&apos;s.                    
                </javadoc>
                <declaration name="p" type="Provider" line="458"/>
                <declaration name="oid" type="Oid" line="459"/>
                <method name="PreferencesEntry" type="constructor" line="460">
                    <params>
                        <param name="p" type="Provider"/>
                        <param name="oid" type="Oid"/>
                    </params>
                </method>
                <method name="equals" type="boolean" line="465">
                    <params>
                        <param name="other" type="Object"/>
                    </params>
                    <scope line="466"/>
                    <scope line="470"/>
                    <declaration name="that" type="PreferencesEntry" line="474"/>
                    <scope line="475">
                        <scope line="476"/>
                        <scope line="478"/>
                    </scope>
                </method>
                <method name="hashCode" type="int" line="486">
                    <declaration name="result" type="int" line="487"/>
                    <scope line="490"/>
                </method>
                <javadoc line="497">
                    Determines if a preference implies another. A preference
                      implies another if the latter is subsumed by the
                      former. e.g., &lt;Provider1, null&gt; implies &lt;Provider1, OidX&gt;
                      because the null in the former indicates that it should
                      be used for all mechanisms.                    
                </javadoc>
                <method name="implies" type="boolean" line="504">
                    <params>
                        <param name="other" type="Object"/>
                    </params>
                    <scope line="506">
                        <declaration name="temp" type="PreferencesEntry" line="507"/>
                    </scope>
                    <scope line="511"/>
                </method>
                <method name="getProvider" type="Provider" line="516"/>
                <method name="getOid" type="Oid" line="520"/>
                <javadoc line="524">
                    Determines if this entry is applicable to the desired
                      mechanism. The entry is applicable to the desired mech if
                      it contains the same oid or if it contains a null oid
                      indicating that it is applicable to all mechs.                    
                    <param>
                        mechOid the desired mechanism                        
                    </param>
                    <return>
                        true if the provider in this entry should be
                          queried for this mechanism.                        
                    </return>
                </javadoc>
                <method name="impliesMechanism" type="boolean" line="533">
                    <params>
                        <param name="oid" type="Oid"/>
                    </params>
                </method>
                <method name="toString" type="String" line="538">
                    <declaration name="buf" type="StringBuffer" line="539"/>
                </method>
            </class>
        </class>
    </source>