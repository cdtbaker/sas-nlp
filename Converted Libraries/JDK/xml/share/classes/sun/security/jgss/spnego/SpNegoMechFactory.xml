<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss.spnego">
        <import package="org.ietf.jgss"/>
        <import package="sun.security.jgss"/>
        <import package="sun.security.jgss.spi"/>
        <import package="sun.security.jgss.krb5.Krb5MechFactory"/>
        <import package="sun.security.jgss.krb5.Krb5InitCredential"/>
        <import package="sun.security.jgss.krb5.Krb5AcceptCredential"/>
        <import package="sun.security.jgss.krb5.Krb5NameElement"/>
        <import package="java.security.Provider"/>
        <import package="java.util.Vector"/>
        <class name="SpNegoMechFactory" line="38">
            <comment line="61">
                The default underlying mech of SPNEGO, must not be SPNEGO itself.                
            </comment>
            <comment line="67">
                Use an instance of a GSSManager whose provider list
                 does not include native provider                
            </comment>
            <implements interface="MechanismFactory"/>
            <javadoc line="38">
                SpNego Mechanism plug in for JGSS
                  This is the properties object required by the JGSS framework.
                  All mechanism specific information is defined here.                
                <author>
                    Seema Malkani                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <declaration name="PROVIDER" type="Provider" line="49"/>
            <declaration name="GSS_SPNEGO_MECH_OID" type="Oid" line="52"/>
            <declaration name="nameTypes" type="Oid[]" line="55"/>
            <declaration name="DEFAULT_SPNEGO_MECH_OID" type="Oid" line="61"/>
            <declaration name="manager" type="GSSManagerImpl" line="68"/>
            <declaration name="availableMechs" type="Oid[]" line="69"/>
            <method name="getCredFromSubject" type="SpNegoCredElement" line="73">
                <params>
                    <param name="name" type="GSSNameSpi"/>
                    <param name="initiate" type="boolean"/>
                </params>
                <comment line="82">
                    Force permission check before returning the cred to caller                    
                </comment>
                <declaration name="creds" type="Vector&lt;SpNegoCredElement&gt;" line="74"/>
                <declaration name="result" type="SpNegoCredElement" line="78"/>
                <scope line="82">
                    <declaration name="cred" type="GSSCredentialSpi" line="83"/>
                    <scope line="84">
                        <scope line="85">
                            <declaration name="krbCred" type="Krb5InitCredential" line="86"/>
                        </scope>
                        <scope line="89">
                            <declaration name="krbCred" type="Krb5AcceptCredential" line="90"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="SpNegoMechFactory" type="constructor" line="99">
                <params>
                    <param name="caller" type="GSSCaller"/>
                </params>
                <comment line="105">
                    Skip SpNego mechanism                    
                </comment>
                <comment line="110">
                    Move the preferred mech to first place                    
                </comment>
                <declaration name="mechs" type="Oid[]" line="101"/>
                <scope line="103">
                    <scope line="105"/>
                </scope>
                <scope line="110">
                    <scope line="111">
                        <scope line="112"/>
                    </scope>
                </scope>
            </method>
            <method name="getNameElement" type="GSSNameSpi" line="122">
                <params>
                    <param name="nameStr" type="String"/>
                    <param name="nameType" type="Oid"/>
                </params>
            </method>
            <method name="getNameElement" type="GSSNameSpi" line="128">
                <params>
                    <param name="name" type="byte[]"/>
                    <param name="nameType" type="Oid"/>
                </params>
            </method>
            <method name="getCredentialElement" type="GSSCredentialSpi" line="134">
                <params>
                    <param name="name" type="GSSNameSpi"/>
                    <param name="initLifetime" type="int"/>
                    <param name="acceptLifetime" type="int"/>
                    <param name="usage" type="int"/>
                </params>
                <comment line="141">
                    get CredElement for the default Mechanism                    
                </comment>
                <declaration name="credElement" type="SpNegoCredElement" line="136"/>
                <scope line="139"/>
            </method>
            <method name="getMechanismContext" type="GSSContextSpi" line="150">
                <params>
                    <param name="peer" type="GSSNameSpi"/>
                    <param name="myInitiatorCred" type="GSSCredentialSpi"/>
                    <param name="lifetime" type="int"/>
                </params>
                <comment line="152">
                    get SpNego mechanism context                    
                </comment>
                <comment line="156">
                    convert to SpNegoCredElement                    
                </comment>
                <scope line="152"/>
                <scope line="154">
                    <declaration name="cred" type="SpNegoCredElement" line="156"/>
                </scope>
            </method>
            <method name="getMechanismContext" type="GSSContextSpi" line="163">
                <params>
                    <param name="myAcceptorCred" type="GSSCredentialSpi"/>
                </params>
                <comment line="165">
                    get SpNego mechanism context                    
                </comment>
                <comment line="169">
                    convert to SpNegoCredElement                    
                </comment>
                <scope line="165"/>
                <scope line="167">
                    <declaration name="cred" type="SpNegoCredElement" line="169"/>
                </scope>
            </method>
            <method name="getMechanismContext" type="GSSContextSpi" line="176">
                <params>
                    <param name="exportedContext" type="byte[]"/>
                </params>
                <comment line="178">
                    get SpNego mechanism context                    
                </comment>
            </method>
            <method name="getMechanismOid" type="Oid" line="181"/>
            <method name="getProvider" type="Provider" line="185"/>
            <method name="getNameTypes" type="Oid[]" line="189">
                <comment line="191">
                    nameTypes is cloned in GSSManager.getNamesForMech                    
                </comment>
            </method>
        </class>
    </source>