<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss.krb5">
        <import package="org.ietf.jgss"/>
        <import package="sun.security.jgss.GSSUtil"/>
        <import package="sun.security.jgss.GSSCaller"/>
        <import package="sun.security.jgss.spi"/>
        <import package="javax.security.auth.kerberos.ServicePermission"/>
        <import package="java.security.Provider"/>
        <import package="java.util.Vector"/>
        <class name="Krb5MechFactory" line="36">
            <implements interface="MechanismFactory"/>
            <javadoc line="36">
                Krb5 Mechanism plug in for JGSS
                  This is the properties object required by the JGSS framework.
                  All mechanism specific information is defined here.                
                <author>
                    Mayank Upadhyay                    
                </author>
            </javadoc>
            <declaration name="DEBUG" type="boolean" line="46"/>
            <declaration name="PROVIDER" type="Provider" line="48"/>
            <declaration name="GSS_KRB5_MECH_OID" type="Oid" line="51"/>
            <declaration name="NT_GSS_KRB5_PRINCIPAL" type="Oid" line="54"/>
            <declaration name="nameTypes" type="Oid[]" line="57"/>
            <declaration name="caller" type="GSSCaller" line="63"/>
            <method name="getCredFromSubject" type="Krb5CredElement" line="67">
                <params>
                    <param name="name" type="GSSNameSpi"/>
                    <param name="initiate" type="boolean"/>
                </params>
                <comment line="77">
                    Force permission check before returning the cred to caller                    
                </comment>
                <declaration name="creds" type="Vector&lt;Krb5CredElement&gt;" line="68"/>
                <declaration name="result" type="Krb5CredElement" line="74"/>
                <scope line="78">
                    <scope line="79"/>
                    <scope line="81"/>
                </scope>
            </method>
            <method name="Krb5MechFactory" type="constructor" line="89">
                <params>
                    <param name="caller" type="GSSCaller"/>
                </params>
            </method>
            <method name="getNameElement" type="GSSNameSpi" line="94">
                <params>
                    <param name="nameStr" type="String"/>
                    <param name="nameType" type="Oid"/>
                </params>
            </method>
            <method name="getNameElement" type="GSSNameSpi" line="99">
                <params>
                    <param name="name" type="byte[]"/>
                    <param name="nameType" type="Oid"/>
                </params>
                <comment line="100">
                    At this point, even an exported name is stripped down to safe                    
                </comment>
                <comment line="101">
                    bytes only                    
                </comment>
                <comment line="102">
                    XXX Use encoding here                    
                </comment>
            </method>
            <method name="getCredentialElement" type="GSSCredentialSpi" line="108">
                <params>
                    <param name="name" type="GSSNameSpi"/>
                    <param name="initLifetime" type="int"/>
                    <param name="acceptLifetime" type="int"/>
                    <param name="usage" type="int"/>
                </params>
                <scope line="110"/>
                <declaration name="credElement" type="Krb5CredElement" line="115"/>
                <scope line="118">
                    <scope line="120"/>
                    <scope line="125"/>
                </scope>
            </method>
            <method name="checkInitCredPermission" type="void" line="138">
                <params>
                    <param name="name" type="Krb5NameElement"/>
                </params>
                <declaration name="sm" type="SecurityManager" line="139"/>
                <scope line="140">
                    <declaration name="realm" type="String" line="141"/>
                    <declaration name="tgsPrincipal" type="String" line="142"/>
                    <declaration name="perm" type="ServicePermission" line="144"/>
                    <scope line="146"/>
                    <scope line="148">
                        <scope line="149"/>
                    </scope>
                </scope>
            </method>
            <method name="checkAcceptCredPermission" type="void" line="159">
                <params>
                    <param name="name" type="Krb5NameElement"/>
                    <param name="originalName" type="GSSNameSpi"/>
                </params>
                <comment line="168">
                    Don&apos;t disclose the name of the principal                    
                </comment>
                <comment line="171">
                    Don&apos;t call e.initCause() with caught exception                    
                </comment>
                <declaration name="sm" type="SecurityManager" line="160"/>
                <scope line="161">
                    <declaration name="perm" type="ServicePermission" line="162"/>
                    <scope line="164"/>
                    <scope line="166">
                        <scope line="167"/>
                    </scope>
                </scope>
            </method>
            <method name="getMechanismContext" type="GSSContextSpi" line="180">
                <params>
                    <param name="peer" type="GSSNameSpi"/>
                    <param name="myInitiatorCred" type="GSSCredentialSpi"/>
                    <param name="lifetime" type="int"/>
                </params>
                <comment line="185">
                    XXX Convert myInitiatorCred to Krb5CredElement                    
                </comment>
                <scope line="181"/>
                <scope line="186"/>
            </method>
            <method name="getMechanismContext" type="GSSContextSpi" line="195">
                <params>
                    <param name="myAcceptorCred" type="GSSCredentialSpi"/>
                </params>
                <comment line="196">
                    XXX Convert myAcceptorCred to Krb5CredElement                    
                </comment>
                <scope line="197"/>
            </method>
            <method name="getMechanismContext" type="GSSContextSpi" line="205">
                <params>
                    <param name="exportedContext" type="byte[]"/>
                </params>
            </method>
            <method name="getMechanismOid" type="Oid" line="210"/>
            <method name="getProvider" type="Provider" line="214"/>
            <method name="getNameTypes" type="Oid[]" line="218">
                <comment line="219">
                    nameTypes is cloned in GSSManager.getNamesForMech                    
                </comment>
            </method>
            <method name="createOid" type="Oid" line="223">
                <params>
                    <param name="oidStr" type="String"/>
                </params>
                <comment line="228">
                    Should not happen!                    
                </comment>
                <declaration name="retVal" type="Oid" line="224"/>
                <scope line="225"/>
                <scope line="227"/>
            </method>
        </class>
    </source>