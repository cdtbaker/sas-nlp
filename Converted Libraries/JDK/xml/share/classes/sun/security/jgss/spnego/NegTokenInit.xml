<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.jgss.spnego">
        <import package="java.io"/>
        <import package="java.util"/>
        <import package="org.ietf.jgss"/>
        <import package="sun.security.jgss"/>
        <import package="sun.security.util"/>
        <class name="NegTokenInit" line="34">
            <extends class="SpNegoToken"/>
            <comment line="66">
                DER-encoded mechTypes                
            </comment>
            <comment line="84">
                Used by sun.security.jgss.wrapper.NativeGSSContext
                 to parse SPNEGO tokens                
            </comment>
            <comment line="210">
                Used by sun.security.jgss.wrapper.NativeGSSContext
                 to find the mechs in SPNEGO tokens                
            </comment>
            <comment line="220">
                Used by sun.security.jgss.wrapper.NativeGSSContext
                 to access the mech token portion of SPNEGO tokens                
            </comment>
            <javadoc line="34">
                Implements the SPNEGO NegTokenInit token
                  as specified in RFC 2478
                  NegTokenInit ::= SEQUENCE {
                  mechTypes       [0] MechTypeList  OPTIONAL,
                  reqFlags        [1] ContextFlags  OPTIONAL,
                  mechToken       [2] OCTET STRING  OPTIONAL,
                  mechListMIC     [3] OCTET STRING  OPTIONAL
                  }
                  MechTypeList ::= SEQUENCE OF MechType
                  MechType::= OBJECT IDENTIFIER
                  ContextFlags ::= BIT STRING {
                  delegFlag       (0),
                  mutualFlag      (1),
                  replayFlag      (2),
                  sequenceFlag    (3),
                  anonFlag        (4),
                  confFlag        (5),
                  integFlag       (6)
                  }                
                <author>
                    Seema Malkani                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <declaration name="mechTypes" type="byte[]" line="66"/>
            <declaration name="mechTypeList" type="Oid[]" line="67"/>
            <declaration name="reqFlags" type="BitArray" line="69"/>
            <declaration name="mechToken" type="byte[]" line="70"/>
            <declaration name="mechListMIC" type="byte[]" line="71"/>
            <method name="NegTokenInit" type="constructor" line="75">
                <params>
                    <param name="mechTypes" type="byte[]"/>
                    <param name="flags" type="BitArray"/>
                    <param name="token" type="byte[]"/>
                    <param name="mechListMIC" type="byte[]"/>
                </params>
            </method>
            <method name="NegTokenInit" type="constructor" line="85">
                <params>
                    <param name="in" type="byte[]"/>
                </params>
            </method>
            <method name="encode" type="byte[]" line="90">
                <comment line="93">
                    create negInitToken                    
                </comment>
                <comment line="96">
                    DER-encoded mechTypes with CONTEXT 00                    
                </comment>
                <comment line="102">
                    write context flags with CONTEXT 01                    
                </comment>
                <comment line="110">
                    mechToken with CONTEXT 02                    
                </comment>
                <comment line="118">
                    mechListMIC with CONTEXT 03                    
                </comment>
                <comment line="130">
                    insert in a SEQUENCE                    
                </comment>
                <scope line="91">
                    <declaration name="initToken" type="DerOutputStream" line="93"/>
                    <scope line="96"/>
                    <scope line="102">
                        <declaration name="flags" type="DerOutputStream" line="103"/>
                    </scope>
                    <scope line="110">
                        <declaration name="dataValue" type="DerOutputStream" line="111"/>
                    </scope>
                    <scope line="118">
                        <scope line="119"/>
                        <declaration name="mic" type="DerOutputStream" line="123"/>
                    </scope>
                    <declaration name="out" type="DerOutputStream" line="130"/>
                </scope>
                <scope line="135"/>
            </method>
            <method name="parseToken" type="void" line="141">
                <params>
                    <param name="in" type="byte[]"/>
                </params>
                <comment line="145">
                    verify NegotiationToken type token                    
                </comment>
                <comment line="156">
                    parse various fields if present                    
                </comment>
                <comment line="161">
                    get the DER-encoded sequence of mechTypes                    
                </comment>
                <comment line="166">
                    read all the mechTypes                    
                </comment>
                <comment line="180">
                    received reqFlags, skip it                    
                </comment>
                <scope line="142">
                    <declaration name="der" type="DerValue" line="143"/>
                    <scope line="145"/>
                    <declaration name="tmp1" type="DerValue" line="149"/>
                    <scope line="150"/>
                    <declaration name="lastField" type="int" line="156"/>
                    <scope line="157">
                        <declaration name="tmp2" type="DerValue" line="158"/>
                        <scope line="159">
                            <declaration name="mValue" type="DerInputStream" line="162"/>
                            <declaration name="mList" type="DerValue[]" line="166"/>
                            <declaration name="mech" type="ObjectIdentifier" line="168"/>
                            <scope line="169">
                                <scope line="171"/>
                            </scope>
                        </scope>
                        <scope line="177"/>
                        <scope line="180">
                            <scope line="182"/>
                        </scope>
                        <scope line="187">
                            <scope line="189">
                                <scope line="191"/>
                            </scope>
                        </scope>
                    </scope>
                </scope>
                <scope line="199"/>
            </method>
            <method name="getMechTypes" type="byte[]" line="205"/>
            <method name="getMechTypeList" type="Oid[]" line="211"/>
            <method name="getReqFlags" type="BitArray" line="215"/>
            <method name="getMechToken" type="byte[]" line="221"/>
            <method name="getMechListMIC" type="byte[]" line="225"/>
        </class>
    </source>