<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.timestamp">
        <import package="java.io.IOException"/>
        <import package="java.math.BigInteger"/>
        <import package="java.util.Date"/>
        <import package="sun.security.util.DerValue"/>
        <import package="sun.security.util.ObjectIdentifier"/>
        <import package="sun.security.x509.AlgorithmId"/>
        <class name="TimestampToken" line="8">
            <javadoc line="8">
                This class provides the timestamp token info resulting from a successful
                  timestamp request, as defined in
                  &lt;a href=&quot;http://www.ietf.org/rfc/rfc3161.txt&quot;&gt;RFC 3161&lt;/a&gt;.
                  The timestampTokenInfo ASN.1 type has the following definition:
                  &lt;pre&gt;
                  TSTInfo ::= SEQUENCE {
                  version                INTEGER  { v1(1) },
                  policy                 TSAPolicyId,
                  messageImprint         MessageImprint,
                  -- MUST have the same value as the similar field in
                  -- TimeStampReq
                  serialNumber           INTEGER,
                  -- Time-Stamping users MUST be ready to accommodate integers
                  -- up to 160 bits.
                  genTime                GeneralizedTime,
                  accuracy               Accuracy                 OPTIONAL,
                  ordering               BOOLEAN             DEFAULT FALSE,
                  nonce                  INTEGER                  OPTIONAL,
                  -- MUST be present if the similar field was present
                  -- in TimeStampReq.  In that case it MUST have the same value.
                  tsa                    [0] GeneralName          OPTIONAL,
                  extensions             [1] IMPLICIT Extensions  OPTIONAL }
                  Accuracy ::= SEQUENCE {
                  seconds        INTEGER           OPTIONAL,
                  millis     [0] INTEGER  (1..999) OPTIONAL,
                  micros     [1] INTEGER  (1..999) OPTIONAL  }
                  &lt;/pre&gt;                
                <since>
                    1.5                    
                </since>
                <see>
                    Timestamper                    
                </see>
                <author>
                    Vincent Ryan                    
                </author>
            </javadoc>
            <declaration name="version" type="int" line="41"/>
            <declaration name="policy" type="ObjectIdentifier" line="42"/>
            <declaration name="serialNumber" type="BigInteger" line="43"/>
            <declaration name="hashAlgorithm" type="AlgorithmId" line="44"/>
            <declaration name="hashedMessage" type="byte[]" line="45"/>
            <declaration name="genTime" type="Date" line="46"/>
            <declaration name="nonce" type="BigInteger" line="47"/>
            <javadoc line="48">
                Constructs an object to store a timestamp token.                
                <param>
                    status A buffer containing the ASN.1 BER encoding of the
                      TSTInfo element defined in RFC 3161.                    
                </param>
            </javadoc>
            <method name="TimestampToken" type="constructor" line="53">
                <params>
                    <param name="timestampTokenInfo" type="byte[]"/>
                </params>
                <scope line="54"/>
            </method>
            <javadoc line="59">
                Extract the date and time from the timestamp token.                
                <return>
                    The date and time when the timestamp was generated.                    
                </return>
            </javadoc>
            <method name="getDate" type="Date" line="63"/>
            <method name="getHashAlgorithm" type="AlgorithmId" line="66"/>
            <method name="getHashedMessage" type="byte[]" line="69"/>
            <method name="getNonce" type="BigInteger" line="72"/>
            <method name="parse" type="void" line="75">
                <params>
                    <param name="timestampTokenInfo" type="byte[]"/>
                </params>
                <declaration name="tstInfo" type="DerValue" line="76"/>
                <scope line="77"/>
                <declaration name="messageImprint" type="DerValue" line="82"/>
                <scope line="87">
                    <declaration name="d" type="DerValue" line="88"/>
                    <scope line="89"/>
                </scope>
            </method>
        </class>
    </source>