<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.timestamp">
        <import package="java.io.IOException"/>
        <import package="java.math.BigInteger"/>
        <import package="sun.security.pkcs.PKCS7"/>
        <import package="sun.security.pkcs.PKCS9Attribute"/>
        <import package="sun.security.pkcs.PKCS9Attributes"/>
        <import package="sun.security.pkcs.ParsingException"/>
        <import package="sun.security.pkcs.SignerInfo"/>
        <import package="sun.security.util.DerValue"/>
        <import package="sun.security.x509.AlgorithmId"/>
        <import package="sun.security.x509.X500Name"/>
        <class name="TSResponse" line="12">
            <javadoc line="12">
                This class provides the response corresponding to a timestamp request,
                  as defined in
                  &lt;a href=&quot;http://www.ietf.org/rfc/rfc3161.txt&quot;&gt;RFC 3161&lt;/a&gt;.
                  The TimeStampResp ASN.1 type has the following definition:
                  &lt;pre&gt;
                  TimeStampResp ::= SEQUENCE {
                  status            PKIStatusInfo,
                  timeStampToken    TimeStampToken OPTIONAL ]
                  PKIStatusInfo ::= SEQUENCE {
                  status        PKIStatus,
                  statusString  PKIFreeText OPTIONAL,
                  failInfo      PKIFailureInfo OPTIONAL }
                  PKIStatus ::= INTEGER {
                  granted                (0),
                  -- when the PKIStatus contains the value zero a TimeStampToken, as
                  -- requested, is present.
                  grantedWithMods        (1),
                  -- when the PKIStatus contains the value one a TimeStampToken,
                  -- with modifications, is present.
                  rejection              (2),
                  waiting                (3),
                  revocationWarning      (4),
                  -- this message contains a warning that a revocation is
                  -- imminent
                  revocationNotification (5)
                  -- notification that a revocation has occurred }
                  PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
                  -- text encoded as UTF-8 String (note:  each UTF8String SHOULD
                  -- include an RFC 1766 language tag to indicate the language
                  -- of the contained text)
                  PKIFailureInfo ::= BIT STRING {
                  badAlg              (0),
                  -- unrecognized or unsupported Algorithm Identifier
                  badRequest          (2),
                  -- transaction not permitted or supported
                  badDataFormat       (5),
                  -- the data submitted has the wrong format
                  timeNotAvailable    (14),
                  -- the TSA&apos;s time source is not available
                  unacceptedPolicy    (15),
                  -- the requested TSA policy is not supported by the TSA
                  unacceptedExtension (16),
                  -- the requested extension is not supported by the TSA
                  addInfoNotAvailable (17)
                  -- the additional information requested could not be understood
                  -- or is not available
                  systemFailure       (25)
                  -- the request cannot be handled due to system failure }
                  TimeStampToken ::= ContentInfo
                  -- contentType is id-signedData
                  -- content is SignedData
                  -- eContentType within SignedData is id-ct-TSTInfo
                  -- eContent within SignedData is TSTInfo
                  &lt;/pre&gt;                
                <since>
                    1.5                    
                </since>
                <author>
                    Vincent Ryan                    
                </author>
                <see>
                    Timestamper                    
                </see>
            </javadoc>
            <declaration name="GRANTED" type="int" line="72"/>
            <javadoc line="72">
                The requested timestamp was granted.                
            </javadoc>
            <declaration name="GRANTED_WITH_MODS" type="int" line="76"/>
            <javadoc line="76">
                The requested timestamp was granted with some modifications.                
            </javadoc>
            <declaration name="REJECTION" type="int" line="80"/>
            <javadoc line="80">
                The requested timestamp was not granted.                
            </javadoc>
            <declaration name="WAITING" type="int" line="84"/>
            <javadoc line="84">
                The requested timestamp has not yet been processed.                
            </javadoc>
            <declaration name="REVOCATION_WARNING" type="int" line="88"/>
            <javadoc line="88">
                A warning that a certificate revocation is imminent.                
            </javadoc>
            <declaration name="REVOCATION_NOTIFICATION" type="int" line="92"/>
            <javadoc line="92">
                Notification that a certificate revocation has occurred.                
            </javadoc>
            <declaration name="BAD_ALG" type="int" line="96"/>
            <javadoc line="96">
                Unrecognized or unsupported algorithm identifier.                
            </javadoc>
            <declaration name="BAD_REQUEST" type="int" line="100"/>
            <javadoc line="100">
                The requested transaction is not permitted or supported.                
            </javadoc>
            <declaration name="BAD_DATA_FORMAT" type="int" line="104"/>
            <javadoc line="104">
                The data submitted has the wrong format.                
            </javadoc>
            <declaration name="TIME_NOT_AVAILABLE" type="int" line="108"/>
            <javadoc line="108">
                The TSA&apos;s time source is not available.                
            </javadoc>
            <declaration name="UNACCEPTED_POLICY" type="int" line="112"/>
            <javadoc line="112">
                The requested TSA policy is not supported by the TSA.                
            </javadoc>
            <declaration name="UNACCEPTED_EXTENSION" type="int" line="116"/>
            <javadoc line="116">
                The requested extension is not supported by the TSA.                
            </javadoc>
            <declaration name="ADD_INFO_NOT_AVAILABLE" type="int" line="120"/>
            <javadoc line="120">
                The additional information requested could not be understood or is not
                  available.                
            </javadoc>
            <declaration name="SYSTEM_FAILURE" type="int" line="125"/>
            <javadoc line="125">
                The request cannot be handled due to system failure.                
            </javadoc>
            <declaration name="DEBUG" type="boolean" line="129"/>
            <declaration name="status" type="int" line="130"/>
            <declaration name="statusString" type="String[]" line="131"/>
            <declaration name="failureInfo" type="int" line="132"/>
            <declaration name="encodedTsToken" type="byte[]" line="133"/>
            <declaration name="tsToken" type="PKCS7" line="134"/>
            <javadoc line="135">
                Constructs an object to store the response to a timestamp request.                
                <param>
                    status A buffer containing the ASN.1 BER encoded response.                    
                </param>
                <throws>
                    IOException The exception is thrown if a problem is encountered
                      parsing the timestamp response.                    
                </throws>
            </javadoc>
            <method name="TSResponse" type="constructor" line="141">
                <params>
                    <param name="tsReply" type="byte[]"/>
                </params>
            </method>
            <javadoc line="144">
                Retrieve the status code returned by the TSA.                
            </javadoc>
            <method name="getStatusCode" type="int" line="147"/>
            <javadoc line="150">
                Retrieve the status messages returned by the TSA.                
                <return>
                    If null then no status messages were received.                    
                </return>
            </javadoc>
            <method name="getStatusMessages" type="String[]" line="154"/>
            <javadoc line="157">
                Retrieve the failure code returned by the TSA.                
                <return>
                    If -1 then no failure code was received.                    
                </return>
            </javadoc>
            <method name="getFailureCode" type="int" line="161"/>
            <method name="getStatusCodeAsText" type="String" line="164"/>
            <method name="getFailureCodeAsText" type="String" line="182">
                <scope line="183"/>
            </method>
            <javadoc line="207">
                Retrieve the timestamp token returned by the TSA.                
                <return>
                    If null then no token was received.                    
                </return>
            </javadoc>
            <method name="getToken" type="PKCS7" line="211"/>
            <javadoc line="214">
                Retrieve the ASN.1 BER encoded timestamp token returned by the TSA.                
                <return>
                    If null then no token was received.                    
                </return>
            </javadoc>
            <method name="getEncodedToken" type="byte[]" line="218"/>
            <method name="parse" type="void" line="221">
                <params>
                    <param name="tsReply" type="byte[]"/>
                </params>
                <declaration name="derValue" type="DerValue" line="222"/>
                <scope line="223"/>
                <declaration name="status" type="DerValue" line="226"/>
                <scope line="228"/>
                <scope line="231">
                    <declaration name="strings" type="DerValue[]" line="232"/>
                    <scope line="234"/>
                </scope>
                <scope line="238">
                    <declaration name="failInfo" type="byte[]" line="239"/>
                    <declaration name="failureInfo" type="int" line="240"/>
                    <scope line="241"/>
                </scope>
                <scope line="246">
                    <declaration name="timestampToken" type="DerValue" line="247"/>
                </scope>
                <scope line="251">
                    <scope line="252"/>
                </scope>
                <scope line="256"/>
            </method>
            <class name="TimestampException" line="260">
                <extends class="IOException"/>
                <method name="TimestampException" type="constructor" line="261">
                    <params>
                        <param name="message" type="String"/>
                    </params>
                </method>
            </class>
        </class>
    </source>