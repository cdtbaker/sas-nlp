<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.timestamp">
        <import package="java.io.IOException"/>
        <import package="java.math.BigInteger"/>
        <import package="java.security.cert.X509Extension"/>
        <import package="sun.security.util.DerValue"/>
        <import package="sun.security.util.DerOutputStream"/>
        <import package="sun.security.util.ObjectIdentifier"/>
        <class name="TSRequest" line="35">
            <javadoc line="35">
                This class provides a timestamp request, as defined in
                  &lt;a href=&quot;http://www.ietf.org/rfc/rfc3161.txt&quot;&gt;RFC 3161&lt;/a&gt;.
                  The TimeStampReq ASN.1 type has the following definition:
                  &lt;pre&gt;
                  TimeStampReq ::= SEQUENCE {
                  version           INTEGER { v1(1) },
                  messageImprint    MessageImprint
                  -- a hash algorithm OID and the hash value of the data to be
                  -- time-stamped.
                  reqPolicy         TSAPolicyId    OPTIONAL,
                  nonce             INTEGER        OPTIONAL,
                  certReq           BOOLEAN        DEFAULT FALSE,
                  extensions        [0] IMPLICIT Extensions OPTIONAL }
                  MessageImprint ::= SEQUENCE {
                  hashAlgorithm     AlgorithmIdentifier,
                  hashedMessage     OCTET STRING }
                  TSAPolicyId ::= OBJECT IDENTIFIER
                  &lt;/pre&gt;                
                <since>
                    1.5                    
                </since>
                <author>
                    Vincent Ryan                    
                </author>
                <see>
                    Timestamper                    
                </see>
            </javadoc>
            <declaration name="SHA1_OID" type="ObjectIdentifier" line="67"/>
            <declaration name="MD5_OID" type="ObjectIdentifier" line="68"/>
            <scope line="69">
                <declaration name="sha1" type="ObjectIdentifier" line="70"/>
                <declaration name="md5" type="ObjectIdentifier" line="71"/>
                <scope line="72"/>
                <scope line="75"/>
            </scope>
            <declaration name="version" type="int" line="82"/>
            <declaration name="hashAlgorithmId" type="ObjectIdentifier" line="84"/>
            <declaration name="hashValue" type="byte[]" line="86"/>
            <declaration name="policyId" type="String" line="88"/>
            <declaration name="nonce" type="BigInteger" line="90"/>
            <declaration name="returnCertificate" type="boolean" line="92"/>
            <declaration name="extensions" type="X509Extension[]" line="94"/>
            <javadoc line="96">
                Constructs a timestamp request for the supplied hash value..                
                <param>
                    hashValue     The hash value. This is the data to be timestamped.                    
                </param>
                <param>
                    hashAlgorithm The name of the hash algorithm.                    
                </param>
            </javadoc>
            <method name="TSRequest" type="constructor" line="102">
                <params>
                    <param name="hashValue" type="byte[]"/>
                    <param name="hashAlgorithm" type="String"/>
                </params>
                <comment line="105">
                    Check the common hash algorithms                    
                </comment>
                <comment line="108">
                    Check that the hash value matches the hash algorithm                    
                </comment>
                <comment line="115">
                    Check that the hash value matches the hash algorithm                    
                </comment>
                <comment line="119">
                    Clone the hash value                    
                </comment>
                <scope line="105"/>
                <scope line="112"/>
            </method>
            <javadoc line="123">
                Sets the Time-Stamp Protocol version.                
                <param>
                    version The TSP version.                    
                </param>
            </javadoc>
            <method name="setVersion" type="void" line="128">
                <params>
                    <param name="version" type="int"/>
                </params>
            </method>
            <javadoc line="132">
                Sets an object identifier for the Time-Stamp Protocol policy.                
                <param>
                    version The policy object identifier.                    
                </param>
            </javadoc>
            <method name="setPolicyId" type="void" line="137">
                <params>
                    <param name="policyId" type="String"/>
                </params>
            </method>
            <javadoc line="141">
                Sets a nonce.
                  A nonce is a single-use random number.                
                <param>
                    nonce The nonce value.                    
                </param>
            </javadoc>
            <method name="setNonce" type="void" line="147">
                <params>
                    <param name="nonce" type="BigInteger"/>
                </params>
            </method>
            <javadoc line="151">
                Request that the TSA include its signing certificate in the response.                
                <param>
                    returnCertificate True if the TSA should return its signing
                      certificate. By default it is not returned.                    
                </param>
            </javadoc>
            <method name="requestCertificate" type="void" line="157">
                <params>
                    <param name="returnCertificate" type="boolean"/>
                </params>
            </method>
            <javadoc line="161">
                Sets the Time-Stamp Protocol extensions.                
                <param>
                    extensions The protocol extensions.                    
                </param>
            </javadoc>
            <method name="setExtensions" type="void" line="166">
                <params>
                    <param name="extensions" type="X509Extension[]"/>
                </params>
            </method>
            <method name="encode" type="byte[]" line="170">
                <comment line="175">
                    encode version                    
                </comment>
                <comment line="178">
                    encode messageImprint                    
                </comment>
                <comment line="186">
                    encode optional elements                    
                </comment>
                <declaration name="request" type="DerOutputStream" line="172"/>
                <declaration name="messageImprint" type="DerOutputStream" line="178"/>
                <declaration name="hashAlgorithm" type="DerOutputStream" line="179"/>
                <scope line="187"/>
                <scope line="190"/>
                <scope line="193"/>
                <declaration name="out" type="DerOutputStream" line="197"/>
            </method>
        </class>
    </source>