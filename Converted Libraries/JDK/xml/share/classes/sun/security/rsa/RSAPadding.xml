<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.rsa">
        <import package="java.math.BigInteger"/>
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.interfaces"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto.BadPaddingException"/>
        <import package="javax.crypto.spec.PSource"/>
        <import package="javax.crypto.spec.OAEPParameterSpec"/>
        <import package="sun.security.jca.JCAUtil"/>
        <class name="RSAPadding" line="41">
            <comment line="67">
                NOTE: the constants below are embedded in the JCE RSACipher class
                 file. Do not change without coordinating the update                
            </comment>
            <comment line="70">
                PKCS#1 v1.5 padding, blocktype 1 (signing)                
            </comment>
            <comment line="72">
                PKCS#1 v1.5 padding, blocktype 2 (encryption)                
            </comment>
            <comment line="74">
                nopadding. Does not do anything, but allows simpler RSACipher code                
            </comment>
            <comment line="76">
                PKCS#1 v2.1 OAEP padding                
            </comment>
            <comment line="79">
                type, one of PAD_*                
            </comment>
            <comment line="82">
                size of the padded block (i.e. size of the modulus)                
            </comment>
            <comment line="85">
                PRNG used to generate padding bytes (PAD_BLOCKTYPE_2, PAD_OAEP_MGF1)                
            </comment>
            <comment line="88">
                maximum size of the data                
            </comment>
            <comment line="91">
                OAEP: main messagedigest                
            </comment>
            <comment line="94">
                OAEP: message digest for MGF1                
            </comment>
            <comment line="97">
                OAEP: value of digest of data (user-supplied or zero-length) using md                
            </comment>
            <comment line="129">
                internal constructor                
            </comment>
            <comment line="189">
                cache of hashes of zero length data                
            </comment>
            <javadoc line="41">
                RSA padding and unpadding.
                  Format of PKCS#1 v1.5 padding is:
                  0x00 | BT | PS...PS | 0x00 | data...data
                  where BT is the blocktype (1 or 2). The length of the entire string
                  must be the same as the size of the modulus (i.e. 128 byte for a 1024 bit
                  key). Per spec, the padding string must be at least 8 bytes long. That
                  leaves up to (length of key in bytes) - 11 bytes for the data.
                  OAEP padding is a bit more complicated and has a number of options.
                  We support:
                  . arbitrary hash functions (&apos;Hash&apos; in the specification), MessageDigest
                  implementation must be available
                  . MGF1 as the mask generation function
                  . the empty string as the default value for label L and whatever
                  specified in javax.crypto.spec.OAEPParameterSpec
                  Note: RSA keys should be at least 512 bits long                
                <since>
                    1.5                    
                </since>
                <author>
                    Andreas Sterbenz                    
                </author>
            </javadoc>
            <declaration name="PAD_BLOCKTYPE_1" type="int" line="70"/>
            <declaration name="PAD_BLOCKTYPE_2" type="int" line="72"/>
            <declaration name="PAD_NONE" type="int" line="74"/>
            <declaration name="PAD_OAEP_MGF1" type="int" line="76"/>
            <declaration name="type" type="int" line="79"/>
            <declaration name="paddedSize" type="int" line="82"/>
            <declaration name="random" type="SecureRandom" line="85"/>
            <declaration name="maxDataSize" type="int" line="88"/>
            <declaration name="md" type="MessageDigest" line="91"/>
            <declaration name="mgfMd" type="MessageDigest" line="94"/>
            <declaration name="lHash" type="byte[]" line="97"/>
            <javadoc line="99">
                Get a RSAPadding instance of the specified type.
                  Keys used with this padding must be paddedSize bytes long.                
            </javadoc>
            <method name="getInstance" type="RSAPadding" line="104">
                <params>
                    <param name="type" type="int"/>
                    <param name="paddedSize" type="int"/>
                </params>
            </method>
            <javadoc line="108">
                Get a RSAPadding instance of the specified type.
                  Keys used with this padding must be paddedSize bytes long.                
            </javadoc>
            <method name="getInstance" type="RSAPadding" line="114">
                <params>
                    <param name="type" type="int"/>
                    <param name="paddedSize" type="int"/>
                    <param name="random" type="SecureRandom"/>
                </params>
            </method>
            <javadoc line="118">
                Get a RSAPadding instance of the specified type, which must be
                  OAEP. Keys used with this padding must be paddedSize bytes long.                
            </javadoc>
            <method name="getInstance" type="RSAPadding" line="124">
                <params>
                    <param name="type" type="int"/>
                    <param name="paddedSize" type="int"/>
                    <param name="random" type="SecureRandom"/>
                    <param name="spec" type="OAEPParameterSpec"/>
                </params>
            </method>
            <method name="RSAPadding" type="constructor" line="131">
                <params>
                    <param name="type" type="int"/>
                    <param name="paddedSize" type="int"/>
                    <param name="random" type="SecureRandom"/>
                    <param name="spec" type="OAEPParameterSpec"/>
                </params>
                <comment line="137">
                    sanity check, already verified in RSASignature/RSACipher                    
                </comment>
                <scope line="135"/>
                <declaration name="mdName" type="String" line="148"/>
                <declaration name="mgfMdName" type="String" line="149"/>
                <declaration name="digestInput" type="byte[]" line="150"/>
                <scope line="151">
                    <scope line="152">
                        <declaration name="mgfName" type="String" line="154"/>
                        <scope line="155"/>
                        <declaration name="pSrc" type="PSource" line="160"/>
                        <declaration name="pSrcAlgo" type="String" line="161"/>
                        <scope line="162"/>
                    </scope>
                </scope>
                <scope line="170"/>
                <declaration name="digestLen" type="int" line="175"/>
                <scope line="177"/>
            </method>
            <declaration name="emptyHashes" type="Map&lt;String,byte[]&gt;" line="189"/>
            <javadoc line="192">
                Return the value of the digest using the specified message digest
                  &lt;code&gt;md&lt;/code&gt; and the digest input &lt;code&gt;digestInput&lt;/code&gt;.
                  if &lt;code&gt;digestInput&lt;/code&gt; is null or 0-length, zero length
                  is used to generate the initial digest.
                  Note: the md object must be in reset state                
            </javadoc>
            <method name="getInitialHash" type="byte[]" line="200">
                <params>
                    <param name="md" type="MessageDigest"/>
                    <param name="digestInput" type="byte[]"/>
                </params>
                <declaration name="result" type="byte[]" line="201"/>
                <scope line="202">
                    <declaration name="digestName" type="String" line="203"/>
                    <scope line="205"/>
                </scope>
                <scope line="209"/>
            </method>
            <javadoc line="215">
                Return the maximum size of the plaintext data that can be processed using
                  this object.                
            </javadoc>
            <method name="getMaxDataSize" type="int" line="219"/>
            <javadoc line="223">
                Pad the data and return the padded block.                
            </javadoc>
            <method name="pad" type="byte[]" line="227">
                <params>
                    <param name="data" type="byte[]"/>
                    <param name="ofs" type="int"/>
                    <param name="len" type="int"/>
                </params>
            </method>
            <javadoc line="231">
                Pad the data and return the padded block.                
            </javadoc>
            <method name="pad" type="byte[]" line="234">
                <params>
                    <param name="data" type="byte[]"/>
                </params>
                <scope line="235"/>
            </method>
            <javadoc line="252">
                Unpad the padded block and return the data.                
            </javadoc>
            <method name="unpad" type="byte[]" line="256">
                <params>
                    <param name="padded" type="byte[]"/>
                    <param name="ofs" type="int"/>
                    <param name="len" type="int"/>
                </params>
            </method>
            <javadoc line="260">
                Unpad the padded block and return the data.                
            </javadoc>
            <method name="unpad" type="byte[]" line="263">
                <params>
                    <param name="padded" type="byte[]"/>
                </params>
                <scope line="264"/>
            </method>
            <javadoc line="280">
                PKCS#1 v1.5 padding (blocktype 1 and 2).                
            </javadoc>
            <method name="padV15" type="byte[]" line="283">
                <params>
                    <param name="data" type="byte[]"/>
                </params>
                <comment line="292">
                    blocktype 1: all padding bytes are 0xff                    
                </comment>
                <comment line="297">
                    blocktype 2: padding bytes are random non-zero bytes                    
                </comment>
                <comment line="301">
                    generate non-zero padding bytes
                     use a buffer to reduce calls to SecureRandom                    
                </comment>
                <declaration name="padded" type="byte[]" line="284"/>
                <declaration name="psSize" type="int" line="286"/>
                <declaration name="k" type="int" line="287"/>
                <scope line="290">
                    <scope line="292"/>
                </scope>
                <scope line="295">
                    <scope line="297"/>
                    <declaration name="r" type="byte[]" line="302"/>
                    <declaration name="i" type="int" line="303"/>
                    <scope line="304">
                        <declaration name="b" type="int" line="305"/>
                        <scope line="306">
                            <scope line="307"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="319">
                PKCS#1 v1.5 unpadding (blocktype 1 and 2).                
            </javadoc>
            <method name="unpadV15" type="byte[]" line="322">
                <params>
                    <param name="padded" type="byte[]"/>
                </params>
                <declaration name="k" type="int" line="323"/>
                <scope line="324"/>
                <scope line="327"/>
                <scope line="330">
                    <declaration name="b" type="int" line="331"/>
                    <scope line="332"/>
                    <scope line="335"/>
                    <scope line="338"/>
                </scope>
                <declaration name="n" type="int" line="342"/>
                <scope line="343"/>
                <declaration name="data" type="byte[]" line="346"/>
            </method>
            <javadoc line="351">
                PKCS#1 v2.0 OAEP padding (MGF1).
                  Paragraph references refer to PKCS#1 v2.1 (June 14, 2002)                
            </javadoc>
            <method name="padOAEP" type="byte[]" line="355">
                <params>
                    <param name="M" type="byte[]"/>
                </params>
                <comment line="362">
                    2.d: generate a random octet string seed of length hLen
                     if necessary                    
                </comment>
                <comment line="367">
                    buffer for encoded message EM                    
                </comment>
                <comment line="370">
                    start and length of seed (as index into EM)                    
                </comment>
                <comment line="374">
                    copy seed into EM                    
                </comment>
                <comment line="377">
                    start and length of data block DB in EM
                     we place it inside of EM to reduce copying                    
                </comment>
                <comment line="382">
                    start of message M in EM                    
                </comment>
                <comment line="385">
                    build DB
                     2.b: Concatenate lHash, PS, a single octet with hexadecimal value
                     0x01, and the message M to form a data block DB of length
                     k - hLen -1 octets as DB = lHash || PS || 0x01 || M
                     (note that PS is all zeros)                    
                </comment>
                <comment line="394">
                    produce maskedDB                    
                </comment>
                <comment line="397">
                    produce maskSeed                    
                </comment>
                <scope line="356"/>
                <declaration name="hLen" type="int" line="359"/>
                <declaration name="seed" type="byte[]" line="363"/>
                <declaration name="EM" type="byte[]" line="367"/>
                <declaration name="seedStart" type="int" line="370"/>
                <declaration name="seedLen" type="int" line="371"/>
                <declaration name="dbStart" type="int" line="378"/>
                <declaration name="dbLen" type="int" line="379"/>
                <declaration name="mStart" type="int" line="382"/>
            </method>
            <javadoc line="402">
                PKCS#1 v2.1 OAEP unpadding (MGF1).                
            </javadoc>
            <method name="unpadOAEP" type="byte[]" line="405">
                <params>
                    <param name="padded" type="byte[]"/>
                </params>
                <comment line="423">
                    verify lHash == lHash&apos;                    
                </comment>
                <comment line="430">
                    skip over padding (0x00 bytes)                    
                </comment>
                <declaration name="EM" type="byte[]" line="406"/>
                <declaration name="hLen" type="int" line="407"/>
                <scope line="409"/>
                <declaration name="seedStart" type="int" line="413"/>
                <declaration name="seedLen" type="int" line="414"/>
                <declaration name="dbStart" type="int" line="416"/>
                <declaration name="dbLen" type="int" line="417"/>
                <scope line="423">
                    <scope line="424"/>
                </scope>
                <declaration name="i" type="int" line="430"/>
                <scope line="431">
                    <scope line="433"/>
                </scope>
                <scope line="438"/>
                <declaration name="mLen" type="int" line="443"/>
                <declaration name="m" type="byte[]" line="444"/>
            </method>
            <javadoc line="450">
                Compute MGF1 using mgfMD as the message digest.
                  Note that we combine MGF1 with the XOR operation to reduce data
                  copying.
                  We generate maskLen bytes of MGF1 from the seed and XOR it into
                  out[] starting at outOfs;                
            </javadoc>
            <method name="mgf1" type="void" line="459">
                <params>
                    <param name="seed" type="byte[]"/>
                    <param name="seedOfs" type="int"/>
                    <param name="seedLen" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                    <param name="maskLen" type="int"/>
                </params>
                <comment line="461">
                    32 bit counter                    
                </comment>
                <comment line="462">
                    20 bytes is length of SHA-1 digest                    
                </comment>
                <comment line="469">
                    should never happen                    
                </comment>
                <comment line="476">
                    increment counter                    
                </comment>
                <comment line="478">
                    empty                    
                </comment>
                <declaration name="C" type="byte[]" line="460"/>
                <declaration name="digest" type="byte[]" line="461"/>
                <scope line="462">
                    <scope line="465"/>
                    <scope line="467"/>
                    <scope line="471"/>
                    <scope line="474">
                        <scope line="476"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>