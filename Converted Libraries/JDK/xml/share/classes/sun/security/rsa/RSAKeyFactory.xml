<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.security.rsa">
        <import package="java.math.BigInteger"/>
        <import package="java.security"/>
        <import package="java.security.interfaces"/>
        <import package="java.security.spec"/>
        <import package="sun.security.action.GetPropertyAction"/>
        <class name="RSAKeyFactory" line="36">
            <extends class="KeyFactorySpi"/>
            <comment line="77">
                If the modulus length is above this value, restrict the size of
                 the exponent to something that can be reasonably computed.  We
                 could simply hardcode the exp len to something like 64 bits, but
                 this approach allows flexibility in case impls would like to use
                 larger module and exponent values.                
            </comment>
            <comment line="92">
                instance used for static translateKey();                
            </comment>
            <comment line="116">
                Single test entry point for all of the mechanisms in the SunRsaSign
                 provider (RSAKeyImpls).  All of the tests are the same.
                
                 For compatibility, we round up to the nearest byte here:
                 some Key impls might pass in a value within a byte of the
                 real value.                
            </comment>
            <comment line="198">
                see JCA doc                
            </comment>
            <comment line="210">
                see JCA doc                
            </comment>
            <comment line="222">
                internal implementation of translateKey() for public keys. See JCA doc                
            </comment>
            <comment line="248">
                internal implementation of translateKey() for private keys. See JCA doc                
            </comment>
            <comment line="294">
                internal implementation of generatePublic. See JCA doc                
            </comment>
            <comment line="312">
                internal implementation of generatePrivate. See JCA doc                
            </comment>
            <javadoc line="36">
                KeyFactory for RSA keys. Keys must be instances of PublicKey or PrivateKey
                  and getAlgorithm() must return &quot;RSA&quot;. For such keys, it supports conversion
                  between the following:
                  For public keys:
                  . PublicKey with an X.509 encoding
                  . RSAPublicKey
                  . RSAPublicKeySpec
                  . X509EncodedKeySpec
                  For private keys:
                  . PrivateKey with a PKCS#8 encoding
                  . RSAPrivateKey
                  . RSAPrivateCrtKey
                  . RSAPrivateKeySpec
                  . RSAPrivateCrtKeySpec
                  . PKCS8EncodedKeySpec
                  (of course, CRT variants only for CRT keys)
                  Note: as always, RSA keys should be at least 512 bits long                
                <since>
                    1.5                    
                </since>
                <author>
                    Andreas Sterbenz                    
                </author>
            </javadoc>
            <declaration name="rsaPublicKeySpecClass" type="Class&lt;?&gt;" line="63"/>
            <declaration name="rsaPrivateKeySpecClass" type="Class&lt;?&gt;" line="65"/>
            <declaration name="rsaPrivateCrtKeySpecClass" type="Class&lt;?&gt;" line="67"/>
            <declaration name="x509KeySpecClass" type="Class&lt;?&gt;" line="70"/>
            <declaration name="pkcs8KeySpecClass" type="Class&lt;?&gt;" line="71"/>
            <declaration name="MIN_MODLEN" type="int" line="73"/>
            <declaration name="MAX_MODLEN" type="int" line="74"/>
            <declaration name="MAX_MODLEN_RESTRICT_EXP" type="int" line="83"/>
            <declaration name="MAX_RESTRICTED_EXPLEN" type="int" line="84"/>
            <declaration name="restrictExpLen" type="boolean" line="86"/>
            <declaration name="INSTANCE" type="RSAKeyFactory" line="92"/>
            <method name="RSAKeyFactory" type="constructor" line="94">
                <comment line="95">
                    empty                    
                </comment>
            </method>
            <javadoc line="98">
                Static method to convert Key into an instance of RSAPublicKeyImpl
                  or RSAPrivate(Crt)KeyImpl. If the key is not an RSA key or cannot be
                  used, throw an InvalidKeyException.
                  Used by RSASignature and RSACipher.                
            </javadoc>
            <method name="toRSAKey" type="RSAKey" line="105">
                <params>
                    <param name="key" type="Key"/>
                </params>
                <scope line="108"/>
                <scope line="110"/>
            </method>
            <method name="checkRSAProviderKeyLengths" type="void" line="124">
                <params>
                    <param name="modulusLen" type="int"/>
                    <param name="exponent" type="BigInteger"/>
                </params>
            </method>
            <javadoc line="129">
                Check the length of an RSA key modulus/exponent to make sure it
                  is not too short or long.  Some impls have their own min and
                  max key sizes that may or may not match with a system defined value.                
                <param>
                    modulusLen the bit length of the RSA modulus.                    
                </param>
                <param>
                    exponent the RSA exponent                    
                </param>
                <param>
                    minModulusLen if > 0, check to see if modulusLen is at
                      least this long, otherwise unused.                    
                </param>
                <param>
                    maxModulusLen caller will allow this max number of bits.
                      Allow the smaller of the system-defined maximum and this param.                    
                </param>
                <throws>
                    InvalidKeyException if any of the values are unacceptable.                    
                </throws>
            </javadoc>
            <method name="checkKeyLengths" type="void" line="144">
                <params>
                    <param name="modulusLen" type="int"/>
                    <param name="exponent" type="BigInteger"/>
                    <param name="minModulusLen" type="int"/>
                    <param name="maxModulusLen" type="int"/>
                </params>
                <comment line="151">
                    Even though our policy file may allow this, we don&apos;t want                    
                </comment>
                <comment line="152">
                    either value (mod/exp) to be too big.                    
                </comment>
                <comment line="156">
                    If a RSAPrivateKey/RSAPublicKey, make sure the                    
                </comment>
                <comment line="157">
                    modulus len isn&apos;t too big.                    
                </comment>
                <comment line="163">
                    If a RSAPublicKey, make sure the exponent isn&apos;t too big.                    
                </comment>
                <scope line="146"/>
                <declaration name="maxLen" type="int" line="154"/>
                <scope line="158"/>
                <scope line="166"/>
            </method>
            <javadoc line="175">
                Translate an RSA key into a SunRsaSign RSA key. If conversion is
                  not possible, throw an InvalidKeyException.
                  See also JCA doc.                
            </javadoc>
            <method name="engineTranslateKey" type="Key" line="180">
                <params>
                    <param name="key" type="Key"/>
                </params>
                <scope line="181"/>
                <declaration name="keyAlg" type="String" line="184"/>
                <scope line="185"/>
                <scope line="188"/>
                <scope line="190"/>
                <scope line="192"/>
            </method>
            <method name="engineGeneratePublic" type="PublicKey" line="199">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="200"/>
                <scope line="202"/>
                <scope line="204"/>
            </method>
            <method name="engineGeneratePrivate" type="PrivateKey" line="211">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="212"/>
                <scope line="214"/>
                <scope line="216"/>
            </method>
            <method name="translatePublicKey" type="PublicKey" line="223">
                <params>
                    <param name="key" type="PublicKey"/>
                </params>
                <comment line="235">
                    catch providers that incorrectly implement RSAPublicKey                    
                </comment>
                <scope line="224">
                    <scope line="225"/>
                    <declaration name="rsaKey" type="RSAPublicKey" line="228"/>
                    <scope line="229"/>
                    <scope line="234"/>
                </scope>
                <scope line="238">
                    <declaration name="encoded" type="byte[]" line="239"/>
                </scope>
                <scope line="241"/>
            </method>
            <method name="translatePrivateKey" type="PrivateKey" line="249">
                <params>
                    <param name="key" type="PrivateKey"/>
                </params>
                <comment line="267">
                    catch providers that incorrectly implement RSAPrivateCrtKey                    
                </comment>
                <comment line="281">
                    catch providers that incorrectly implement RSAPrivateKey                    
                </comment>
                <scope line="250">
                    <scope line="251"/>
                    <declaration name="rsaKey" type="RSAPrivateCrtKey" line="254"/>
                    <scope line="255"/>
                    <scope line="266"/>
                </scope>
                <scope line="270">
                    <scope line="271"/>
                    <declaration name="rsaKey" type="RSAPrivateKey" line="274"/>
                    <scope line="275"/>
                    <scope line="280"/>
                </scope>
                <scope line="284">
                    <declaration name="encoded" type="byte[]" line="285"/>
                </scope>
                <scope line="287"/>
            </method>
            <method name="generatePublic" type="PublicKey" line="295">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="296">
                    <declaration name="x509Spec" type="X509EncodedKeySpec" line="297"/>
                </scope>
                <scope line="299">
                    <declaration name="rsaSpec" type="RSAPublicKeySpec" line="300"/>
                </scope>
                <scope line="305"/>
            </method>
            <method name="generatePrivate" type="PrivateKey" line="313">
                <params>
                    <param name="keySpec" type="KeySpec"/>
                </params>
                <scope line="314">
                    <declaration name="pkcsSpec" type="PKCS8EncodedKeySpec" line="315"/>
                </scope>
                <scope line="317">
                    <declaration name="rsaSpec" type="RSAPrivateCrtKeySpec" line="318"/>
                </scope>
                <scope line="329">
                    <declaration name="rsaSpec" type="RSAPrivateKeySpec" line="330"/>
                </scope>
                <scope line="335"/>
            </method>
            <method name="engineGetKeySpec" type="T" line="342">
                <params>
                    <param name="key" type="Key"/>
                    <param name="keySpec" type="Class<T>"/>
                </params>
                <comment line="344">
                    convert key to one of our keys                    
                </comment>
                <comment line="345">
                    this also verifies that the key is a valid RSA key and ensures                    
                </comment>
                <comment line="346">
                    that the encoding is X.509/PKCS#8 for public/private keys                    
                </comment>
                <comment line="397">
                    should not occur, caught in engineTranslateKey()                    
                </comment>
                <scope line="343"/>
                <scope line="348"/>
                <scope line="351">
                    <declaration name="rsaKey" type="RSAPublicKey" line="352"/>
                    <scope line="353"/>
                    <scope line="358"/>
                    <scope line="360"/>
                </scope>
                <scope line="365">
                    <scope line="366"/>
                    <scope line="368">
                        <scope line="369">
                            <declaration name="crtKey" type="RSAPrivateCrtKey" line="370"/>
                        </scope>
                        <scope line="381"/>
                    </scope>
                    <scope line="385">
                        <declaration name="rsaKey" type="RSAPrivateKey" line="386"/>
                    </scope>
                    <scope line="391"/>
                </scope>
                <scope line="396"/>
            </method>
        </class>
    </source>