<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.tools.jar">
        <import package="java.io"/>
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="sun.net.www.MessageHeader"/>
        <import package="sun.misc.BASE64Encoder"/>
        <import package="sun.misc.BASE64Decoder"/>
        <import package="sun.security.pkcs"/>
        <import package="sun.security.x509.AlgorithmId"/>
        <class name="SignatureFile" line="39">
            <comment line="65">
                                
            </comment>
            <comment line="68">
                list of headers that all pertain to a particular file in the                
            </comment>
            <comment line="72">
                                
            </comment>
            <comment line="80">
                                
            </comment>
            <comment line="84">
                The file name for the file. This is the raw name, i.e. the
                 extention-less 8 character name (such as MYSIGN) which wil be
                 used to build the signature filename (MYSIGN.SF) and the block                
            </comment>
            <comment line="91">
                The digital signature block corresponding to this signature                
            </comment>
            <javadoc line="39">
                &lt;p&gt;A signature file as defined in the &lt;a
                  href=&quot;manifest.html&quot;&gt;Manifest and Signature Format&lt;/a&gt;. It has
                  essentially the same structure as a Manifest file in that it is a
                  set of RFC 822 headers (sections). The first section contains meta
                  data relevant to the entire file (i.e &quot;Signature-Version:1.0&quot;) and
                  each subsequent section contains data relevant to specific entries:
                  entry sections.
                  &lt;p&gt;Each entry section contains the name of an entry (which must
                  have a counterpart in the manifest). Like the manifest it contains
                  a hash, the hash of the manifest section correspondind to the
                  name. Since the manifest entry contains the hash of the data, this
                  is equivalent to a signature of the data, plus the attributes of
                  the manifest entry.
                  &lt;p&gt;This signature file format deal with PKCS7 encoded DSA signature
                  block. It should be straightforward to extent to support other
                  algorithms.                
                <author>
                    David Brown                    
                </author>
                <author>
                    Benjamin Renaud                    
                </author>
            </javadoc>
            <declaration name="debug" type="boolean" line="65"/>
            <declaration name="entries" type="Vector" line="69"/>
            <declaration name="hashes" type="String[]" line="72"/>
            <method name="debug" type="void" line="74">
                <params>
                    <param name="s" type="String"/>
                </params>
            </method>
            <declaration name="manifest" type="Manifest" line="81"/>
            <declaration name="rawName" type="String" line="88"/>
            <declaration name="signatureBlock" type="PKCS7" line="92"/>
            <javadoc line="95">
                Private constructor which takes a name a given signature
                  file. The name must be extension-less and less or equal to 8
                  character in length.                
            </javadoc>
            <method name="SignatureFile" type="constructor" line="99">
                <params>
                    <param name="name" type="String"/>
                </params>
                <scope line="103">
                    <scope line="104"/>
                </scope>
            </method>
            <javadoc line="111">
                Private constructor which takes a name a given signature file
                  and a new file predicate. If it is a new file, a main header
                  will be added.                
            </javadoc>
            <method name="SignatureFile" type="constructor" line="116">
                <params>
                    <param name="name" type="String"/>
                    <param name="newFile" type="boolean"/>
                </params>
                <scope line="120">
                    <declaration name="globals" type="MessageHeader" line="121"/>
                </scope>
            </method>
            <javadoc line="127">
                Constructs a new Signature file corresponding to a given
                  Manifest. All entries in the manifest are signed.                
                <param>
                    manifest the manifest to use.                    
                </param>
                <param>
                    name for this signature file. This should
                      be less than 8 characters, and without a suffix (i.e.
                      without a period in it.                    
                </param>
                <exception>
                    JarException if an invalid name is passed in.                    
                </exception>
            </javadoc>
            <method name="SignatureFile" type="constructor" line="140">
                <params>
                    <param name="manifest" type="Manifest"/>
                    <param name="name" type="String"/>
                </params>
                <declaration name="enum_" type="Enumeration" line="145"/>
                <scope line="146">
                    <declaration name="mh" type="MessageHeader" line="147"/>
                    <declaration name="entryName" type="String" line="148"/>
                    <scope line="149"/>
                </scope>
            </method>
            <javadoc line="155">
                Constructs a new Signature file corresponding to a given
                  Manifest. Specific entries in the manifest are signed.                
                <param>
                    manifest the manifest to use.                    
                </param>
                <param>
                    entries the entries to sign.                    
                </param>
                <param>
                    filename for this signature file. This should
                      be less than 8 characters, and without a suffix (i.e.
                      without a period in it.                    
                </param>
                <exception>
                    JarException if an invalid name is passed in.                    
                </exception>
            </javadoc>
            <method name="SignatureFile" type="constructor" line="171">
                <params>
                    <param name="manifest" type="Manifest"/>
                    <param name="entries" type="String[]"/>
                    <param name="filename" type="String"/>
                </params>
            </method>
            <javadoc line="177">
                Construct a Signature file from an input stream.                
                <exception>
                    IOException if an invalid name is passed in or if a
                      stream exception occurs.                    
                </exception>
            </javadoc>
            <method name="SignatureFile" type="constructor" line="184">
                <params>
                    <param name="is" type="InputStream"/>
                    <param name="filename" type="String"/>
                </params>
                <scope line="186">
                    <declaration name="m" type="MessageHeader" line="187"/>
                </scope>
            </method>
            <javadoc line="192">
                Construct a Signature file from an input stream.                
                <exception>
                    IOException if an invalid name is passed in or if a
                      stream exception occurs.                    
                </exception>
            </javadoc>
            <method name="SignatureFile" type="constructor" line="198">
                <params>
                    <param name="is" type="InputStream"/>
                </params>
            </method>
            <method name="SignatureFile" type="constructor" line="202">
                <params>
                    <param name="bytes" type="byte[]"/>
                </params>
            </method>
            <javadoc line="206">
                Returns the name of the signature file, ending with a &quot;.SF&quot;
                  suffix                
            </javadoc>
            <method name="getName" type="String" line="209"/>
            <javadoc line="213">
                Returns the name of the block file, ending with a block suffix
                  such as &quot;.DSA&quot;.                
            </javadoc>
            <method name="getBlockName" type="String" line="216">
                <declaration name="suffix" type="String" line="217"/>
                <scope line="218">
                    <declaration name="info" type="SignerInfo" line="219"/>
                    <declaration name="temp" type="String" line="221"/>
                </scope>
            </method>
            <javadoc line="227">
                Returns the signature block associated with this file.                
            </javadoc>
            <method name="getBlock" type="PKCS7" line="230"/>
            <javadoc line="234">
                Sets the signature block associated with this file.                
            </javadoc>
            <method name="setBlock" type="void" line="237">
                <params>
                    <param name="block" type="PKCS7"/>
                </params>
            </method>
            <javadoc line="241">
                Add a set of entries from the current manifest.                
            </javadoc>
            <method name="add" type="void" line="244">
                <params>
                    <param name="entries" type="String[]"/>
                </params>
                <scope line="245"/>
            </method>
            <javadoc line="250">
                Add a specific entry from the current manifest.                
            </javadoc>
            <method name="add" type="void" line="253">
                <params>
                    <param name="entry" type="String"/>
                </params>
                <declaration name="mh" type="MessageHeader" line="254"/>
                <scope line="255"/>
                <declaration name="smh" type="MessageHeader" line="258"/>
                <scope line="259"/>
                <scope line="261"/>
            </method>
            <javadoc line="267">
                Get the entry corresponding to a given name. Returns null if
                  the entry does not exist.                
            </javadoc>
            <method name="getEntry" type="MessageHeader" line="271">
                <params>
                    <param name="name" type="String"/>
                </params>
                <declaration name="enum_" type="Enumeration" line="272"/>
                <scope line="273">
                    <declaration name="mh" type="MessageHeader" line="274"/>
                    <scope line="275"/>
                </scope>
            </method>
            <javadoc line="282">
                Returns the n-th entry. The global header is a entry 0.                
            </javadoc>
            <method name="entryAt" type="MessageHeader" line="284">
                <params>
                    <param name="n" type="int"/>
                </params>
            </method>
            <javadoc line="288">
                Returns an enumeration of the entries.                
            </javadoc>
            <method name="entries" type="Enumeration" line="291"/>
            <javadoc line="295">
                Given a manifest entry, computes the signature entry for this
                  manifest entry.                
            </javadoc>
            <method name="computeEntry" type="MessageHeader" line="299">
                <params>
                    <param name="mh" type="MessageHeader"/>
                </params>
                <declaration name="smh" type="MessageHeader" line="300"/>
                <declaration name="name" type="String" line="302"/>
                <scope line="303"/>
                <declaration name="encoder" type="BASE64Encoder" line="308"/>
                <scope line="309">
                    <scope line="310">
                        <declaration name="dig" type="MessageDigest" line="311"/>
                        <declaration name="baos" type="ByteArrayOutputStream" line="312"/>
                        <declaration name="ps" type="PrintStream" line="313"/>
                        <declaration name="headerBytes" type="byte[]" line="315"/>
                        <declaration name="digest" type="byte[]" line="316"/>
                    </scope>
                </scope>
                <scope line="320"/>
            </method>
            <declaration name="digests" type="Hashtable" line="325"/>
            <method name="getDigest" type="MessageDigest" line="328">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <declaration name="dig" type="MessageDigest" line="329"/>
                <scope line="330"/>
            </method>
            <javadoc line="339">
                Add a signature file at current position in a stream                
            </javadoc>
            <method name="stream" type="void" line="342">
                <params>
                    <param name="os" type="OutputStream"/>
                </params>
                <comment line="345">
                    the first header in the file should be the global one.
                     It should say &quot;SignatureFile-Version: x.x&quot;; barf if not                    
                </comment>
                <declaration name="globals" type="MessageHeader" line="347"/>
                <scope line="348"/>
                <declaration name="ps" type="PrintStream" line="353"/>
                <scope line="356">
                    <declaration name="mh" type="MessageHeader" line="357"/>
                </scope>
            </method>
        </class>
    </source>