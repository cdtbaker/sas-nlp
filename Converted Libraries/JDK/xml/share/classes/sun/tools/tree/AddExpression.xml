<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.tools.tree">
        <import package="sun.tools.java"/>
        <import package="sun.tools.asm.Assembler"/>
        <class name="AddExpression" line="4">
            <extends class="BinaryArithmeticExpression"/>
            <javadoc line="4">
                WARNING: The contents of this source file are not part of any
                  supported API.  Code that depends on them does so at its own risk:
                  they are subject to change or removal without notice.                
            </javadoc>
            <javadoc line="10">
                constructor                
            </javadoc>
            <method name="AddExpression" type="constructor" line="13">
                <params>
                    <param name="where" type="long"/>
                    <param name="left" type="Expression"/>
                    <param name="right" type="Expression"/>
                </params>
            </method>
            <javadoc line="16">
                Select the type                
            </javadoc>
            <method name="selectType" type="void" line="19">
                <params>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                    <param name="tm" type="int"/>
                </params>
                <scope line="20"/>
                <scope line="24"/>
            </method>
            <method name="isNonNull" type="boolean" line="30"/>
            <javadoc line="33">
                Evaluate                
            </javadoc>
            <method name="eval" type="Expression" line="36">
                <params>
                    <param name="a" type="int"/>
                    <param name="b" type="int"/>
                </params>
            </method>
            <method name="eval" type="Expression" line="39">
                <params>
                    <param name="a" type="long"/>
                    <param name="b" type="long"/>
                </params>
            </method>
            <method name="eval" type="Expression" line="42">
                <params>
                    <param name="a" type="float"/>
                    <param name="b" type="float"/>
                </params>
            </method>
            <method name="eval" type="Expression" line="45">
                <params>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                </params>
            </method>
            <method name="eval" type="Expression" line="48">
                <params>
                    <param name="a" type="String"/>
                    <param name="b" type="String"/>
                </params>
            </method>
            <javadoc line="51">
                Inline the value of an AddExpression.  If this AddExpression
                  represents a concatenation of compile-time constant strings,
                  dispatch to the special method inlineValueSB, which handles
                  the inlining more efficiently.                
            </javadoc>
            <method name="inlineValue" type="Expression" line="57">
                <params>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                </params>
                <scope line="58">
                    <declaration name="buffer" type="StringBuffer" line="59"/>
                    <scope line="60"/>
                </scope>
            </method>
            <javadoc line="66">
                Attempt to evaluate this expression.  If this expression
                  yields a value, append it to the StringBuffer `buffer&apos;.
                  If this expression cannot be evaluated at this time (for
                  example if it contains a division by zero, a non-constant
                  subexpression, or a subexpression which &quot;refuses&quot; to evaluate)
                  then return `null&apos; to indicate failure.
                  It is anticipated that this method will be called to evaluate
                  concatenations of compile-time constant strings.  The call
                  originates from AddExpression#inlineValue().
                  This method does not use associativity to good effect in
                  folding string concatenations.  This is room for improvement.
                  -------------
                  A bit of history: this method was added because an
                  expression like...
                  &quot;a&quot; + &quot;b&quot; + &quot;c&quot; + &quot;d&quot;
                  ...was evaluated at compile-time as...
                  (new StringBuffer((new StringBuffer(&quot;a&quot;)).append(&quot;b&quot;).toString())).
                  append((new StringBuffer(&quot;c&quot;)).append(&quot;d&quot;).toString()).toString()
                  Alex Garthwaite, in profiling the memory allocation of the
                  compiler, noticed this and suggested that the method inlineValueSB()
                  be added to evaluate constant string concatenations in a more
                  efficient manner.  The compiler now builds the string in a
                  top-down fashion, by accumulating the result in a StringBuffer
                  which is allocated once and passed in as a parameter.  The new
                  evaluation scheme is equivalent to...
                  (new StringBuffer(&quot;a&quot;)).append(&quot;b&quot;).append(&quot;c&quot;).append(&quot;d&quot;)
                  .toString()
                  ...which is more efficient.  Since then, the code has been modified
                  to fix certain problems.  Now, for example, it can return `null&apos;
                  when it encounters a concatenation which it is not able to
                  evaluate.
                  See also Expression#inlineValueSB() and ExprExpression#inlineValueSB().                
            </javadoc>
            <method name="inlineValueSB" type="StringBuffer" line="100">
                <params>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                    <param name="buffer" type="StringBuffer"/>
                </params>
                <scope line="101"/>
                <scope line="105"/>
            </method>
            <javadoc line="110">
                Simplify                
            </javadoc>
            <method name="simplify" type="Expression" line="113">
                <scope line="114">
                    <scope line="115">
                        <scope line="116"/>
                        <scope line="119"/>
                    </scope>
                </scope>
                <scope line="124"/>
                <scope line="127"/>
            </method>
            <javadoc line="132">
                The cost of inlining this expression                
            </javadoc>
            <method name="costInline" type="int" line="135">
                <params>
                    <param name="thresh" type="int"/>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                </params>
            </method>
            <javadoc line="138">
                Code                
            </javadoc>
            <method name="codeOperation" type="void" line="141">
                <params>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                    <param name="asm" type="Assembler"/>
                </params>
            </method>
            <javadoc line="144">
                Convert this expression to a string and append it to the string
                  buffer on the top of the stack.
                  If the needBuffer argument is true, the string buffer needs to be
                  created, initialized, and pushed on the stack, first.                
            </javadoc>
            <method name="codeAppend" type="void" line="150">
                <params>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                    <param name="asm" type="Assembler"/>
                    <param name="sbClass" type="ClassDeclaration"/>
                    <param name="needBuffer" type="boolean"/>
                </params>
                <scope line="151"/>
                <scope line="155"/>
            </method>
            <method name="codeValue" type="void" line="159">
                <params>
                    <param name="env" type="Environment"/>
                    <param name="ctx" type="Context"/>
                    <param name="asm" type="Assembler"/>
                </params>
                <scope line="160">
                    <scope line="161">
                        <scope line="162"/>
                        <scope line="167"/>
                        <declaration name="sbClass" type="ClassDeclaration" line="172"/>
                        <declaration name="sourceClass" type="ClassDefinition" line="173"/>
                        <declaration name="f" type="MemberDefinition" line="175"/>
                    </scope>
                    <scope line="178"/>
                    <scope line="181"/>
                </scope>
                <scope line="185"/>
            </method>
        </class>
    </source>