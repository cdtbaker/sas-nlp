<?xml version="1.0" encoding="UTF-8"?>
    <source package="sun.invoke.util">
        <import package="java.lang.reflect.Modifier"/>
        <import package="java.lang.reflect.Modifier"/>
        <class name="VerifyAccess" line="31">
            <comment line="38">
                cannot instantiate                
            </comment>
            <javadoc line="31">
                This class centralizes information about the JVM&apos;s linkage access control.                
                <author>
                    jrose                    
                </author>
            </javadoc>
            <method name="VerifyAccess" type="constructor" line="37"/>
            <declaration name="PACKAGE_ONLY" type="int" line="39"/>
            <declaration name="ALL_ACCESS_MODES" type="int" line="40"/>
            <declaration name="ALLOW_NESTMATE_ACCESS" type="boolean" line="41"/>
            <javadoc line="43">
                Evaluate the JVM linkage rules for access to the given method
                  on behalf of a caller class which proposes to perform the access.
                  Return true if the caller class has privileges to invoke a method
                  or access a field with the given properties.
                  This requires an accessibility check of the referencing class,
                  plus an accessibility check of the member within the class,
                  which depends on the member&apos;s modifier flags.
                  &lt;p&gt;
                  The relevant properties include the defining class ({@code defc})
                  of the member, and its modifier flags ({@code mods}).
                  Also relevant is the class used to make the initial symbolic reference
                  to the member ({@code refc}).  If this latter class is not distinguished,
                  the defining class should be passed for both arguments ({@code defc == refc}).
                  &lt;h3&gt;JVM Specification, 5.4.4 &quot;Access Control&quot;&lt;/h3&gt;
                  A field or method R is accessible to a class or interface D if
                  and only if any of the following conditions is true:&lt;ul&gt;
                  &lt;li&gt;R is public.
                  &lt;li&gt;R is protected and is declared in a class C, and D is either
                  a subclass of C or C itself.  Furthermore, if R is not
                  static, then the symbolic reference to R must contain a
                  symbolic reference to a class T, such that T is either a
                  subclass of D, a superclass of D or D itself.
                  &lt;li&gt;R is either protected or has default access (that is,
                  neither public nor protected nor private), and is declared
                  by a class in the same runtime package as D.
                  &lt;li&gt;R is private and is declared in D.
                  &lt;/ul&gt;
                  This discussion of access control omits a related restriction
                  on the target of a protected field access or method invocation
                  (the target must be of class D or a subtype of D). That
                  requirement is checked as part of the verification process
                  (5.4.1); it is not part of link-time access control.                
                <param>
                    refc the class used in the symbolic reference to the proposed member                    
                </param>
                <param>
                    defc the class in which the proposed member is actually defined                    
                </param>
                <param>
                    mods modifier flags for the proposed member                    
                </param>
                <param>
                    lookupClass the class for which the access check is being made                    
                </param>
                <return>
                    true iff the the accessing class can access such a member                    
                </return>
            </javadoc>
            <method name="isMemberAccessible" type="boolean" line="85">
                <params>
                    <param name="refc" type="Class<?>"/>
                    <param name="defc" type="Class<?>"/>
                    <param name="mods" type="int"/>
                    <param name="lookupClass" type="Class<?>"/>
                </params>
                <comment line="83">
                    symbolic ref class                    
                </comment>
                <comment line="84">
                    actual def class                    
                </comment>
                <comment line="85">
                    actual member mods                    
                </comment>
                <comment line="87">
                    Usually refc and defc are the same, but if they differ, verify them both.                    
                </comment>
                <comment line="90">
                    Note that defc is verified in the switch below.                    
                </comment>
                <comment line="94">
                    Apply the special rules for refc here.                    
                </comment>
                <comment line="97">
                    If refc == defc, the call to isPublicSuperClass will do
                     the whole job, since in that case refc (as defc) will be
                     a superclass of the lookup class.                    
                </comment>
                <comment line="103">
                    easy check; all self-access is OK                    
                </comment>
                <comment line="106">
                    already checked above                    
                </comment>
                <comment line="113">
                    Loosened rules for privates follows access rules for inner classes.                    
                </comment>
                <scope line="87">
                    <scope line="88"/>
                    <scope line="92"/>
                </scope>
            </method>
            <method name="isRelatedClass" type="boolean" line="120">
                <params>
                    <param name="refc" type="Class<?>"/>
                    <param name="lookupClass" type="Class<?>"/>
                </params>
            </method>
            <method name="isPublicSuperClass" type="boolean" line="126">
                <params>
                    <param name="defc" type="Class<?>"/>
                    <param name="lookupClass" type="Class<?>"/>
                </params>
            </method>
            <javadoc line="130">
                Evaluate the JVM linkage rules for access to the given class on behalf of caller.
                  &lt;h3&gt;JVM Specification, 5.4.4 &quot;Access Control&quot;&lt;/h3&gt;
                  A class or interface C is accessible to a class or interface D
                  if and only if either of the following conditions are true:&lt;ul&gt;
                  &lt;li&gt;C is public.
                  &lt;li&gt;C and D are members of the same runtime package.
                  &lt;/ul&gt;                
                <param>
                    refc the symbolic reference class to which access is being checked (C)                    
                </param>
                <param>
                    lookupClass the class performing the lookup (D)                    
                </param>
            </javadoc>
            <method name="isClassAccessible" type="boolean" line="141">
                <params>
                    <param name="refc" type="Class<?>"/>
                    <param name="lookupClass" type="Class<?>"/>
                </params>
                <declaration name="mods" type="int" line="142"/>
            </method>
            <javadoc line="150">
                Test if two classes have the same class loader and package qualifier.                
                <param>
                    class1                    
                </param>
                <param>
                    class2                    
                </param>
                <return>
                    whether they are in the same package                    
                </return>
            </javadoc>
            <method name="isSamePackage" type="boolean" line="156">
                <params>
                    <param name="class1" type="Class<?>"/>
                    <param name="class2" type="Class<?>"/>
                </params>
                <declaration name="name1" type="String" line="162"/>
                <declaration name="dot" type="int" line="163"/>
                <scope line="166"/>
            </method>
            <javadoc line="173">
                Return the package name for this class.                
            </javadoc>
            <method name="getPackageName" type="String" line="175">
                <params>
                    <param name="cls" type="Class<?>"/>
                </params>
                <declaration name="name" type="String" line="177"/>
                <declaration name="dot" type="int" line="178"/>
            </method>
            <javadoc line="183">
                Test if two classes are defined as part of the same package member (top-level class).
                  If this is true, they can share private access with each other.                
                <param>
                    class1                    
                </param>
                <param>
                    class2                    
                </param>
                <return>
                    whether they are identical or nested together                    
                </return>
            </javadoc>
            <method name="isSamePackageMember" type="boolean" line="190">
                <params>
                    <param name="class1" type="Class<?>"/>
                    <param name="class2" type="Class<?>"/>
                </params>
            </method>
            <method name="getOutermostEnclosingClass" type="Class<?>" line="200">
                <params>
                    <param name="c" type="Class<?>"/>
                </params>
                <declaration name="pkgmem" type="Class&lt;?&gt;" line="201"/>
            </method>
            <method name="loadersAreRelated" type="boolean" line="208">
                <params>
                    <param name="loader1" type="ClassLoader"/>
                    <param name="loader2" type="ClassLoader"/>
                    <param name="loader1MustBeParent" type="boolean"/>
                </params>
                <comment line="219">
                    see if loader2 is a parent of loader1:                    
                </comment>
                <scope line="210"/>
                <scope line="214"/>
                <scope line="220"/>
            </method>
            <javadoc line="226">
                Is the class loader of parentClass identical to, or an ancestor of,
                  the class loader of childClass?                
                <param>
                    parentClass                    
                </param>
                <param>
                    childClass                    
                </param>
                <return>
                    whether parentClass precedes or equals childClass in class loader order                    
                </return>
            </javadoc>
            <method name="classLoaderIsAncestor" type="boolean" line="233">
                <params>
                    <param name="parentClass" type="Class<?>"/>
                    <param name="childClass" type="Class<?>"/>
                </params>
            </method>
        </class>
    </source>