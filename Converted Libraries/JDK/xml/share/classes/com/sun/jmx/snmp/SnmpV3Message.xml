<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.jmx.snmp">
        <import package="java.util.Vector"/>
        <import package="java.util.logging.Level"/>
        <import package="java.net.InetAddress"/>
        <import package="com.sun.jmx.defaults.JmxProperties.SNMP_LOGGER"/>
        <import package="com.sun.jmx.snmp.internal.SnmpMsgProcessingSubSystem"/>
        <import package="com.sun.jmx.snmp.internal.SnmpSecurityModel"/>
        <import package="com.sun.jmx.snmp.internal.SnmpDecryptedPdu"/>
        <import package="com.sun.jmx.snmp.internal.SnmpSecurityCache"/>
        <import package="com.sun.jmx.snmp.SnmpMsg"/>
        <import package="com.sun.jmx.snmp.SnmpPdu"/>
        <import package="com.sun.jmx.snmp.SnmpStatusException"/>
        <import package="com.sun.jmx.snmp.SnmpTooBigException"/>
        <import package="com.sun.jmx.snmp.SnmpScopedPduBulk"/>
        <import package="com.sun.jmx.snmp.BerException"/>
        <import package="com.sun.jmx.snmp.SnmpScopedPduRequest"/>
        <import package="com.sun.jmx.snmp.BerDecoder"/>
        <import package="com.sun.jmx.snmp.SnmpDefinitions"/>
        <import package="com.sun.jmx.snmp.SnmpEngineId"/>
        <import package="com.sun.jmx.snmp.SnmpScopedPduPacket"/>
        <import package="com.sun.jmx.snmp.BerEncoder"/>
        <import package="com.sun.jmx.snmp.SnmpPduRequestType"/>
        <import package="com.sun.jmx.snmp.SnmpPduBulkType"/>
        <class name="SnmpV3Message" line="24">
            <extends class="SnmpMsg"/>
            <javadoc line="24">
                Is a partially decoded representation of an SNMP V3 packet.
                  &lt;P&gt;
                  This class can be used when developing customized manager or agent.
                  &lt;P&gt;
                  The &lt;CODE&gt;SnmpV3Message&lt;/CODE&gt; class is directly mapped onto the
                  message syntax defined in RFC 2572.
                  &lt;BLOCKQUOTE&gt;
                  &lt;PRE&gt;
                  SNMPv3Message ::= SEQUENCE {
                  msgVersion INTEGER ( 0 .. 2147483647 ),
                  -- administrative parameters
                  msgGlobalData HeaderData,
                  -- security model-specific parameters
                  -- format defined by Security Model
                  msgSecurityParameters OCTET STRING,
                  msgData  ScopedPduData
                  }
                  HeaderData ::= SEQUENCE {
                  msgID      INTEGER (0..2147483647),
                  msgMaxSize INTEGER (484..2147483647),
                  msgFlags   OCTET STRING (SIZE(1)),
                  --  .... ...1   authFlag
                  --  .... ..1.   privFlag
                  --  .... .1..   reportableFlag
                  --              Please observe:
                  --  .... ..00   is OK, means noAuthNoPriv
                  --  .... ..01   is OK, means authNoPriv
                  --  .... ..10   reserved, must NOT be used.
                  --  .... ..11   is OK, means authPriv
                  msgSecurityModel INTEGER (1..2147483647)
                  }
                  &lt;/BLOCKQUOTE&gt;
                  &lt;/PRE&gt;
                  &lt;p&gt;&lt;b&gt;This API is a Sun Microsystems internal API  and is subject
                  to change without notice.&lt;/b&gt;&lt;/p&gt;                
                <since>
                    1.5                    
                </since>
            </javadoc>
            <declaration name="msgId" type="int" line="63"/>
            <javadoc line="63">
                Message identifier.                
            </javadoc>
            <declaration name="msgMaxSize" type="int" line="67"/>
            <javadoc line="67">
                Message max size the pdu sender can deal with.                
            </javadoc>
            <declaration name="msgFlags" type="byte" line="71"/>
            <javadoc line="71">
                Message flags. Reportable flag  and security level.&lt;/P&gt;
                  &lt;PRE&gt;
                  --  .... ...1   authFlag
                  --  .... ..1.   privFlag
                  --  .... .1..   reportableFlag
                  --              Please observe:
                  --  .... ..00   is OK, means noAuthNoPriv
                  --  .... ..01   is OK, means authNoPriv
                  --  .... ..10   reserved, must NOT be used.
                  --  .... ..11   is OK, means authPriv
                  &lt;/PRE&gt;                
            </javadoc>
            <declaration name="msgSecurityModel" type="int" line="85"/>
            <javadoc line="85">
                The security model the security sub system MUST use in order to deal with this pdu (eg: User based Security Model Id = 3).                
            </javadoc>
            <declaration name="msgSecurityParameters" type="byte[]" line="89"/>
            <javadoc line="89">
                The unmarshalled security parameters.                
            </javadoc>
            <declaration name="contextEngineId" type="byte[]" line="93"/>
            <javadoc line="93">
                The context engine Id in which the pdu must be handled (Generaly the local engine Id).                
            </javadoc>
            <declaration name="contextName" type="byte[]" line="97"/>
            <javadoc line="97">
                The context name in which the OID has to be interpreted.                
            </javadoc>
            <declaration name="encryptedPdu" type="byte[]" line="101"/>
            <javadoc line="101">
                The encrypted form of the scoped pdu (Only relevant when dealing with privacy).                
            </javadoc>
            <javadoc line="105">
                Constructor.                
            </javadoc>
            <method name="SnmpV3Message" type="constructor" line="108"/>
            <javadoc line="110">
                Encodes this message and puts the result in the specified byte array.
                  For internal use only.                
                <param>
                    outputBytes An array to receive the resulting encoding.                    
                </param>
                <exception>
                    ArrayIndexOutOfBoundsException If the result does not fit
                      into the specified array.                    
                </exception>
            </javadoc>
            <method name="encodeMessage" type="int" line="117">
                <params>
                    <param name="outputBytes" type="byte[]"/>
                </params>
                <declaration name="encodingLength" type="int" line="118"/>
                <scope line="119"/>
            </method>
            <javadoc line="124">
                Decodes the specified bytes and initializes this message.
                  For internal use only.                
                <param>
                    inputBytes The bytes to be decoded.                    
                </param>
                <exception>
                    SnmpStatusException If the specified bytes are not a valid encoding.                    
                </exception>
            </javadoc>
            <method name="decodeMessage" type="void" line="130">
                <params>
                    <param name="inputBytes" type="byte[]"/>
                    <param name="byteCount" type="int"/>
                </params>
                <scope line="131">
                    <declaration name="bdec" type="BerDecoder" line="132"/>
                    <scope line="142"/>
                    <scope line="150"/>
                </scope>
                <scope line="155"/>
                <scope line="159">
                    <declaration name="strb" type="StringBuilder" line="160"/>
                </scope>
            </method>
            <javadoc line="164">
                Returns the associated request Id.                
                <param>
                    data The flat message.                    
                </param>
                <return>
                    The request Id.                    
                </return>
            </javadoc>
            <method name="getRequestId" type="int" line="169">
                <params>
                    <param name="data" type="byte[]"/>
                </params>
                <declaration name="bdec" type="BerDecoder" line="170"/>
                <declaration name="msgId" type="int" line="171"/>
                <scope line="172"/>
                <scope line="179"/>
                <scope line="182"/>
                <scope line="185"/>
            </method>
            <javadoc line="189">
                Initializes this message with the specified &lt;CODE&gt;pdu&lt;/CODE&gt;.
                  &lt;P&gt;
                  This method initializes the data field with an array of
                  &lt;CODE&gt;maxDataLength&lt;/CODE&gt; bytes. It encodes the &lt;CODE&gt;pdu&lt;/CODE&gt;.
                  The resulting encoding is stored in the data field
                  and the length of the encoding is stored in &lt;CODE&gt;dataLength&lt;/CODE&gt;.
                  &lt;p&gt;
                  If the encoding length exceeds &lt;CODE&gt;maxDataLength&lt;/CODE&gt;,
                  the method throws an exception.                
                <param>
                    p The PDU to be encoded.                    
                </param>
                <param>
                    maxDataLength The maximum length permitted for the data field.                    
                </param>
                <exception>
                    SnmpStatusException If the specified &lt;CODE&gt;pdu&lt;/CODE&gt;
                      is not valid.                    
                </exception>
                <exception>
                    SnmpTooBigException If the resulting encoding does not fit
                      into &lt;CODE&gt;maxDataLength&lt;/CODE&gt; bytes.                    
                </exception>
                <exception>
                    ArrayIndexOutOfBoundsException If the encoding exceeds
                      &lt;CODE&gt;maxDataLength&lt;/CODE&gt;.                    
                </exception>
            </javadoc>
            <method name="encodeSnmpPdu" type="void" line="208">
                <params>
                    <param name="p" type="SnmpPdu"/>
                    <param name="maxDataLength" type="int"/>
                </params>
                <declaration name="pdu" type="SnmpScopedPduPacket" line="209"/>
                <scope line="210">
                    <declaration name="strb" type="StringBuilder" line="211"/>
                </scope>
                <scope line="225">
                    <declaration name="benc" type="BerEncoder" line="226"/>
                    <declaration name="reqPdu" type="SnmpPduRequestType" line="237"/>
                    <declaration name="bulkPdu" type="SnmpPduBulkType" line="243"/>
                </scope>
                <scope line="254"/>
            </method>
            <javadoc line="258">
                Gets the PDU encoded in this message.
                  &lt;P&gt;
                  This method decodes the data field and returns the resulting PDU.                
                <return>
                    The resulting PDU.                    
                </return>
                <exception>
                    SnmpStatusException If the encoding is not valid.                    
                </exception>
            </javadoc>
            <method name="decodeSnmpPdu" type="SnmpPdu" line="265">
                <declaration name="pdu" type="SnmpScopedPduPacket" line="266"/>
                <declaration name="bdec" type="BerDecoder" line="267"/>
                <scope line="268">
                    <declaration name="type" type="int" line="269"/>
                    <declaration name="reqPdu" type="SnmpScopedPduRequest" line="279"/>
                    <declaration name="bulkPdu" type="SnmpScopedPduBulk" line="286"/>
                </scope>
                <scope line="299">
                    <scope line="300"/>
                </scope>
                <scope line="315">
                    <declaration name="strb" type="StringBuilder" line="316"/>
                </scope>
            </method>
            <javadoc line="321">
                Dumps this message in a string.                
                <return>
                    The string containing the dump.                    
                </return>
            </javadoc>
            <method name="printMessage" type="String" line="325">
                <declaration name="sb" type="StringBuffer" line="326"/>
                <scope line="331"/>
                <scope line="334"/>
                <scope line="339"/>
                <scope line="342"/>
            </method>
        </class>
    </source>