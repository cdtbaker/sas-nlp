<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.jmx.remote.security">
        <import package="java.io.IOException"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.Principal"/>
        <import package="java.security.PrivilegedAction"/>
        <import package="java.security.PrivilegedActionException"/>
        <import package="java.security.PrivilegedExceptionAction"/>
        <import package="java.util.Collections"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.Map"/>
        <import package="java.util.Properties"/>
        <import package="javax.management.remote.JMXPrincipal"/>
        <import package="javax.management.remote.JMXAuthenticator"/>
        <import package="javax.security.auth.AuthPermission"/>
        <import package="javax.security.auth.Subject"/>
        <import package="javax.security.auth.callback"/>
        <import package="javax.security.auth.login.AppConfigurationEntry"/>
        <import package="javax.security.auth.login.Configuration"/>
        <import package="javax.security.auth.login.LoginContext"/>
        <import package="javax.security.auth.login.LoginException"/>
        <import package="javax.security.auth.spi.LoginModule"/>
        <import package="com.sun.jmx.remote.util.ClassLogger"/>
        <import package="com.sun.jmx.remote.util.EnvHelp"/>
        <class name="JMXPluggableAuthenticator" line="51">
            <implements interface="JMXAuthenticator"/>
            <javadoc line="51">
                &lt;p&gt;This class represents a
                  &lt;a href=&quot;{@docRoot}/../guide/security/jaas/JAASRefGuide.html&quot;&gt;JAAS&lt;/a&gt;
                  based implementation of the {@link JMXAuthenticator} interface.&lt;/p&gt;
                  &lt;p&gt;Authentication is performed by passing the supplied user&apos;s credentials
                  to one or more authentication mechanisms ({@link LoginModule}) for
                  verification. An authentication mechanism acquires the user&apos;s credentials
                  by calling {@link NameCallback} and/or {@link PasswordCallback}.
                  If authentication is successful then an authenticated {@link Subject}filled in with a {@link Principal} is returned.  Authorization checks
                  will then be performed based on this &lt;code&gt;Subject&lt;/code&gt;.&lt;/p&gt;
                  &lt;p&gt;By default, a single file-based authentication mechanism{@link FileLoginModule} is configured (&lt;code&gt;FileLoginConfig&lt;/code&gt;).&lt;/p&gt;
                  &lt;p&gt;To override the default configuration use the
                  &lt;code&gt;com.sun.management.jmxremote.login.config&lt;/code&gt; management property
                  described in the JRE/lib/management/management.properties file.
                  Set this property to the name of a JAAS configuration entry and ensure that
                  the entry is loaded by the installed {@link Configuration}. In addition,
                  ensure that the authentication mechanisms specified in the entry acquire
                  the user&apos;s credentials by calling {@link NameCallback} and{@link PasswordCallback} and that they return a {@link Subject} filled-in
                  with a {@link Principal}, for those users that are successfully
                  authenticated.&lt;/p&gt;                
            </javadoc>
            <javadoc line="80">
                Creates an instance of &lt;code&gt;JMXPluggableAuthenticator&lt;/code&gt;
                  and initializes it with a {@link LoginContext}.                
                <param>
                    env the environment containing configuration properties for the
                      authenticator. Can be null, which is equivalent to an empty
                      Map.                    
                </param>
                <exception>
                    SecurityException if the authentication mechanism cannot be
                      initialized.                    
                </exception>
            </javadoc>
            <method name="JMXPluggableAuthenticator" type="constructor" line="90">
                <params>
                    <param name="env" type="Map<?,?>"/>
                </params>
                <comment line="104">
                    use the supplied JAAS login configuration                    
                </comment>
                <comment line="109">
                    use the default JAAS login configuration (file-based)                    
                </comment>
                <declaration name="loginConfigName" type="String" line="92"/>
                <declaration name="passwordFile" type="String" line="93"/>
                <scope line="95"/>
                <scope line="100">
                    <scope line="102"/>
                    <scope line="107">
                        <declaration name="sm" type="SecurityManager" line="109"/>
                        <scope line="110"/>
                        <declaration name="pf" type="String" line="116"/>
                        <scope line="117">
                            <anonymous_class line="119">
                                <method name="run" type="LoginContext" line="120"/>
                            </anonymous_class>
                        </scope>
                        <scope line="128"/>
                    </scope>
                </scope>
                <scope line="133"/>
                <scope line="136"/>
            </method>
            <javadoc line="141">
                Authenticate the &lt;code&gt;MBeanServerConnection&lt;/code&gt; client
                  with the given client credentials.                
                <param>
                    credentials the user-defined credentials to be passed in
                      to the server in order to authenticate the user before creating
                      the <code>MBeanServerConnection</code>.  This parameter must
                      be a two-element <code>String[]</code> containing the client's
                      username and password in that order.                    
                </param>
                <return>
                    the authenticated subject containing a
                      <code>JMXPrincipal(username)</code>.                    
                </return>
                <exception>
                    SecurityException if the server cannot authenticate the user
                      with the provided credentials.                    
                </exception>
            </javadoc>
            <method name="authenticate" type="Subject" line="157">
                <params>
                    <param name="credentials" type="Object"/>
                </params>
                <comment line="159">
                    Verify that credentials is of type String[].                    
                </comment>
                <comment line="162">
                    Special case for null so we get a more informative message                    
                </comment>
                <comment line="171">
                    Verify that the array contains two elements.                    
                </comment>
                <comment line="180">
                    Verify that username exists and the associated
                     password matches the one supplied by the client.                    
                </comment>
                <comment line="190">
                    Perform authentication                    
                </comment>
                <scope line="160">
                    <declaration name="message" type="String" line="165"/>
                </scope>
                <declaration name="aCredentials" type="String[]" line="172"/>
                <scope line="173">
                    <declaration name="message" type="String" line="174"/>
                </scope>
                <scope line="184">
                    <declaration name="message" type="String" line="185"/>
                </scope>
                <scope line="190">
                    <declaration name="subject" type="Subject" line="192"/>
                    <anonymous_class line="193">
                        <method name="run" type="Void" line="194"/>
                    </anonymous_class>
                </scope>
                <scope line="202"/>
            </method>
            <method name="authenticationFailure" type="void" line="209">
                <params>
                    <param name="method" type="String"/>
                    <param name="message" type="String"/>
                </params>
                <declaration name="msg" type="String" line="210"/>
                <declaration name="e" type="SecurityException" line="211"/>
            </method>
            <method name="authenticationFailure" type="void" line="218">
                <params>
                    <param name="method" type="String"/>
                    <param name="exception" type="Exception"/>
                </params>
                <declaration name="msg" type="String" line="219"/>
                <declaration name="se" type="SecurityException" line="220"/>
                <scope line="221"/>
                <scope line="224">
                    <declaration name="e" type="SecurityException" line="226"/>
                </scope>
            </method>
            <method name="logException" type="void" line="236">
                <params>
                    <param name="method" type="String"/>
                    <param name="message" type="String"/>
                    <param name="e" type="Exception"/>
                </params>
                <scope line="237"/>
                <scope line="240"/>
            </method>
            <declaration name="loginContext" type="LoginContext" line="245"/>
            <declaration name="username" type="String" line="246"/>
            <declaration name="password" type="String" line="247"/>
            <declaration name="LOGIN_CONFIG_PROP" type="String" line="248"/>
            <declaration name="LOGIN_CONFIG_NAME" type="String" line="250"/>
            <declaration name="PASSWORD_FILE_PROP" type="String" line="251"/>
            <declaration name="logger" type="ClassLogger" line="253"/>
            <class name="JMXCallbackHandler" line="256">
                <comment line="298">
                    The JAAS configuration for file-based authentication                    
                </comment>
                <comment line="301">
                    The classname of the login module for file-based authentication                    
                </comment>
                <comment line="305">
                    The option that identifies the password file to use                    
                </comment>
                <implements interface="CallbackHandler"/>
                <javadoc line="256">
                    This callback handler supplies the username and password (which was
                      originally supplied by the JMX user) to the JAAS login module performing
                      the authentication. No interactive user prompting is required because the
                      credentials are already available to this class (via its enclosing class).                    
                </javadoc>
                <javadoc line="264">
                    Sets the username and password in the appropriate Callback object.                    
                </javadoc>
                <method name="handle" type="void" line="268">
                    <params>
                        <param name="callbacks" type="Callback[]"/>
                    </params>
                    <scope line="270">
                        <scope line="271"/>
                        <scope line="274"/>
                        <scope line="278"/>
                    </scope>
                </method>
            </class>
            <class name="FileLoginConfig" line="286">
                <extends class="Configuration"/>
                <comment line="298">
                    The JAAS configuration for file-based authentication                    
                </comment>
                <comment line="301">
                    The classname of the login module for file-based authentication                    
                </comment>
                <comment line="305">
                    The option that identifies the password file to use                    
                </comment>
                <javadoc line="286">
                    This class defines the JAAS configuration for file-based authentication.
                      It is equivalent to the following textual configuration entry:
                      &lt;pre&gt;
                      JMXPluggableAuthenticator {
                      com.sun.jmx.remote.security.FileLoginModule required;
                      };
                      &lt;/pre&gt;                    
                </javadoc>
                <declaration name="entries" type="AppConfigurationEntry[]" line="298"/>
                <declaration name="FILE_LOGIN_MODULE" type="String" line="301"/>
                <declaration name="PASSWORD_FILE_OPTION" type="String" line="305"/>
                <javadoc line="307">
                    Creates an instance of &lt;code&gt;FileLoginConfig&lt;/code&gt;                    
                    <param>
                        passwordFile A filepath that identifies the password file to use.
                          If null then the default password file is used.                        
                    </param>
                </javadoc>
                <method name="FileLoginConfig" type="constructor" line="313">
                    <params>
                        <param name="passwordFile" type="String"/>
                    </params>
                    <declaration name="options" type="Map&lt;String,String&gt;" line="315"/>
                    <scope line="316"/>
                    <scope line="319"/>
                </method>
                <javadoc line="330">
                    Gets the JAAS configuration for file-based authentication                    
                </javadoc>
                <method name="getAppConfigurationEntry" type="AppConfigurationEntry[]" line="333">
                    <params>
                        <param name="name" type="String"/>
                    </params>
                </method>
                <javadoc line="338">
                    Refreshes the configuration.                    
                </javadoc>
                <method name="refresh" type="void" line="341">
                    <comment line="343">
                        the configuration is fixed                        
                    </comment>
                </method>
            </class>
        </class>
    </source>