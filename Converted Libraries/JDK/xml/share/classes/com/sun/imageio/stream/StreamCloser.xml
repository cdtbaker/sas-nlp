<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.imageio.stream">
        <import package="java.io.IOException"/>
        <import package="java.util.Set"/>
        <import package="java.util.WeakHashMap"/>
        <import package="javax.imageio.stream.ImageInputStream"/>
        <class name="StreamCloser" line="33">
            <javadoc line="33">
                This class provide means to properly close hanging
                  image input/output streams on VM shutdown.
                  This might be useful for proper cleanup such as removal
                  of temporary files.
                  Addition of stream do not prevent it from being garbage collected
                  if no other references to it exists. Stream can be closed
                  explicitly without removal from StreamCloser queue.
                  Explicit removal from the queue only helps to save some memory.                
            </javadoc>
            <declaration name="toCloseQueue" type="WeakHashMap&lt;CloseAction,Object&gt;" line="46"/>
            <declaration name="streamCloser" type="Thread" line="47"/>
            <method name="addToQueue" type="void" line="49">
                <params>
                    <param name="ca" type="CloseAction"/>
                </params>
                <comment line="65">
                    Make a copy of the set in order to avoid                    
                </comment>
                <comment line="66">
                    concurrent modification (the is.close()                    
                </comment>
                <comment line="67">
                    will in turn call removeFromQueue())                    
                </comment>
                <comment line="87">
                    The thread must be a member of a thread group
                     which will not get GCed before VM exit.
                     Make its parent the top-level thread group.                    
                </comment>
                <comment line="97">
                    Set context class loader to null in order to avoid
                     keeping a strong reference to an application classloader.                    
                </comment>
                <scope line="50">
                    <scope line="51"/>
                    <scope line="58">
                        <anonymous_class line="59">
                            <method name="run" type="void" line="60">
                                <comment line="65">
                                    Make a copy of the set in order to avoid                                    
                                </comment>
                                <comment line="66">
                                    concurrent modification (the is.close()                                    
                                </comment>
                                <comment line="67">
                                    will in turn call removeFromQueue())                                    
                                </comment>
                                <scope line="61">
                                    <scope line="62">
                                        <declaration name="set" type="Set&lt;CloseAction&gt;" line="63"/>
                                        <declaration name="actions" type="CloseAction[]" line="68"/>
                                        <scope line="71">
                                            <scope line="72">
                                                <scope line="73"/>
                                                <scope line="75"/>
                                            </scope>
                                        </scope>
                                    </scope>
                                </scope>
                            </method>
                        </anonymous_class>
                        <declaration name="streamCloserRunnable" type="Runnable" line="59"/>
                        <anonymous_class line="85">
                            <method name="run" type="Object" line="86">
                                <comment line="87">
                                    The thread must be a member of a thread group
                                     which will not get GCed before VM exit.
                                     Make its parent the top-level thread group.                                    
                                </comment>
                                <comment line="97">
                                    Set context class loader to null in order to avoid
                                     keeping a strong reference to an application classloader.                                    
                                </comment>
                                <declaration name="tg" type="ThreadGroup" line="91"/>
                            </method>
                        </anonymous_class>
                    </scope>
                </scope>
            </method>
            <method name="removeFromQueue" type="void" line="109">
                <params>
                    <param name="ca" type="CloseAction"/>
                </params>
                <scope line="110">
                    <scope line="111"/>
                </scope>
            </method>
            <method name="createCloseAction" type="CloseAction" line="117">
                <params>
                    <param name="iis" type="ImageInputStream"/>
                </params>
            </method>
            <class name="CloseAction" line="121">
                <declaration name="iis" type="ImageInputStream" line="122"/>
                <method name="CloseAction" type="constructor" line="124">
                    <params>
                        <param name="iis" type="ImageInputStream"/>
                    </params>
                </method>
                <method name="performAction" type="void" line="128">
                    <scope line="129"/>
                </method>
            </class>
        </class>
    </source>