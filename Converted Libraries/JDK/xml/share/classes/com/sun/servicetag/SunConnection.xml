<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.servicetag">
        <import package="java.io"/>
        <import package="java.net.URISyntaxException"/>
        <import package="java.net.URL"/>
        <import package="java.net.HttpURLConnection"/>
        <import package="java.net.MalformedURLException"/>
        <import package="java.io.OutputStreamWriter"/>
        <import package="java.util.Locale"/>
        <import package="javax.net.ssl.HttpsURLConnection"/>
        <class name="SunConnection" line="37">
            <comment line="59">
                System properties for testing                
            </comment>
            <javadoc line="37">
                Sun Connection Class for Product Registration.
                  Registration Web Application Interface
                  1) POST the product registry to the output stream of the registration
                  relay service.
                  2) Open the webapp URL from a browser with the following parameters:
                  registry-urn
                  product=jdk
                  locale=&lt;default-locale&gt;
                  version=&lt;version&gt;                
                <see>
                    https://sn-tools.central.sun.com/twiki/pub/ServiceTags/RegistrationRelayService/                    
                </see>
            </javadoc>
            <declaration name="JDK_REGISTRATION_URL" type="String" line="54"/>
            <declaration name="SANDBOX_TESTING_URL" type="String" line="55"/>
            <declaration name="REGISTRATION_WEB_PATH" type="String" line="56"/>
            <declaration name="SVCTAG_REGISTER_TESTING" type="String" line="59"/>
            <declaration name="SVCTAG_REGISTRATION_URL" type="String" line="60"/>
            <declaration name="SVCTAG_CONNECTION_TIMEOUT" type="String" line="61"/>
            <method name="SunConnection" type="constructor" line="63"/>
            <javadoc line="66">
                Returns a URL for JDK registration interfacing with the Sun Connection
                  registration relay service in this form:
                  &lt;registration-url&gt;/&lt;registry_urn&gt;?product=jdk&amp;locale=&lt;locale&gt;
                  The &lt;registration-url&gt; can be overridden by an environment
                  variable or a system property.
                  1) &quot;servicetag.register.testing&quot; system property to switch to the
                  Sun Connection registration sandbox testing.
                  2) &quot;servicetag.registration.url&quot; system property to override
                  the URL
                  3) Default production URL                
            </javadoc>
            <method name="getRegistrationURL" type="URL" line="81">
                <params>
                    <param name="registrationURN" type="String"/>
                    <param name="locale" type="Locale"/>
                    <param name="version" type="String"/>
                </params>
                <comment line="93">
                    trim whitespaces                    
                </comment>
                <comment line="99">
                    Add the registry_urn in the URL&apos;s query                    
                </comment>
                <comment line="104">
                    should never reach here                    
                </comment>
                <declaration name="url" type="String" line="82"/>
                <scope line="83">
                    <scope line="84"/>
                    <scope line="86"/>
                </scope>
                <scope line="94"/>
                <declaration name="registerURL" type="String" line="99"/>
                <scope line="100"/>
                <scope line="102">
                    <declaration name="x" type="InternalError" line="104"/>
                </scope>
            </method>
            <method name="rewriteURL" type="String" line="111">
                <params>
                    <param name="url" type="String"/>
                    <param name="registryURN" type="String"/>
                    <param name="locale" type="Locale"/>
                    <param name="version" type="String"/>
                </params>
                <declaration name="sb" type="StringBuilder" line="112"/>
                <declaration name="len" type="int" line="113"/>
                <scope line="114"/>
            </method>
            <javadoc line="127">
                Registers all products in the given product registry.  If it fails
                  to post the service tag registry, open the browser with the offline
                  registration page.                
                <param>
                    regData registration data to be posted to the Sun Connection
                      for registration.                    
                </param>
                <param>
                    locale Locale                    
                </param>
                <param>
                    version JDK version                    
                </param>
                <throws>
                    IOException if I/O error occurs in this operation                    
                </throws>
            </javadoc>
            <method name="register" type="void" line="141">
                <params>
                    <param name="regData" type="RegistrationData"/>
                    <param name="locale" type="Locale"/>
                    <param name="version" type="String"/>
                </params>
                <comment line="143">
                    Gets the URL for SunConnection registration relay service                    
                </comment>
                <comment line="148">
                    Post the Product Registry to Sun Connection                    
                </comment>
                <comment line="151">
                    service tags posted successfully
                     now prompt for registration                    
                </comment>
                <comment line="155">
                    open browser with the offline registration page                    
                </comment>
                <declaration name="url" type="URL" line="143"/>
                <declaration name="succeed" type="boolean" line="148"/>
                <scope line="149"/>
                <scope line="153"/>
            </method>
            <javadoc line="159">
                Opens a browser for JDK product registration.                
                <param>
                    url Registration Webapp URL                    
                </param>
            </javadoc>
            <method name="openBrowser" type="void" line="163">
                <params>
                    <param name="url" type="URL"/>
                </params>
                <comment line="183">
                    ignore if not supported                    
                </comment>
                <scope line="164">
                    <scope line="165"/>
                </scope>
                <scope line="171"/>
                <scope line="173">
                    <declaration name="x" type="InternalError" line="174"/>
                </scope>
                <scope line="177">
                    <scope line="178"/>
                </scope>
                <scope line="181">
                    <scope line="183"/>
                </scope>
            </method>
            <javadoc line="189">
                POST service tag registry to Sun Connection                
                <param>
                    loc the URL of the webapp to handle the POST request                    
                </param>
                <param>
                    streg the Service Tag registry                    
                </param>
                <return>
                    true if posting succeeds; otherwise, false.                    
                </return>
            </javadoc>
            <method name="postRegistrationData" type="boolean" line="196">
                <params>
                    <param name="url" type="URL"/>
                    <param name="registration" type="RegistrationData"/>
                </params>
                <comment line="205">
                    default 10 seconds timeout                    
                </comment>
                <comment line="235">
                    should never reach here                    
                </comment>
                <comment line="240">
                    SocketTimeoutException, IOException or UnknownHostException                    
                </comment>
                <scope line="197">
                    <declaration name="con" type="HttpsURLConnection" line="198"/>
                    <declaration name="timeout" type="String" line="205"/>
                    <scope line="208"/>
                    <declaration name="out" type="OutputStream" line="216"/>
                    <scope line="217"/>
                    <scope line="221">
                        <scope line="222"/>
                    </scope>
                    <declaration name="returnCode" type="int" line="227"/>
                    <scope line="228"/>
                </scope>
                <scope line="233">
                    <declaration name="x" type="InternalError" line="235"/>
                </scope>
                <scope line="238">
                    <scope line="240"/>
                </scope>
            </method>
            <javadoc line="247">
                Opens the offline registratioin page in the browser.                
            </javadoc>
            <method name="openOfflineRegisterPage" type="void" line="252">
                <comment line="265">
                    should never reach here                    
                </comment>
                <comment line="275">
                    ignore if not supported                    
                </comment>
                <scope line="253">
                    <scope line="254"/>
                </scope>
                <declaration name="registerPage" type="File" line="260"/>
                <scope line="261"/>
                <scope line="263">
                    <declaration name="x" type="InternalError" line="265"/>
                </scope>
                <scope line="269">
                    <scope line="270"/>
                </scope>
                <scope line="273">
                    <scope line="275"/>
                </scope>
            </method>
            <method name="printReturnData" type="void" line="282">
                <params>
                    <param name="con" type="HttpURLConnection"/>
                    <param name="returnCode" type="int"/>
                </params>
                <declaration name="reader" type="BufferedReader" line="283"/>
                <scope line="284">
                    <scope line="285"/>
                    <scope line="288"/>
                    <declaration name="sb" type="StringBuilder" line="292"/>
                    <declaration name="line" type="String" line="293"/>
                    <scope line="294"/>
                </scope>
                <scope line="299">
                    <scope line="300"/>
                </scope>
            </method>
        </class>
    </source>