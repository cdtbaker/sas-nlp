<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.servicetag">
        <import package="java.io"/>
        <import package="java.util.Date"/>
        <import package="java.text.SimpleDateFormat"/>
        <import package="java.text.ParseException"/>
        <import package="java.util.TimeZone"/>
        <import package="java.util.UUID"/>
        <import package="java.lang.reflect.Field"/>
        <import package="java.lang.reflect.Method"/>
        <class name="Util" line="38">
            <comment line="48">
                for debugging and tracing                
            </comment>
            <declaration name="verbose" type="boolean" line="39"/>
            <declaration name="jrepath" type="String" line="40"/>
            <declaration name="REGKEY_TAIL" type="String" line="41"/>
            <declaration name="STCLIENT_TAIL" type="String" line="43"/>
            <declaration name="WIN32_STCLIENT" type="String" line="44"/>
            <method name="isVerbose" type="boolean" line="48"/>
            <javadoc line="52">
                Gets the pathname of JRE in the running platform
                  This can be a JDK or JRE.                
            </javadoc>
            <method name="getJrePath" type="String" line="56">
                <comment line="58">
                    Determine the JRE path by checking the existence of                    
                </comment>
                <comment line="59">
                    &lt;HOME&gt;/jre/lib and &lt;HOME&gt;/lib.                    
                </comment>
                <comment line="64">
                    java.home usually points to the JRE path                    
                </comment>
                <scope line="57">
                    <declaration name="javaHome" type="String" line="60"/>
                    <declaration name="f" type="File" line="62"/>
                    <scope line="63"/>
                </scope>
            </method>
            <javadoc line="71">
                Tests if the running platform is a JDK.                
            </javadoc>
            <method name="isJdk" type="boolean" line="74">
                <comment line="75">
                    &lt;HOME&gt;/jre exists which implies it&apos;s a JDK                    
                </comment>
            </method>
            <javadoc line="79">
                Generates the URN string of &quot;urn:st&quot; namespace                
            </javadoc>
            <method name="generateURN" type="String" line="82"/>
            <method name="getIntValue" type="int" line="86">
                <params>
                    <param name="value" type="String"/>
                </params>
                <scope line="87"/>
                <scope line="89"/>
            </method>
            <javadoc line="95">
                Formats the Date into a timestamp string in YYYY-MM-dd HH:mm:ss GMT.                
                <param>
                    timestamp Date                    
                </param>
                <return>
                    a string representation of the timestamp
                      in the YYYY-MM-dd HH:mm:ss GMT format.                    
                </return>
            </javadoc>
            <method name="formatTimestamp" type="String" line="101">
                <params>
                    <param name="timestamp" type="Date"/>
                </params>
                <scope line="102"/>
                <declaration name="df" type="SimpleDateFormat" line="105"/>
            </method>
            <javadoc line="110">
                Parses a timestamp string in YYYY-MM-dd HH:mm:ss GMT format.                
                <param>
                    timestamp Timestamp in the YYYY-MM-dd HH:mm:ss GMT format.                    
                </param>
                <return>
                    Date                    
                </return>
            </javadoc>
            <method name="parseTimestamp" type="Date" line="115">
                <params>
                    <param name="timestamp" type="String"/>
                </params>
                <comment line="121">
                    should not reach here                    
                </comment>
                <declaration name="df" type="SimpleDateFormat" line="116"/>
                <scope line="118"/>
                <scope line="120"/>
            </method>
            <method name="commandOutput" type="String" line="127">
                <params>
                    <param name="p" type="Process"/>
                </params>
                <declaration name="r" type="Reader" line="128"/>
                <declaration name="err" type="Reader" line="129"/>
                <scope line="130">
                    <declaration name="output" type="String" line="133"/>
                    <declaration name="errorMsg" type="String" line="134"/>
                </scope>
                <scope line="137">
                    <scope line="138"/>
                </scope>
                <scope line="142">
                    <scope line="143">
                        <scope line="144"/>
                    </scope>
                    <scope line="147">
                        <scope line="148"/>
                    </scope>
                </scope>
            </method>
            <method name="commandOutput" type="String" line="155">
                <params>
                    <param name="r" type="Reader"/>
                </params>
                <declaration name="sb" type="StringBuilder" line="156"/>
                <declaration name="c" type="int" line="157"/>
                <scope line="158">
                    <scope line="159"/>
                </scope>
            </method>
            <method name="getJdkVersion" type="int" line="166"/>
            <method name="getUpdateVersion" type="int" line="171"/>
            <declaration name="jdkVersion" type="int" line="176"/>
            <declaration name="jdkUpdate" type="int" line="177"/>
            <method name="parseVersion" type="void" line="178">
                <comment line="183">
                    parse java.runtime.version                    
                </comment>
                <comment line="184">
                    valid format of the version string is:                    
                </comment>
                <comment line="185">
                    n.n.n[_uu[c]][-&lt;identifer&gt;]-bxx                    
                </comment>
                <comment line="201">
                    not conforming to the naming convention                    
                </comment>
                <scope line="179"/>
                <declaration name="cs" type="String" line="186"/>
                <scope line="190">
                    <scope line="195">
                        <declaration name="nextChar" type="int" line="196"/>
                        <scope line="197">
                            <declaration name="uu" type="String" line="198"/>
                        </scope>
                        <scope line="200"/>
                    </scope>
                </scope>
                <scope line="205"/>
            </method>
            <javadoc line="210">
                Returns this java string as a null-terminated byte array                
            </javadoc>
            <method name="stringToByteArray" type="byte[]" line="213">
                <params>
                    <param name="str" type="String"/>
                </params>
            </method>
            <javadoc line="217">
                Converts a null-terminated byte array to java string                
            </javadoc>
            <method name="byteArrayToString" type="String" line="220">
                <params>
                    <param name="array" type="byte[]"/>
                </params>
            </method>
            <javadoc line="224">
                Gets the stclient path using a well known location from
                  the Windows platform Registry, ensuring the path returned
                  by the registry is really the one we are looking for,
                  otherwise it will return null.                
            </javadoc>
            <method name="getWindowsStClientFile" type="File" line="230">
                <params>
                    <param name="wow64" type="boolean"/>
                </params>
                <comment line="235">
                    use the default  key                    
                </comment>
                <declaration name="out" type="File" line="231"/>
                <declaration name="regKey" type="String" line="232"/>
                <declaration name="keyName" type="String" line="235"/>
                <declaration name="path" type="String" line="236"/>
                <scope line="239"/>
                <scope line="242"/>
            </method>
            <javadoc line="248">
                Finds a stclient in 32 and 64 bit environments, first by querying
                  the windows registry, if not then get the well known paths for
                  64bit see http://support.microsoft.com/kb/896459                
            </javadoc>
            <method name="getWindowsStClientFile" type="File" line="254">
                <comment line="257">
                    try to get the default entry                    
                </comment>
                <comment line="262">
                    we are on 64-bit system                    
                </comment>
                <comment line="263">
                    try the wow64 area                    
                </comment>
                <comment line="268">
                    try the default hard coded path, maybe wow64 registry is missing                    
                </comment>
                <declaration name="stclient" type="File" line="255"/>
                <scope line="256">
                    <scope line="259"/>
                </scope>
                <scope line="262">
                    <scope line="265"/>
                    <scope line="270">
                        <scope line="271"/>
                    </scope>
                </scope>
                <scope line="277"/>
            </method>
            <javadoc line="283">
                This uses reflection to access a private java windows registry
                  interface, any changes to that Class must be appropriately adjusted.
                  Returns a null if unsuccessful.                
            </javadoc>
            <method name="getRegistryKey" type="String" line="288">
                <params>
                    <param name="regKey" type="String"/>
                    <param name="keyName" type="String"/>
                </params>
                <comment line="293">
                    Get the registry methods                    
                </comment>
                <comment line="306">
                    Get all the constants we need                    
                </comment>
                <comment line="313">
                    Convert keys                    
                </comment>
                <comment line="317">
                    Open the registry                    
                </comment>
                <declaration name="out" type="String" line="289"/>
                <scope line="290">
                    <declaration name="clazz" type="Class&lt;?&gt;" line="291"/>
                    <declaration name="winRegOpenKeyM" type="Method" line="294"/>
                    <declaration name="winRegCloseKeyM" type="Method" line="298"/>
                    <declaration name="winRegQueryValueM" type="Method" line="302"/>
                    <declaration name="HKLM" type="int" line="307"/>
                    <declaration name="KEY_READ" type="int" line="308"/>
                    <declaration name="ERROR_CODE" type="int" line="309"/>
                    <declaration name="NATIVE_HANDLE" type="int" line="310"/>
                    <declaration name="ERROR_SUCCESS" type="int" line="311"/>
                    <declaration name="reg" type="byte[]" line="314"/>
                    <declaration name="key" type="byte[]" line="315"/>
                    <declaration name="result" type="int[]" line="318"/>
                    <scope line="320">
                        <declaration name="stvalue" type="byte[]" line="321"/>
                    </scope>
                </scope>
                <scope line="326">
                    <scope line="327"/>
                </scope>
            </method>
            <method name="getValueFromStaticField" type="int" line="334">
                <params>
                    <param name="fldName" type="String"/>
                    <param name="klass" type="Class<?>"/>
                </params>
                <declaration name="f" type="Field" line="335"/>
            </method>
        </class>
    </source>