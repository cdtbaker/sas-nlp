<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.media.sound">
        <import package="java.util.ArrayList"/>
        <import package="java.util.List"/>
        <import package="java.util.Collections"/>
        <import package="javax.sound.midi"/>
        <class name="AbstractMidiDevice" line="6">
            <implements interface="MidiDevice"/>
            <implements interface="ReferenceCountingDevice"/>
            <javadoc line="6">
                Abstract AbstractMidiDevice class representing functionality shared by
                  MidiInDevice and MidiOutDevice objects.                
                <author>
                    David Rivas                    
                </author>
                <author>
                    Kara Kytle                    
                </author>
                <author>
                    Matthias Pfisterer                    
                </author>
                <author>
                    Florian Bomers                    
                </author>
            </javadoc>
            <declaration name="TRACE_TRANSMITTER" type="boolean" line="15"/>
            <declaration name="receiverList" type="ArrayList&lt;Receiver&gt;" line="16"/>
            <declaration name="transmitterList" type="TransmitterList" line="17"/>
            <declaration name="traRecLock" type="Object" line="18"/>
            <declaration name="info" type="MidiDevice.Info" line="19"/>
            <declaration name="open" type="boolean" line="20"/>
            <declaration name="openRefCount" type="int" line="21"/>
            <declaration name="openKeepingObjects" type="List" line="22"/>
            <javadoc line="22">
                List of Receivers and Transmitters that opened the device implicitely.                
            </javadoc>
            <declaration name="id" type="long" line="26"/>
            <javadoc line="26">
                This is the device handle returned from native code                
            </javadoc>
            <javadoc line="30">
                Constructs an AbstractMidiDevice with the specified info object.                
                <param>
                    info the description of the device                    
                </param>
            </javadoc>
            <method name="AbstractMidiDevice" type="constructor" line="34">
                <params>
                    <param name="info" type="MidiDevice.Info"/>
                </params>
            </method>
            <method name="getDeviceInfo" type="MidiDevice.Info" line="40"/>
            <javadoc line="43">
                Open the device from an aplication program.
                  Setting the open reference count to -1 here prevents Transmitters and Receivers that
                  opened the the device implicitly from closing it. The only way to close the device after
                  this call is a call to close().                
            </javadoc>
            <method name="open" type="void" line="49">
                <scope line="51"/>
            </method>
            <javadoc line="57">
                Open the device implicitly.
                  This method is intended to be used by AbstractReceiver
                  and BasicTransmitter. Actually, it is called by getReceiverReferenceCounting() and
                  getTransmitterReferenceCounting(). These, in turn, are called by MidiSytem on calls to
                  getReceiver() and getTransmitter(). The former methods should pass the Receiver or
                  Transmitter just created as the object parameter to this method. Storing references to
                  these objects is necessary to be able to decide later (when it comes to closing) if
                  R/T&apos;s are ones that opened the device implicitly.                
                <object>
                    The Receiver or Transmitter instance that triggered this implicit open.                    
                </object>
            </javadoc>
            <method name="openInternal" type="void" line="68">
                <params>
                    <param name="object" type="Object"/>
                </params>
                <scope line="70">
                    <scope line="71"/>
                </scope>
            </method>
            <method name="doOpen" type="void" line="79">
                <scope line="81">
                    <scope line="82"/>
                </scope>
            </method>
            <method name="close" type="void" line="89">
                <scope line="91"/>
            </method>
            <javadoc line="97">
                Close the device for an object that implicitely opened it.
                  This method is intended to be used by Transmitter.close() and Receiver.close().
                  Those methods should pass this for the object parameter. Since Transmitters or Receivers
                  do not know if their device has been opened implicitely because of them, they call this
                  method in any case. This method now is able to seperate Receivers/Transmitters that opened
                  the device implicitely from those that didn&apos;t by looking up the R/T in the
                  openKeepingObjects list. Only if the R/T is contained there, the reference count is
                  reduced.                
                <param>
                    object The object that might have been opening the device implicitely (for now,
                      this may be a Transmitter or receiver).                    
                </param>
            </javadoc>
            <method name="closeInternal" type="void" line="109">
                <params>
                    <param name="object" type="Object"/>
                </params>
                <scope line="111">
                    <scope line="112">
                        <scope line="113">
                            <scope line="115"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="doClose" type="void" line="123">
                <scope line="125">
                    <scope line="126"/>
                </scope>
            </method>
            <method name="isOpen" type="boolean" line="133"/>
            <method name="implClose" type="void" line="136">
                <scope line="137">
                    <scope line="138">
                        <scope line="139"/>
                    </scope>
                    <scope line="144"/>
                </scope>
            </method>
            <javadoc line="149">
                This implementation always returns -1.
                  Devices that actually provide this should over-ride
                  this method.                
            </javadoc>
            <method name="getMicrosecondPosition" type="long" line="154"/>
            <javadoc line="157">
                Return the maximum number of Receivers supported by this device.
                  Depending on the return value of hasReceivers(), this method returns either 0 or -1.
                  Subclasses should rather override hasReceivers() than override this method.                
            </javadoc>
            <method name="getMaxReceivers" type="int" line="162">
                <scope line="163"/>
                <scope line="166"/>
            </method>
            <javadoc line="170">
                Return the maximum number of Transmitters supported by this device.
                  Depending on the return value of hasTransmitters(), this method returns either 0 or -1.
                  Subclasses should override hasTransmitters().                
            </javadoc>
            <method name="getMaxTransmitters" type="int" line="175">
                <scope line="176"/>
                <scope line="179"/>
            </method>
            <javadoc line="183">
                Retrieve a Receiver for this device.
                  This method returns the value returned by createReceiver(), if it doesn&apos;t throw
                  an exception. Subclasses should rather override createReceiver() than override
                  this method.
                  If createReceiver returns a Receiver, it is added to the internal list
                  of Receivers (see getReceiversList)                
            </javadoc>
            <method name="getReceiver" type="Receiver" line="191">
                <declaration name="receiver" type="Receiver" line="192"/>
                <scope line="193"/>
            </method>
            <method name="getReceivers" type="List<Receiver>" line="199">
                <declaration name="recs" type="List&lt;Receiver&gt;" line="200"/>
                <scope line="201">
                    <scope line="202"/>
                    <scope line="205"/>
                </scope>
            </method>
            <javadoc line="211">
                This implementation uses createTransmitter, which may throw an exception.
                  If a transmitter is returned in createTransmitter, it is added to the internal
                  TransmitterList                
            </javadoc>
            <method name="getTransmitter" type="Transmitter" line="216">
                <declaration name="transmitter" type="Transmitter" line="217"/>
                <scope line="218"/>
            </method>
            <method name="getTransmitters" type="List<Transmitter>" line="224">
                <declaration name="tras" type="List&lt;Transmitter&gt;" line="225"/>
                <scope line="226">
                    <scope line="227"/>
                    <scope line="230"/>
                </scope>
            </method>
            <method name="getId" type="long" line="236"/>
            <javadoc line="239">
                Retrieve a Receiver and open the device implicitly.
                  This method is called by MidiSystem.getReceiver().                
            </javadoc>
            <method name="getReceiverReferenceCounting" type="Receiver" line="243">
                <declaration name="receiver" type="Receiver" line="244"/>
                <scope line="245"/>
            </method>
            <javadoc line="251">
                Retrieve a Transmitter and open the device implicitly.
                  This method is called by MidiSystem.getTransmitter().                
            </javadoc>
            <method name="getTransmitterReferenceCounting" type="Transmitter" line="255">
                <declaration name="transmitter" type="Transmitter" line="256"/>
                <scope line="257"/>
            </method>
            <javadoc line="263">
                Return the list of objects that have opened the device implicitely.                
            </javadoc>
            <method name="getOpenKeepingObjects" type="List" line="266">
                <scope line="267"/>
            </method>
            <javadoc line="272">
                Return the internal list of Receivers, possibly creating it first.                
            </javadoc>
            <method name="getReceiverList" type="List<Receiver>" line="275">
                <scope line="276">
                    <scope line="277"/>
                </scope>
            </method>
            <javadoc line="283">
                Returns if this device supports Receivers.
                  Subclasses that use Receivers should override this method to
                  return true. They also should override createReceiver().                
                <return>
                    true, if the device supports Receivers, false otherwise.                    
                </return>
            </javadoc>
            <method name="hasReceivers" type="boolean" line="289"/>
            <javadoc line="292">
                Create a Receiver object.
                  throwing an exception here means that Receivers aren&apos;t enabled.
                  Subclasses that use Receivers should override this method with
                  one that returns objects implementing Receiver.
                  Classes overriding this method should also override hasReceivers()
                  to return true.                
            </javadoc>
            <method name="createReceiver" type="Receiver" line="300"/>
            <javadoc line="303">
                Return the internal list of Transmitters, possibly creating it first.                
            </javadoc>
            <method name="getTransmitterList" type="TransmitterList" line="306">
                <scope line="307">
                    <scope line="308"/>
                </scope>
            </method>
            <javadoc line="314">
                Returns if this device supports Transmitters.
                  Subclasses that use Transmitters should override this method to
                  return true. They also should override createTransmitter().                
                <return>
                    true, if the device supports Transmitters, false otherwise.                    
                </return>
            </javadoc>
            <method name="hasTransmitters" type="boolean" line="320"/>
            <javadoc line="323">
                Create a Transmitter object.
                  throwing an exception here means that Transmitters aren&apos;t enabled.
                  Subclasses that use Transmitters should override this method with
                  one that returns objects implementing Transmitters.
                  Classes overriding this method should also override hasTransmitters()
                  to return true.                
            </javadoc>
            <method name="createTransmitter" type="Transmitter" line="331"/>
            <method name="implOpen" type="void" line="334"/>
            <javadoc line="335">
                close this device if discarded by the garbage collector                
            </javadoc>
            <method name="finalize" type="void" line="338"/>
            <class name="AbstractReceiver" line="341">
                <implements interface="MidiDeviceReceiver"/>
                <javadoc line="341">
                    Base class for Receivers.
                      Subclasses that use Receivers must use this base class, since it
                      contains magic necessary to manage implicit closing the device.
                      This is necessary for Receivers retrieved via MidiSystem.getReceiver()
                      (which opens the device implicitely).                    
                </javadoc>
                <declaration name="open" type="boolean" line="349"/>
                <javadoc line="350">
                    Deliver a MidiMessage.
                      This method contains magic related to the closed state of a
                      Receiver. Therefore, subclasses should not override this method.
                      Instead, they should implement implSend().                    
                </javadoc>
                <method name="send" type="void" line="356">
                    <params>
                        <param name="message" type="MidiMessage"/>
                        <param name="timeStamp" type="long"/>
                    </params>
                    <scope line="357"/>
                    <scope line="360"/>
                </method>
                <method name="implSend" type="void" line="364"/>
                <javadoc line="365">
                    Close the Receiver.
                      Here, the call to the magic method closeInternal() takes place.
                      Therefore, subclasses that override this method must call
                      &apos;super.close()&apos;.                    
                </javadoc>
                <method name="close" type="void" line="371">
                    <scope line="373"/>
                </method>
                <method name="getMidiDevice" type="MidiDevice" line="378"/>
                <method name="isOpen" type="boolean" line="381"/>
            </class>
            <class name="BasicTransmitter" line="385">
                <implements interface="MidiDeviceTransmitter"/>
                <javadoc line="385">
                    Transmitter base class.
                      This class especially makes sure the device is closed if it
                      has been opened implicitly by a call to MidiSystem.getTransmitter().
                      The logic of doing so is actually in closeInternal().
                      Also, it has some optimizations regarding sending to the Receivers,
                      for known Receivers, and managing itself in the TransmitterList.                    
                </javadoc>
                <declaration name="receiver" type="Receiver" line="394"/>
                <declaration name="tlist" type="TransmitterList" line="395"/>
                <method name="BasicTransmitter" type="constructor" line="396"/>
                <method name="setTransmitterList" type="void" line="398">
                    <params>
                        <param name="tlist" type="TransmitterList"/>
                    </params>
                </method>
                <method name="setReceiver" type="void" line="401">
                    <params>
                        <param name="receiver" type="Receiver"/>
                    </params>
                    <scope line="402"/>
                </method>
                <method name="getReceiver" type="Receiver" line="408"/>
                <javadoc line="411">
                    Close the Transmitter.
                      Here, the call to the magic method closeInternal() takes place.
                      Therefore, subclasses that override this method must call
                      &apos;super.close()&apos;.                    
                </javadoc>
                <method name="close" type="void" line="417">
                    <scope line="419"/>
                </method>
                <method name="getMidiDevice" type="MidiDevice" line="425"/>
            </class>
            <class name="TransmitterList" line="429">
                <javadoc line="429">
                    a class to manage a list of transmitters                    
                </javadoc>
                <declaration name="transmitters" type="ArrayList&lt;Transmitter&gt;" line="433"/>
                <declaration name="midiOutReceiver" type="MidiOutDevice.MidiOutReceiver" line="434"/>
                <declaration name="optimizedReceiverCount" type="int" line="435"/>
                <method name="add" type="void" line="436">
                    <params>
                        <param name="t" type="Transmitter"/>
                    </params>
                    <scope line="437"/>
                    <scope line="440"/>
                </method>
                <method name="remove" type="void" line="445">
                    <params>
                        <param name="t" type="Transmitter"/>
                    </params>
                    <scope line="446">
                        <declaration name="index" type="int" line="447"/>
                        <scope line="448"/>
                    </scope>
                </method>
                <method name="receiverChanged" type="void" line="454">
                    <params>
                        <param name="t" type="BasicTransmitter"/>
                        <param name="oldR" type="Receiver"/>
                        <param name="newR" type="Receiver"/>
                    </params>
                    <scope line="455">
                        <scope line="456"/>
                        <scope line="459">
                            <scope line="460"/>
                        </scope>
                    </scope>
                </method>
                <javadoc line="467">
                    closes all transmitters and empties the list                    
                </javadoc>
                <method name="close" type="void" line="470">
                    <scope line="471">
                        <scope line="472"/>
                    </scope>
                </method>
                <javadoc line="479">
                    Send this message to all receivers
                      status = packedMessage &amp; 0xFF
                      data1 = (packedMessage &amp; 0xFF00) &gt;&gt; 8;
                      data1 = (packedMessage &amp; 0xFF0000) &gt;&gt; 16;                    
                </javadoc>
                <method name="sendMessage" type="void" line="485">
                    <params>
                        <param name="packedMessage" type="int"/>
                        <param name="timeStamp" type="long"/>
                    </params>
                    <scope line="486">
                        <scope line="487">
                            <declaration name="size" type="int" line="488"/>
                            <scope line="489">
                                <scope line="490"/>
                            </scope>
                            <scope line="495">
                                <scope line="497">
                                    <declaration name="receiver" type="Receiver" line="498"/>
                                    <scope line="499">
                                        <scope line="500">
                                            <scope line="501"/>
                                            <scope line="504"/>
                                        </scope>
                                        <scope line="508"/>
                                    </scope>
                                </scope>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="516"/>
                </method>
                <method name="sendMessage" type="void" line="519">
                    <params>
                        <param name="data" type="byte[]"/>
                        <param name="timeStamp" type="long"/>
                    </params>
                    <scope line="520">
                        <scope line="521">
                            <declaration name="size" type="int" line="522"/>
                            <scope line="524">
                                <declaration name="receiver" type="Receiver" line="525"/>
                                <scope line="526"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="532"/>
                </method>
                <javadoc line="536">
                    Send this message to all transmitters                    
                </javadoc>
                <method name="sendMessage" type="void" line="539">
                    <params>
                        <param name="message" type="MidiMessage"/>
                        <param name="timeStamp" type="long"/>
                    </params>
                    <scope line="540"/>
                    <scope line="544">
                        <declaration name="size" type="int" line="545"/>
                        <scope line="546">
                            <scope line="547"/>
                        </scope>
                        <scope line="552">
                            <scope line="554">
                                <declaration name="receiver" type="Receiver" line="555"/>
                                <scope line="556"/>
                            </scope>
                        </scope>
                    </scope>
                </method>
            </class>
        </class>
    </source>