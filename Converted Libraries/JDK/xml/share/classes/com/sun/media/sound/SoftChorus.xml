<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.media.sound">
        <import package="java.util.Arrays"/>
        <class name="SoftChorus" line="29">
            <implements interface="SoftAudioProcessor"/>
            <javadoc line="29">
                A chorus effect made using LFO and variable delay. One for each channel
                  (left,right), with different starting phase for stereo effect.                
                <author>
                    Karl Helgason                    
                </author>
            </javadoc>
            <class name="VariableDelay" line="37">
                <declaration name="delaybuffer" type="float[]" line="39"/>
                <declaration name="rovepos" type="int" line="40"/>
                <declaration name="gain" type="float" line="41"/>
                <declaration name="rgain" type="float" line="42"/>
                <declaration name="delay" type="float" line="43"/>
                <declaration name="lastdelay" type="float" line="44"/>
                <declaration name="feedback" type="float" line="45"/>
                <method name="VariableDelay" type="constructor" line="47">
                    <params>
                        <param name="maxbuffersize" type="int"/>
                    </params>
                </method>
                <method name="setDelay" type="void" line="51">
                    <params>
                        <param name="delay" type="float"/>
                    </params>
                </method>
                <method name="setFeedBack" type="void" line="55">
                    <params>
                        <param name="feedback" type="float"/>
                    </params>
                </method>
                <method name="setGain" type="void" line="59">
                    <params>
                        <param name="gain" type="float"/>
                    </params>
                </method>
                <method name="setReverbSendGain" type="void" line="63">
                    <params>
                        <param name="rgain" type="float"/>
                    </params>
                </method>
                <method name="processMix" type="void" line="67">
                    <params>
                        <param name="in" type="float[]"/>
                        <param name="out" type="float[]"/>
                        <param name="rout" type="float[]"/>
                    </params>
                    <declaration name="gain" type="float" line="68"/>
                    <declaration name="delay" type="float" line="69"/>
                    <declaration name="feedback" type="float" line="70"/>
                    <declaration name="delaybuffer" type="float[]" line="72"/>
                    <declaration name="len" type="int" line="73"/>
                    <declaration name="delaydelta" type="float" line="74"/>
                    <declaration name="rnlen" type="int" line="75"/>
                    <declaration name="rovepos" type="int" line="76"/>
                    <scope line="79">
                        <declaration name="r" type="float" line="80"/>
                        <declaration name="ri" type="int" line="81"/>
                        <declaration name="s" type="float" line="82"/>
                        <declaration name="a" type="float" line="83"/>
                        <declaration name="b" type="float" line="84"/>
                        <declaration name="o" type="float" line="85"/>
                    </scope>
                    <scope line="92">
                        <declaration name="r" type="float" line="93"/>
                        <declaration name="ri" type="int" line="94"/>
                        <declaration name="s" type="float" line="95"/>
                        <declaration name="a" type="float" line="96"/>
                        <declaration name="b" type="float" line="97"/>
                        <declaration name="o" type="float" line="98"/>
                    </scope>
                </method>
                <method name="processReplace" type="void" line="109">
                    <params>
                        <param name="in" type="float[]"/>
                        <param name="out" type="float[]"/>
                        <param name="rout" type="float[]"/>
                    </params>
                </method>
            </class>
            <class name="LFODelay" line="116">
                <declaration name="phase" type="double" line="118"/>
                <declaration name="phase_step" type="double" line="119"/>
                <declaration name="depth" type="double" line="120"/>
                <declaration name="vdelay" type="VariableDelay" line="121"/>
                <declaration name="samplerate" type="double" line="122"/>
                <declaration name="controlrate" type="double" line="123"/>
                <method name="LFODelay" type="constructor" line="125">
                    <params>
                        <param name="samplerate" type="double"/>
                        <param name="controlrate" type="double"/>
                    </params>
                    <comment line="128">
                        vdelay = new VariableDelay((int)(samplerate*4));                        
                    </comment>
                </method>
                <method name="setDepth" type="void" line="133">
                    <params>
                        <param name="depth" type="double"/>
                    </params>
                </method>
                <method name="setRate" type="void" line="138">
                    <params>
                        <param name="rate" type="double"/>
                    </params>
                    <declaration name="g" type="double" line="139"/>
                </method>
                <method name="setPhase" type="void" line="143">
                    <params>
                        <param name="phase" type="double"/>
                    </params>
                </method>
                <method name="setFeedBack" type="void" line="147">
                    <params>
                        <param name="feedback" type="float"/>
                    </params>
                </method>
                <method name="setGain" type="void" line="151">
                    <params>
                        <param name="gain" type="float"/>
                    </params>
                </method>
                <method name="setReverbSendGain" type="void" line="155">
                    <params>
                        <param name="rgain" type="float"/>
                    </params>
                </method>
                <method name="processMix" type="void" line="159">
                    <params>
                        <param name="in" type="float[]"/>
                        <param name="out" type="float[]"/>
                        <param name="rout" type="float[]"/>
                    </params>
                </method>
                <method name="processReplace" type="void" line="166">
                    <params>
                        <param name="in" type="float[]"/>
                        <param name="out" type="float[]"/>
                        <param name="rout" type="float[]"/>
                    </params>
                </method>
            </class>
            <declaration name="mix" type="boolean" line="174"/>
            <declaration name="inputA" type="SoftAudioBuffer" line="175"/>
            <declaration name="left" type="SoftAudioBuffer" line="176"/>
            <declaration name="right" type="SoftAudioBuffer" line="177"/>
            <declaration name="reverb" type="SoftAudioBuffer" line="178"/>
            <declaration name="vdelay1L" type="LFODelay" line="179"/>
            <declaration name="vdelay1R" type="LFODelay" line="180"/>
            <declaration name="rgain" type="float" line="181"/>
            <declaration name="dirty" type="boolean" line="182"/>
            <declaration name="dirty_vdelay1L_rate" type="double" line="183"/>
            <declaration name="dirty_vdelay1R_rate" type="double" line="184"/>
            <declaration name="dirty_vdelay1L_depth" type="double" line="185"/>
            <declaration name="dirty_vdelay1R_depth" type="double" line="186"/>
            <declaration name="dirty_vdelay1L_feedback" type="float" line="187"/>
            <declaration name="dirty_vdelay1R_feedback" type="float" line="188"/>
            <declaration name="dirty_vdelay1L_reverbsendgain" type="float" line="189"/>
            <declaration name="dirty_vdelay1R_reverbsendgain" type="float" line="190"/>
            <declaration name="controlrate" type="float" line="191"/>
            <method name="init" type="void" line="193">
                <params>
                    <param name="samplerate" type="float"/>
                    <param name="controlrate" type="float"/>
                </params>
                <comment line="197">
                    %                    
                </comment>
                <comment line="198">
                    %                    
                </comment>
            </method>
            <method name="globalParameterControlChange" type="void" line="206">
                <params>
                    <param name="slothpath" type="int[]"/>
                    <param name="param" type="long"/>
                    <param name="value" type="long"/>
                </params>
                <comment line="209">
                    Chorus Type                    
                </comment>
                <comment line="211">
                    Chorus 1 0 (0%) 3 (0.4Hz) 5 (1.9ms) 0 (0%)                    
                </comment>
                <comment line="217">
                    Chorus 2 5 (4%) 9 (1.1Hz) 19 (6.3ms) 0 (0%)                    
                </comment>
                <comment line="223">
                    Chorus 3 8 (6%) 3 (0.4Hz) 19 (6.3ms) 0 (0%)                    
                </comment>
                <comment line="229">
                    Chorus 4 16 (12%) 9 (1.1Hz) 16 (5.3ms) 0 (0%)                    
                </comment>
                <comment line="235">
                    FB Chorus 64 (49%) 2 (0.2Hz) 24 (7.8ms) 0 (0%)                    
                </comment>
                <comment line="241">
                    Flanger 112 (86%) 1 (0.1Hz) 5 (1.9ms) 0 (0%)                    
                </comment>
                <comment line="250">
                    Mod Rate                    
                </comment>
                <comment line="254">
                    Mod Depth                    
                </comment>
                <comment line="258">
                    Feedback                    
                </comment>
                <comment line="263">
                    Send to Reverb                    
                </comment>
                <scope line="207">
                    <scope line="208">
                        <scope line="209"/>
                        <scope line="250"/>
                        <scope line="254"/>
                        <scope line="258"/>
                        <scope line="263"/>
                    </scope>
                </scope>
            </method>
            <method name="processControlLogic" type="void" line="274">
                <scope line="275"/>
            </method>
            <declaration name="silentcounter" type="double" line="287"/>
            <method name="processAudio" type="void" line="289">
                <scope line="291">
                    <scope line="294">
                        <scope line="295"/>
                    </scope>
                </scope>
                <declaration name="inputA" type="float[]" line="304"/>
                <declaration name="left" type="float[]" line="305"/>
                <declaration name="right" type="float[]" line="306"/>
                <declaration name="reverb" type="float[]" line="307"/>
                <scope line="309"/>
                <scope line="313"/>
            </method>
            <method name="setInput" type="void" line="320">
                <params>
                    <param name="pin" type="int"/>
                    <param name="input" type="SoftAudioBuffer"/>
                </params>
            </method>
            <method name="setMixMode" type="void" line="325">
                <params>
                    <param name="mix" type="boolean"/>
                </params>
            </method>
            <method name="setOutput" type="void" line="329">
                <params>
                    <param name="pin" type="int"/>
                    <param name="output" type="SoftAudioBuffer"/>
                </params>
            </method>
        </class>
    </source>