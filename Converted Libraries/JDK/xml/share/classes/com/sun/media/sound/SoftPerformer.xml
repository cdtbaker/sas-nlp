<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.media.sound">
        <import package="java.util.ArrayList"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.Comparator"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.List"/>
        <import package="java.util.Map"/>
        <class name="SoftPerformer" line="8">
            <javadoc line="8">
                This class decodes information from ModelPeformer for use in SoftVoice.
                  It also adds default connections if they where missing in ModelPerformer.                
                <author>
                    Karl Helgason                    
                </author>
            </javadoc>
            <declaration name="defaultconnections" type="ModelConnectionBlock[]" line="14"/>
            <scope line="15">
                <declaration name="o" type="int" line="16"/>
                <anonymous_class line="22">
                    <method name="transform" type="double" line="23">
                        <params>
                            <param name="value" type="double"/>
                        </params>
                        <declaration name="v" type="int" line="24"/>
                        <declaration name="msb" type="int" line="25"/>
                        <declaration name="lsb" type="int" line="26"/>
                    </method>
                </anonymous_class>
            </scope>
            <declaration name="keyFrom" type="int" line="68"/>
            <declaration name="keyTo" type="int" line="69"/>
            <declaration name="velFrom" type="int" line="70"/>
            <declaration name="velTo" type="int" line="71"/>
            <declaration name="exclusiveClass" type="int" line="72"/>
            <declaration name="selfNonExclusive" type="boolean" line="73"/>
            <declaration name="forcedVelocity" type="boolean" line="74"/>
            <declaration name="forcedKeynumber" type="boolean" line="75"/>
            <declaration name="performer" type="ModelPerformer" line="76"/>
            <declaration name="connections" type="ModelConnectionBlock[]" line="77"/>
            <declaration name="oscillators" type="ModelOscillator[]" line="78"/>
            <declaration name="midi_rpn_connections" type="Map&lt;Integer,int[]&gt;" line="79"/>
            <declaration name="midi_nrpn_connections" type="Map&lt;Integer,int[]&gt;" line="80"/>
            <declaration name="midi_ctrl_connections" type="int[][]" line="81"/>
            <declaration name="midi_connections" type="int[][]" line="82"/>
            <declaration name="ctrl_connections" type="int[]" line="83"/>
            <declaration name="ctrl_connections_list" type="List&lt;Integer&gt;" line="84"/>
            <class name="KeySortComparator" line="85">
                <implements interface="Comparator">
                    <type_params>
                        <type_param name="ModelSource"/>
                    </type_params>
                </implements>
                <method name="compare" type="int" line="86">
                    <params>
                        <param name="o1" type="ModelSource"/>
                        <param name="o2" type="ModelSource"/>
                    </params>
                </method>
            </class>
            <declaration name="keySortComparator" type="KeySortComparator" line="90"/>
            <method name="extractKeys" type="String" line="91">
                <params>
                    <param name="conn" type="ModelConnectionBlock"/>
                </params>
                <declaration name="sb" type="StringBuffer" line="92"/>
                <scope line="93">
                    <declaration name="srcs" type="ModelSource[]" line="95"/>
                    <declaration name="srcs2" type="ModelSource[]" line="96"/>
                    <scope line="99"/>
                </scope>
                <scope line="106"/>
            </method>
            <method name="processSource" type="void" line="112">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="id" type="ModelIdentifier" line="113"/>
                <declaration name="o" type="String" line="114"/>
            </method>
            <method name="processMidiControlSource" type="void" line="124">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="125"/>
                <declaration name="c" type="int" line="127"/>
                <scope line="129">
                    <declaration name="olda" type="int[]" line="130"/>
                    <declaration name="newa" type="int[]" line="131"/>
                </scope>
            </method>
            <method name="processNoteOnSource" type="void" line="137">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="138"/>
                <declaration name="c" type="int" line="139"/>
                <scope line="144">
                    <declaration name="olda" type="int[]" line="145"/>
                    <declaration name="newa" type="int[]" line="146"/>
                </scope>
            </method>
            <method name="processMidiSource" type="void" line="152">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="153"/>
                <declaration name="c" type="int" line="154"/>
                <scope line="160">
                    <declaration name="olda" type="int[]" line="161"/>
                    <declaration name="newa" type="int[]" line="162"/>
                </scope>
            </method>
            <method name="processMidiRpnSource" type="void" line="168">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="169"/>
                <declaration name="c" type="int" line="171"/>
                <scope line="173">
                    <declaration name="olda" type="int[]" line="174"/>
                    <declaration name="newa" type="int[]" line="175"/>
                </scope>
            </method>
            <method name="processMidiNrpnSource" type="void" line="181">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="182"/>
                <declaration name="c" type="int" line="184"/>
                <scope line="186">
                    <declaration name="olda" type="int[]" line="187"/>
                    <declaration name="newa" type="int[]" line="188"/>
                </scope>
            </method>
            <method name="SoftPerformer" type="constructor" line="194">
                <params>
                    <param name="performer" type="ModelPerformer"/>
                </params>
                <declaration name="connmap" type="Map&lt;String,ModelConnectionBlock&gt;" line="202"/>
                <declaration name="performer_connections" type="List&lt;ModelConnectionBlock&gt;" line="203"/>
                <scope line="205">
                    <declaration name="isModulationWheelConectionFound" type="boolean" line="206"/>
                    <scope line="207">
                        <declaration name="connection" type="ModelConnectionBlock" line="208"/>
                        <declaration name="sources" type="ModelSource[]" line="209"/>
                        <declaration name="dest" type="ModelDestination" line="210"/>
                        <declaration name="isModulationWheelConection" type="boolean" line="211"/>
                        <scope line="212">
                            <scope line="213">
                                <scope line="214">
                                    <scope line="215"/>
                                </scope>
                            </scope>
                        </scope>
                        <scope line="223">
                            <declaration name="newconnection" type="ModelConnectionBlock" line="224"/>
                        </scope>
                    </scope>
                    <scope line="232">
                        <declaration name="conn" type="ModelConnectionBlock" line="233"/>
                    </scope>
                    <declaration name="channel_pressure_set" type="boolean" line="238"/>
                    <declaration name="poly_pressure" type="boolean" line="239"/>
                    <declaration name="mod_cc_1_connection" type="ModelConnectionBlock" line="240"/>
                    <declaration name="mod_cc_1_connection_src_ix" type="int" line="241"/>
                    <scope line="242">
                        <declaration name="sources" type="ModelSource[]" line="243"/>
                        <declaration name="dest" type="ModelDestination" line="244"/>
                        <scope line="245">
                            <scope line="246">
                                <declaration name="srcid" type="ModelIdentifier" line="247"/>
                                <scope line="248">
                                    <scope line="249"/>
                                </scope>
                                <scope line="254"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="261">
                        <scope line="262">
                            <declaration name="mc" type="ModelConnectionBlock" line="263"/>
                            <declaration name="src_list" type="ModelSource[]" line="266"/>
                            <declaration name="src_list_new" type="ModelSource[]" line="267"/>
                        </scope>
                        <scope line="273">
                            <declaration name="mc" type="ModelConnectionBlock" line="274"/>
                            <declaration name="src_list" type="ModelSource[]" line="277"/>
                            <declaration name="src_list_new" type="ModelSource[]" line="278"/>
                        </scope>
                    </scope>
                    <declaration name="found_vib_connection" type="ModelConnectionBlock" line="285"/>
                    <scope line="286">
                        <declaration name="sources" type="ModelSource[]" line="287"/>
                        <scope line="288">
                            <scope line="289">
                                <scope line="291">
                                    <scope line="293">
                                        <scope line="294"/>
                                    </scope>
                                </scope>
                            </scope>
                        </scope>
                    </scope>
                    <declaration name="instance" type="int" line="302"/>
                    <scope line="303"/>
                    <declaration name="connection" type="ModelConnectionBlock" line="306"/>
                    <declaration name="scale" type="double" line="309"/>
                    <anonymous_class line="310">
                        <declaration name="s" type="double" line="311"/>
                        <method name="transform" type="double" line="312">
                            <params>
                                <param name="value" type="double"/>
                            </params>
                            <scope line="315"/>
                            <scope line="318"/>
                            <scope line="322"/>
                        </method>
                    </anonymous_class>
                </scope>
                <declaration name="connections" type="List&lt;ModelConnectionBlock&gt;" line="335"/>
                <scope line="337"/>
                <scope line="341"/>
                <declaration name="ix" type="int" line="344"/>
                <declaration name="mustBeOnTop" type="boolean" line="345"/>
                <scope line="346">
                    <scope line="347">
                        <declaration name="dest" type="ModelDestination" line="348"/>
                        <declaration name="id" type="ModelIdentifier" line="349"/>
                        <scope line="350"/>
                    </scope>
                    <scope line="356"/>
                </scope>
                <scope line="362">
                    <scope line="363">
                        <declaration name="srcs" type="ModelSource[]" line="364"/>
                        <scope line="365"/>
                    </scope>
                </scope>
                <scope line="377">
                    <scope line="378">
                        <scope line="379"/>
                    </scope>
                    <scope line="383">
                        <scope line="384">
                            <scope line="385"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="isUnnecessaryTransform" type="boolean" line="392">
                <params>
                    <param name="transform" type="ModelTransform"/>
                </params>
                <declaration name="stransform" type="ModelStandardTransform" line="395"/>
            </method>
        </class>
    </source>