<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.media.sound">
        <import package="java.util.ArrayList"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.Comparator"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.List"/>
        <import package="java.util.Map"/>
        <class name="SoftPerformer" line="34">
            <javadoc line="34">
                This class decodes information from ModelPeformer for use in SoftVoice.
                  It also adds default connections if they where missing in ModelPerformer.                
                <author>
                    Karl Helgason                    
                </author>
            </javadoc>
            <declaration name="defaultconnections" type="ModelConnectionBlock[]" line="42"/>
            <scope line="45">
                <declaration name="o" type="int" line="46"/>
                <anonymous_class line="94">
                    <method name="transform" type="double" line="95">
                        <params>
                            <param name="value" type="double"/>
                        </params>
                        <declaration name="v" type="int" line="96"/>
                        <declaration name="msb" type="int" line="97"/>
                        <declaration name="lsb" type="int" line="98"/>
                    </method>
                </anonymous_class>
            </scope>
            <declaration name="keyFrom" type="int" line="301"/>
            <declaration name="keyTo" type="int" line="302"/>
            <declaration name="velFrom" type="int" line="303"/>
            <declaration name="velTo" type="int" line="304"/>
            <declaration name="exclusiveClass" type="int" line="305"/>
            <declaration name="selfNonExclusive" type="boolean" line="306"/>
            <declaration name="forcedVelocity" type="boolean" line="307"/>
            <declaration name="forcedKeynumber" type="boolean" line="308"/>
            <declaration name="performer" type="ModelPerformer" line="309"/>
            <declaration name="connections" type="ModelConnectionBlock[]" line="310"/>
            <declaration name="oscillators" type="ModelOscillator[]" line="311"/>
            <declaration name="midi_rpn_connections" type="Map&lt;Integer,int[]&gt;" line="312"/>
            <declaration name="midi_nrpn_connections" type="Map&lt;Integer,int[]&gt;" line="313"/>
            <declaration name="midi_ctrl_connections" type="int[][]" line="314"/>
            <declaration name="midi_connections" type="int[][]" line="315"/>
            <declaration name="ctrl_connections" type="int[]" line="316"/>
            <declaration name="ctrl_connections_list" type="List&lt;Integer&gt;" line="317"/>
            <class name="KeySortComparator" line="319">
                <implements interface="Comparator">
                    <type_params>
                        <type_param name="ModelSource"/>
                    </type_params>
                </implements>
                <method name="compare" type="int" line="321">
                    <params>
                        <param name="o1" type="ModelSource"/>
                        <param name="o2" type="ModelSource"/>
                    </params>
                </method>
            </class>
            <declaration name="keySortComparator" type="KeySortComparator" line="326"/>
            <method name="extractKeys" type="String" line="328">
                <params>
                    <param name="conn" type="ModelConnectionBlock"/>
                </params>
                <declaration name="sb" type="StringBuffer" line="329"/>
                <scope line="330">
                    <declaration name="srcs" type="ModelSource[]" line="332"/>
                    <declaration name="srcs2" type="ModelSource[]" line="333"/>
                    <scope line="337"/>
                </scope>
                <scope line="344"/>
            </method>
            <method name="processSource" type="void" line="351">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="id" type="ModelIdentifier" line="352"/>
                <declaration name="o" type="String" line="353"/>
            </method>
            <method name="processMidiControlSource" type="void" line="372">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="373"/>
                <declaration name="c" type="int" line="376"/>
                <scope line="379">
                    <declaration name="olda" type="int[]" line="380"/>
                    <declaration name="newa" type="int[]" line="381"/>
                </scope>
            </method>
            <method name="processNoteOnSource" type="void" line="389">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="390"/>
                <declaration name="c" type="int" line="391"/>
                <scope line="400">
                    <declaration name="olda" type="int[]" line="401"/>
                    <declaration name="newa" type="int[]" line="402"/>
                </scope>
            </method>
            <method name="processMidiSource" type="void" line="410">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="411"/>
                <declaration name="c" type="int" line="412"/>
                <scope line="423">
                    <declaration name="olda" type="int[]" line="424"/>
                    <declaration name="newa" type="int[]" line="425"/>
                </scope>
            </method>
            <method name="processMidiRpnSource" type="void" line="433">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="434"/>
                <declaration name="c" type="int" line="437"/>
                <scope line="440">
                    <declaration name="olda" type="int[]" line="441"/>
                    <declaration name="newa" type="int[]" line="442"/>
                </scope>
            </method>
            <method name="processMidiNrpnSource" type="void" line="450">
                <params>
                    <param name="src" type="ModelSource"/>
                    <param name="ix" type="int"/>
                </params>
                <declaration name="v" type="String" line="451"/>
                <declaration name="c" type="int" line="454"/>
                <scope line="457">
                    <declaration name="olda" type="int[]" line="458"/>
                    <declaration name="newa" type="int[]" line="459"/>
                </scope>
            </method>
            <method name="SoftPerformer" type="constructor" line="467">
                <params>
                    <param name="performer" type="ModelPerformer"/>
                </params>
                <comment line="484">
                    Add modulation depth range (RPN 5) to the modulation wheel (cc#1)                    
                </comment>
                <comment line="494">
                    check if connection block has the source &quot;modulation                    
                </comment>
                <comment line="495">
                    wheel cc#1&quot;                    
                </comment>
                <comment line="538">
                    Let Aftertouch to behave just like modulation wheel (cc#1)                    
                </comment>
                <comment line="547">
                    if(dest != null &amp;&amp; sources != null)                    
                </comment>
                <comment line="551">
                    check if connection block has the source &quot;modulation                    
                </comment>
                <comment line="552">
                    wheel cc#1&quot;                    
                </comment>
                <comment line="559">
                    check if channel or poly pressure are already                    
                </comment>
                <comment line="560">
                    connected                    
                </comment>
                <comment line="601">
                    Enable Vibration Sound Controllers : 76, 77, 78                    
                </comment>
                <comment line="681">
                    Add default connection blocks                    
                </comment>
                <comment line="685">
                    Add connection blocks from modelperformer                    
                </comment>
                <comment line="688">
                    seperate connection blocks : Init time, Midi Time, Midi/Control Time,                    
                </comment>
                <comment line="689">
                    Control Time                    
                </comment>
                <declaration name="connmap" type="Map&lt;String,ModelConnectionBlock&gt;" line="477"/>
                <declaration name="performer_connections" type="List&lt;ModelConnectionBlock&gt;" line="479"/>
                <scope line="482">
                    <declaration name="isModulationWheelConectionFound" type="boolean" line="486"/>
                    <scope line="487">
                        <declaration name="connection" type="ModelConnectionBlock" line="488"/>
                        <declaration name="sources" type="ModelSource[]" line="489"/>
                        <declaration name="dest" type="ModelDestination" line="490"/>
                        <declaration name="isModulationWheelConection" type="boolean" line="491"/>
                        <scope line="492">
                            <scope line="493">
                                <scope line="497">
                                    <scope line="499"/>
                                </scope>
                            </scope>
                        </scope>
                        <scope line="507">
                            <declaration name="newconnection" type="ModelConnectionBlock" line="509"/>
                        </scope>
                    </scope>
                    <scope line="519">
                        <declaration name="conn" type="ModelConnectionBlock" line="520"/>
                    </scope>
                    <declaration name="channel_pressure_set" type="boolean" line="539"/>
                    <declaration name="poly_pressure" type="boolean" line="540"/>
                    <declaration name="mod_cc_1_connection" type="ModelConnectionBlock" line="541"/>
                    <declaration name="mod_cc_1_connection_src_ix" type="int" line="542"/>
                    <scope line="544">
                        <declaration name="sources" type="ModelSource[]" line="545"/>
                        <declaration name="dest" type="ModelDestination" line="546"/>
                        <scope line="548">
                            <scope line="549">
                                <declaration name="srcid" type="ModelIdentifier" line="550"/>
                                <scope line="553">
                                    <scope line="554"/>
                                </scope>
                                <scope line="561"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="572">
                        <scope line="573">
                            <declaration name="mc" type="ModelConnectionBlock" line="574"/>
                            <declaration name="src_list" type="ModelSource[]" line="577"/>
                            <declaration name="src_list_new" type="ModelSource[]" line="578"/>
                        </scope>
                        <scope line="586">
                            <declaration name="mc" type="ModelConnectionBlock" line="587"/>
                            <declaration name="src_list" type="ModelSource[]" line="590"/>
                            <declaration name="src_list_new" type="ModelSource[]" line="591"/>
                        </scope>
                    </scope>
                    <declaration name="found_vib_connection" type="ModelConnectionBlock" line="602"/>
                    <scope line="603">
                        <declaration name="sources" type="ModelSource[]" line="604"/>
                        <scope line="606">
                            <scope line="608">
                                <scope line="611">
                                    <scope line="615">
                                        <scope line="618"/>
                                    </scope>
                                </scope>
                            </scope>
                        </scope>
                    </scope>
                    <declaration name="instance" type="int" line="628"/>
                    <scope line="630"/>
                    <declaration name="connection" type="ModelConnectionBlock" line="634"/>
                    <declaration name="scale" type="double" line="645"/>
                    <anonymous_class line="650">
                        <declaration name="s" type="double" line="651"/>
                        <method name="transform" type="double" line="652">
                            <params>
                                <param name="value" type="double"/>
                            </params>
                            <scope line="655"/>
                            <scope line="657"/>
                            <scope line="661"/>
                        </method>
                    </anonymous_class>
                </scope>
                <declaration name="connections" type="List&lt;ModelConnectionBlock&gt;" line="690"/>
                <scope line="693"/>
                <scope line="697"/>
                <declaration name="ix" type="int" line="701"/>
                <declaration name="mustBeOnTop" type="boolean" line="702"/>
                <scope line="704">
                    <scope line="705">
                        <declaration name="dest" type="ModelDestination" line="706"/>
                        <declaration name="id" type="ModelIdentifier" line="707"/>
                        <scope line="708"/>
                    </scope>
                    <scope line="716"/>
                </scope>
                <scope line="723">
                    <scope line="724">
                        <declaration name="srcs" type="ModelSource[]" line="725"/>
                        <scope line="726"/>
                    </scope>
                </scope>
                <scope line="744">
                    <scope line="745">
                        <scope line="746"/>
                    </scope>
                    <scope line="750">
                        <scope line="751">
                            <scope line="752"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="isUnnecessaryTransform" type="boolean" line="761">
                <params>
                    <param name="transform" type="ModelTransform"/>
                </params>
                <declaration name="stransform" type="ModelStandardTransform" line="766"/>
            </method>
        </class>
    </source>