<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.security.auth">
        <import package="java.io"/>
        <import package="java.lang.RuntimePermission"/>
        <import package="java.net.MalformedURLException"/>
        <import package="java.net.SocketPermission"/>
        <import package="java.net.URL"/>
        <import package="java.security.GeneralSecurityException"/>
        <import package="java.text.MessageFormat"/>
        <import package="java.util.Enumeration"/>
        <import package="java.util.Hashtable"/>
        <import package="java.util.LinkedList"/>
        <import package="java.util.ListIterator"/>
        <import package="java.util.Vector"/>
        <import package="java.util.StringTokenizer"/>
        <import package="sun.security.util.PropertyExpander"/>
        <class name="PolicyParser" line="43">
            <comment line="100">
                Convenience variables for parsing                
            </comment>
            <comment line="107">
                unexpanded                
            </comment>
            <javadoc line="43">
                The policy for a Java runtime (specifying
                  which permissions are available for code from various principals)
                  is represented as a separate
                  persistent configuration.  The configuration may be stored as a
                  flat ASCII file, as a serialized binary file of
                  the Policy class, or as a database. &lt;p&gt;
                  &lt;p&gt;The Java runtime creates one global Policy object, which is used to
                  represent the static policy configuration file.  It is consulted by
                  a ProtectionDomain when the protection domain initializes its set of
                  permissions. &lt;p&gt;
                  &lt;p&gt;The Policy &lt;code&gt;init&lt;/code&gt; method parses the policy
                  configuration file, and then
                  populates the Policy object.  The Policy object is agnostic in that
                  it is not involved in making policy decisions.  It is merely the
                  Java runtime representation of the persistent policy configuration
                  file. &lt;p&gt;
                  &lt;p&gt;When a protection domain needs to initialize its set of
                  permissions, it executes code such as the following
                  to ask the global Policy object to populate a
                  Permissions object with the appropriate permissions:
                  &lt;pre&gt;
                  policy = Policy.getPolicy();
                  Permissions perms = policy.getPermissions(MyCodeSource)
                  &lt;/pre&gt;
                  &lt;p&gt;The protection domain passes in a CodeSource
                  object, which encapsulates its codebase (URL) and public key attributes.
                  The Policy object evaluates the global policy in light of who the
                  principal is and returns an appropriate Permissions object.                
                <deprecated>
                    As of JDK&nbsp;1.4, replaced by{@link sun.security.provider.PolicyParser}.
                      This class is entirely deprecated.                    
                </deprecated>
                <author>
                    Roland Schemers                    
                </author>
                <since>
                    1.2                    
                </since>
            </javadoc>
            <declaration name="rb" type="java.util.ResourceBundle" line="88"/>
            <anonymous_class line="90">
                <method name="run" type="java.util.ResourceBundle" line="91"/>
            </anonymous_class>
            <declaration name="grantEntries" type="Vector&lt;GrantEntry&gt;" line="97"/>
            <declaration name="debug" type="sun.security.util.Debug" line="100"/>
            <declaration name="st" type="StreamTokenizer" line="102"/>
            <declaration name="lookahead" type="int" line="103"/>
            <declaration name="linenum" type="int" line="104"/>
            <declaration name="expandProp" type="boolean" line="105"/>
            <declaration name="keyStoreUrlString" type="String" line="106"/>
            <declaration name="keyStoreType" type="String" line="107"/>
            <method name="expand" type="String" line="111">
                <params>
                    <param name="value" type="String"/>
                </params>
            </method>
            <javadoc line="117">
                Creates a PolicyParser object.                
            </javadoc>
            <method name="PolicyParser" type="constructor" line="121"/>
            <method name="PolicyParser" type="constructor" line="126">
                <params>
                    <param name="expandProp" type="boolean"/>
                </params>
            </method>
            <javadoc line="131">
                Reads a policy configuration into the Policy object using a
                  Reader object. &lt;p&gt;                
                <param>
                    policy the policy Reader object.                    
                </param>
                <exception>
                    ParsingException if the policy configuration contains
                      a syntax error.                    
                </exception>
                <exception>
                    IOException if an error occurs while reading the policy
                      configuration.                    
                </exception>
            </javadoc>
            <method name="read" type="void" line="146">
                <params>
                    <param name="policy" type="Reader"/>
                </params>
                <comment line="152">
                    Configure the stream tokenizer:
                          Recognize strings between &quot;...&quot;
                          Don&apos;t convert words to lowercase
                          Recognize both C-style and C++-style comments
                          Treat end-of-line as white space, not as a token                    
                </comment>
                <comment line="178">
                    The main parsing loop.  The loop is executed once
                     for each entry in the config file.      The entries
                     are delimited by semicolons.   Once we&apos;ve read in
                     the information for an entry, go ahead and try to
                     add it to the policy vector.                    
                </comment>
                <comment line="191">
                    could be null if we couldn&apos;t expand a property                    
                </comment>
                <comment line="195">
                    only one keystore entry per policy file, others will be
                     ignored                    
                </comment>
                <comment line="199">
                    error?                    
                </comment>
                <scope line="147"/>
                <scope line="187">
                    <scope line="188">
                        <declaration name="ge" type="GrantEntry" line="189"/>
                    </scope>
                    <scope line="193"/>
                    <scope line="197"/>
                </scope>
            </method>
            <method name="add" type="void" line="205">
                <params>
                    <param name="ge" type="GrantEntry"/>
                </params>
            </method>
            <method name="replace" type="void" line="210">
                <params>
                    <param name="origGe" type="GrantEntry"/>
                    <param name="newGe" type="GrantEntry"/>
                </params>
            </method>
            <method name="remove" type="boolean" line="215">
                <params>
                    <param name="ge" type="GrantEntry"/>
                </params>
            </method>
            <javadoc line="219">
                Returns the (possibly expanded) keystore location, or null if the
                  expansion fails.                
            </javadoc>
            <method name="getKeyStoreUrl" type="String" line="223">
                <scope line="224">
                    <scope line="225"/>
                </scope>
                <scope line="229"/>
            </method>
            <method name="setKeyStoreUrl" type="void" line="235">
                <params>
                    <param name="url" type="String"/>
                </params>
            </method>
            <method name="getKeyStoreType" type="String" line="239"/>
            <method name="setKeyStoreType" type="void" line="243">
                <params>
                    <param name="type" type="String"/>
                </params>
            </method>
            <javadoc line="247">
                Enumerate all the entries in the global policy object.
                  This method is used by policy admin tools.   The tools
                  should use the Enumeration methods on the returned object
                  to fetch the elements sequentially.                
            </javadoc>
            <method name="grantElements" type="Enumeration<GrantEntry>" line="253"/>
            <javadoc line="257">
                write out the policy                
            </javadoc>
            <method name="write" type="void" line="262">
                <params>
                    <param name="policy" type="Writer"/>
                </params>
                <comment line="273">
                    write the (unexpanded) keystore entry as the first entry of the
                     policy file                    
                </comment>
                <comment line="279">
                    write &quot;grant&quot; entries                    
                </comment>
                <declaration name="out" type="PrintWriter" line="263"/>
                <declaration name="enum_" type="Enumeration&lt;GrantEntry&gt;" line="265"/>
                <scope line="274"/>
                <scope line="279">
                    <declaration name="ge" type="GrantEntry" line="280"/>
                </scope>
            </method>
            <javadoc line="287">
                parses a keystore entry                
            </javadoc>
            <method name="parseKeyStoreEntry" type="void" line="290">
                <comment line="295">
                    parse keystore type                    
                </comment>
                <comment line="297">
                    default type                    
                </comment>
                <scope line="295"/>
                <scope line="300"/>
                <scope line="302"/>
            </method>
            <javadoc line="308">
                writes the (unexpanded) keystore entry                
            </javadoc>
            <method name="writeKeyStoreEntry" type="void" line="311">
                <params>
                    <param name="out" type="PrintWriter"/>
                </params>
            </method>
            <javadoc line="321">
                parse a Grant entry                
            </javadoc>
            <method name="parseGrantEntry" type="GrantEntry" line="326">
                <comment line="347">
                    check for principalClass wildcard                    
                </comment>
                <comment line="356">
                    check for principalName wildcard                    
                </comment>
                <comment line="365">
                    disallow WILDCARD_CLASS &amp;&amp; actual name                    
                </comment>
                <comment line="382">
                    ignore the entire policy entry
                     but continue parsing all the info
                     so we can get to the next entry                    
                </comment>
                <comment line="398">
                    disallow non principal-based grant entries                    
                </comment>
                <comment line="414">
                    ignore. The add never happened                    
                </comment>
                <comment line="415">
                    BugId 4219343                    
                </comment>
                <declaration name="e" type="GrantEntry" line="327"/>
                <declaration name="principals" type="LinkedList&lt;PrincipalEntry&gt;" line="328"/>
                <declaration name="ignoreEntry" type="boolean" line="329"/>
                <scope line="333">
                    <scope line="335"/>
                    <scope line="338"/>
                    <scope line="341">
                        <scope line="342"/>
                        <declaration name="principalClass" type="String" line="347"/>
                        <scope line="348"/>
                        <scope line="351"/>
                        <declaration name="principalName" type="String" line="356"/>
                        <scope line="357"/>
                        <scope line="360"/>
                        <scope line="366"/>
                        <scope line="376"/>
                        <scope line="380"/>
                    </scope>
                    <scope line="390"/>
                </scope>
                <scope line="398"/>
                <scope line="407">
                    <scope line="408">
                        <scope line="409">
                            <declaration name="pe" type="PermissionEntry" line="410"/>
                        </scope>
                        <scope line="412"/>
                    </scope>
                    <scope line="417"/>
                </scope>
                <scope line="425"/>
                <scope line="429"/>
            </method>
            <javadoc line="436">
                parse a Permission entry                
            </javadoc>
            <method name="parsePermissionEntry" type="PermissionEntry" line="441">
                <comment line="445">
                    Permission                    
                </comment>
                <comment line="450">
                    Permission name                    
                </comment>
                <declaration name="e" type="PermissionEntry" line="442"/>
                <scope line="448"/>
                <scope line="453"/>
                <scope line="458">
                    <scope line="460"/>
                </scope>
                <scope line="466"/>
            </method>
            <method name="peekAndMatch" type="boolean" line="474">
                <params>
                    <param name="expect" type="String"/>
                </params>
                <scope line="475"/>
                <scope line="478"/>
            </method>
            <method name="peek" type="boolean" line="483">
                <params>
                    <param name="expect" type="String"/>
                </params>
                <declaration name="found" type="boolean" line="484"/>
            </method>
            <method name="match" type="String" line="520">
                <params>
                    <param name="expect" type="String"/>
                </params>
                <declaration name="value" type="String" line="521"/>
                <declaration name="form" type="MessageFormat" line="529"/>
                <declaration name="source" type="Object[]" line="531"/>
                <scope line="534"/>
                <scope line="536"/>
                <scope line="539"/>
                <scope line="542"/>
                <scope line="547"/>
                <scope line="550"/>
                <scope line="553"/>
                <scope line="556"/>
            </method>
            <javadoc line="597">
                skip all tokens for this entry leaving the delimiter &quot;;&quot;
                  in the stream.                
            </javadoc>
            <method name="skipEntry" type="void" line="603">
                <scope line="604"/>
            </method>
            <class name="GrantEntry" line="619">
                <javadoc line="619">
                    Each grant entry in the policy configuration file is
                      represented by a
                      GrantEntry object.  &lt;p&gt;
                      &lt;p&gt;
                      For example, the entry
                      &lt;pre&gt;
                      grant signedBy &quot;Duke&quot; {
                      permission java.io.FilePermission &quot;/tmp&quot;, &quot;read,write&quot;;
                      };
                      &lt;/pre&gt;
                      is represented internally
                      &lt;pre&gt;
                      pe = new PermissionEntry(&quot;java.io.FilePermission&quot;,
                      &quot;/tmp&quot;, &quot;read,write&quot;);
                      ge = new GrantEntry(&quot;Duke&quot;, null);
                      ge.add(pe);
                      &lt;/pre&gt;                    
                    <author>
                        Roland Schemers
                          version 1.19, 05/21/98                        
                    </author>
                </javadoc>
                <declaration name="signedBy" type="String" line="651"/>
                <declaration name="codeBase" type="String" line="652"/>
                <declaration name="principals" type="LinkedList&lt;PrincipalEntry&gt;" line="653"/>
                <declaration name="permissionEntries" type="Vector&lt;PermissionEntry&gt;" line="654"/>
                <method name="GrantEntry" type="constructor" line="656"/>
                <method name="GrantEntry" type="constructor" line="660">
                    <params>
                        <param name="signedBy" type="String"/>
                        <param name="codeBase" type="String"/>
                    </params>
                </method>
                <method name="add" type="void" line="667">
                    <params>
                        <param name="pe" type="PermissionEntry"/>
                    </params>
                </method>
                <method name="remove" type="boolean" line="672">
                    <params>
                        <param name="pe" type="PermissionEntry"/>
                    </params>
                </method>
                <method name="contains" type="boolean" line="677">
                    <params>
                        <param name="pe" type="PermissionEntry"/>
                    </params>
                </method>
                <javadoc line="681">
                    Enumerate all the permission entries in this GrantEntry.                    
                </javadoc>
                <method name="permissionElements" type="Enumeration<PermissionEntry>" line="684"/>
                <method name="write" type="void" line="689">
                    <params>
                        <param name="out" type="PrintWriter"/>
                    </params>
                    <scope line="691"/>
                    <scope line="698"/>
                    <scope line="705">
                        <declaration name="pli" type="ListIterator&lt;PrincipalEntry&gt;" line="706"/>
                        <scope line="707">
                            <declaration name="pe" type="PrincipalEntry" line="709"/>
                        </scope>
                    </scope>
                    <declaration name="enum_" type="Enumeration&lt;PermissionEntry&gt;" line="717"/>
                    <scope line="718">
                        <declaration name="pe" type="PermissionEntry" line="719"/>
                    </scope>
                </method>
            </class>
            <class name="PrincipalEntry" line="728">
                <javadoc line="728">
                    Principal info (class and name) in a grant entry                    
                </javadoc>
                <declaration name="WILDCARD_CLASS" type="String" line="733"/>
                <declaration name="WILDCARD_NAME" type="String" line="734"/>
                <declaration name="principalClass" type="String" line="736"/>
                <declaration name="principalName" type="String" line="737"/>
                <javadoc line="739">
                    A PrincipalEntry consists of the &lt;code&gt;Principal&lt;/code&gt;
                      class and &lt;code&gt;Principal&lt;/code&gt; name.
                      &lt;p&gt;                    
                    <param>
                        principalClass the <code>Principal</code> class. <p>                        
                    </param>
                    <param>
                        principalName the <code>Principal</code> name. <p>                        
                    </param>
                </javadoc>
                <method name="PrincipalEntry" type="constructor" line="749">
                    <params>
                        <param name="principalClass" type="String"/>
                        <param name="principalName" type="String"/>
                    </params>
                </method>
                <javadoc line="757">
                    Test for equality between the specified object and this object.
                      Two PrincipalEntries are equal if their PrincipalClass and
                      PrincipalName values are equal.
                      &lt;p&gt;                    
                    <param>
                        obj the object to test for equality with this object.                        
                    </param>
                    <return>
                        true if the objects are equal, false otherwise.                        
                    </return>
                </javadoc>
                <method name="equals" type="boolean" line="768">
                    <params>
                        <param name="obj" type="Object"/>
                    </params>
                    <declaration name="that" type="PrincipalEntry" line="775"/>
                    <scope line="777"/>
                </method>
                <javadoc line="784">
                    Return a hashcode for this &lt;code&gt;PrincipalEntry&lt;/code&gt;.
                      &lt;p&gt;                    
                    <return>
                        a hashcode for this <code>PrincipalEntry</code>.                        
                    </return>
                </javadoc>
                <method name="hashCode" type="int" line="791"/>
            </class>
            <class name="PermissionEntry" line="796">
                <javadoc line="796">
                    Each permission entry in the policy configuration file is
                      represented by a
                      PermissionEntry object.  &lt;p&gt;
                      &lt;p&gt;
                      For example, the entry
                      &lt;pre&gt;
                      permission java.io.FilePermission &quot;/tmp&quot;, &quot;read,write&quot;;
                      &lt;/pre&gt;
                      is represented internally
                      &lt;pre&gt;
                      pe = new PermissionEntry(&quot;java.io.FilePermission&quot;,
                      &quot;/tmp&quot;, &quot;read,write&quot;);
                      &lt;/pre&gt;                    
                    <author>
                        Roland Schemers
                          version 1.19, 05/21/98                        
                    </author>
                </javadoc>
                <declaration name="permission" type="String" line="820"/>
                <declaration name="name" type="String" line="821"/>
                <declaration name="action" type="String" line="822"/>
                <declaration name="signedBy" type="String" line="823"/>
                <method name="PermissionEntry" type="constructor" line="825"/>
                <method name="PermissionEntry" type="constructor" line="830">
                    <params>
                        <param name="permission" type="String"/>
                        <param name="name" type="String"/>
                        <param name="action" type="String"/>
                    </params>
                </method>
                <javadoc line="836">
                    Calculates a hash code value for the object.  Objects
                      which are equal will also have the same hashcode.                    
                </javadoc>
                <method name="hashCode" type="int" line="840">
                    <declaration name="retval" type="int" line="841"/>
                </method>
                <method name="equals" type="boolean" line="847">
                    <params>
                        <param name="obj" type="Object"/>
                    </params>
                    <comment line="881">
                        everything matched -- the 2 objects are equal                        
                    </comment>
                    <declaration name="that" type="PermissionEntry" line="854"/>
                    <scope line="856"/>
                    <scope line="858"/>
                    <scope line="862"/>
                    <scope line="864"/>
                    <scope line="868"/>
                    <scope line="870"/>
                    <scope line="874"/>
                    <scope line="876"/>
                </method>
                <method name="write" type="void" line="884">
                    <params>
                        <param name="out" type="PrintWriter"/>
                    </params>
                    <comment line="891">
                        have to add escape chars for quotes                        
                    </comment>
                    <comment line="896">
                        count the number of quote chars                        
                    </comment>
                    <comment line="902">
                        now, add an escape char before each quote                        
                    </comment>
                    <scope line="887">
                        <scope line="891">
                            <declaration name="numQuotes" type="int" line="892"/>
                            <declaration name="chars" type="char[]" line="893"/>
                            <scope line="896"/>
                            <declaration name="newChars" type="char[]" line="902"/>
                            <scope line="903">
                                <scope line="904"/>
                                <scope line="906"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="916"/>
                    <scope line="921"/>
                </method>
            </class>
            <class name="ParsingException" line="930">
                <extends class="GeneralSecurityException"/>
                <declaration name="serialVersionUID" type="long" line="932"/>
                <javadoc line="934">
                    Constructs a ParsingException with the specified
                      detail message. A detail message is a String that describes
                      this particular exception, which may, for example, specify which
                      algorithm is not available.                    
                    <param>
                        msg the detail message.                        
                    </param>
                </javadoc>
                <method name="ParsingException" type="constructor" line="942">
                    <params>
                        <param name="msg" type="String"/>
                    </params>
                </method>
                <method name="ParsingException" type="constructor" line="946">
                    <params>
                        <param name="line" type="int"/>
                        <param name="msg" type="String"/>
                    </params>
                </method>
                <method name="ParsingException" type="constructor" line="950">
                    <params>
                        <param name="line" type="int"/>
                        <param name="expect" type="String"/>
                        <param name="actual" type="String"/>
                    </params>
                </method>
            </class>
            <method name="main" type="void" line="957">
                <params>
                    <param name="arg" type="String"/>
                </params>
                <declaration name="pp" type="PolicyParser" line="958"/>
                <declaration name="fr" type="FileWriter" line="960"/>
            </method>
        </class>
    </source>