<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.security.sasl.ntlm">
        <import package="com.sun.security.ntlm.NTLMException"/>
        <import package="com.sun.security.ntlm.Server"/>
        <import package="java.io.IOException"/>
        <import package="java.security.GeneralSecurityException"/>
        <import package="java.util.Map"/>
        <import package="java.util.Random"/>
        <import package="javax.security.auth.callback.Callback"/>
        <import package="javax.security.auth.callback.CallbackHandler"/>
        <import package="javax.security.auth.callback.NameCallback"/>
        <import package="javax.security.auth.callback.PasswordCallback"/>
        <import package="javax.security.auth.callback.UnsupportedCallbackException"/>
        <import package="javax.security.sasl"/>
        <class name="NTLMServer" line="14">
            <implements interface="SaslServer"/>
            <javadoc line="14">
                Required callbacks:
                  - RealmCallback
                  used as key by handler to fetch password, optional
                  - NameCallback
                  used as key by handler to fetch password
                  - PasswordCallback
                  handler must enter password for username/realm supplied
                  Environment properties that affect the implementation:
                  javax.security.sasl.qop
                  String, quality of protection; only &quot;auth&quot; is accepted, default &quot;auth&quot;
                  com.sun.security.sasl.ntlm.version
                  String, name a specific version to accept:
                  LM/NTLM: Original NTLM v1
                  LM: Original NTLM v1, LM only
                  NTLM: Original NTLM v1, NTLM only
                  NTLM2: NTLM v1 with Client Challenge
                  LMv2/NTLMv2: NTLM v2
                  LMv2: NTLM v2, LM only
                  NTLMv2: NTLM v2, NTLM only
                  If not specified, use system property &quot;ntlm.version&quot;. If also
                  not specfied, all versions are accepted.
                  com.sun.security.sasl.ntlm.domain
                  String, the domain of the server, default is server name (fqdn parameter)
                  com.sun.security.sasl.ntlm.random
                  java.util.Random, the nonce source. Default null, an internal
                  java.util.Random object will be used
                  Negotiated Properties:
                  javax.security.sasl.qop
                  Always &quot;auth&quot;
                  com.sun.security.sasl.ntlm.hostname
                  The hostname for the user, provided by the client                
            </javadoc>
            <declaration name="NTLM_VERSION" type="String" line="48"/>
            <declaration name="NTLM_DOMAIN" type="String" line="49"/>
            <declaration name="NTLM_HOSTNAME" type="String" line="50"/>
            <declaration name="NTLM_RANDOM" type="String" line="51"/>
            <declaration name="random" type="Random" line="52"/>
            <declaration name="server" type="Server" line="53"/>
            <declaration name="nonce" type="byte[]" line="54"/>
            <declaration name="step" type="int" line="55"/>
            <declaration name="authzId" type="String" line="56"/>
            <declaration name="mech" type="String" line="57"/>
            <declaration name="hostname" type="String" line="58"/>
            <javadoc line="59">
                @param mech not null                
                <param>
                    protocol not null for Sasl, ignored in NTLM                    
                </param>
                <param>
                    serverName not null for Sasl, can be null in NTLM. If non-null,
                      might be used as domain if not provided in props                    
                </param>
                <param>
                    props can be null                    
                </param>
                <param>
                    cbh can be null for Sasl, but will throw NPE in auth for NTLM                    
                </param>
                <throws>
                    SaslException                    
                </throws>
            </javadoc>
            <method name="NTLMServer" type="constructor" line="68">
                <params>
                    <param name="mech" type="String"/>
                    <param name="protocol" type="String"/>
                    <param name="serverName" type="String"/>
                    <param name="props" type="Map"/>
                    <param name="cbh" type="CallbackHandler"/>
                </params>
                <declaration name="version" type="String" line="70"/>
                <declaration name="domain" type="String" line="71"/>
                <declaration name="rtmp" type="Random" line="72"/>
                <scope line="73"/>
                <scope line="79"/>
                <scope line="82"/>
                <scope line="85"/>
                <scope line="88">
                    <anonymous_class line="89">
                        <method name="getPassword" type="char[]" line="90">
                            <params>
                                <param name="ntdomain" type="String"/>
                                <param name="username" type="String"/>
                            </params>
                            <scope line="91">
                                <declaration name="rcb" type="RealmCallback" line="92"/>
                                <declaration name="ncb" type="NameCallback" line="93"/>
                                <declaration name="pcb" type="PasswordCallback" line="94"/>
                                <declaration name="passwd" type="char[]" line="96"/>
                            </scope>
                            <scope line="100"/>
                            <scope line="103"/>
                        </method>
                    </anonymous_class>
                </scope>
                <scope line="110"/>
            </method>
            <method name="getMechanismName" type="String" line="115"/>
            <method name="evaluateResponse" type="byte[]" line="118">
                <params>
                    <param name="response" type="byte[]"/>
                </params>
                <scope line="119">
                    <scope line="121"/>
                    <scope line="125">
                        <declaration name="out" type="String[]" line="126"/>
                    </scope>
                </scope>
                <scope line="132"/>
            </method>
            <method name="isComplete" type="boolean" line="136"/>
            <method name="getAuthorizationID" type="String" line="139"/>
            <method name="unwrap" type="byte[]" line="142">
                <params>
                    <param name="incoming" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
            </method>
            <method name="wrap" type="byte[]" line="145">
                <params>
                    <param name="outgoing" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
            </method>
            <method name="getNegotiatedProperty" type="Object" line="148">
                <params>
                    <param name="propName" type="String"/>
                </params>
                <scope line="149"/>
                <scope line="152"/>
                <scope line="155"/>
            </method>
            <method name="dispose" type="void" line="159"/>
        </class>
    </source>