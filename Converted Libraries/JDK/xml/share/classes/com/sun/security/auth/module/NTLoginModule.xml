<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.security.auth.module">
        <import package="java.util"/>
        <import package="java.io.IOException"/>
        <import package="javax.security.auth"/>
        <import package="javax.security.auth.callback"/>
        <import package="javax.security.auth.login"/>
        <import package="javax.security.auth.spi"/>
        <import package="java.security.Principal"/>
        <import package="com.sun.security.auth.NTUserPrincipal"/>
        <import package="com.sun.security.auth.NTSidUserPrincipal"/>
        <import package="com.sun.security.auth.NTDomainPrincipal"/>
        <import package="com.sun.security.auth.NTSidDomainPrincipal"/>
        <import package="com.sun.security.auth.NTSidPrimaryGroupPrincipal"/>
        <import package="com.sun.security.auth.NTSidGroupPrincipal"/>
        <import package="com.sun.security.auth.NTNumericCredential"/>
        <class name="NTLoginModule" line="16">
            <implements interface="LoginModule"/>
            <javadoc line="16">
                &lt;p&gt; This &lt;code&gt;LoginModule&lt;/code&gt;
                  renders a user&apos;s NT security information as some number of
                  &lt;code&gt;Principal&lt;/code&gt;s
                  and associates them with a &lt;code&gt;Subject&lt;/code&gt;.
                  &lt;p&gt; This LoginModule recognizes the debug option.
                  If set to true in the login Configuration,
                  debug messages will be output to the output stream, System.out.
                  &lt;p&gt; This LoginModule also recognizes the debugNative option.
                  If set to true in the login Configuration,
                  debug messages from the native component of the module
                  will be output to the output stream, System.out.                
                <see>
                    javax.security.auth.spi.LoginModule                    
                </see>
            </javadoc>
            <declaration name="ntSystem" type="NTSystem" line="31"/>
            <declaration name="subject" type="Subject" line="32"/>
            <declaration name="callbackHandler" type="CallbackHandler" line="33"/>
            <declaration name="sharedState" type="Map&amp;lt;String,?&amp;gt;" line="34"/>
            <declaration name="options" type="Map&amp;lt;String,?&amp;gt;" line="35"/>
            <declaration name="debug" type="boolean" line="36"/>
            <declaration name="debugNative" type="boolean" line="37"/>
            <declaration name="succeeded" type="boolean" line="38"/>
            <declaration name="commitSucceeded" type="boolean" line="39"/>
            <declaration name="userPrincipal" type="NTUserPrincipal" line="40"/>
            <declaration name="userSID" type="NTSidUserPrincipal" line="41"/>
            <declaration name="userDomain" type="NTDomainPrincipal" line="42"/>
            <declaration name="domainSID" type="NTSidDomainPrincipal" line="43"/>
            <declaration name="primaryGroup" type="NTSidPrimaryGroupPrincipal" line="44"/>
            <declaration name="groups" type="NTSidGroupPrincipal" line="45"/>
            <declaration name="iToken" type="NTNumericCredential" line="46"/>
            <javadoc line="47">
                Initialize this &lt;code&gt;LoginModule&lt;/code&gt;.
                  &lt;p&gt;                
                <param>
                    subject the &lt;code&gt;Subject&lt;/code&gt; to be authenticated. &lt;p&gt;                    
                </param>
                <param>
                    callbackHandler a &lt;code&gt;CallbackHandler&lt;/code&gt; for communicating
                      with the end user (prompting for usernames and
                      passwords, for example). This particular LoginModule only
                      extracts the underlying NT system information, so this
                      parameter is ignored.&lt;p&gt;                    
                </param>
                <param>
                    sharedState shared &lt;code&gt;LoginModule&lt;/code&gt; state. &lt;p&gt;                    
                </param>
                <param>
                    options options specified in the login
                      &lt;code&gt;Configuration&lt;/code&gt; for this particular
                      &lt;code&gt;LoginModule&lt;/code&gt;.                    
                </param>
            </javadoc>
            <method name="initialize" type="void" line="61">
                <params>
                    <param name="subject" type="Subject"/>
                    <param name="callbackHandler" type="CallbackHandler"/>
                    <param name="sharedState" type="Map&lt;String,?&gt;"/>
                    <param name="options" type="Map&lt;String,?&gt;"/>
                </params>
                <scope line="68"/>
            </method>
            <javadoc line="72">
                Import underlying NT system identity information.
                  &lt;p&gt;                
                <return>
                    true in all cases since this &lt;code&gt;LoginModule&lt;/code&gt;
                      should not be ignored.                    
                </return>
                <exception>
                    FailedLoginException if the authentication fails. &lt;p&gt;                    
                </exception>
                <exception>
                    LoginException if this &lt;code&gt;LoginModule&lt;/code&gt;
                      is unable to perform the authentication.                    
                </exception>
            </javadoc>
            <method name="login" type="boolean" line="81">
                <scope line="84">
                    <scope line="85"/>
                </scope>
                <scope line="90"/>
                <scope line="94"/>
                <scope line="98">
                    <scope line="100"/>
                </scope>
                <scope line="104">
                    <scope line="106"/>
                </scope>
                <scope line="110">
                    <scope line="112"/>
                </scope>
                <scope line="116">
                    <scope line="118"/>
                </scope>
                <scope line="122">
                    <declaration name="groupSIDs" type="String" line="123"/>
                    <scope line="125">
                        <scope line="127"/>
                    </scope>
                </scope>
                <scope line="132">
                    <scope line="134"/>
                </scope>
            </method>
            <javadoc line="141">
                &lt;p&gt; This method is called if the LoginContext&apos;s
                  overall authentication succeeded
                  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules
                  succeeded).
                  &lt;p&gt; If this LoginModule&apos;s own authentication attempt
                  succeeded (checked by retrieving the private state saved by the
                  &lt;code&gt;login&lt;/code&gt; method), then this method associates some
                  number of various &lt;code&gt;Principal&lt;/code&gt;s
                  with the &lt;code&gt;Subject&lt;/code&gt; located in the
                  &lt;code&gt;LoginModuleContext&lt;/code&gt;.  If this LoginModule&apos;s own
                  authentication attempted failed, then this method removes
                  any state that was originally saved.
                  &lt;p&gt;                
                <exception>
                    LoginException if the commit fails.                    
                </exception>
                <return>
                    true if this LoginModule&apos;s own login and commit
                      attempts succeeded, or false otherwise.                    
                </return>
            </javadoc>
            <method name="commit" type="boolean" line="159">
                <scope line="160">
                    <scope line="161"/>
                </scope>
                <scope line="166"/>
                <declaration name="principals" type="Set&amp;lt;Principal&amp;gt;" line="169"/>
                <scope line="170"/>
                <scope line="173"/>
                <scope line="176"/>
                <scope line="179"/>
                <scope line="182"/>
                <scope line="185">
                    <scope line="186"/>
                </scope>
                <declaration name="pubCreds" type="Set&amp;lt;Object&amp;gt;" line="190"/>
                <scope line="191"/>
            </method>
            <javadoc line="197">
                &lt;p&gt; This method is called if the LoginContext&apos;s
                  overall authentication failed.
                  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules
                  did not succeed).
                  &lt;p&gt; If this LoginModule&apos;s own authentication attempt
                  succeeded (checked by retrieving the private state saved by the
                  &lt;code&gt;login&lt;/code&gt; and &lt;code&gt;commit&lt;/code&gt; methods),
                  then this method cleans up any state that was originally saved.
                  &lt;p&gt;                
                <exception>
                    LoginException if the abort fails.                    
                </exception>
                <return>
                    false if this LoginModule&apos;s own login and/or commit attempts
                      failed, and true otherwise.                    
                </return>
            </javadoc>
            <method name="abort" type="boolean" line="211">
                <scope line="212"/>
                <scope line="215"/>
                <scope line="218"/>
                <scope line="229"/>
            </method>
            <javadoc line="234">
                Logout the user.
                  &lt;p&gt; This method removes the &lt;code&gt;NTUserPrincipal&lt;/code&gt;,
                  &lt;code&gt;NTDomainPrincipal&lt;/code&gt;, &lt;code&gt;NTSidUserPrincipal&lt;/code&gt;,
                  &lt;code&gt;NTSidDomainPrincipal&lt;/code&gt;, &lt;code&gt;NTSidGroupPrincipal&lt;/code&gt;s,
                  and &lt;code&gt;NTSidPrimaryGroupPrincipal&lt;/code&gt;
                  that may have been added by the &lt;code&gt;commit&lt;/code&gt; method.
                  &lt;p&gt;                
                <exception>
                    LoginException if the logout fails.                    
                </exception>
                <return>
                    true in all cases since this &lt;code&gt;LoginModule&lt;/code&gt;
                      should not be ignored.                    
                </return>
            </javadoc>
            <method name="logout" type="boolean" line="246">
                <scope line="247"/>
                <declaration name="principals" type="Set&amp;lt;Principal&amp;gt;" line="250"/>
                <scope line="251"/>
                <scope line="254"/>
                <scope line="257"/>
                <scope line="260"/>
                <scope line="263"/>
                <scope line="266">
                    <scope line="267"/>
                </scope>
                <declaration name="pubCreds" type="Set&amp;lt;Object&amp;gt;" line="271"/>
                <scope line="272"/>
                <scope line="285"/>
            </method>
        </class>
    </source>