<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.security.sasl">
        <import package="javax.security.sasl"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <import package="java.util.logging.Logger"/>
        <import package="java.util.logging.Level"/>
        <class name="CramMD5Client" line="34">
            <extends class="CramMD5Base"/>
            <implements interface="SaslClient"/>
            <javadoc line="34">
                Implements the CRAM-MD5 SASL client-side mechanism.
                  (&lt;A HREF=&quot;http://www.ietf.org/rfc/rfc2195.txt&quot;&gt;RFC 2195&lt;/A&gt;).
                  CRAM-MD5 has no initial response. It receives bytes from
                  the server as a challenge, which it hashes by using MD5 and the password.
                  It concatenates the authentication ID with this result and returns it
                  as the response to the challenge. At that point, the exchange is complete.                
                <author>
                    Vincent Ryan                    
                </author>
                <author>
                    Rosanna Lee                    
                </author>
            </javadoc>
            <declaration name="username" type="String" line="46"/>
            <javadoc line="48">
                Creates a SASL mechanism with client credentials that it needs
                  to participate in CRAM-MD5 authentication exchange with the server.                
                <param>
                    authID A  non-null string representing the principal
                      being authenticated.                    
                </param>
                <param>
                    pw A non-null String or byte[]
                      containing the password. If it is an array, it is first cloned.                    
                </param>
            </javadoc>
            <method name="CramMD5Client" type="constructor" line="58">
                <params>
                    <param name="authID" type="String"/>
                    <param name="pw" type="byte[]"/>
                </params>
                <comment line="65">
                    caller should have already cloned                    
                </comment>
                <scope line="59"/>
            </method>
            <javadoc line="68">
                CRAM-MD5 has no initial response.                
            </javadoc>
            <method name="hasInitialResponse" type="boolean" line="71"/>
            <javadoc line="75">
                Processes the challenge data.
                  The server sends a challenge data using which the client must
                  compute an MD5-digest with its password as the key.                
                <param>
                    challengeData A non-null byte array containing the challenge
                      data from the server.                    
                </param>
                <return>
                    A non-null byte array containing the response to be sent to
                      the server.                    
                </return>
                <throws>
                    SaslException If platform does not have MD5 support                    
                </throws>
                <throw>
                    IllegalStateException if this method is invoked more than once.                    
                </throw>
            </javadoc>
            <method name="evaluateChallenge" type="byte[]" line="89">
                <params>
                    <param name="challengeData" type="byte[]"/>
                </params>
                <comment line="91">
                    See if we&apos;ve been here before                    
                </comment>
                <comment line="102">
                    generate a keyed-MD5 digest from the user&apos;s password and challenge.                    
                </comment>
                <comment line="111">
                    clear it when we no longer need it                    
                </comment>
                <comment line="114">
                    response is username + &quot; &quot; + digest                    
                </comment>
                <scope line="92"/>
                <scope line="97"/>
                <scope line="103">
                    <scope line="104"/>
                    <declaration name="digest" type="String" line="109"/>
                    <declaration name="resp" type="String" line="115"/>
                </scope>
                <scope line="122"/>
                <scope line="125"/>
            </method>
        </class>
    </source>