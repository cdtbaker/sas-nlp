<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.security.auth">
        <import package="java.io"/>
        <import package="java.lang.RuntimePermission"/>
        <import package="java.lang.reflect"/>
        <import package="java.net.MalformedURLException"/>
        <import package="java.net.URL"/>
        <import package="java.util"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.CodeSource"/>
        <import package="java.security.KeyStore"/>
        <import package="java.security.KeyStoreException"/>
        <import package="java.security.Permission"/>
        <import package="java.security.Permissions"/>
        <import package="java.security.PermissionCollection"/>
        <import package="java.security.Principal"/>
        <import package="java.security.UnresolvedPermission"/>
        <import package="java.security.Security"/>
        <import package="java.security.cert.Certificate"/>
        <import package="java.security.cert.X509Certificate"/>
        <import package="javax.security.auth.Subject"/>
        <import package="javax.security.auth.PrivateCredentialPermission"/>
        <import package="sun.security.util.PropertyExpander"/>
        <class name="PolicyFile" line="53">
            <extends class="javax.security.auth.Policy"/>
            <comment line="254">
                needs to be package private                
            </comment>
            <comment line="271">
                for use with the reflection API                
            </comment>
            <comment line="510">
                Fast path reading from file urls in order to avoid calling
                 FileURLConnection.connect() which can be quite slow the first time
                 it is called. We really should clean up FileURLConnection so that
                 this is not a problem but in the meantime this fix helps reduce
                 start up time noticeably for the new launcher. -- DAC                
            </comment>
            <comment line="1146">
                Returns the signer certificates from the list of certificates associated
                 with the given code source.
                
                 The signer certificates are those certificates that were used to verify
                 signed code originating from the codesource location.
                
                 This method assumes that in the given code source, each signer
                 certificate is followed by its supporting certificate chain
                 (which may be empty), and that the signer certificate and its
                 supporting certificate chain are ordered bottom-to-top (i.e., with the
                 signer certificate first and the (root) certificate authority last).                
            </comment>
            <comment line="1402">
                have we pulled in the policy permissions yet?                
            </comment>
            <javadoc line="53">
                This class represents a default implementation for
                  &lt;code&gt;javax.security.auth.Policy&lt;/code&gt;.
                  &lt;p&gt; This object stores the policy for entire Java runtime,
                  and is the amalgamation of multiple static policy
                  configurations that resides in files.
                  The algorithm for locating the policy file(s) and reading their
                  information into this &lt;code&gt;Policy&lt;/code&gt; object is:
                  &lt;ol&gt;
                  &lt;li&gt;
                  Loop through the &lt;code&gt;java.security.Security&lt;/code&gt; properties,
                  &lt;i&gt;auth.policy.url.1&lt;/i&gt;, &lt;i&gt;auth.policy.url.2&lt;/i&gt;, ...,
                  &lt;i&gt;auth.policy.url.X&lt;/i&gt;&quot;.  These properties are set
                  in the Java security properties file, which is located in the file named
                  &amp;lt;JAVA_HOME&amp;gt;/lib/security/java.security.
                  &amp;lt;JAVA_HOME&amp;gt; refers to the value of the java.home system property,
                  and specifies the directory where the JRE is installed.
                  Each property value specifies a &lt;code&gt;URL&lt;/code&gt; pointing to a
                  policy file to be loaded.  Read in and load each policy.
                  &lt;li&gt;
                  The &lt;code&gt;java.lang.System&lt;/code&gt; property &lt;i&gt;java.security.auth.policy&lt;/i&gt;
                  may also be set to a &lt;code&gt;URL&lt;/code&gt; pointing to another policy file
                  (which is the case when a user uses the -D switch at runtime).
                  If this property is defined, and its use is allowed by the
                  security property file (the Security property,
                  &lt;i&gt;policy.allowSystemProperty&lt;/i&gt; is set to &lt;i&gt;true&lt;/i&gt;),
                  also load that policy.
                  &lt;li&gt;
                  If the &lt;i&gt;java.security.auth.policy&lt;/i&gt; property is defined using
                  &quot;==&quot; (rather than &quot;=&quot;), then ignore all other specified
                  policies and only load this policy.
                  &lt;/ol&gt;
                  Each policy file consists of one or more grant entries, each of
                  which consists of a number of permission entries.
                  &lt;pre&gt;
                  grant signedBy &quot;&lt;b&gt;alias&lt;/b&gt;&quot;, codeBase &quot;&lt;b&gt;URL&lt;/b&gt;&quot;,
                  principal &lt;b&gt;principalClass&lt;/b&gt; &quot;&lt;b&gt;principalName&lt;/b&gt;&quot;,
                  principal &lt;b&gt;principalClass&lt;/b&gt; &quot;&lt;b&gt;principalName&lt;/b&gt;&quot;,
                  ... {
                  permission &lt;b&gt;Type&lt;/b&gt; &quot;&lt;b&gt;name&lt;/b&gt; &quot;&lt;b&gt;action&lt;/b&gt;&quot;,
                  signedBy &quot;&lt;b&gt;alias&lt;/b&gt;&quot;;
                  permission &lt;b&gt;Type&lt;/b&gt; &quot;&lt;b&gt;name&lt;/b&gt; &quot;&lt;b&gt;action&lt;/b&gt;&quot;,
                  signedBy &quot;&lt;b&gt;alias&lt;/b&gt;&quot;;
                  ....
                  };
                  &lt;/pre&gt;
                  All non-bold items above must appear as is (although case
                  doesn&apos;t matter and some are optional, as noted below).
                  Italicized items represent variable values.
                  &lt;p&gt; A grant entry must begin with the word &lt;code&gt;grant&lt;/code&gt;.
                  The &lt;code&gt;signedBy&lt;/code&gt; and &lt;code&gt;codeBase&lt;/code&gt;
                  name/value pairs are optional.
                  If they are not present, then any signer (including unsigned code)
                  will match, and any codeBase will match.  Note that the
                  &lt;code&gt;principal&lt;/code&gt; name/value pair is not optional.
                  This &lt;code&gt;Policy&lt;/code&gt; implementation only permits
                  Principal-based grant entries.  Note that the &lt;i&gt;principalClass&lt;/i&gt;
                  may be set to the wildcard value, , which allows it to match
                  any &lt;code&gt;Principal&lt;/code&gt; class.  In addition, the &lt;i&gt;principalName&lt;/i&gt;
                  may also be set to the wildcard value, , allowing it to match
                  any &lt;code&gt;Principal&lt;/code&gt; name.  When setting the &lt;i&gt;principalName&lt;/i&gt;
                  to the , do not surround the  with quotes.
                  &lt;p&gt; A permission entry must begin with the word &lt;code&gt;permission&lt;/code&gt;.
                  The word &lt;code&gt;&lt;i&gt;Type&lt;/i&gt;&lt;/code&gt; in the template above is
                  a specific permission type, such as &lt;code&gt;java.io.FilePermission&lt;/code&gt;
                  or &lt;code&gt;java.lang.RuntimePermission&lt;/code&gt;.
                  &lt;p&gt; The &quot;&lt;i&gt;action&lt;/i&gt;&quot; is required for
                  many permission types, such as &lt;code&gt;java.io.FilePermission&lt;/code&gt;
                  (where it specifies what type of file access that is permitted).
                  It is not required for categories such as
                  &lt;code&gt;java.lang.RuntimePermission&lt;/code&gt;
                  where it is not necessary - you either have the
                  permission specified by the &lt;code&gt;&quot;&lt;i&gt;name&lt;/i&gt;&quot;&lt;/code&gt;
                  value following the type name or you don&apos;t.
                  &lt;p&gt; The &lt;code&gt;signedBy&lt;/code&gt; name/value pair for a permission entry
                  is optional. If present, it indicates a signed permission. That is,
                  the permission class itself must be signed by the given alias in
                  order for it to be granted. For example,
                  suppose you have the following grant entry:
                  &lt;pre&gt;
                  grant principal foo.com.Principal &quot;Duke&quot; {
                  permission Foo &quot;foobar&quot;, signedBy &quot;FooSoft&quot;;
                  }
                  &lt;/pre&gt;
                  &lt;p&gt; Then this permission of type &lt;i&gt;Foo&lt;/i&gt; is granted if the
                  &lt;code&gt;Foo.class&lt;/code&gt; permission has been signed by the
                  &quot;FooSoft&quot; alias, or if &lt;code&gt;Foo.class&lt;/code&gt; is a
                  system class (i.e., is found on the CLASSPATH).
                  &lt;p&gt; Items that appear in an entry must appear in the specified order
                  (&lt;code&gt;permission&lt;/code&gt;, &lt;i&gt;Type&lt;/i&gt;, &quot;&lt;i&gt;name&lt;/i&gt;&quot;, and
                  &quot;&lt;i&gt;action&lt;/i&gt;&quot;). An entry is terminated with a semicolon.
                  &lt;p&gt; Case is unimportant for the identifiers (&lt;code&gt;permission&lt;/code&gt;,
                  &lt;code&gt;signedBy&lt;/code&gt;, &lt;code&gt;codeBase&lt;/code&gt;, etc.) but is
                  significant for the &lt;i&gt;Type&lt;/i&gt;
                  or for any string that is passed in as a value. &lt;p&gt;
                  &lt;p&gt; An example of two entries in a policy configuration file is
                  &lt;pre&gt;
                  // if the code is comes from &quot;foo.com&quot; and is running as &quot;Duke&quot;,
                  // grant it read/write to all files in /tmp.
                  grant codeBase &quot;foo.com&quot;, principal foo.com.Principal &quot;Duke&quot; {
                  permission java.io.FilePermission &quot;/tmp/&quot;, &quot;read,write&quot;;
                  };
                  // grant any code running as &quot;Duke&quot; permission to read
                  // the &quot;java.vendor&quot; Property.
                  grant principal foo.com.Principal &quot;Duke&quot; {
                  permission java.util.PropertyPermission &quot;java.vendor&quot;;
                  &lt;/pre&gt;
                  &lt;p&gt; This &lt;code&gt;Policy&lt;/code&gt; implementation supports
                  special handling for PrivateCredentialPermissions.
                  If a grant entry is configured with a
                  &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;,
                  and the &quot;Principal Class/Principal Name&quot; for that
                  &lt;code&gt;PrivateCredentialPermission&lt;/code&gt; is &quot;self&quot;,
                  then the entry grants the specified &lt;code&gt;Subject&lt;/code&gt; permission to
                  access its own private Credential.  For example,
                  the following grants the &lt;code&gt;Subject&lt;/code&gt; &quot;Duke&quot;
                  access to its own a.b.Credential.
                  &lt;pre&gt;
                  grant principal foo.com.Principal &quot;Duke&quot; {
                  permission javax.security.auth.PrivateCredentialPermission
                  &quot;a.b.Credential self&quot;,
                  &quot;read&quot;;
                  };
                  &lt;/pre&gt;
                  The following grants the &lt;code&gt;Subject&lt;/code&gt; &quot;Duke&quot;
                  access to all of its own private Credentials:
                  &lt;pre&gt;
                  grant principal foo.com.Principal &quot;Duke&quot; {
                  permission javax.security.auth.PrivateCredentialPermission
                  &quot; self&quot;,
                  &quot;read&quot;;
                  };
                  &lt;/pre&gt;
                  The following grants all Subjects authenticated as a
                  &lt;code&gt;SolarisPrincipal&lt;/code&gt; (regardless of their respective names)
                  permission to access their own private Credentials:
                  &lt;pre&gt;
                  grant principal com.sun.security.auth.SolarisPrincipal  {
                  permission javax.security.auth.PrivateCredentialPermission
                  &quot; self&quot;,
                  &quot;read&quot;;
                  };
                  &lt;/pre&gt;
                  The following grants all Subjects permission to access their own
                  private Credentials:
                  &lt;pre&gt;
                  grant principal   {
                  permission javax.security.auth.PrivateCredentialPermission
                  &quot; self&quot;,
                  &quot;read&quot;;
                  };
                  &lt;/pre&gt;                
                <deprecated>
                    As of JDK&nbsp;1.4, replaced by
                      <code>sun.security.provider.PolicyFile</code>.
                      This class is entirely deprecated.                    
                </deprecated>
                <see>
                    java.security.CodeSource                    
                </see>
                <see>
                    java.security.Permissions                    
                </see>
                <see>
                    java.security.ProtectionDomain                    
                </see>
            </javadoc>
            <declaration name="rb" type="java.util.ResourceBundle" line="245"/>
            <anonymous_class line="247">
                <method name="run" type="java.util.ResourceBundle" line="248"/>
            </anonymous_class>
            <declaration name="debug" type="sun.security.util.Debug" line="255"/>
            <declaration name="AUTH_POLICY" type="String" line="258"/>
            <declaration name="SECURITY_MANAGER" type="String" line="259"/>
            <declaration name="AUTH_POLICY_URL" type="String" line="260"/>
            <declaration name="policyEntries" type="Vector&lt;PolicyEntry&gt;" line="262"/>
            <declaration name="aliasMapping" type="Hashtable" line="263"/>
            <declaration name="initialized" type="boolean" line="265"/>
            <declaration name="expandProperties" type="boolean" line="267"/>
            <declaration name="ignoreIdentityScope" type="boolean" line="268"/>
            <declaration name="PARAMS" type="Class[]" line="272"/>
            <javadoc line="274">
                Initializes the Policy object and reads the default policy
                  configuration file(s) into the Policy object.                
            </javadoc>
            <method name="PolicyFile" type="constructor" line="278">
                <comment line="279">
                    initialize Policy if either the AUTH_POLICY or                    
                </comment>
                <comment line="280">
                    SECURITY_MANAGER properties are set                    
                </comment>
                <declaration name="prop" type="String" line="281"/>
                <scope line="283"/>
            </method>
            <method name="init" type="void" line="290"/>
            <javadoc line="302">
                Refreshes the policy object by re-reading all the policy files.
                  &lt;p&gt;                
                <exception>
                    SecurityException if the caller doesn't have permission
                      to refresh the <code>Policy</code>.                    
                </exception>
            </javadoc>
            <method name="refresh" type="void" line="311">
                <comment line="319">
                    XXX                    
                </comment>
                <comment line="320">
                                        
                </comment>
                <comment line="321">
                    1)   if code instantiates PolicyFile directly, then it will need                    
                </comment>
                <comment line="322">
                    all the permissions required for the PolicyFile initialization                    
                </comment>
                <comment line="323">
                    2)   if code calls Policy.getPolicy, then it simply needs                    
                </comment>
                <comment line="324">
                    AuthPermission(getPolicy), and the javax.security.auth.Policy                    
                </comment>
                <comment line="325">
                    implementation instantiates PolicyFile in a doPrivileged block                    
                </comment>
                <comment line="326">
                    3)   if after instantiating a Policy (either via #1 or #2),                    
                </comment>
                <comment line="327">
                    code calls refresh, it simply needs                    
                </comment>
                <comment line="328">
                    AuthPermission(refreshPolicy).  then PolicyFile wraps                    
                </comment>
                <comment line="329">
                    the refresh in a doPrivileged block.                    
                </comment>
                <declaration name="sm" type="java.lang.SecurityManager" line="313"/>
                <scope line="314"/>
                <anonymous_class line="332">
                    <method name="run" type="Void" line="333"/>
                </anonymous_class>
            </method>
            <method name="initKeyStore" type="KeyStore" line="341">
                <params>
                    <param name="policyUrl" type="URL"/>
                    <param name="keyStoreName" type="String"/>
                    <param name="keyStoreType" type="String"/>
                </params>
                <comment line="344">
                    location of keystore is specified as absolute URL in policy
                     file, or is relative to URL of policy file                    
                </comment>
                <comment line="351">
                    absolute URL                    
                </comment>
                <comment line="353">
                    relative URL                    
                </comment>
                <comment line="373">
                    ignore, treat it like we have no keystore                    
                </comment>
                <scope line="342">
                    <scope line="343">
                        <declaration name="keyStoreUrl" type="URL" line="348"/>
                        <scope line="349"/>
                        <scope line="352"/>
                        <scope line="357"/>
                        <declaration name="inStream" type="InputStream" line="361"/>
                        <declaration name="ks" type="KeyStore" line="364"/>
                    </scope>
                    <scope line="372">
                        <scope line="374"/>
                    </scope>
                </scope>
            </method>
            <method name="initPolicyFile" type="void" line="383">
                <comment line="418">
                    ignore.                    
                </comment>
                <comment line="450">
                    ignore that policy                    
                </comment>
                <comment line="456">
                    do not load a static policy                    
                </comment>
                <declaration name="prop" type="String" line="385"/>
                <declaration name="iscp" type="String" line="389"/>
                <declaration name="allowSys" type="String" line="393"/>
                <scope line="395">
                    <declaration name="extra_policy" type="String" line="397"/>
                    <scope line="398">
                        <declaration name="overrideAll" type="boolean" line="399"/>
                        <scope line="400"/>
                        <scope line="404">
                            <declaration name="policyURL" type="URL" line="406"/>
                            <declaration name="policyFile" type="File" line="407"/>
                            <scope line="408"/>
                            <scope line="411"/>
                        </scope>
                        <scope line="417">
                            <scope line="419"/>
                        </scope>
                        <scope line="424">
                            <scope line="425"/>
                        </scope>
                    </scope>
                </scope>
                <declaration name="n" type="int" line="433"/>
                <declaration name="loaded_one" type="boolean" line="434"/>
                <declaration name="policy_url" type="String" line="435"/>
                <scope line="437">
                    <scope line="438"/>
                    <scope line="445">
                        <scope line="446"/>
                    </scope>
                </scope>
                <scope line="455"/>
            </method>
            <javadoc line="460">
                Checks public key. If it is marked as trusted in
                  the identity database, add it to the policy
                  with the AllPermission.                
            </javadoc>
            <method name="checkForTrustedIdentity" type="boolean" line="465">
                <params>
                    <param name="cert" type="Certificate"/>
                </params>
                <comment line="466">
                    XXX  JAAS has no way to access the SUN package.                    
                </comment>
                <comment line="467">
                    we&apos;ll add this back in when JAAS goes into core.                    
                </comment>
            </method>
            <javadoc line="471">
                Reads a policy configuration into the Policy object using a
                  Reader object.                
                <param>
                    policyFile the policy Reader object.                    
                </param>
            </javadoc>
            <method name="init" type="void" line="477">
                <params>
                    <param name="policy" type="URL"/>
                </params>
                <declaration name="pp" type="PolicyParser" line="478"/>
                <scope line="479">
                    <declaration name="isr" type="InputStreamReader" line="480"/>
                    <declaration name="keyStore" type="KeyStore" line="484"/>
                    <declaration name="enum_" type="Enumeration&lt;PolicyParser.GrantEntry&gt;" line="486"/>
                    <scope line="487">
                        <declaration name="ge" type="PolicyParser.GrantEntry" line="488"/>
                    </scope>
                </scope>
                <scope line="491"/>
                <scope line="500">
                    <scope line="501"/>
                </scope>
            </method>
            <method name="getInputStream" type="InputStream" line="516">
                <params>
                    <param name="url" type="URL"/>
                </params>
                <scope line="517">
                    <declaration name="path" type="String" line="518"/>
                </scope>
                <scope line="520"/>
            </method>
            <javadoc line="525">
                Given a PermissionEntry, create a codeSource.                
                <return>
                    null if signedBy alias is not recognized                    
                </return>
            </javadoc>
            <method name="getCodeSource" type="CodeSource" line="532">
                <params>
                    <param name="ge" type="PolicyParser.GrantEntry"/>
                    <param name="keyStore" type="KeyStore"/>
                </params>
                <comment line="537">
                    we don&apos;t have a key for this alias,                    
                </comment>
                <comment line="538">
                    just return                    
                </comment>
                <declaration name="certs" type="Certificate[]" line="533"/>
                <scope line="534">
                    <scope line="536">
                        <scope line="539"/>
                    </scope>
                </scope>
                <declaration name="location" type="URL" line="547"/>
                <scope line="554"/>
                <scope line="558"/>
            </method>
            <javadoc line="565">
                Add one policy entry to the vector.                
            </javadoc>
            <method name="addGrantEntry" type="void" line="569">
                <params>
                    <param name="ge" type="PolicyParser.GrantEntry"/>
                    <param name="keyStore" type="KeyStore"/>
                </params>
                <comment line="589">
                    skip if signedBy alias was unknown...                    
                </comment>
                <comment line="598">
                    XXX special case PrivateCredentialPermission-SELF                    
                </comment>
                <comment line="622">
                    only add if we had no signer or we had a                    
                </comment>
                <comment line="623">
                    a signer and found the keys for it.                    
                </comment>
                <scope line="571">
                    <scope line="575">
                        <declaration name="li" type="ListIterator&lt;PolicyParser.PrincipalEntry&gt;" line="576"/>
                        <scope line="578">
                            <declaration name="pppe" type="PolicyParser.PrincipalEntry" line="579"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="587">
                    <declaration name="codesource" type="CodeSource" line="588"/>
                    <declaration name="entry" type="PolicyEntry" line="592"/>
                    <declaration name="enum_" type="Enumeration&lt;PolicyParser.PermissionEntry&gt;" line="593"/>
                    <scope line="595">
                        <declaration name="pe" type="PolicyParser.PermissionEntry" line="596"/>
                        <scope line="597">
                            <declaration name="perm" type="Permission" line="599"/>
                            <scope line="602"/>
                            <scope line="606"/>
                            <scope line="612"/>
                        </scope>
                        <scope line="615">
                            <declaration name="certs" type="Certificate" line="616"/>
                            <scope line="624">
                                <declaration name="perm" type="Permission" line="625"/>
                                <scope line="631"/>
                            </scope>
                        </scope>
                        <scope line="635"/>
                        <scope line="642"/>
                    </scope>
                </scope>
                <scope line="652"/>
            </method>
            <javadoc line="665">
                Returns a new Permission object of the given Type. The Permission is
                  created by getting the
                  Class object using the &lt;code&gt;Class.forName&lt;/code&gt; method, and using
                  the reflection API to invoke the (String name, String actions)
                  constructor on the
                  object.                
                <param>
                    type the type of Permission being created.                    
                </param>
                <param>
                    name the name of the Permission being created.                    
                </param>
                <param>
                    actions the actions of the Permission being created.                    
                </param>
                <exception>
                    ClassNotFoundException  if the particular Permission
                      class could not be found.                    
                </exception>
                <exception>
                    IllegalAccessException  if the class or initializer is
                      not accessible.                    
                </exception>
                <exception>
                    InstantiationException  if getInstance tries to
                      instantiate an abstract class or an interface, or if the
                      instantiation fails for some other reason.                    
                </exception>
                <exception>
                    NoSuchMethodException if the (String, String) constructor
                      is not found.                    
                </exception>
                <exception>
                    InvocationTargetException if the underlying Permission
                      constructor throws an exception.                    
                </exception>
            </javadoc>
            <method name="getInstance" type="Permission" line="703">
                <params>
                    <param name="type" type="String"/>
                    <param name="name" type="String"/>
                    <param name="actions" type="String"/>
                </params>
                <comment line="704">
                    XXX we might want to keep a hash of created factories...                    
                </comment>
                <declaration name="pc" type="Class" line="705"/>
                <declaration name="c" type="Constructor" line="706"/>
            </method>
            <javadoc line="710">
                Fetch all certs associated with this alias.                
            </javadoc>
            <method name="getCertificates" type="Certificate[]" line="714">
                <params>
                    <param name="keyStore" type="KeyStore"/>
                    <param name="aliases" type="String"/>
                </params>
                <comment line="725">
                    See if this alias&apos;s cert has already been cached                    
                </comment>
                <comment line="732">
                    never happens, because keystore has already been loaded                    
                </comment>
                <comment line="733">
                    when we call this                    
                </comment>
                <comment line="748">
                    make sure n == vcerts.size, since we are doing a logical *and*                    
                </comment>
                <declaration name="vcerts" type="Vector&lt;Certificate&gt;" line="716"/>
                <declaration name="st" type="StringTokenizer" line="718"/>
                <declaration name="n" type="int" line="719"/>
                <scope line="721">
                    <declaration name="alias" type="String" line="722"/>
                    <declaration name="cert" type="Certificate" line="724"/>
                    <scope line="727">
                        <scope line="729"/>
                        <scope line="731"/>
                        <scope line="735"/>
                    </scope>
                    <scope line="741"/>
                </scope>
                <scope line="749">
                    <declaration name="certs" type="Certificate[]" line="750"/>
                </scope>
                <scope line="753"/>
            </method>
            <javadoc line="758">
                Enumerate all the entries in the global policy object.
                  This method is used by policy admin tools.   The tools
                  should use the Enumeration methods on the returned object
                  to fetch the elements sequentially.                
            </javadoc>
            <method name="elements" type="Enumeration<PolicyEntry>" line="764"/>
            <javadoc line="768">
                Examines this &lt;code&gt;Policy&lt;/code&gt; and returns the Permissions granted
                  to the specified &lt;code&gt;Subject&lt;/code&gt; and &lt;code&gt;CodeSource&lt;/code&gt;.
                  &lt;p&gt; Permissions for a particular &lt;i&gt;grant&lt;/i&gt; entry are returned
                  if the &lt;code&gt;CodeSource&lt;/code&gt; constructed using the codebase and
                  signedby values specified in the entry &lt;code&gt;implies&lt;/code&gt;
                  the &lt;code&gt;CodeSource&lt;/code&gt; provided to this method, and if the
                  &lt;code&gt;Subject&lt;/code&gt; provided to this method contains all of the
                  Principals specified in the entry.
                  &lt;p&gt; The &lt;code&gt;Subject&lt;/code&gt; provided to this method contains all
                  of the Principals specified in the entry if, for each
                  &lt;code&gt;Principal&lt;/code&gt;, &quot;P1&quot;, specified in the &lt;i&gt;grant&lt;/i&gt; entry
                  one of the following two conditions is met:
                  &lt;p&gt;
                  &lt;ol&gt;
                  &lt;li&gt; the &lt;code&gt;Subject&lt;/code&gt; has a
                  &lt;code&gt;Principal&lt;/code&gt;, &quot;P2&quot;, where
                  &lt;code&gt;P2.getClass().getName()&lt;/code&gt; equals the
                  P1&apos;s class name, and where
                  &lt;code&gt;P2.getName()&lt;/code&gt; equals the P1&apos;s name.
                  &lt;li&gt; P1 implements
                  &lt;code&gt;com.sun.security.auth.PrincipalComparator&lt;/code&gt;,
                  and &lt;code&gt;P1.implies&lt;/code&gt; the provided &lt;code&gt;Subject&lt;/code&gt;.
                  &lt;/ol&gt;
                  &lt;p&gt; Note that this &lt;code&gt;Policy&lt;/code&gt; implementation has
                  special handling for PrivateCredentialPermissions.
                  When this method encounters a &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;
                  which specifies &quot;self&quot; as the &lt;code&gt;Principal&lt;/code&gt; class and name,
                  it does not add that &lt;code&gt;Permission&lt;/code&gt; to the returned
                  &lt;code&gt;PermissionCollection&lt;/code&gt;.  Instead, it builds
                  a new &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;
                  for each &lt;code&gt;Principal&lt;/code&gt; associated with the provided
                  &lt;code&gt;Subject&lt;/code&gt;.  Each new &lt;code&gt;PrivateCredentialPermission&lt;/code&gt;
                  contains the same Credential class as specified in the
                  originally granted permission, as well as the Class and name
                  for the respective &lt;code&gt;Principal&lt;/code&gt;.
                  &lt;p&gt;                
                <param>
                    subject the Permissions granted to this <code>Subject</code>
                      and the additionally provided <code>CodeSource</code>
                      are returned. <p>                    
                </param>
                <param>
                    codesource the Permissions granted to this <code>CodeSource</code>
                      and the additionally provided <code>Subject</code>
                      are returned.                    
                </param>
                <return>
                    the Permissions granted to the provided <code>Subject</code>
                      <code>CodeSource</code>.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="PermissionCollection" line="824">
                <params>
                    <param name="subject" type="Subject"/>
                    <param name="codesource" type="CodeSource"/>
                </params>
                <comment line="826">
                    XXX  when JAAS goes into the JDK core,                    
                </comment>
                <comment line="827">
                    we can remove this method and simply                    
                </comment>
                <comment line="828">
                    rely on the getPermissions variant that takes a codesource,                    
                </comment>
                <comment line="829">
                    which no one can use at this point in time.                    
                </comment>
                <comment line="830">
                    at that time, we can also make SubjectCodeSource a public                    
                </comment>
                <comment line="831">
                    class.                    
                </comment>
                <comment line="833">
                    XXX                    
                </comment>
                <comment line="834">
                                        
                </comment>
                <comment line="835">
                    1)   if code instantiates PolicyFile directly, then it will need                    
                </comment>
                <comment line="836">
                    all the permissions required for the PolicyFile initialization                    
                </comment>
                <comment line="837">
                    2)   if code calls Policy.getPolicy, then it simply needs                    
                </comment>
                <comment line="838">
                    AuthPermission(getPolicy), and the javax.security.auth.Policy                    
                </comment>
                <comment line="839">
                    implementation instantiates PolicyFile in a doPrivileged block                    
                </comment>
                <comment line="840">
                    3)   if after instantiating a Policy (either via #1 or #2),                    
                </comment>
                <comment line="841">
                    code calls getPermissions, PolicyFile wraps the call                    
                </comment>
                <comment line="842">
                    in a doPrivileged block.                    
                </comment>
                <anonymous_class line="844">
                    <method name="run" type="PermissionCollection" line="845">
                        <declaration name="scs" type="SubjectCodeSource" line="846"/>
                    </method>
                </anonymous_class>
            </method>
            <javadoc line="859">
                Examines the global policy for the specified CodeSource, and
                  creates a PermissionCollection object with
                  the set of permissions for that principal&apos;s protection domain.                
                <param>
                    CodeSource the codesource associated with the caller.
                      This encapsulates the original location of the code (where the code
                      came from) and the public key(s) of its signer.                    
                </param>
                <return>
                    the set of permissions according to the policy.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="PermissionCollection" line="870">
                <params>
                    <param name="codesource" type="CodeSource"/>
                </params>
            </method>
            <javadoc line="878">
                Examines the global policy for the specified CodeSource, and
                  creates a PermissionCollection object with
                  the set of permissions for that principal&apos;s protection domain.                
                <param>
                    permissions the permissions to populate                    
                </param>
                <param>
                    codesource the codesource associated with the caller.
                      This encapsulates the original location of the code (where the code
                      came from) and the public key(s) of its signer.                    
                </param>
                <return>
                    the set of permissions according to the policy.                    
                </return>
            </javadoc>
            <method name="getPermissions" type="Permissions" line="892">
                <params>
                    <param name="perms" type="Permissions"/>
                    <param name="cs" type="CodeSource"/>
                </params>
                <comment line="905">
                    needs to be in a begin/endPrivileged block because                    
                </comment>
                <comment line="906">
                    codesource.implies calls URL.equals which does an                    
                </comment>
                <comment line="907">
                    InetAddress lookup                    
                </comment>
                <comment line="927">
                    we could check for duplicates                    
                </comment>
                <comment line="928">
                    before adding new permissions,                    
                </comment>
                <comment line="929">
                    but the SubjectDomainCombiner                    
                </comment>
                <comment line="930">
                    already checks for duplicates later                    
                </comment>
                <comment line="937">
                    now see if any of the keys are trusted ids.                    
                </comment>
                <comment line="945">
                    checkForTrustedIdentity added it                    
                </comment>
                <comment line="946">
                    to the policy for us. next time                    
                </comment>
                <comment line="947">
                    around we&apos;ll find it. This time                    
                </comment>
                <comment line="948">
                    around we need to add it.                    
                </comment>
                <scope line="893"/>
                <declaration name="codesource" type="CodeSource" line="897"/>
                <scope line="901"/>
                <scope line="909">
                    <declaration name="entry" type="PolicyEntry" line="911"/>
                    <scope line="913"/>
                    <scope line="919">
                        <scope line="920">
                            <declaration name="p" type="Permission" line="921"/>
                            <scope line="922"/>
                            <scope line="926"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="939">
                    <declaration name="certs" type="Certificate" line="940"/>
                    <scope line="941">
                        <scope line="942">
                            <scope line="944"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="957">
                Returns true if &apos;Self&apos; permissions were added to the provided
                  &apos;perms&apos;, and false otherwise.
                  &lt;p&gt;                
                <param>
                    p check to see if this Permission is a "SELF"
                      PrivateCredentialPermission. <p>                    
                </param>
                <param>
                    entryCs the codesource for the Policy entry.                    
                </param>
                <param>
                    accCs the codesource for from the current AccessControlContext.                    
                </param>
                <param>
                    perms the PermissionCollection where the individual
                      PrivateCredentialPermissions will be added.                    
                </param>
            </javadoc>
            <method name="addSelfPermissions" type="boolean" line="976">
                <params>
                    <param name="p" type="Permission"/>
                    <param name="entryCs" type="CodeSource"/>
                    <param name="accCs" type="CodeSource"/>
                    <param name="perms" type="Permissions"/>
                </params>
                <comment line="988">
                    see if it is a SELF permission                    
                </comment>
                <comment line="994">
                    regular PrivateCredentialPermission                    
                </comment>
                <comment line="998">
                    granted a SELF permission - create a                    
                </comment>
                <comment line="999">
                    PrivateCredentialPermission for each                    
                </comment>
                <comment line="1000">
                    of the Policy entry&apos;s CodeSource Principals                    
                </comment>
                <comment line="1003">
                    XXX SubjectCodeSource has no Subject???                    
                </comment>
                <comment line="1013">
                    XXX                    
                </comment>
                <comment line="1014">
                    if the Policy entry&apos;s Principal does not contain a                    
                </comment>
                <comment line="1015">
                    WILDCARD for the Principal name, then a                    
                </comment>
                <comment line="1016">
                    new PrivateCredentialPermission is created                    
                </comment>
                <comment line="1017">
                    for the Principal listed in the Policy entry.                    
                </comment>
                <comment line="1018">
                    if the Policy entry&apos;s Principal contains a WILDCARD                    
                </comment>
                <comment line="1019">
                    for the Principal name, then a new                    
                </comment>
                <comment line="1020">
                    PrivateCredentialPermission is created                    
                </comment>
                <comment line="1021">
                    for each Principal associated with the Subject                    
                </comment>
                <comment line="1022">
                    in the current ACC.                    
                </comment>
                <comment line="1029">
                    here&apos;s the new PrivateCredentialPermission                    
                </comment>
                <declaration name="pcp" type="PrivateCredentialPermission" line="985"/>
                <declaration name="scs" type="SubjectCodeSource" line="986"/>
                <declaration name="pPrincipals" type="String[][]" line="989"/>
                <scope line="992"/>
                <scope line="996">
                    <scope line="1002"/>
                    <declaration name="pli" type="ListIterator&lt;PolicyParser.PrincipalEntry&gt;" line="1007"/>
                    <scope line="1009">
                        <declaration name="principal" type="PolicyParser.PrincipalEntry" line="1011"/>
                        <declaration name="principalInfo" type="String[][]" line="1024"/>
                        <scope line="1027">
                            <declaration name="newPcp" type="PrivateCredentialPermission" line="1031"/>
                            <scope line="1040"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="1052">
                return the principal class/name pair in the 2D array.
                  array[x][y]:     x corresponds to the array length.
                  if (y == 0), it&apos;s the principal class.
                  if (y == 1), it&apos;s the principal name.                
            </javadoc>
            <method name="getPrincipalInfo" type="String[][]" line="1060">
                <params>
                    <param name="principal" type="PolicyParser.PrincipalEntry"/>
                    <param name="accCs" type="CodeSource"/>
                </params>
                <comment line="1062">
                    there are 3 possibilities:                    
                </comment>
                <comment line="1063">
                    1) the entry&apos;s Principal class and name are not wildcarded                    
                </comment>
                <comment line="1064">
                    2) the entry&apos;s Principal name is wildcarded only                    
                </comment>
                <comment line="1065">
                    3) the entry&apos;s Principal class and name are wildcarded                    
                </comment>
                <comment line="1072">
                    build a PrivateCredentialPermission for the principal                    
                </comment>
                <comment line="1073">
                    from the Policy entry                    
                </comment>
                <comment line="1084">
                    build a PrivateCredentialPermission for all                    
                </comment>
                <comment line="1085">
                    the Subject&apos;s principals that are instances of principalClass                    
                </comment>
                <comment line="1087">
                    the accCs is guaranteed to be a SubjectCodeSource                    
                </comment>
                <comment line="1088">
                    because the earlier CodeSource.implies succeeded                    
                </comment>
                <comment line="1105">
                    error                    
                </comment>
                <comment line="1123">
                    build a PrivateCredentialPermission for every                    
                </comment>
                <comment line="1124">
                    one of the current Subject&apos;s principals                    
                </comment>
                <comment line="1126">
                    the accCs is guaranteed to be a SubjectCodeSource                    
                </comment>
                <comment line="1127">
                    because the earlier CodeSource.implies succeeded                    
                </comment>
                <scope line="1070">
                    <declaration name="info" type="String[][]" line="1074"/>
                </scope>
                <scope line="1082">
                    <declaration name="scs" type="SubjectCodeSource" line="1089"/>
                    <declaration name="principalSet" type="Set&lt;Principal&gt;" line="1091"/>
                    <scope line="1092">
                        <declaration name="pClass" type="Class" line="1093"/>
                    </scope>
                    <scope line="1096">
                        <scope line="1097"/>
                    </scope>
                    <scope line="1104"/>
                    <declaration name="info" type="String[][]" line="1109"/>
                    <declaration name="pIterator" type="java.util.Iterator&lt;Principal&gt;" line="1110"/>
                    <declaration name="i" type="int" line="1112"/>
                    <scope line="1113">
                        <declaration name="p" type="Principal" line="1114"/>
                    </scope>
                </scope>
                <scope line="1121">
                    <declaration name="scs" type="SubjectCodeSource" line="1128"/>
                    <declaration name="principalSet" type="Set&lt;Principal&gt;" line="1129"/>
                    <declaration name="info" type="String[][]" line="1131"/>
                    <declaration name="pIterator" type="java.util.Iterator&lt;Principal&gt;" line="1132"/>
                    <declaration name="i" type="int" line="1134"/>
                    <scope line="1135">
                        <declaration name="p" type="Principal" line="1136"/>
                    </scope>
                </scope>
            </method>
            <method name="getSignerCertificates" type="Certificate[]" line="1158">
                <params>
                    <param name="cs" type="CodeSource"/>
                </params>
                <comment line="1167">
                    Do we have to do anything?                    
                </comment>
                <comment line="1180">
                    Done                    
                </comment>
                <declaration name="certs" type="Certificate[]" line="1159"/>
                <scope line="1162"/>
                <declaration name="i" type="int" line="1168"/>
                <declaration name="count" type="int" line="1169"/>
                <scope line="1170">
                    <scope line="1174"/>
                </scope>
                <declaration name="userCertList" type="ArrayList&lt;Certificate&gt;" line="1183"/>
                <scope line="1185">
                    <scope line="1189"/>
                </scope>
                <declaration name="userCerts" type="Certificate[]" line="1194"/>
            </method>
            <method name="canonicalizeCodebase" type="CodeSource" line="1200">
                <params>
                    <param name="cs" type="CodeSource"/>
                    <param name="extractSignerCerts" type="boolean"/>
                </params>
                <comment line="1210">
                    remove trailing &apos;*&apos; because it causes canonicalization                    
                </comment>
                <comment line="1211">
                    to fail on win32                    
                </comment>
                <comment line="1222">
                    reappend &apos;*&apos; to canonicalized filename (note that                    
                </comment>
                <comment line="1223">
                    canonicalization may have removed trailing file                    
                </comment>
                <comment line="1224">
                    separator, so we have to check for that, too)                    
                </comment>
                <comment line="1260">
                    leave codesource as it is, unless we have to extract its                    
                </comment>
                <comment line="1261">
                    signer certificates                    
                </comment>
                <declaration name="canonCs" type="CodeSource" line="1201"/>
                <scope line="1203">
                    <scope line="1204">
                        <declaration name="path" type="String" line="1205"/>
                        <declaration name="csUrl" type="URL" line="1208"/>
                        <scope line="1209">
                            <declaration name="appendFileSep" type="boolean" line="1213"/>
                            <scope line="1216"/>
                            <declaration name="f" type="File" line="1219"/>
                            <declaration name="sb" type="StringBuffer" line="1221"/>
                        </scope>
                        <scope line="1230"/>
                        <scope line="1235">
                            <declaration name="scs" type="SubjectCodeSource" line="1236"/>
                            <scope line="1237"/>
                            <scope line="1243"/>
                        </scope>
                        <scope line="1250">
                            <scope line="1251"/>
                            <scope line="1254"/>
                        </scope>
                    </scope>
                    <scope line="1259">
                        <scope line="1262">
                            <scope line="1263"/>
                            <scope line="1266">
                                <declaration name="scs" type="SubjectCodeSource" line="1267"/>
                            </scope>
                        </scope>
                    </scope>
                </scope>
                <scope line="1275">
                    <scope line="1276">
                        <scope line="1277"/>
                        <scope line="1280">
                            <declaration name="scs" type="SubjectCodeSource" line="1281"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <class name="PolicyEntry" line="1292">
                <javadoc line="1292">
                    Each entry in the policy configuration file is represented by a
                      PolicyEntry object.  &lt;p&gt;
                      A PolicyEntry is a (CodeSource,Permission) pair.  The
                      CodeSource contains the (URL, PublicKey) that together identify
                      where the Java bytecodes come from and who (if anyone) signed
                      them.  The URL could refer to localhost.  The URL could also be
                      null, meaning that this policy entry is given to all comers, as
                      long as they match the signer field.  The signer could be null,
                      meaning the code is not signed. &lt;p&gt;
                      The Permission contains the (Type, Name, Action) triplet. &lt;p&gt;
                      For now, the Policy object retrieves the public key from the
                      X.509 certificate on disk that corresponds to the signedBy
                      alias specified in the Policy config file.  For reasons of
                      efficiency, the Policy object keeps a hashtable of certs already
                      read in.  This could be replaced by a secure internal key
                      store.
                      &lt;p&gt;
                      For example, the entry
                      &lt;pre&gt;
                      permission java.io.File &quot;/tmp&quot;, &quot;read,write&quot;,
                      signedBy &quot;Duke&quot;;
                      &lt;/pre&gt;
                      is represented internally
                      &lt;pre&gt;
                      FilePermission f = new FilePermission(&quot;/tmp&quot;, &quot;read,write&quot;);
                      PublicKey p = publickeys.get(&quot;Duke&quot;);
                      URL u = InetAddress.getLocalHost();
                      CodeBase c = new CodeBase( p, u );
                      pe = new PolicyEntry(f, c);
                      &lt;/pre&gt;                    
                    <author>
                        Marianne Mueller                        
                    </author>
                    <author>
                        Roland Schemers                        
                    </author>
                    <see>
                        java.security.CodeSource                        
                    </see>
                    <see>
                        java.security.Policy                        
                    </see>
                    <see>
                        java.security.Permissions                        
                    </see>
                    <see>
                        java.security.ProtectionDomain                        
                    </see>
                </javadoc>
                <declaration name="codesource" type="CodeSource" line="1339"/>
                <declaration name="permissions" type="Vector&lt;Permission&gt;" line="1340"/>
                <javadoc line="1342">
                    Given a Permission and a CodeSource, create a policy entry.
                      XXX Decide if/how to add validity fields and &quot;purpose&quot; fields to
                      XXX policy entries                    
                    <param>
                        cs the CodeSource, which encapsulates the URL and the public
                          key
                          attributes from the policy config file.   Validity checks are
                          performed on the public key before PolicyEntry is called.                        
                    </param>
                </javadoc>
                <method name="PolicyEntry" type="constructor" line="1355">
                    <params>
                        <param name="cs" type="CodeSource"/>
                    </params>
                </method>
                <javadoc line="1360">
                    add a Permission object to this entry.                    
                </javadoc>
                <method name="add" type="void" line="1363">
                    <params>
                        <param name="p" type="Permission"/>
                    </params>
                </method>
                <javadoc line="1367">
                    Return the CodeSource for this policy entry                    
                </javadoc>
                <method name="getCodeSource" type="CodeSource" line="1370"/>
                <method name="toString" type="String" line="1374">
                    <declaration name="sb" type="StringBuffer" line="1375"/>
                    <scope line="1379">
                        <declaration name="p" type="Permission" line="1380"/>
                    </scope>
                </method>
            </class>
        </class>
        <class name="PolicyPermissions" line="1394">
            <extends class="PermissionCollection"/>
            <comment line="254">
                needs to be package private                
            </comment>
            <comment line="271">
                for use with the reflection API                
            </comment>
            <comment line="510">
                Fast path reading from file urls in order to avoid calling
                 FileURLConnection.connect() which can be quite slow the first time
                 it is called. We really should clean up FileURLConnection so that
                 this is not a problem but in the meantime this fix helps reduce
                 start up time noticeably for the new launcher. -- DAC                
            </comment>
            <comment line="1146">
                Returns the signer certificates from the list of certificates associated
                 with the given code source.
                
                 The signer certificates are those certificates that were used to verify
                 signed code originating from the codesource location.
                
                 This method assumes that in the given code source, each signer
                 certificate is followed by its supporting certificate chain
                 (which may be empty), and that the signer certificate and its
                 supporting certificate chain are ordered bottom-to-top (i.e., with the
                 signer certificate first and the (root) certificate authority last).                
            </comment>
            <comment line="1402">
                have we pulled in the policy permissions yet?                
            </comment>
            <declaration name="serialVersionUID" type="long" line="1396"/>
            <declaration name="codesource" type="CodeSource" line="1398"/>
            <declaration name="perms" type="Permissions" line="1399"/>
            <declaration name="policy" type="PolicyFile" line="1400"/>
            <declaration name="notInit" type="boolean" line="1401"/>
            <declaration name="additionalPerms" type="Vector&lt;Permission&gt;" line="1402"/>
            <method name="PolicyPermissions" type="constructor" line="1406">
                <params>
                    <param name="policy" type="PolicyFile"/>
                    <param name="codesource" type="CodeSource"/>
                </params>
            </method>
            <method name="add" type="void" line="1414">
                <params>
                    <param name="permission" type="Permission"/>
                </params>
                <scope line="1420"/>
                <scope line="1424"/>
            </method>
            <method name="init" type="void" line="1429">
                <scope line="1430">
                    <scope line="1434">
                        <declaration name="e" type="Enumeration&lt;Permission&gt;" line="1435"/>
                        <scope line="1436"/>
                    </scope>
                </scope>
            </method>
            <method name="implies" type="boolean" line="1446">
                <params>
                    <param name="permission" type="Permission"/>
                </params>
            </method>
            <method name="elements" type="Enumeration<Permission>" line="1452"/>
            <method name="toString" type="String" line="1458"/>
        </class>
    </source>