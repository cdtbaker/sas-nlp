<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.security.sasl.digest">
        <import package="java.util.Map"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.List"/>
        <import package="java.util.Set"/>
        <import package="java.util.logging.Logger"/>
        <import package="java.util.logging.Level"/>
        <import package="java.math.BigInteger"/>
        <import package="java.util.Random"/>
        <import package="java.security.Provider"/>
        <import package="java.io.ByteArrayInputStream"/>
        <import package="java.io.ByteArrayOutputStream"/>
        <import package="java.io.UnsupportedEncodingException"/>
        <import package="java.io.IOException"/>
        <import package="java.security.MessageDigest"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.PrivilegedAction"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <import package="java.security.InvalidKeyException"/>
        <import package="java.security.spec.KeySpec"/>
        <import package="java.security.spec.InvalidKeySpecException"/>
        <import package="java.security.InvalidAlgorithmParameterException"/>
        <import package="javax.crypto.Cipher"/>
        <import package="javax.crypto.SecretKey"/>
        <import package="javax.crypto.Mac"/>
        <import package="javax.crypto.SecretKeyFactory"/>
        <import package="javax.crypto.BadPaddingException"/>
        <import package="javax.crypto.NoSuchPaddingException"/>
        <import package="javax.crypto.IllegalBlockSizeException"/>
        <import package="javax.crypto.spec.IvParameterSpec"/>
        <import package="javax.crypto.spec.SecretKeySpec"/>
        <import package="javax.crypto.spec.DESKeySpec"/>
        <import package="javax.crypto.spec.DESedeKeySpec"/>
        <import package="javax.security.sasl"/>
        <import package="com.sun.security.sasl.util.AbstractSaslImpl"/>
        <import package="javax.security.auth.callback.CallbackHandler"/>
        <class name="DigestMD5Base" line="37">
            <extends class="AbstractSaslImpl"/>
            <javadoc line="37">
                Utility class for DIGEST-MD5 mechanism. Provides utility methods
                  and contains two inner classes which implement the SecurityCtx
                  interface. The inner classes provide the funtionality to allow
                  for quality-of-protection (QOP) with integrity checking and
                  privacy.                
                <author>
                    Jonathan Bruce                    
                </author>
                <author>
                    Rosanna Lee                    
                </author>
            </javadoc>
            <declaration name="DI_CLASS_NAME" type="String" line="47"/>
            <declaration name="DP_CLASS_NAME" type="String" line="48"/>
            <declaration name="MAX_CHALLENGE_LENGTH" type="int" line="49"/>
            <declaration name="MAX_RESPONSE_LENGTH" type="int" line="50"/>
            <declaration name="DEFAULT_MAXBUF" type="int" line="51"/>
            <declaration name="DES3" type="int" line="52"/>
            <declaration name="RC4" type="int" line="53"/>
            <declaration name="DES" type="int" line="54"/>
            <declaration name="RC4_56" type="int" line="55"/>
            <declaration name="RC4_40" type="int" line="56"/>
            <declaration name="CIPHER_TOKENS" type="String[]" line="57"/>
            <declaration name="JCE_CIPHER_NAME" type="String[]" line="58"/>
            <declaration name="DES_3_STRENGTH" type="byte" line="59"/>
            <declaration name="RC4_STRENGTH" type="byte" line="60"/>
            <declaration name="DES_STRENGTH" type="byte" line="61"/>
            <declaration name="RC4_56_STRENGTH" type="byte" line="62"/>
            <declaration name="RC4_40_STRENGTH" type="byte" line="63"/>
            <declaration name="UNSET" type="byte" line="64"/>
            <declaration name="CIPHER_MASKS" type="byte[]" line="65"/>
            <declaration name="SECURITY_LAYER_MARKER" type="String" line="66"/>
            <declaration name="EMPTY_BYTE_ARRAY" type="byte[]" line="67"/>
            <declaration name="step" type="int" line="68"/>
            <declaration name="cbh" type="CallbackHandler" line="69"/>
            <declaration name="secCtx" type="SecurityCtx" line="70"/>
            <declaration name="H_A1" type="byte[]" line="71"/>
            <declaration name="nonce" type="byte[]" line="72"/>
            <declaration name="negotiatedStrength" type="String" line="73"/>
            <declaration name="negotiatedCipher" type="String" line="74"/>
            <declaration name="negotiatedQop" type="String" line="75"/>
            <declaration name="negotiatedRealm" type="String" line="76"/>
            <declaration name="useUTF8" type="boolean" line="77"/>
            <declaration name="encoding" type="String" line="78"/>
            <declaration name="digestUri" type="String" line="79"/>
            <declaration name="authzid" type="String" line="80"/>
            <javadoc line="81">
                Constucts an instance of DigestMD5Base. Calls super constructor
                  to parse properties for mechanism.                
                <param>
                    props A map of property/value pairs                    
                </param>
                <param>
                    className name of class to use for logging                    
                </param>
                <param>
                    firstStep number of first step in authentication state machine                    
                </param>
                <param>
                    digestUri digestUri used in authentication                    
                </param>
                <param>
                    cbh callback handler used to get info required for auth                    
                </param>
                <throws>
                    SaslException If invalid value found in props.                    
                </throws>
            </javadoc>
            <method name="DigestMD5Base" type="constructor" line="91">
                <params>
                    <param name="props" type="Map"/>
                    <param name="className" type="String"/>
                    <param name="firstStep" type="int"/>
                    <param name="digestUri" type="String"/>
                    <param name="cbh" type="CallbackHandler"/>
                </params>
            </method>
            <javadoc line="97">
                Retrieves the SASL mechanism IANA name.                
                <return>
                    The String "DIGEST-MD5"                    
                </return>
            </javadoc>
            <method name="getMechanismName" type="String" line="101"/>
            <javadoc line="104">
                Unwrap the incoming message using the wrap method of the secCtx object
                  instance.                
                <param>
                    incoming The byte array containing the incoming bytes.                    
                </param>
                <param>
                    start The offset from which to read the byte array.                    
                </param>
                <param>
                    len The number of bytes to read from the offset.                    
                </param>
                <return>
                    The unwrapped message according to either the integrity or
                      privacy quality-of-protection specifications.                    
                </return>
                <throws>
                    SaslException if an error occurs when unwrapping the incoming
                      message                    
                </throws>
            </javadoc>
            <method name="unwrap" type="byte[]" line="115">
                <params>
                    <param name="incoming" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="116"/>
                <scope line="119"/>
            </method>
            <javadoc line="124">
                Wrap outgoing bytes using the wrap method of the secCtx object
                  instance.                
                <param>
                    outgoing The byte array containing the outgoing bytes.                    
                </param>
                <param>
                    start The offset from which to read the byte array.                    
                </param>
                <param>
                    len The number of bytes to read from the offset.                    
                </param>
                <return>
                    The wrapped message according to either the integrity or
                      privacy quality-of-protection specifications.                    
                </return>
                <throws>
                    SaslException if an error occurs when wrapping the outgoing
                      message                    
                </throws>
            </javadoc>
            <method name="wrap" type="byte[]" line="135">
                <params>
                    <param name="outgoing" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="136"/>
                <scope line="139"/>
            </method>
            <method name="dispose" type="void" line="144">
                <scope line="145"/>
            </method>
            <method name="getNegotiatedProperty" type="Object" line="149">
                <params>
                    <param name="propName" type="String"/>
                </params>
                <scope line="150">
                    <scope line="151"/>
                    <scope line="154"/>
                </scope>
                <scope line="158"/>
            </method>
            <declaration name="pem_array" type="char" line="162"/>
            <javadoc line="162">
                This array maps the characters to their 6 bit values                
            </javadoc>
            <declaration name="RAW_NONCE_SIZE" type="int" line="166"/>
            <declaration name="ENCODED_NONCE_SIZE" type="int" line="167"/>
            <method name="generateNonce" type="byte[]" line="168">
                <declaration name="random" type="Random" line="169"/>
                <declaration name="randomData" type="byte[]" line="170"/>
                <declaration name="nonce" type="byte[]" line="172"/>
                <declaration name="a" type="byte" line="173"/>
                <declaration name="j" type="int" line="174"/>
                <scope line="175"/>
            </method>
            <javadoc line="186">
                Checks if a byte[] contains characters that must be quoted
                  and write the resulting, possibly escaped, characters to out.                
            </javadoc>
            <method name="writeQuotedStringValue" type="void" line="190">
                <params>
                    <param name="out" type="ByteArrayOutputStream"/>
                    <param name="buf" type="byte[]"/>
                </params>
                <declaration name="len" type="int" line="191"/>
                <declaration name="ch" type="byte" line="192"/>
                <scope line="193">
                    <scope line="195"/>
                </scope>
            </method>
            <method name="needEscape" type="boolean" line="201">
                <params>
                    <param name="str" type="String"/>
                </params>
                <declaration name="len" type="int" line="202"/>
                <scope line="203">
                    <scope line="204"/>
                </scope>
            </method>
            <method name="needEscape" type="boolean" line="210">
                <params>
                    <param name="ch" type="char"/>
                </params>
            </method>
            <method name="quotedStringValue" type="String" line="213">
                <params>
                    <param name="str" type="String"/>
                </params>
                <scope line="214">
                    <declaration name="len" type="int" line="215"/>
                    <declaration name="buf" type="char[]" line="216"/>
                    <declaration name="j" type="int" line="217"/>
                    <declaration name="ch" type="char" line="218"/>
                    <scope line="219">
                        <scope line="221"/>
                    </scope>
                </scope>
                <scope line="228"/>
            </method>
            <javadoc line="232">
                Convert a byte array to hexadecimal string.                
                <param>
                    a non-null byte array                    
                </param>
                <return>
                    a non-null String contain the HEX value                    
                </return>
            </javadoc>
            <method name="binaryToHex" type="byte[]" line="237">
                <params>
                    <param name="digest" type="byte[]"/>
                </params>
                <declaration name="digestString" type="StringBuffer" line="238"/>
                <scope line="239">
                    <scope line="240"/>
                    <scope line="243"/>
                </scope>
            </method>
            <javadoc line="249">
                Used to convert username-value, passwd or realm to 8859_1 encoding
                  if all chars in string are within the 8859_1 (Latin 1) encoding range.                
                <param>
                    a non-null String                    
                </param>
                <return>
                    a non-nuill byte array containing the correct character encoding
                      for username, paswd or realm.                    
                </return>
            </javadoc>
            <method name="stringToByte_8859_1" type="byte[]" line="256">
                <params>
                    <param name="str" type="String"/>
                </params>
                <declaration name="buffer" type="char[]" line="257"/>
                <scope line="258">
                    <scope line="259">
                        <scope line="260">
                            <scope line="261"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="268"/>
            </method>
            <method name="getPlatformCiphers" type="byte[]" line="272">
                <declaration name="ciphers" type="byte[]" line="273"/>
                <scope line="274">
                    <scope line="275"/>
                    <scope line="280"/>
                    <scope line="282"/>
                </scope>
                <scope line="285"/>
            </method>
            <javadoc line="291">
                Assembles response-value for digest-response.                
                <param>
                    authMethod "AUTHENTICATE" for client-generated response;
                      "" for server-generated response                    
                </param>
                <return>
                    A non-null byte array containing the repsonse-value.                    
                </return>
                <throws>
                    NoSuchAlgorithmException if the platform does not have MD5
                      digest support.                    
                </throws>
                <throws>
                    UnsupportedEncodingException if a an error occurs
                      encoding a string into either Latin-1 or UTF-8.                    
                </throws>
                <throws>
                    IOException if an error occurs writing to the output
                      byte array buffer.                    
                </throws>
            </javadoc>
            <method name="generateResponseValue" type="byte[]" line="303">
                <params>
                    <param name="authMethod" type="String"/>
                    <param name="digestUriValue" type="String"/>
                    <param name="qopValue" type="String"/>
                    <param name="usernameValue" type="String"/>
                    <param name="realmValue" type="String"/>
                    <param name="passwdValue" type="char[]"/>
                    <param name="nonceValue" type="byte[]"/>
                    <param name="cNonceValue" type="byte[]"/>
                    <param name="nonceCount" type="int"/>
                    <param name="authzidValue" type="byte[]"/>
                </params>
                <declaration name="md5" type="MessageDigest" line="304"/>
                <declaration name="hexA1" type="byte[]" line="305"/>
                <declaration name="A2" type="ByteArrayOutputStream" line="306"/>
                <scope line="309"/>
                <scope line="313"/>
                <declaration name="digest" type="byte[]" line="317"/>
                <scope line="319"/>
                <scope line="330"/>
                <scope line="339"/>
                <scope line="347"/>
                <scope line="362"/>
                <declaration name="answer" type="byte[]" line="367"/>
                <scope line="368"/>
            </method>
            <javadoc line="373">
                Takes &apos;nonceCount&apos; value and returns HEX value of the value.                
                <return>
                    A non-null String representing the current NONCE-COUNT                    
                </return>
            </javadoc>
            <method name="nonceCountToHex" type="String" line="377">
                <params>
                    <param name="count" type="int"/>
                </params>
                <declaration name="str" type="String" line="378"/>
                <declaration name="pad" type="StringBuffer" line="379"/>
                <scope line="380">
                    <scope line="381"/>
                </scope>
            </method>
            <javadoc line="387">
                Parses digest-challenge string, extracting each token
                  and value(s)                
                <param>
                    buf A non-null digest-challenge string.                    
                </param>
                <param>
                    multipleAllowed true if multiple qop or realm or QOP directives
                      are allowed.                    
                </param>
                <throws>
                    SaslException if the buf cannot be parsed according to RFC 2831                    
                </throws>
            </javadoc>
            <method name="parseDirectives" type="byte[][]" line="395">
                <params>
                    <param name="buf" type="byte[]"/>
                    <param name="keyTable" type="String[]"/>
                    <param name="realmChoices" type="List<byte[]>"/>
                    <param name="realmIndex" type="int"/>
                </params>
                <declaration name="valueTable" type="byte[][]" line="396"/>
                <declaration name="key" type="ByteArrayOutputStream" line="397"/>
                <declaration name="value" type="ByteArrayOutputStream" line="398"/>
                <declaration name="gettingKey" type="boolean" line="399"/>
                <declaration name="gettingQuotedValue" type="boolean" line="400"/>
                <declaration name="expectSeparator" type="boolean" line="401"/>
                <declaration name="bch" type="byte" line="402"/>
                <declaration name="i" type="int" line="403"/>
                <scope line="404">
                    <scope line="406">
                        <scope line="407">
                            <scope line="408"/>
                        </scope>
                        <scope line="413">
                            <scope line="414"/>
                            <scope line="419">
                                <scope line="420"/>
                            </scope>
                            <scope line="425"/>
                        </scope>
                        <scope line="429">
                            <scope line="431">
                                <scope line="432"/>
                            </scope>
                            <scope line="436"/>
                        </scope>
                        <scope line="440"/>
                    </scope>
                    <scope line="445">
                        <scope line="446">
                            <scope line="448"/>
                            <scope line="452"/>
                        </scope>
                        <scope line="456"/>
                        <scope line="461"/>
                    </scope>
                    <scope line="466"/>
                    <scope line="474"/>
                    <scope line="477"/>
                </scope>
                <scope line="482"/>
                <scope line="485"/>
            </method>
            <method name="isLws" type="boolean" line="490">
                <params>
                    <param name="b" type="byte"/>
                </params>
            </method>
            <method name="skipLws" type="int" line="500">
                <params>
                    <param name="buf" type="byte[]"/>
                    <param name="start" type="int"/>
                </params>
                <declaration name="i" type="int" line="501"/>
                <scope line="502">
                    <scope line="503"/>
                </scope>
            </method>
            <javadoc line="509">
                Processes directive/value pairs from the digest-challenge and
                  fill out the challengeVal array.                
                <param>
                    key A non-null String challenge token name.                    
                </param>
                <param>
                    value A non-null String token value.                    
                </param>
                <throws>
                    SaslException if a either the key or the value is null                    
                </throws>
            </javadoc>
            <method name="extractDirective" type="void" line="516">
                <params>
                    <param name="key" type="String"/>
                    <param name="value" type="byte[]"/>
                    <param name="keyTable" type="String[]"/>
                    <param name="valueTable" type="byte[][]"/>
                    <param name="realmChoices" type="List<byte[]>"/>
                    <param name="realmIndex" type="int"/>
                </params>
                <scope line="517">
                    <scope line="518">
                        <scope line="519">
                            <scope line="521"/>
                        </scope>
                        <scope line="525">
                            <scope line="526"/>
                        </scope>
                        <scope line="531"/>
                    </scope>
                </scope>
            </method>
            <class name="DigestIntegrity" line="538">
                <implements interface="SecurityCtx"/>
                <javadoc line="538">
                    Implementation of the SecurityCtx interface allowing for messages
                      between the client and server to be integrity checked. After a
                      successful DIGEST-MD5 authentication, integtrity checking is invoked
                      if the SASL QOP (quality-of-protection) is set to &apos;auth-int&apos;.
                      &lt;p&gt;
                      Further details on the integrity-protection mechanism can be found
                      at section 2.3 - Integrity protection in the
                      &lt;a href=&quot;http://www.ietf.org/rfc/rfc2831.txt&quot;&gt;RFC2831&lt;/a&gt; definition.                    
                    <author>
                        Jonathan Bruce                        
                    </author>
                </javadoc>
                <declaration name="CLIENT_INT_MAGIC" type="String" line="550"/>
                <declaration name="SVR_INT_MAGIC" type="String" line="551"/>
                <declaration name="myKi" type="byte[]" line="552"/>
                <declaration name="peerKi" type="byte[]" line="553"/>
                <declaration name="mySeqNum" type="int" line="554"/>
                <declaration name="peerSeqNum" type="int" line="555"/>
                <declaration name="messageType" type="byte[]" line="556"/>
                <declaration name="sequenceNum" type="byte[]" line="557"/>
                <javadoc line="558">
                    Initializes DigestIntegrity implementation of SecurityCtx to
                      enable DIGEST-MD5 integrity checking.                    
                    <throws>
                        SaslException if an error is encountered generating the
                          key-pairs for integrity checking.                        
                    </throws>
                </javadoc>
                <method name="DigestIntegrity" type="constructor" line="564">
                    <params>
                        <param name="clientMode" type="boolean"/>
                    </params>
                    <scope line="565"/>
                    <scope line="568"/>
                    <scope line="571"/>
                    <scope line="574"/>
                </method>
                <javadoc line="579">
                    Generate client-server, server-client key pairs for DIGEST-MD5
                      integrity checking.                    
                    <throws>
                        UnsupportedEncodingException if the UTF-8 encoding is not
                          supported on the platform.                        
                    </throws>
                    <throws>
                        IOException if an error occurs when writing to or from the
                          byte array output buffers.                        
                    </throws>
                    <throws>
                        NoSuchAlgorithmException if the MD5 message digest algorithm
                          cannot loaded.                        
                    </throws>
                </javadoc>
                <method name="generateIntegrityKeyPair" type="void" line="589">
                    <params>
                        <param name="clientMode" type="boolean"/>
                    </params>
                    <declaration name="cimagic" type="byte[]" line="590"/>
                    <declaration name="simagic" type="byte[]" line="591"/>
                    <declaration name="md5" type="MessageDigest" line="592"/>
                    <declaration name="keyBuffer" type="byte[]" line="593"/>
                    <declaration name="Kic" type="byte[]" line="597"/>
                    <declaration name="Kis" type="byte[]" line="600"/>
                    <scope line="601"/>
                    <scope line="605"/>
                    <scope line="609"/>
                </method>
                <javadoc line="614">
                    Append MAC onto outgoing message.                    
                    <param>
                        outgoing A non-null byte array containing the outgoing message.                        
                    </param>
                    <param>
                        start The offset from which to read the byte array.                        
                    </param>
                    <param>
                        len The non-zero number of bytes for be read from the offset.                        
                    </param>
                    <return>
                        The message including the integrity MAC                        
                    </return>
                    <throws>
                        SaslException if an error is encountered converting a string
                          into a UTF-8 byte encoding, or if the MD5 message digest algorithm
                          cannot be found or if there is an error writing to the byte array
                          output buffers.                        
                    </throws>
                </javadoc>
                <method name="wrap" type="byte[]" line="625">
                    <params>
                        <param name="outgoing" type="byte[]"/>
                        <param name="start" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                    <scope line="626"/>
                    <declaration name="wrapped" type="byte[]" line="629"/>
                    <declaration name="mac" type="byte[]" line="632"/>
                    <scope line="633"/>
                    <scope line="641"/>
                </method>
                <javadoc line="646">
                    Return verified message without MAC - only if the received MAC
                      and re-generated MAC are the same.                    
                    <param>
                        incoming A non-null byte array containing the incoming
                          message.                        
                    </param>
                    <param>
                        start The offset from which to read the byte array.                        
                    </param>
                    <param>
                        len The non-zero number of bytes to read from the offset
                          position.                        
                    </param>
                    <return>
                        The verified message or null if integrity checking fails.                        
                    </return>
                    <throws>
                        SaslException if an error is encountered converting a string
                          into a UTF-8 byte encoding, or if the MD5 message digest algorithm
                          cannot be found or if there is an error writing to the byte array
                          output buffers                        
                    </throws>
                </javadoc>
                <method name="unwrap" type="byte[]" line="660">
                    <params>
                        <param name="incoming" type="byte[]"/>
                        <param name="start" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                    <scope line="661"/>
                    <declaration name="mac" type="byte[]" line="664"/>
                    <declaration name="msg" type="byte[]" line="665"/>
                    <declaration name="msgType" type="byte[]" line="666"/>
                    <declaration name="seqNum" type="byte[]" line="667"/>
                    <declaration name="expectedMac" type="byte[]" line="672"/>
                    <scope line="673"/>
                    <scope line="680"/>
                    <scope line="684"/>
                    <scope line="687"/>
                </method>
                <javadoc line="693">
                    Generates MAC to be appended onto out-going messages.                    
                    <param>
                        Ki A non-null byte array containing the key for the digest                        
                    </param>
                    <param>
                        SeqNum A non-null byte array contain the sequence number                        
                    </param>
                    <param>
                        msg  The message to be digested                        
                    </param>
                    <param>
                        start The offset from which to read the msg byte array                        
                    </param>
                    <param>
                        len The non-zero number of bytes to be read from the offset                        
                    </param>
                    <return>
                        The MAC of a message.                        
                    </return>
                    <throws>
                        SaslException if an error occurs when generating MAC.                        
                    </throws>
                </javadoc>
                <method name="getHMAC" type="byte[]" line="703">
                    <params>
                        <param name="Ki" type="byte[]"/>
                        <param name="seqnum" type="byte[]"/>
                        <param name="msg" type="byte[]"/>
                        <param name="start" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                    <declaration name="seqAndMsg" type="byte[]" line="704"/>
                    <scope line="707">
                        <declaration name="keyKi" type="SecretKey" line="708"/>
                        <declaration name="m" type="Mac" line="709"/>
                        <declaration name="hMAC_MD5" type="byte[]" line="712"/>
                        <declaration name="macBuffer" type="byte" line="713"/>
                    </scope>
                    <scope line="717"/>
                    <scope line="720"/>
                </method>
                <javadoc line="724">
                    Increment own sequence number and set answer in NBO sequenceNum field.                    
                </javadoc>
                <method name="incrementSeqNum" type="void" line="727"/>
            </class>
            <class name="DigestPrivacy" line="731">
                <extends class="DigestIntegrity"/>
                <implements interface="SecurityCtx"/>
                <javadoc line="731">
                    Implementation of the SecurityCtx interface allowing for messages
                      between the client and server to be integrity checked and encrypted.
                      After a successful DIGEST-MD5 authentication, privacy is invoked if the
                      SASL QOP (quality-of-protection) is set to &apos;auth-conf&apos;.
                      &lt;p&gt;
                      Further details on the integrity-protection mechanism can be found
                      at section 2.4 - Confidentiality protection in
                      &lt;a href=&quot;http://www.ietf.org/rfc/rfc2831.txt&quot;&gt;RFC2831&lt;/a&gt; definition.                    
                    <author>
                        Jonathan Bruce                        
                    </author>
                </javadoc>
                <declaration name="CLIENT_CONF_MAGIC" type="String" line="743"/>
                <declaration name="SVR_CONF_MAGIC" type="String" line="744"/>
                <declaration name="encCipher" type="Cipher" line="745"/>
                <declaration name="decCipher" type="Cipher" line="746"/>
                <javadoc line="747">
                    Initializes the cipher object instances for encryption and decryption.                    
                    <throws>
                        SaslException if an error occurs with the Key
                          initialization, or a string cannot be encoded into a byte array
                          using the UTF-8 encoding, or an error occurs when writing to a
                          byte array output buffers or the mechanism cannot load the MD5
                          message digest algorithm or invalid initialization parameters are
                          passed to the cipher object instances.                        
                    </throws>
                </javadoc>
                <method name="DigestPrivacy" type="constructor" line="756">
                    <params>
                        <param name="clientMode" type="boolean"/>
                    </params>
                    <scope line="758"/>
                    <scope line="761"/>
                    <scope line="764"/>
                    <scope line="767"/>
                    <scope line="770"/>
                </method>
                <javadoc line="774">
                    Generates client-server and server-client keys to encrypt and
                      decrypt messages. Also generates IVs for DES ciphers.                    
                    <throws>
                        IOException if an error occurs when writing to or from the
                          byte array output buffers.                        
                    </throws>
                    <throws>
                        NoSuchAlgorithmException if the MD5 message digest algorithm
                          cannot loaded.                        
                    </throws>
                    <throws>
                        UnsupportedEncodingException if an UTF-8 encoding is not
                          supported on the platform.                        
                    </throws>
                    <throw>
                        SaslException if an error occurs initializing the keys and
                          IVs for the chosen cipher.                        
                    </throw>
                </javadoc>
                <method name="generatePrivacyKeyPair" type="void" line="786">
                    <params>
                        <param name="clientMode" type="boolean"/>
                    </params>
                    <declaration name="ccmagic" type="byte[]" line="787"/>
                    <declaration name="scmagic" type="byte[]" line="788"/>
                    <declaration name="md5" type="MessageDigest" line="789"/>
                    <declaration name="n" type="int" line="790"/>
                    <scope line="791"/>
                    <scope line="794"/>
                    <scope line="797"/>
                    <declaration name="keyBuffer" type="byte[]" line="800"/>
                    <declaration name="Kcc" type="byte[]" line="804"/>
                    <declaration name="Kcs" type="byte[]" line="807"/>
                    <scope line="808"/>
                    <declaration name="myKc" type="byte[]" line="812"/>
                    <declaration name="peerKc" type="byte[]" line="813"/>
                    <scope line="814"/>
                    <scope line="818"/>
                    <scope line="822">
                        <declaration name="encKey" type="SecretKey" line="823"/>
                        <declaration name="decKey" type="SecretKey" line="824"/>
                        <scope line="825"/>
                        <scope line="833">
                            <declaration name="cipherFullname" type="String" line="834"/>
                            <scope line="835"/>
                            <scope line="839"/>
                            <declaration name="encIv" type="IvParameterSpec" line="847"/>
                            <declaration name="decIv" type="IvParameterSpec" line="848"/>
                            <scope line="851"/>
                        </scope>
                    </scope>
                    <scope line="859"/>
                    <scope line="862"/>
                    <scope line="865"/>
                    <scope line="868"/>
                </method>
                <javadoc line="872">
                    Encrypt out-going message.                    
                    <param>
                        outgoing A non-null byte array containing the outgoing message.                        
                    </param>
                    <param>
                        start The offset from which to read the byte array.                        
                    </param>
                    <param>
                        len The non-zero number of bytes to be read from the offset.                        
                    </param>
                    <return>
                        The encrypted message.                        
                    </return>
                    <throws>
                        SaslException if an error occurs when writing to or from the
                          byte array output buffers or if the MD5 message digest algorithm
                          cannot loaded or if an UTF-8 encoding is not supported on the
                          platform.                        
                    </throws>
                </javadoc>
                <method name="wrap" type="byte[]" line="883">
                    <params>
                        <param name="outgoing" type="byte[]"/>
                        <param name="start" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                    <scope line="884"/>
                    <declaration name="mac" type="byte[]" line="888"/>
                    <scope line="889"/>
                    <declaration name="bs" type="int" line="894"/>
                    <declaration name="padding" type="byte[]" line="895"/>
                    <scope line="896">
                        <declaration name="pad" type="int" line="897"/>
                        <scope line="899"/>
                    </scope>
                    <scope line="903"/>
                    <declaration name="toBeEncrypted" type="byte[]" line="906"/>
                    <scope line="910"/>
                    <declaration name="cipherBlock" type="byte[]" line="913"/>
                    <scope line="914">
                        <scope line="916"/>
                    </scope>
                    <scope line="920"/>
                    <declaration name="wrapped" type="byte[]" line="923"/>
                    <scope line="927"/>
                </method>
                <method name="unwrap" type="byte[]" line="932">
                    <params>
                        <param name="incoming" type="byte[]"/>
                        <param name="start" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                    <scope line="933"/>
                    <declaration name="encryptedMsg" type="byte[]" line="936"/>
                    <declaration name="msgType" type="byte[]" line="937"/>
                    <declaration name="seqNum" type="byte[]" line="938"/>
                    <scope line="942"/>
                    <declaration name="decryptedMsg" type="byte[]" line="946"/>
                    <scope line="947">
                        <scope line="949"/>
                    </scope>
                    <scope line="953"/>
                    <declaration name="msgWithPadding" type="byte[]" line="956"/>
                    <declaration name="mac" type="byte[]" line="957"/>
                    <scope line="960"/>
                    <declaration name="msgLength" type="int" line="966"/>
                    <declaration name="blockSize" type="int" line="967"/>
                    <scope line="968">
                        <scope line="970">
                            <scope line="971"/>
                        </scope>
                    </scope>
                    <declaration name="expectedMac" type="byte[]" line="977"/>
                    <scope line="978"/>
                    <scope line="981"/>
                    <scope line="985"/>
                    <scope line="988"/>
                    <scope line="992"/>
                    <scope line="995">
                        <declaration name="clearMsg" type="byte[]" line="996"/>
                    </scope>
                </method>
            </class>
            <declaration name="MASK" type="BigInteger" line="1002"/>
            <javadoc line="1003">
                Sets the parity bit (0th bit) in each byte so that each byte
                  contains an odd number of 1&apos;s.                
            </javadoc>
            <method name="setParityBit" type="void" line="1007">
                <params>
                    <param name="key" type="byte[]"/>
                </params>
                <scope line="1008">
                    <declaration name="b" type="int" line="1009"/>
                </scope>
            </method>
            <javadoc line="1014">
                Expands a 7-byte array into an 8-byte array that contains parity bits
                  The binary format of a cryptographic key is:
                  (B1,B2,...,B7,P1,B8,...B14,P2,B15,...,B49,P7,B50,...,B56,P8)
                  where (B1,B2,...,B56) are the independent bits of a DES key and
                  (PI,P2,...,P8) are reserved for parity bits computed on the preceding
                  seven independent bits and set so that the parity of the octet is odd,
                  i.e., there is an odd number of &quot;1&quot; bits in the octet.                
            </javadoc>
            <method name="addDesParity" type="byte[]" line="1023">
                <params>
                    <param name="input" type="byte[]"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <declaration name="raw" type="byte[]" line="1025"/>
                <declaration name="result" type="byte[]" line="1027"/>
                <declaration name="in" type="BigInteger" line="1028"/>
                <scope line="1029"/>
            </method>
            <javadoc line="1037">
                Create parity-adjusted keys suitable for DES / DESede encryption.                
                <param>
                    input A non-null byte array containing key material for
                      DES / DESede.                    
                </param>
                <param>
                    desStrength A string specifying eithe a DES or a DESede key.                    
                </param>
                <return>
                    SecretKey An instance of either DESKeySpec or DESedeKeySpec.                    
                </return>
                <throws>
                    NoSuchAlgorithmException if the either the DES or DESede
                      algorithms cannote be lodaed by JCE.                    
                </throws>
                <throws>
                    InvalidKeyException if an invalid array of bytes is used
                      as a key for DES or DESede.                    
                </throws>
                <throws>
                    InvalidKeySpecException in an invalid parameter is passed
                      to either te DESKeySpec of the DESedeKeySpec constructors.                    
                </throws>
            </javadoc>
            <method name="makeDesKeys" type="SecretKey" line="1050">
                <params>
                    <param name="input" type="byte[]"/>
                    <param name="desStrength" type="String"/>
                </params>
                <declaration name="subkey1" type="byte[]" line="1051"/>
                <declaration name="spec" type="KeySpec" line="1052"/>
                <declaration name="desFactory" type="SecretKeyFactory" line="1053"/>
                <scope line="1054">
                    <scope line="1056"/>
                </scope>
                <scope line="1063">
                    <declaration name="subkey2" type="byte[]" line="1064"/>
                    <declaration name="ede" type="byte[]" line="1065"/>
                    <scope line="1070"/>
                </scope>
                <scope line="1077"/>
            </method>
        </class>
    </source>