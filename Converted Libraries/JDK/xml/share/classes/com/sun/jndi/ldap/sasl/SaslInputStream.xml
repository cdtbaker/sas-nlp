<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.jndi.ldap.sasl">
        <import package="javax.security.sasl.Sasl"/>
        <import package="javax.security.sasl.SaslClient"/>
        <import package="javax.security.sasl.SaslException"/>
        <import package="java.io.IOException"/>
        <import package="java.io.EOFException"/>
        <import package="java.io.InputStream"/>
        <class name="SaslInputStream" line="35">
            <extends class="InputStream"/>
            <comment line="51">
                buffer for storing raw bytes                
            </comment>
            <comment line="52">
                buffer for storing length                
            </comment>
            <comment line="54">
                buffer for storing processed bytes
                 Initialized to empty buffer                
            </comment>
            <comment line="56">
                read position in buf                
            </comment>
            <comment line="57">
                underlying input stream                
            </comment>
            <javadoc line="35">
                This class is used by clients of Java SASL that need to create an input stream
                  that uses SaslClient&apos;s unwrap() method to decode the SASL buffers
                  sent by the SASL server.
                  Extend from InputStream instead of FilterInputStream because
                  we need to override less methods in InputStream. That is, the
                  behavior of the default implementations in InputStream matches
                  more closely with the behavior we want in SaslInputStream.                
                <author>
                    Rosanna Lee                    
                </author>
            </javadoc>
            <declaration name="debug" type="boolean" line="48"/>
            <declaration name="saslBuffer" type="byte[]" line="50"/>
            <declaration name="lenBuf" type="byte[]" line="51"/>
            <declaration name="buf" type="byte[]" line="53"/>
            <declaration name="bufPos" type="int" line="55"/>
            <declaration name="in" type="InputStream" line="56"/>
            <declaration name="sc" type="SaslClient" line="57"/>
            <declaration name="recvMaxBufSize" type="int" line="58"/>
            <method name="SaslInputStream" type="constructor" line="60">
                <params>
                    <param name="sc" type="SaslClient"/>
                    <param name="in" type="InputStream"/>
                </params>
                <declaration name="str" type="String" line="65"/>
                <scope line="66">
                    <scope line="67"/>
                    <scope line="69"/>
                </scope>
            </method>
            <method name="read" type="int" line="77">
                <declaration name="inBuf" type="byte[]" line="78"/>
                <declaration name="count" type="int" line="79"/>
                <scope line="80"/>
                <scope line="82"/>
            </method>
            <method name="read" type="int" line="87">
                <params>
                    <param name="inBuf" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="count" type="int"/>
                </params>
                <comment line="91">
                    read and unwrap next SASL buffer                    
                </comment>
                <comment line="92">
                    ignore zero length content                    
                </comment>
                <comment line="96">
                    EOF                    
                </comment>
                <comment line="102">
                    Requesting more that we have stored
                     Return all that we have; next invocation of read() will
                     trigger fill()                    
                </comment>
                <comment line="109">
                    Requesting less than we have stored
                     Return all that was requested                    
                </comment>
                <scope line="89">
                    <declaration name="actual" type="int" line="90"/>
                    <scope line="91"/>
                    <scope line="94"/>
                </scope>
                <declaration name="avail" type="int" line="99"/>
                <scope line="100"/>
                <scope line="107"/>
            </method>
            <javadoc line="116">
                Fills the buf with more data by reading a SASL buffer, unwrapping it,
                  and leaving the bytes in buf for read() to return.                
                <return>
                    The number of unwrapped bytes available                    
                </return>
            </javadoc>
            <method name="fill" type="int" line="121">
                <comment line="123">
                    Read in length of buffer                    
                </comment>
                <comment line="140">
                    Read SASL buffer                    
                </comment>
                <comment line="147">
                    Unwrap                    
                </comment>
                <declaration name="actual" type="int" line="123"/>
                <scope line="124"/>
                <declaration name="len" type="int" line="127"/>
                <scope line="129"/>
                <scope line="135"/>
                <scope line="141"/>
            </method>
            <javadoc line="154">
                Read requested number of bytes before returning.                
                <return>
                    The number of bytes actually read; -1 if none read                    
                </return>
            </javadoc>
            <method name="readFully" type="int" line="158">
                <params>
                    <param name="inBuf" type="byte[]"/>
                    <param name="total" type="int"/>
                </params>
                <declaration name="count" type="int" line="159"/>
                <scope line="161"/>
                <scope line="165">
                    <scope line="168"/>
                    <scope line="172"/>
                </scope>
            </method>
            <method name="available" type="int" line="181"/>
            <method name="close" type="void" line="185">
                <comment line="189">
                    Dispose of SaslClient&apos;s state                    
                </comment>
                <comment line="191">
                    Save exception for throwing after closing &apos;in&apos;                    
                </comment>
                <comment line="195">
                    Close underlying input stream                    
                </comment>
                <declaration name="save" type="SaslException" line="186"/>
                <scope line="187"/>
                <scope line="189"/>
                <scope line="196"/>
            </method>
            <javadoc line="201">
                Returns the integer represented by  4 bytes in network byte order.                
            </javadoc>
            <method name="networkByteOrderToInt" type="int" line="205">
                <params>
                    <param name="buf" type="byte[]"/>
                    <param name="start" type="int"/>
                    <param name="count" type="int"/>
                </params>
                <comment line="205">
                    Copied from com.sun.security.sasl.util.SaslImpl.                    
                </comment>
                <scope line="206"/>
                <declaration name="answer" type="int" line="210"/>
                <scope line="212"/>
            </method>
        </class>
    </source>