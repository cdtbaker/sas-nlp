<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.jndi.ldap.sasl">
        <import package="java.io"/>
        <import package="java.util.Vector"/>
        <import package="java.util.Hashtable"/>
        <import package="java.util.StringTokenizer"/>
        <import package="javax.naming.AuthenticationException"/>
        <import package="javax.naming.AuthenticationNotSupportedException"/>
        <import package="javax.naming.NamingException"/>
        <import package="javax.naming.ldap.Control"/>
        <import package="javax.security.auth.callback.CallbackHandler"/>
        <import package="javax.security.sasl"/>
        <import package="com.sun.jndi.ldap.Connection"/>
        <import package="com.sun.jndi.ldap.LdapClient"/>
        <import package="com.sun.jndi.ldap.LdapResult"/>
        <class name="LdapSasl" line="45">
            <comment line="54">
                SASL stuff                
            </comment>
            <comment line="62">
                LDAPv3                
            </comment>
            <javadoc line="45">
                Handles SASL support.                
                <author>
                    Vincent Ryan                    
                </author>
                <author>
                    Rosanna Lee                    
                </author>
            </javadoc>
            <declaration name="SASL_CALLBACK" type="String" line="54"/>
            <declaration name="SASL_AUTHZ_ID" type="String" line="55"/>
            <declaration name="SASL_REALM" type="String" line="57"/>
            <declaration name="LDAP_SUCCESS" type="int" line="60"/>
            <declaration name="LDAP_SASL_BIND_IN_PROGRESS" type="int" line="61"/>
            <method name="LdapSasl" type="constructor" line="63"/>
            <javadoc line="66">
                Performs SASL bind.
                  Creates a SaslClient by using a default CallbackHandler
                  that uses the Context.SECURITY_PRINCIPAL and Context.SECURITY_CREDENTIALS
                  properties to satisfy the callbacks, and by using the
                  SASL_AUTHZ_ID property as the authorization id. If the SASL_AUTHZ_ID
                  property has not been set, Context.SECURITY_PRINCIPAL is used.
                  If SASL_CALLBACK has been set, use that instead of the default
                  CallbackHandler.
                  &lt;p&gt;
                  If bind is successful and the selected SASL mechanism has a security
                  layer, set inStream and outStream to be filter streams that use
                  the security layer. These will be used for subsequent communication
                  with the server.
                  &lt;p&gt;                
                <param>
                    conn The non-null connection to use for sending an LDAP BIND                    
                </param>
                <param>
                    server Non-null string name of host to connect to                    
                </param>
                <param>
                    dn Non-null DN to bind as; also used as authentication ID                    
                </param>
                <param>
                    pw Possibly null password; can be byte[], char[] or String                    
                </param>
                <param>
                    authMech A non-null space-separated list of SASL authentication
                      mechanisms.                    
                </param>
                <param>
                    env The possibly null environment of the context, possibly containing
                      properties for used by SASL mechanisms                    
                </param>
                <param>
                    bindCtls The possibly null controls to accompany the bind                    
                </param>
                <return>
                    LdapResult containing status of the bind                    
                </return>
            </javadoc>
            <method name="saslBind" type="LdapResult" line="95">
                <params>
                    <param name="clnt" type="LdapClient"/>
                    <param name="conn" type="Connection"/>
                    <param name="server" type="String"/>
                    <param name="dn" type="String"/>
                    <param name="pw" type="Object"/>
                    <param name="authMech" type="String"/>
                    <param name="env" type="Hashtable"/>
                    <param name="bindCtls" type="Control[]"/>
                </params>
                <comment line="100">
                    Use supplied callback handler or create default                    
                </comment>
                <comment line="108">
                    Prepare parameters for creating SASL client                    
                </comment>
                <comment line="113">
                    Create SASL client to use using SASL package                    
                </comment>
                <comment line="152">
                    If negotiated integrity or privacy,                    
                </comment>
                <declaration name="saslClnt" type="SaslClient" line="97"/>
                <declaration name="cleanupHandler" type="boolean" line="98"/>
                <declaration name="cbh" type="CallbackHandler" line="101"/>
                <scope line="103"/>
                <declaration name="authzId" type="String" line="109"/>
                <declaration name="mechs" type="String[]" line="110"/>
                <scope line="112">
                    <scope line="117"/>
                    <declaration name="res" type="LdapResult" line="121"/>
                    <declaration name="mechName" type="String" line="122"/>
                    <declaration name="response" type="byte[]" line="123"/>
                    <scope line="130">
                        <scope line="134">
                            <scope line="135"/>
                        </scope>
                    </scope>
                    <scope line="144">
                        <scope line="145"/>
                        <declaration name="qop" type="String" line="150"/>
                        <scope line="154">
                            <declaration name="newIn" type="InputStream" line="156"/>
                            <declaration name="newOut" type="OutputStream" line="158"/>
                        </scope>
                        <scope line="162"/>
                    </scope>
                </scope>
                <scope line="167">
                    <declaration name="ne" type="NamingException" line="168"/>
                </scope>
                <scope line="172">
                    <scope line="173"/>
                </scope>
            </method>
            <javadoc line="179">
                Returns an array of SASL mechanisms given a string of space
                  separated SASL mechanism names.                
                <param>
                    The non-null string containing the mechanism names                    
                </param>
                <return>
                    A non-null array of String; each element of the array
                      contains a single mechanism name.                    
                </return>
            </javadoc>
            <method name="getSaslMechanismNames" type="String[]" line="186">
                <params>
                    <param name="str" type="String"/>
                </params>
                <declaration name="parser" type="StringTokenizer" line="187"/>
                <declaration name="mechs" type="Vector" line="188"/>
                <scope line="189"/>
                <declaration name="mechNames" type="String[]" line="192"/>
                <scope line="193"/>
            </method>
            <declaration name="NO_BYTES" type="byte[]" line="199"/>
        </class>
    </source>