<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.crypto.provider">
        <import package="java.nio.ByteBuffer"/>
        <import package="javax.crypto.MacSpi"/>
        <import package="javax.crypto.SecretKey"/>
        <import package="java.security"/>
        <import package="java.security.spec.AlgorithmParameterSpec"/>
        <import package="com.sun.crypto.provider.TlsPrfGenerator.genPad"/>
        <class name="SslMacCore" line="37">
            <comment line="52">
                Is this the first data to be processed?                
            </comment>
            <comment line="199">
                nested static class for the SslMacMD5 implementation                
            </comment>
            <comment line="232">
                nested static class for the SslMacMD5 implementation                
            </comment>
            <javadoc line="37">
                This file contains the code for the SslMacMD5 and SslMacSHA1 implementations.
                  The SSL 3.0 MAC is a variation of the HMAC algorithm.
                  Note that we don&apos;t implement Cloneable as that is not needed for SSL.                
                <author>
                    Andreas Sterbenz                    
                </author>
                <since>
                    1.6                    
                </since>
            </javadoc>
            <declaration name="md" type="MessageDigest" line="48"/>
            <declaration name="pad1" type="byte[]" line="49"/>
            <declaration name="first" type="boolean" line="51"/>
            <declaration name="secret" type="byte[]" line="52"/>
            <javadoc line="54">
                Standard constructor, creates a new SslMacCore instance instantiating
                  a MessageDigest of the specified name.                
            </javadoc>
            <method name="SslMacCore" type="constructor" line="59">
                <params>
                    <param name="digestAlgorithm" type="String"/>
                    <param name="pad1" type="byte[]"/>
                    <param name="pad2" type="byte[]"/>
                </params>
            </method>
            <javadoc line="66">
                Returns the length of the Mac in bytes.                
                <return>
                    the Mac length in bytes.                    
                </return>
            </javadoc>
            <method name="getDigestLength" type="int" line="71"/>
            <javadoc line="75">
                Initializes the Mac with the given secret key and algorithm parameters.                
                <param>
                    key the secret key.                    
                </param>
                <param>
                    params the algorithm parameters.                    
                </param>
                <exception>
                    InvalidKeyException if the given key is inappropriate for
                      initializing this MAC.                    
                </exception>
                <exception>
                    InvalidAlgorithmParameterException if the given algorithm
                      parameters are inappropriate for this MAC.                    
                </exception>
            </javadoc>
            <method name="init" type="void" line="87">
                <params>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                </params>
                <scope line="89"/>
                <scope line="94"/>
                <scope line="99"/>
            </method>
            <javadoc line="106">
                Processes the given byte.                
                <param>
                    input the input byte to be processed.                    
                </param>
            </javadoc>
            <method name="update" type="void" line="111">
                <params>
                    <param name="input" type="byte"/>
                </params>
                <comment line="114">
                    compute digest for 1st pass; start with inner pad                    
                </comment>
                <comment line="120">
                    add the passed byte to the inner digest                    
                </comment>
                <scope line="112"/>
            </method>
            <javadoc line="123">
                Processes the first &lt;code&gt;len&lt;/code&gt; bytes in &lt;code&gt;input&lt;/code&gt;,
                  starting at &lt;code&gt;offset&lt;/code&gt;.                
                <param>
                    input the input buffer.                    
                </param>
                <param>
                    offset the offset in &lt;code&gt;input&lt;/code&gt; where the input starts.                    
                </param>
                <param>
                    len the number of bytes to process.                    
                </param>
            </javadoc>
            <method name="update" type="void" line="131">
                <params>
                    <param name="input" type="byte"/>
                    <param name="offset" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <comment line="134">
                    compute digest for 1st pass; start with inner pad                    
                </comment>
                <comment line="140">
                    add the selected part of an array of bytes to the inner digest                    
                </comment>
                <scope line="132"/>
            </method>
            <method name="update" type="void" line="143">
                <params>
                    <param name="input" type="ByteBuffer"/>
                </params>
                <comment line="146">
                    compute digest for 1st pass; start with inner pad                    
                </comment>
                <scope line="144"/>
            </method>
            <javadoc line="154">
                Completes the Mac computation and resets the Mac for further use,
                  maintaining the secret key that the Mac was initialized with.                
                <return>
                    the Mac result.                    
                </return>
            </javadoc>
            <method name="doFinal" type="byte[]" line="160">
                <comment line="163">
                    compute digest for 1st pass; start with inner pad                    
                </comment>
                <comment line="171">
                    finish the inner digest                    
                </comment>
                <comment line="174">
                    compute digest for 2nd pass; start with outer pad                    
                </comment>
                <comment line="177">
                    add result of 1st hash                    
                </comment>
                <comment line="183">
                    should never occur                    
                </comment>
                <scope line="161"/>
                <scope line="165"/>
                <scope line="169">
                    <declaration name="tmp" type="byte[]" line="171"/>
                </scope>
                <scope line="181"/>
            </method>
            <javadoc line="187">
                Resets the Mac for further use, maintaining the secret key that the
                  Mac was initialized with.                
            </javadoc>
            <method name="reset" type="void" line="191">
                <scope line="192"/>
            </method>
            <class name="SslMacMD5" line="199">
                <extends class="MacSpi"/>
                <declaration name="core" type="SslMacCore" line="200"/>
                <method name="SslMacMD5" type="constructor" line="201"/>
                <method name="engineGetMacLength" type="int" line="204"/>
                <method name="engineInit" type="void" line="208">
                    <params>
                        <param name="key" type="Key"/>
                        <param name="params" type="AlgorithmParameterSpec"/>
                    </params>
                </method>
                <method name="engineUpdate" type="void" line="211">
                    <params>
                        <param name="input" type="byte"/>
                    </params>
                </method>
                <method name="engineUpdate" type="void" line="214">
                    <params>
                        <param name="input" type="byte"/>
                        <param name="offset" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                </method>
                <method name="engineUpdate" type="void" line="217">
                    <params>
                        <param name="input" type="ByteBuffer"/>
                    </params>
                </method>
                <method name="engineDoFinal" type="byte[]" line="220"/>
                <method name="engineReset" type="void" line="223"/>
                <declaration name="md5Pad1" type="byte[]" line="227"/>
                <declaration name="md5Pad2" type="byte[]" line="228"/>
            </class>
            <class name="SslMacSHA1" line="232">
                <extends class="MacSpi"/>
                <declaration name="core" type="SslMacCore" line="233"/>
                <method name="SslMacSHA1" type="constructor" line="234"/>
                <method name="engineGetMacLength" type="int" line="237"/>
                <method name="engineInit" type="void" line="241">
                    <params>
                        <param name="key" type="Key"/>
                        <param name="params" type="AlgorithmParameterSpec"/>
                    </params>
                </method>
                <method name="engineUpdate" type="void" line="244">
                    <params>
                        <param name="input" type="byte"/>
                    </params>
                </method>
                <method name="engineUpdate" type="void" line="247">
                    <params>
                        <param name="input" type="byte"/>
                        <param name="offset" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                </method>
                <method name="engineUpdate" type="void" line="250">
                    <params>
                        <param name="input" type="ByteBuffer"/>
                    </params>
                </method>
                <method name="engineDoFinal" type="byte[]" line="253"/>
                <method name="engineReset" type="void" line="256"/>
                <declaration name="shaPad1" type="byte[]" line="260"/>
                <declaration name="shaPad2" type="byte[]" line="261"/>
            </class>
        </class>
    </source>