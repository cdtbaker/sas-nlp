<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.crypto.provider">
        <import package="java.util"/>
        <import package="java.lang"/>
        <import package="java.math.BigInteger"/>
        <import package="java.security.InvalidAlgorithmParameterException"/>
        <import package="java.security.InvalidKeyException"/>
        <import package="java.security.Key"/>
        <import package="java.security.NoSuchAlgorithmException"/>
        <import package="java.security.SecureRandom"/>
        <import package="java.security.spec.AlgorithmParameterSpec"/>
        <import package="java.security.spec.InvalidKeySpecException"/>
        <import package="javax.crypto.KeyAgreementSpi"/>
        <import package="javax.crypto.ShortBufferException"/>
        <import package="javax.crypto.SecretKey"/>
        <import package="javax.crypto.spec"/>
        <class name="DHKeyAgreement" line="16">
            <extends class="KeyAgreementSpi"/>
            <javadoc line="16">
                This class implements the Diffie-Hellman key agreement protocol between
                  any number of parties.                
                <author>
                    Jan Luehe                    
                </author>
            </javadoc>
            <declaration name="generateSecret" type="boolean" line="22"/>
            <declaration name="init_p" type="BigInteger" line="23"/>
            <declaration name="init_g" type="BigInteger" line="24"/>
            <declaration name="x" type="BigInteger" line="25"/>
            <declaration name="y" type="BigInteger" line="26"/>
            <javadoc line="27">
                Empty constructor                
            </javadoc>
            <method name="DHKeyAgreement" type="constructor" line="30"/>
            <javadoc line="32">
                Initializes this key agreement with the given key and source of
                  randomness. The given key is required to contain all the algorithm
                  parameters required for this key agreement.
                  &lt;p&gt; If the key agreement algorithm requires random bytes, it gets them
                  from the given source of randomness, &lt;code&gt;random&lt;/code&gt;.
                  However, if the underlying
                  algorithm implementation does not require any random bytes,
                  &lt;code&gt;random&lt;/code&gt; is ignored.                
                <param>
                    key the party&apos;s private information. For example, in the case
                      of the Diffie-Hellman key agreement, this would be the party&apos;s own
                      Diffie-Hellman private key.                    
                </param>
                <param>
                    random the source of randomness                    
                </param>
                <exception>
                    InvalidKeyException if the given key is
                      inappropriate for this key agreement, e.g., is of the wrong type or
                      has an incompatible algorithm type.                    
                </exception>
            </javadoc>
            <method name="engineInit" type="void" line="49">
                <params>
                    <param name="key" type="Key"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="50"/>
                <scope line="53"/>
            </method>
            <javadoc line="56">
                Initializes this key agreement with the given key, set of
                  algorithm parameters, and source of randomness.                
                <param>
                    key the party&apos;s private information. For example, in the case
                      of the Diffie-Hellman key agreement, this would be the party&apos;s own
                      Diffie-Hellman private key.                    
                </param>
                <param>
                    params the key agreement parameters                    
                </param>
                <param>
                    random the source of randomness                    
                </param>
                <exception>
                    InvalidKeyException if the given key is
                      inappropriate for this key agreement, e.g., is of the wrong type or
                      has an incompatible algorithm type.                    
                </exception>
                <exception>
                    InvalidAlgorithmParameterException if the given parameters
                      are inappropriate for this key agreement.                    
                </exception>
            </javadoc>
            <method name="engineInit" type="void" line="70">
                <params>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="74"/>
                <scope line="77"/>
                <declaration name="dhPrivKey" type="javax.crypto.interfaces.DHPrivateKey" line="80"/>
                <scope line="82"/>
                <declaration name="priv_p" type="BigInteger" line="86"/>
                <declaration name="priv_g" type="BigInteger" line="87"/>
                <scope line="88"/>
                <scope line="91"/>
                <scope line="94"/>
            </method>
            <javadoc line="101">
                Executes the next phase of this key agreement with the given
                  key that was received from one of the other parties involved in this key
                  agreement.                
                <param>
                    key the key for this phase. For example, in the case of
                      Diffie-Hellman between 2 parties, this would be the other party&apos;s
                      Diffie-Hellman public key.                    
                </param>
                <param>
                    lastPhase flag which indicates whether or not this is the last
                      phase of this key agreement.                    
                </param>
                <return>
                    the (intermediate) key resulting from this phase, or null if
                      this phase does not yield a key                    
                </return>
                <exception>
                    InvalidKeyException if the given key is inappropriate for
                      this phase.                    
                </exception>
                <exception>
                    IllegalStateException if this key agreement has not been
                      initialized.                    
                </exception>
            </javadoc>
            <method name="engineDoPhase" type="Key" line="117">
                <params>
                    <param name="key" type="Key"/>
                    <param name="lastPhase" type="boolean"/>
                </params>
                <scope line="118"/>
                <declaration name="dhPubKey" type="javax.crypto.interfaces.DHPublicKey" line="121"/>
                <scope line="123"/>
                <declaration name="pub_p" type="BigInteger" line="126"/>
                <declaration name="pub_g" type="BigInteger" line="127"/>
                <scope line="128"/>
                <scope line="131"/>
                <scope line="136">
                    <declaration name="intermediate" type="byte[]" line="137"/>
                </scope>
                <scope line="140"/>
            </method>
            <javadoc line="144">
                Generates the shared secret and returns it in a new buffer.
                  &lt;p&gt;This method resets this &lt;code&gt;KeyAgreementSpi&lt;/code&gt; object,
                  so that it
                  can be reused for further key agreements. Unless this key agreement is
                  reinitialized with one of the &lt;code&gt;engineInit&lt;/code&gt; methods, the same
                  private information and algorithm parameters will be used for
                  subsequent key agreements.                
                <return>
                    the new buffer with the shared secret                    
                </return>
                <exception>
                    IllegalStateException if this key agreement has not been
                      completed yet                    
                </exception>
            </javadoc>
            <method name="engineGenerateSecret" type="byte[]" line="156">
                <scope line="157"/>
                <declaration name="modulus" type="BigInteger" line="161"/>
                <declaration name="tmpResult" type="BigInteger" line="162"/>
                <declaration name="secret" type="byte[]" line="163"/>
                <scope line="164">
                    <declaration name="retval" type="byte" line="165"/>
                </scope>
                <scope line="169"/>
            </method>
            <javadoc line="173">
                Generates the shared secret, and places it into the buffer
                  &lt;code&gt;sharedSecret&lt;/code&gt;, beginning at &lt;code&gt;offset&lt;/code&gt;.
                  &lt;p&gt;If the &lt;code&gt;sharedSecret&lt;/code&gt; buffer is too small to hold the
                  result, a &lt;code&gt;ShortBufferException&lt;/code&gt; is thrown.
                  In this case, this call should be repeated with a larger output buffer.
                  &lt;p&gt;This method resets this &lt;code&gt;KeyAgreementSpi&lt;/code&gt; object,
                  so that it
                  can be reused for further key agreements. Unless this key agreement is
                  reinitialized with one of the &lt;code&gt;engineInit&lt;/code&gt; methods, the same
                  private information and algorithm parameters will be used for
                  subsequent key agreements.                
                <param>
                    sharedSecret the buffer for the shared secret                    
                </param>
                <param>
                    offset the offset in &lt;code&gt;sharedSecret&lt;/code&gt; where the
                      shared secret will be stored                    
                </param>
                <return>
                    the number of bytes placed into &lt;code&gt;sharedSecret&lt;/code&gt;                    
                </return>
                <exception>
                    IllegalStateException if this key agreement has not been
                      completed yet                    
                </exception>
                <exception>
                    ShortBufferException if the given output buffer is too small
                      to hold the secret                    
                </exception>
            </javadoc>
            <method name="engineGenerateSecret" type="int" line="194">
                <params>
                    <param name="sharedSecret" type="byte[]"/>
                    <param name="offset" type="int"/>
                </params>
                <scope line="195"/>
                <scope line="198"/>
                <declaration name="modulus" type="BigInteger" line="201"/>
                <declaration name="secret" type="byte[]" line="202"/>
                <scope line="203">
                    <scope line="204"/>
                </scope>
                <scope line="211">
                    <scope line="212"/>
                </scope>
            </method>
            <javadoc line="220">
                Creates the shared secret and returns it as a secret key object
                  of the requested algorithm type.
                  &lt;p&gt;This method resets this &lt;code&gt;KeyAgreementSpi&lt;/code&gt; object,
                  so that it
                  can be reused for further key agreements. Unless this key agreement is
                  reinitialized with one of the &lt;code&gt;engineInit&lt;/code&gt; methods, the same
                  private information and algorithm parameters will be used for
                  subsequent key agreements.                
                <param>
                    algorithm the requested secret key algorithm                    
                </param>
                <return>
                    the shared secret key                    
                </return>
                <exception>
                    IllegalStateException if this key agreement has not been
                      completed yet                    
                </exception>
                <exception>
                    NoSuchAlgorithmException if the requested secret key
                      algorithm is not available                    
                </exception>
                <exception>
                    InvalidKeyException if the shared secret key material cannot
                      be used to generate a secret key of the requested algorithm type (e.g.,
                      the key material is too short)                    
                </exception>
            </javadoc>
            <method name="engineGenerateSecret" type="SecretKey" line="239">
                <params>
                    <param name="algorithm" type="String"/>
                </params>
                <scope line="240"/>
                <declaration name="secret" type="byte[]" line="243"/>
                <scope line="244"/>
                <scope line="247"/>
                <scope line="250">
                    <declaration name="keysize" type="int" line="251"/>
                    <declaration name="skey" type="SecretKeySpec" line="253"/>
                </scope>
                <scope line="256">
                    <declaration name="keysize" type="int" line="257"/>
                    <declaration name="skey" type="SecretKeySpec" line="258"/>
                    <declaration name="idx" type="int" line="259"/>
                    <scope line="260">
                        <scope line="261"/>
                    </scope>
                    <scope line="267"/>
                </scope>
                <scope line="272"/>
                <scope line="275"/>
            </method>
        </class>
    </source>