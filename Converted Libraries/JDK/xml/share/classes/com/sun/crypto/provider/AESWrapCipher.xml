<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.crypto.provider">
        <import package="java.util.Arrays"/>
        <import package="java.security"/>
        <import package="java.security.spec"/>
        <import package="javax.crypto"/>
        <import package="javax.crypto.spec"/>
        <class name="AESWrapCipher" line="34">
            <extends class="CipherSpi"/>
            <comment line="56">
                internal cipher object which does the real work.                
            </comment>
            <comment line="61">
                are we encrypting or decrypting?                
            </comment>
            <javadoc line="34">
                This class implements the AES KeyWrap algorithm as defined
                  in &lt;a href=http://www.w3.org/TR/xmlenc-core/#sec-Alg-SymmetricKeyWrap&gt;
                  &quot;XML Encryption Syntax and Processing&quot; section 5.6.3 &quot;AES Key Wrap&quot;.
                  Note: only &lt;code&gt;ECB&lt;/code&gt; mode and &lt;code&gt;NoPadding&lt;/code&gt; padding
                  can be used for this algorithm.                
                <author>
                    Valerie Peng                    
                </author>
                <see>
                    AESCipher                    
                </see>
            </javadoc>
            <declaration name="IV" type="byte[]" line="48"/>
            <declaration name="blksize" type="int" line="53"/>
            <declaration name="cipher" type="AESCrypt" line="58"/>
            <declaration name="decrypting" type="boolean" line="63"/>
            <javadoc line="65">
                Creates an instance of AES KeyWrap cipher with default
                  mode, i.e. &quot;ECB&quot; and padding scheme, i.e. &quot;NoPadding&quot;.                
            </javadoc>
            <method name="AESWrapCipher" type="constructor" line="69"/>
            <javadoc line="73">
                Sets the mode of this cipher. Only &quot;ECB&quot; mode is accepted for this
                  cipher.                
                <param>
                    mode the cipher mode                    
                </param>
                <exception>
                    NoSuchAlgorithmException if the requested cipher mode
                      is not &quot;ECB&quot;.                    
                </exception>
            </javadoc>
            <method name="engineSetMode" type="void" line="83">
                <params>
                    <param name="mode" type="String"/>
                </params>
                <scope line="84"/>
            </method>
            <javadoc line="89">
                Sets the padding mechanism of this cipher. Only &quot;NoPadding&quot; schmem
                  is accepted for this cipher.                
                <param>
                    padding the padding mechanism                    
                </param>
                <exception>
                    NoSuchPaddingException if the requested padding mechanism
                      is not &quot;NoPadding&quot;.                    
                </exception>
            </javadoc>
            <method name="engineSetPadding" type="void" line="99">
                <params>
                    <param name="padding" type="String"/>
                </params>
                <scope line="100"/>
            </method>
            <javadoc line="105">
                Returns the block size (in bytes). i.e. 16 bytes.                
                <return>
                    the block size (in bytes), i.e. 16 bytes.                    
                </return>
            </javadoc>
            <method name="engineGetBlockSize" type="int" line="110"/>
            <javadoc line="114">
                Returns the length in bytes that an output buffer would need to be
                  given the input length &lt;code&gt;inputLen&lt;/code&gt; (in bytes).
                  &lt;p&gt;The actual output length of the next &lt;code&gt;update&lt;/code&gt; or
                  &lt;code&gt;doFinal&lt;/code&gt; call may be smaller than the length returned
                  by this method.                
                <param>
                    inputLen the input length (in bytes)                    
                </param>
                <return>
                    the required output buffer size (in bytes)                    
                </return>
            </javadoc>
            <method name="engineGetOutputSize" type="int" line="126">
                <params>
                    <param name="inputLen" type="int"/>
                </params>
                <comment line="128">
                    can only return an upper-limit if not initialized yet.                    
                </comment>
                <declaration name="result" type="int" line="128"/>
                <scope line="129"/>
                <scope line="131"/>
            </method>
            <javadoc line="137">
                Returns the initialization vector (IV) which is null for this cipher.                
                <return>
                    null for this cipher.                    
                </return>
            </javadoc>
            <method name="engineGetIV" type="byte[]" line="142"/>
            <javadoc line="146">
                Initializes this cipher with a key and a source of randomness.
                  &lt;p&gt;The cipher only supports the following two operation modes:&lt;b&gt;
                  Cipher.WRAP_MODE, and &lt;b&gt;
                  Cipher.UNWRAP_MODE.
                  &lt;p&gt;For modes other than the above two, UnsupportedOperationException
                  will be thrown.                
                <param>
                    opmode the operation mode of this cipher. Only
                      &lt;code&gt;WRAP_MODE&lt;/code&gt; or &lt;code&gt;UNWRAP_MODE&lt;/code&gt;) are accepted.                    
                </param>
                <param>
                    key the secret key.                    
                </param>
                <param>
                    random the source of randomness.                    
                </param>
                <exception>
                    InvalidKeyException if the given key is inappropriate for
                      initializing this cipher.                    
                </exception>
            </javadoc>
            <method name="engineInit" type="void" line="164">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="165"/>
                <scope line="167"/>
                <scope line="169"/>
            </method>
            <javadoc line="176">
                Initializes this cipher with a key, a set of algorithm parameters,
                  and a source of randomness.
                  &lt;p&gt;The cipher only supports the following two operation modes:&lt;b&gt;
                  Cipher.WRAP_MODE, and &lt;b&gt;
                  Cipher.UNWRAP_MODE.
                  &lt;p&gt;For modes other than the above two, UnsupportedOperationException
                  will be thrown.                
                <param>
                    opmode the operation mode of this cipher. Only
                      &lt;code&gt;WRAP_MODE&lt;/code&gt; or &lt;code&gt;UNWRAP_MODE&lt;/code&gt;) are accepted.                    
                </param>
                <param>
                    key the secret key.                    
                </param>
                <param>
                    params the algorithm parameters; must be null for this cipher.                    
                </param>
                <param>
                    random the source of randomness.                    
                </param>
                <exception>
                    InvalidKeyException if the given key is inappropriate for
                      initializing this cipher                    
                </exception>
                <exception>
                    InvalidAlgorithmParameterException if the given algorithm
                      parameters is not null.                    
                </exception>
            </javadoc>
            <method name="engineInit" type="void" line="200">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameterSpec"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="201"/>
            </method>
            <javadoc line="208">
                Initializes this cipher with a key, a set of algorithm parameters,
                  and a source of randomness.
                  &lt;p&gt;The cipher only supports the following two operation modes:&lt;b&gt;
                  Cipher.WRAP_MODE, and &lt;b&gt;
                  Cipher.UNWRAP_MODE.
                  &lt;p&gt;For modes other than the above two, UnsupportedOperationException
                  will be thrown.                
                <param>
                    opmode the operation mode of this cipher. Only
                      &lt;code&gt;WRAP_MODE&lt;/code&gt; or &lt;code&gt;UNWRAP_MODE&lt;/code&gt;) are accepted.                    
                </param>
                <param>
                    key the secret key.                    
                </param>
                <param>
                    params the algorithm parameters; must be null for this cipher.                    
                </param>
                <param>
                    random the source of randomness.                    
                </param>
                <exception>
                    InvalidKeyException if the given key is inappropriate.                    
                </exception>
                <exception>
                    InvalidAlgorithmParameterException if the given algorithm
                      parameters is not null.                    
                </exception>
            </javadoc>
            <method name="engineInit" type="void" line="231">
                <params>
                    <param name="opmode" type="int"/>
                    <param name="key" type="Key"/>
                    <param name="params" type="AlgorithmParameters"/>
                    <param name="random" type="SecureRandom"/>
                </params>
                <scope line="232"/>
            </method>
            <javadoc line="239">
                This operation is not supported by this cipher.
                  Since it&apos;s impossible to initialize this cipher given the
                  current Cipher.engineInit(...) implementation,
                  IllegalStateException will always be thrown upon invocation.                
                <param>
                    in the input buffer.                    
                </param>
                <param>
                    inOffset the offset in &lt;code&gt;in&lt;/code&gt; where the input
                      starts.                    
                </param>
                <param>
                    inLen the input length.                    
                </param>
                <return>
                    n/a.                    
                </return>
                <exception>
                    IllegalStateException upon invocation of this method.                    
                </exception>
            </javadoc>
            <method name="engineUpdate" type="byte[]" line="254">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOffset" type="int"/>
                    <param name="inLen" type="int"/>
                </params>
            </method>
            <javadoc line="258">
                This operation is not supported by this cipher.
                  Since it&apos;s impossible to initialize this cipher given the
                  current Cipher.engineInit(...) implementation,
                  IllegalStateException will always be thrown upon invocation.                
                <param>
                    in the input buffer.                    
                </param>
                <param>
                    inOffset the offset in &lt;code&gt;in&lt;/code&gt; where the input
                      starts.                    
                </param>
                <param>
                    inLen the input length.                    
                </param>
                <param>
                    out the buffer for the result.                    
                </param>
                <param>
                    outOffset the offset in &lt;code&gt;out&lt;/code&gt; where the result
                      is stored.                    
                </param>
                <return>
                    n/a.                    
                </return>
                <exception>
                    IllegalStateException upon invocation of this method.                    
                </exception>
            </javadoc>
            <method name="engineUpdate" type="int" line="278">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOffset" type="int"/>
                    <param name="inLen" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOffset" type="int"/>
                </params>
            </method>
            <javadoc line="282">
                This operation is not supported by this cipher.
                  Since it&apos;s impossible to initialize this cipher given the
                  current Cipher.engineInit(...) implementation,
                  IllegalStateException will always be thrown upon invocation.                
                <param>
                    in the input buffer                    
                </param>
                <param>
                    inOffset the offset in &lt;code&gt;in&lt;/code&gt; where the input
                      starts                    
                </param>
                <param>
                    inLen the input length.                    
                </param>
                <return>
                    n/a.                    
                </return>
                <exception>
                    IllegalStateException upon invocation of this method.                    
                </exception>
            </javadoc>
            <method name="engineDoFinal" type="byte[]" line="299">
                <params>
                    <param name="input" type="byte[]"/>
                    <param name="inputOffset" type="int"/>
                    <param name="inputLen" type="int"/>
                </params>
            </method>
            <javadoc line="303">
                This operation is not supported by this cipher.
                  Since it&apos;s impossible to initialize this cipher given the
                  current Cipher.engineInit(...) implementation,
                  IllegalStateException will always be thrown upon invocation.                
                <param>
                    in the input buffer.                    
                </param>
                <param>
                    inOffset the offset in &lt;code&gt;in&lt;/code&gt; where the input
                      starts.                    
                </param>
                <param>
                    inLen the input length.                    
                </param>
                <param>
                    out the buffer for the result.                    
                </param>
                <param>
                    outOffset the ofset in &lt;code&gt;out&lt;/code&gt; where the result
                      is stored.                    
                </param>
                <return>
                    n/a.                    
                </return>
                <exception>
                    IllegalStateException upon invocation of this method.                    
                </exception>
            </javadoc>
            <method name="engineDoFinal" type="int" line="324">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOffset" type="int"/>
                    <param name="inLen" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOffset" type="int"/>
                </params>
            </method>
            <javadoc line="328">
                Returns the parameters used with this cipher which is always null
                  for this cipher.                
                <return>
                    null since this cipher does not use any parameters.                    
                </return>
            </javadoc>
            <method name="engineGetParameters" type="AlgorithmParameters" line="334"/>
            <javadoc line="338">
                Returns the key size of the given key object in number of bits.                
                <param>
                    key the key object.                    
                </param>
                <return>
                    the &quot;effective&quot; key size of the given key object.                    
                </return>
                <exception>
                    InvalidKeyException if &lt;code&gt;key&lt;/code&gt; is invalid.                    
                </exception>
            </javadoc>
            <method name="engineGetKeySize" type="int" line="347">
                <params>
                    <param name="key" type="Key"/>
                </params>
                <declaration name="encoded" type="byte[]" line="348"/>
                <scope line="349"/>
            </method>
            <javadoc line="356">
                Wrap a key.                
                <param>
                    key the key to be wrapped.                    
                </param>
                <return>
                    the wrapped key.                    
                </return>
                <exception>
                    IllegalBlockSizeException if this cipher is a block
                      cipher, no padding has been requested, and the length of the
                      encoding of the key to be wrapped is not a
                      multiple of the block size.                    
                </exception>
                <exception>
                    InvalidKeyException if it is impossible or unsafe to
                      wrap the key with this cipher (e.g., a hardware protected key is
                      being passed to a software only cipher).                    
                </exception>
            </javadoc>
            <method name="engineWrap" type="byte[]" line="373">
                <params>
                    <param name="key" type="Key"/>
                </params>
                <declaration name="keyVal" type="byte[]" line="374"/>
                <scope line="375"/>
                <declaration name="out" type="byte[]" line="379"/>
                <scope line="381"/>
                <scope line="385">
                    <scope line="386"/>
                    <declaration name="N" type="int" line="392"/>
                    <declaration name="buffer" type="byte[]" line="393"/>
                    <scope line="394">
                        <scope line="395">
                            <declaration name="T" type="int" line="396"/>
                            <scope line="400">
                                <declaration name="v" type="byte" line="401"/>
                            </scope>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="413">
                Unwrap a previously wrapped key.                
                <param>
                    wrappedKey the key to be unwrapped.                    
                </param>
                <param>
                    wrappedKeyAlgorithm the algorithm the wrapped key is for.                    
                </param>
                <param>
                    wrappedKeyType the type of the wrapped key.
                      This is one of &lt;code&gt;Cipher.SECRET_KEY&lt;/code&gt;,
                      &lt;code&gt;Cipher.PRIVATE_KEY&lt;/code&gt;, or &lt;code&gt;Cipher.PUBLIC_KEY&lt;/code&gt;.                    
                </param>
                <return>
                    the unwrapped key.                    
                </return>
                <exception>
                    NoSuchAlgorithmException if no installed providers
                      can create keys of type &lt;code&gt;wrappedKeyType&lt;/code&gt; for the
                      &lt;code&gt;wrappedKeyAlgorithm&lt;/code&gt;.                    
                </exception>
                <exception>
                    InvalidKeyException if &lt;code&gt;wrappedKey&lt;/code&gt; does not
                      represent a wrapped key of type &lt;code&gt;wrappedKeyType&lt;/code&gt; for
                      the &lt;code&gt;wrappedKeyAlgorithm&lt;/code&gt;.                    
                </exception>
            </javadoc>
            <method name="engineUnwrap" type="Key" line="437">
                <params>
                    <param name="wrappedKey" type="byte[]"/>
                    <param name="wrappedKeyAlgorithm" type="String"/>
                    <param name="wrappedKeyType" type="int"/>
                </params>
                <comment line="440">
                    ensure the wrappedKey length is multiples of 8 bytes and non-zero                    
                </comment>
                <declaration name="wrappedKeyLen" type="int" line="438"/>
                <scope line="440"/>
                <scope line="443"/>
                <declaration name="out" type="byte[]" line="447"/>
                <declaration name="buffer" type="byte[]" line="448"/>
                <scope line="449">
                    <scope line="451">
                        <scope line="452"/>
                    </scope>
                </scope>
                <scope line="457">
                    <declaration name="N" type="int" line="460"/>
                    <scope line="461">
                        <scope line="462">
                            <declaration name="T" type="int" line="463"/>
                            <scope line="465">
                                <declaration name="v" type="byte" line="466"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="474">
                        <scope line="475"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>