<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.crypto.provider">
        <import package="java.security.InvalidKeyException"/>
        <class name="RC2Crypt" line="30">
            <extends class="SymmetricCipher"/>
            <comment line="48">
                PITABLE from the RFC, used in key setup                
            </comment>
            <comment line="84">
                expanded key, 64 times 16-bit words                
            </comment>
            <comment line="87">
                effective key bits                
            </comment>
            <javadoc line="30">
                Implementation of the RC2(tm) algorithm as described in RFC 2268.
                  RC2 is a 16-bit based algorithm and not particularly fast on 32/64 bit
                  architectures. Also, note that although the JVM has a 16-bit integer
                  type (short), all expressions are evaluated either in 32 or 64 bit
                  (int or long). Expression such as &quot;s1 = s2 + s3&quot; are implemented by
                  first promoting s2 and s3 to int, performing an int addition, and
                  then demoting the result back to short to store in s1. To avoid this
                  fairly slow process, we use the int type throughout and manually insert
                  &quot;&amp; 0xffff&quot; where necessary.                
                <since>
                    1.5                    
                </since>
                <author>
                    Andreas Sterbenz                    
                </author>
            </javadoc>
            <declaration name="PI_TABLE" type="int[]" line="48"/>
            <declaration name="expandedKey" type="int[]" line="84"/>
            <declaration name="effectiveKeyBits" type="int" line="87"/>
            <method name="RC2Crypt" type="constructor" line="89"/>
            <method name="getBlockSize" type="int" line="93"/>
            <method name="getEffectiveKeyBits" type="int" line="97"/>
            <javadoc line="101">
                Initializes the effective key bit size. This method is a hook to
                  allow RC2Cipher to initialize the effective key size.                
            </javadoc>
            <method name="initEffectiveKeyBits" type="void" line="105">
                <params>
                    <param name="effectiveKeyBits" type="int"/>
                </params>
            </method>
            <method name="checkKey" type="void" line="110">
                <params>
                    <param name="algorithm" type="String"/>
                    <param name="keyLength" type="int"/>
                </params>
                <scope line="111"/>
                <scope line="114"/>
            </method>
            <method name="init" type="void" line="121">
                <params>
                    <param name="decrypting" type="boolean"/>
                    <param name="algorithm" type="String"/>
                    <param name="key" type="byte[]"/>
                </params>
                <comment line="130">
                    key buffer, the L[] byte array from the spec                    
                </comment>
                <comment line="133">
                    place key into key buffer                    
                </comment>
                <comment line="136">
                    first loop                    
                </comment>
                <comment line="146">
                    second loop, reduce search space to effective key bits                    
                </comment>
                <comment line="154">
                    byte to short conversion, little endian (copy into K[])                    
                </comment>
                <declaration name="keyLength" type="int" line="122"/>
                <scope line="123"/>
                <declaration name="expandedKeyBytes" type="byte[]" line="130"/>
                <declaration name="t" type="int" line="136"/>
                <scope line="137"/>
                <declaration name="t8" type="int" line="142"/>
                <declaration name="tm" type="int" line="143"/>
                <scope line="148"/>
                <scope line="154"/>
            </method>
            <javadoc line="161">
                Encrypt a single block. Note that in a few places we omit a &quot;&amp; 0xffff&quot;
                  and allow variables to become larger than 16 bit. This still works
                  because there is never a 32 bit overflow.                
            </javadoc>
            <method name="encryptBlock" type="void" line="166">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                </params>
                <comment line="177">
                    5 mixing rounds                    
                </comment>
                <comment line="192">
                    1 mashing round                    
                </comment>
                <comment line="198">
                    6 mixing rounds                    
                </comment>
                <comment line="213">
                    1 mashing round                    
                </comment>
                <comment line="219">
                    5 mixing rounds                    
                </comment>
                <declaration name="R0" type="int" line="167"/>
                <declaration name="R1" type="int" line="169"/>
                <declaration name="R2" type="int" line="171"/>
                <declaration name="R3" type="int" line="173"/>
                <scope line="177"/>
                <scope line="198"/>
                <scope line="219"/>
            </method>
            <method name="decryptBlock" type="void" line="243">
                <params>
                    <param name="in" type="byte[]"/>
                    <param name="inOfs" type="int"/>
                    <param name="out" type="byte[]"/>
                    <param name="outOfs" type="int"/>
                </params>
                <comment line="254">
                    5 r-mixing rounds                    
                </comment>
                <comment line="269">
                    1 r-mashing round                    
                </comment>
                <comment line="275">
                    6 r-mixing rounds                    
                </comment>
                <comment line="290">
                    1 r-mashing round                    
                </comment>
                <comment line="296">
                    5 r-mixing rounds                    
                </comment>
                <declaration name="R0" type="int" line="244"/>
                <declaration name="R1" type="int" line="246"/>
                <declaration name="R2" type="int" line="248"/>
                <declaration name="R3" type="int" line="250"/>
                <scope line="254"/>
                <scope line="275"/>
                <scope line="296"/>
            </method>
        </class>
    </source>