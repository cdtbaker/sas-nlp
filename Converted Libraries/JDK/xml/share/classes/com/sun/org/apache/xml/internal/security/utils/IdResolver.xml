<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security.utils">
        <import package="java.lang.ref.WeakReference"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.WeakHashMap"/>
        <import package="org.w3c.dom.Attr"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.NamedNodeMap"/>
        <import package="org.w3c.dom.Node"/>
        <class name="IdResolver" line="34">
            <javadoc line="34">
                Purpose of this class is to enable the XML Parser to keep track of ID
                  attributes. This is done by &apos;registering&apos; attributes of type ID at the
                  IdResolver. This is necessary if we create a document from scratch and we
                  sign some resources with a URI using a fragent identifier...
                  &lt;BR /&gt;
                  The problem is that if you do not validate a document, you cannot use the
                  &lt;CODE&gt;getElementByID&lt;/CODE&gt; functionality. So this modules uses some implicit
                  knowledge on selected Schemas and DTDs to pick the right Element for a given
                  ID: We know that all &lt;CODE&gt;@Id&lt;/CODE&gt; attributes in an Element from the XML
                  Signature namespace are of type &lt;CODE&gt;ID&lt;/CODE&gt;.                
                <author>
                    $Author: mullan $                    
                </author>
                <see>
                    &lt;A HREF=&quot;http://www.xml.com/lpt/a/2001/11/07/id.html&quot;&gt;&quot;Identity Crisis&quot; on xml.com&lt;/A&gt;                    
                </see>
            </javadoc>
            <declaration name="log" type="java.util.logging.Logger" line="51"/>
            <javadoc line="51">
                {@link java.util.logging} logging facility                
            </javadoc>
            <declaration name="docMap" type="WeakHashMap" line="55"/>
            <javadoc line="57">
                Constructor IdResolver                
            </javadoc>
            <method name="IdResolver" type="constructor" line="61">
                <comment line="63">
                    we don&apos;t allow instantiation                    
                </comment>
            </method>
            <javadoc line="65">
                Method registerElementById                
                <param>
                    element the element to register                    
                </param>
                <param>
                    idValue the value of the ID attribute                    
                </param>
            </javadoc>
            <method name="registerElementById" type="void" line="71">
                <params>
                    <param name="element" type="Element"/>
                    <param name="idValue" type="String"/>
                </params>
                <declaration name="doc" type="Document" line="72"/>
                <declaration name="elementMap" type="WeakHashMap" line="73"/>
                <scope line="74">
                    <scope line="76"/>
                </scope>
            </method>
            <javadoc line="84">
                Method registerElementById                
                <param>
                    element the element to register                    
                </param>
                <param>
                    id the ID attribute                    
                </param>
            </javadoc>
            <method name="registerElementById" type="void" line="90">
                <params>
                    <param name="element" type="Element"/>
                    <param name="id" type="Attr"/>
                </params>
            </method>
            <javadoc line="94">
                Method getElementById                
                <param>
                    doc the document                    
                </param>
                <param>
                    id the value of the ID                    
                </param>
                <return>
                    the element obtained by the id, or null if it is not found.                    
                </return>
            </javadoc>
            <method name="getElementById" type="Element" line="101">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="id" type="String"/>
                </params>
                <comment line="123">
                    this must be done so that Xalan can catch ALL namespaces
                    XMLUtils.circumventBug2650(doc);                    
                </comment>
                <declaration name="result" type="Element" line="103"/>
                <scope line="105"/>
                <scope line="115"/>
                <scope line="126"/>
            </method>
            <javadoc line="136">
                Method getElementByIdUsingDOM                
                <param>
                    doc the document                    
                </param>
                <param>
                    id the value of the ID                    
                </param>
                <return>
                    the element obtained by the id, or null if it is not found.                    
                </return>
            </javadoc>
            <method name="getElementByIdUsingDOM" type="Element" line="143">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="id" type="String"/>
                </params>
            </method>
            <javadoc line="149">
                Method getElementByIdType                
                <param>
                    doc the document                    
                </param>
                <param>
                    id the value of the ID                    
                </param>
                <return>
                    the element obtained by the id, or null if it is not found.                    
                </return>
            </javadoc>
            <method name="getElementByIdType" type="Element" line="156">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="id" type="String"/>
                </params>
                <declaration name="elementMap" type="WeakHashMap" line="159"/>
                <scope line="160"/>
                <scope line="163">
                    <declaration name="weakReference" type="WeakReference" line="164"/>
                    <scope line="165"/>
                </scope>
            </method>
            <declaration name="names" type="java.util.List" line="172"/>
            <declaration name="namesLength" type="int" line="173"/>
            <scope line="174">
                <declaration name="namespaces" type="String" line="175"/>
            </scope>
            <method name="getElementBySearching" type="Element" line="188">
                <params>
                    <param name="root" type="Node"/>
                    <param name="id" type="String"/>
                </params>
                <declaration name="els" type="Element[]" line="189"/>
                <scope line="191">
                    <scope line="192"/>
                </scope>
            </method>
            <method name="getEl" type="int" line="199">
                <params>
                    <param name="currentNode" type="Node"/>
                    <param name="id" type="String"/>
                    <param name="els" type="Element[]"/>
                </params>
                <declaration name="sibling" type="Node" line="200"/>
                <declaration name="parentNode" type="Node" line="201"/>
                <scope line="202">
                    <declaration name="currentElement" type="Element" line="211"/>
                    <scope line="215">
                        <scope line="216"/>
                    </scope>
                    <scope line="219"/>
                    <scope line="223">
                        <scope line="226"/>
                    </scope>
                </scope>
            </method>
            <method name="isElement" type="int" line="237">
                <params>
                    <param name="el" type="Element"/>
                    <param name="id" type="String"/>
                    <param name="els" type="Element[]"/>
                </params>
                <comment line="275">
                    For an element namespace search for importants                    
                </comment>
                <scope line="238"/>
                <declaration name="ns" type="NamedNodeMap" line="241"/>
                <declaration name="elementIndex" type="int" line="242"/>
                <scope line="244">
                    <declaration name="n" type="Attr" line="245"/>
                    <declaration name="s" type="String" line="246"/>
                    <declaration name="index" type="int" line="248"/>
                    <declaration name="name" type="String" line="250"/>
                    <declaration name="value" type="String" line="253"/>
                    <scope line="254">
                        <declaration name="ch" type="char" line="255"/>
                        <scope line="256">
                            <scope line="258"/>
                        </scope>
                        <scope line="261">
                            <scope line="262"/>
                        </scope>
                    </scope>
                    <scope line="267">
                        <scope line="268"/>
                    </scope>
                </scope>
                <scope line="278"/>
                <scope line="281"/>
                <scope line="285"/>
            </method>
        </class>
    </source>