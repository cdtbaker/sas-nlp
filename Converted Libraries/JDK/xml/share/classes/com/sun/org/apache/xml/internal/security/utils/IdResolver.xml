<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security.utils">
        <import package="java.lang.ref.WeakReference"/>
        <import package="java.util.Arrays"/>
        <import package="java.util.WeakHashMap"/>
        <import package="org.w3c.dom.Attr"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.NamedNodeMap"/>
        <import package="org.w3c.dom.Node"/>
        <class name="IdResolver" line="10">
            <javadoc line="10">
                Purpose of this class is to enable the XML Parser to keep track of ID
                  attributes. This is done by &apos;registering&apos; attributes of type ID at the
                  IdResolver. This is necessary if we create a document from scratch and we
                  sign some resources with a URI using a fragent identifier...
                  &lt;BR /&gt;
                  The problem is that if you do not validate a document, you cannot use the
                  &lt;CODE&gt;getElementByID&lt;/CODE&gt; functionality. So this modules uses some implicit
                  knowledge on selected Schemas and DTDs to pick the right Element for a given
                  ID: We know that all &lt;CODE&gt;@Id&lt;/CODE&gt; attributes in an Element from the XML
                  Signature namespace are of type &lt;CODE&gt;ID&lt;/CODE&gt;.                
                <author>
                    $Author: mullan $                    
                </author>
                <see>
                    <A HREF="http://www.xml.com/lpt/a/2001/11/07/id.html">"Identity Crisis" on xml.com</A>                    
                </see>
            </javadoc>
            <declaration name="log" type="java.util.logging.Logger" line="25"/>
            <javadoc line="25">
                {@link java.util.logging} logging facility                
            </javadoc>
            <declaration name="docMap" type="WeakHashMap" line="29"/>
            <javadoc line="30">
                Constructor IdResolver                
            </javadoc>
            <method name="IdResolver" type="constructor" line="33"/>
            <javadoc line="35">
                Method registerElementById                
                <param>
                    element the element to register                    
                </param>
                <param>
                    idValue the value of the ID attribute                    
                </param>
            </javadoc>
            <method name="registerElementById" type="void" line="40">
                <params>
                    <param name="element" type="Element"/>
                    <param name="idValue" type="String"/>
                </params>
                <declaration name="doc" type="Document" line="41"/>
                <declaration name="elementMap" type="WeakHashMap" line="42"/>
                <scope line="43">
                    <scope line="45"/>
                </scope>
            </method>
            <javadoc line="52">
                Method registerElementById                
                <param>
                    element the element to register                    
                </param>
                <param>
                    id the ID attribute                    
                </param>
            </javadoc>
            <method name="registerElementById" type="void" line="57">
                <params>
                    <param name="element" type="Element"/>
                    <param name="id" type="Attr"/>
                </params>
            </method>
            <javadoc line="60">
                Method getElementById                
                <param>
                    doc the document                    
                </param>
                <param>
                    id the value of the ID                    
                </param>
                <return>
                    the element obtained by the id, or null if it is not found.                    
                </return>
            </javadoc>
            <method name="getElementById" type="Element" line="66">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="id" type="String"/>
                </params>
                <declaration name="result" type="Element" line="67"/>
                <scope line="68"/>
                <scope line="73"/>
                <scope line="78"/>
            </method>
            <javadoc line="84">
                Method getElementByIdUsingDOM                
                <param>
                    doc the document                    
                </param>
                <param>
                    id the value of the ID                    
                </param>
                <return>
                    the element obtained by the id, or null if it is not found.                    
                </return>
            </javadoc>
            <method name="getElementByIdUsingDOM" type="Element" line="90">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="id" type="String"/>
                </params>
            </method>
            <javadoc line="94">
                Method getElementByIdType                
                <param>
                    doc the document                    
                </param>
                <param>
                    id the value of the ID                    
                </param>
                <return>
                    the element obtained by the id, or null if it is not found.                    
                </return>
            </javadoc>
            <method name="getElementByIdType" type="Element" line="100">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="id" type="String"/>
                </params>
                <declaration name="elementMap" type="WeakHashMap" line="102"/>
                <scope line="103"/>
                <scope line="106">
                    <declaration name="weakReference" type="WeakReference" line="107"/>
                    <scope line="108"/>
                </scope>
            </method>
            <declaration name="names" type="java.util.List" line="114"/>
            <declaration name="namesLength" type="int" line="115"/>
            <scope line="116">
                <declaration name="namespaces" type="String" line="117"/>
            </scope>
            <method name="getElementBySearching" type="Element" line="121">
                <params>
                    <param name="root" type="Node"/>
                    <param name="id" type="String"/>
                </params>
                <declaration name="els" type="Element[]" line="122"/>
                <scope line="124">
                    <scope line="125"/>
                </scope>
            </method>
            <method name="getEl" type="int" line="131">
                <params>
                    <param name="currentNode" type="Node"/>
                    <param name="id" type="String"/>
                    <param name="els" type="Element[]"/>
                </params>
                <declaration name="sibling" type="Node" line="132"/>
                <declaration name="parentNode" type="Node" line="133"/>
                <scope line="134">
                    <declaration name="currentElement" type="Element" line="141"/>
                    <scope line="144">
                        <scope line="145"/>
                    </scope>
                    <scope line="149"/>
                    <scope line="154">
                        <scope line="157"/>
                    </scope>
                </scope>
            </method>
            <method name="isElement" type="int" line="167">
                <params>
                    <param name="el" type="Element"/>
                    <param name="id" type="String"/>
                    <param name="els" type="Element[]"/>
                </params>
                <scope line="168"/>
                <declaration name="ns" type="NamedNodeMap" line="171"/>
                <declaration name="elementIndex" type="int" line="172"/>
                <scope line="174">
                    <declaration name="n" type="Attr" line="175"/>
                    <declaration name="s" type="String" line="176"/>
                    <declaration name="index" type="int" line="177"/>
                    <declaration name="name" type="String" line="179"/>
                    <declaration name="value" type="String" line="181"/>
                    <scope line="182">
                        <declaration name="ch" type="char" line="183"/>
                        <scope line="184">
                            <scope line="186"/>
                        </scope>
                        <scope line="190">
                            <scope line="191"/>
                        </scope>
                    </scope>
                    <scope line="197">
                        <scope line="198"/>
                    </scope>
                </scope>
                <scope line="204"/>
                <scope line="207"/>
                <scope line="210"/>
            </method>
        </class>
    </source>