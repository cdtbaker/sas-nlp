<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security.signature">
        <import package="java.io.ByteArrayInputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.io.OutputStream"/>
        <import package="javax.crypto.SecretKey"/>
        <import package="javax.crypto.spec.SecretKeySpec"/>
        <import package="javax.xml.parsers.ParserConfigurationException"/>
        <import package="com.sun.org.apache.xml.internal.security.algorithms.SignatureAlgorithm"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.CanonicalizationException"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.Canonicalizer"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.InvalidCanonicalizerException"/>
        <import package="com.sun.org.apache.xml.internal.security.exceptions.XMLSecurityException"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.Constants"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.XMLUtils"/>
        <import package="com.sun.org.apache.xml.internal.security.transforms.params.InclusiveNamespaces"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.Node"/>
        <import package="org.xml.sax.SAXException"/>
        <class name="SignedInfo" line="43">
            <extends class="Manifest"/>
            <javadoc line="43">
                Handles &lt;code&gt;&amp;lt;ds:SignedInfo&amp;gt;&lt;/code&gt; elements
                  This &lt;code&gt;SignedInfo&lt;code&gt; element includes the canonicalization algorithm,
                  a signature algorithm, and one or more references.                
                <author>
                    Christian Geuer-Pollmann                    
                </author>
            </javadoc>
            <declaration name="_signatureAlgorithm" type="SignatureAlgorithm" line="52"/>
            <javadoc line="52">
                Field _signatureAlgorithm                
            </javadoc>
            <declaration name="_c14nizedBytes" type="byte[]" line="55"/>
            <javadoc line="55">
                Field _c14nizedBytes                
            </javadoc>
            <declaration name="c14nMethod" type="Element" line="58"/>
            <declaration name="signatureMethod" type="Element" line="59"/>
            <javadoc line="61">
                Overwrites {@link Manifest#addDocument} because it creates another
                  Element.                
                <param>
                    doc the {@link Document} in which <code>XMLsignature</code> will
                      be placed                    
                </param>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="SignedInfo" type="constructor" line="69">
                <params>
                    <param name="doc" type="Document"/>
                </params>
            </method>
            <javadoc line="74">
                Constructs {@link SignedInfo} using given Canonicalization algorithm and
                  Signature algorithm.                
                <param>
                    doc <code>SignedInfo</code> is placed in this document                    
                </param>
                <param>
                    signatureMethodURI URI representation of the Digest and
                      Signature algorithm                    
                </param>
                <param>
                    canonicalizationMethodURI URI representation of the
                      Canonicalization method                    
                </param>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="SignedInfo" type="constructor" line="87">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="signatureMethodURI" type="String"/>
                    <param name="canonicalizationMethodURI" type="String"/>
                </params>
            </method>
            <javadoc line="91">
                Constructor SignedInfo                
                <param>
                    doc <code>SignedInfo</code> is placed in this document                    
                </param>
                <param>
                    signatureMethodURI URI representation of the Digest and
                      Signature algorithm                    
                </param>
                <param>
                    hMACOutputLength                    
                </param>
                <param>
                    canonicalizationMethodURI URI representation of the
                      Canonicalization method                    
                </param>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="SignedInfo" type="constructor" line="104">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="signatureMethodURI" type="String"/>
                    <param name="hMACOutputLength" type="int"/>
                    <param name="canonicalizationMethodURI" type="String"/>
                </params>
                <scope line="116"/>
                <scope line="119"/>
            </method>
            <javadoc line="129">
                @param doc                
                <param>
                    signatureMethodElem                    
                </param>
                <param>
                    canonicalizationMethodElem                    
                </param>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="SignedInfo" type="constructor" line="136">
                <params>
                    <param name="doc" type="Document"/>
                    <param name="signatureMethodElem" type="Element"/>
                    <param name="canonicalizationMethodElem" type="Element"/>
                </params>
                <comment line="139">
                    Check this?                    
                </comment>
            </method>
            <javadoc line="153">
                Build a {@link SignedInfo} from an {@link Element}                
                <param>
                    element <code>SignedInfo</code>                    
                </param>
                <param>
                    baseURI the URI of the resource where the XML instance was stored                    
                </param>
                <throws>
                    XMLSecurityException                    
                </throws>
                <see>
                    <A HREF="http://lists.w3.org/Archives/Public/w3c-ietf-xmldsig/2001OctDec/0033.html">Question</A>                    
                </see>
                <see>
                    <A HREF="http://lists.w3.org/Archives/Public/w3c-ietf-xmldsig/2001OctDec/0054.html">Answer</A>                    
                </see>
            </javadoc>
            <method name="SignedInfo" type="constructor" line="163">
                <params>
                    <param name="element" type="Element"/>
                    <param name="baseURI" type="String"/>
                </params>
                <comment line="165">
                    Parse the Reference children and Id attribute in the Manifest                    
                </comment>
                <comment line="168">
                    canonicalize ds:SignedInfo, reparse it into a new document
                     and replace the original not-canonicalized ds:SignedInfo by
                     the re-parsed canonicalized one.                    
                </comment>
                <comment line="178">
                    the c14n is not a secure one and can rewrite the URIs or like                    
                </comment>
                <comment line="179">
                    that reparse the SignedInfo to be sure                    
                </comment>
                <declaration name="c14nMethodURI" type="String" line="173"/>
                <scope line="177">
                    <scope line="180">
                        <declaration name="c14nizer" type="Canonicalizer" line="181"/>
                        <declaration name="dbf" type="javax.xml.parsers.DocumentBuilderFactory" line="186"/>
                        <declaration name="db" type="javax.xml.parsers.DocumentBuilder" line="189"/>
                        <declaration name="newdoc" type="org.w3c.dom.Document" line="190"/>
                        <declaration name="imported" type="Node" line="192"/>
                    </scope>
                    <scope line="199"/>
                    <scope line="201"/>
                    <scope line="203"/>
                </scope>
            </method>
            <javadoc line="212">
                Tests core validation process                
                <return>
                    true if verification was successful                    
                </return>
                <throws>
                    MissingResourceFailureException                    
                </throws>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="verify" type="boolean" line="220"/>
            <javadoc line="224">
                Tests core validation process                
                <param>
                    followManifests defines whether the verification process has to verify referenced <CODE>ds:Manifest</CODE>s, too                    
                </param>
                <return>
                    true if verification was successful                    
                </return>
                <throws>
                    MissingResourceFailureException                    
                </throws>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="verify" type="boolean" line="233">
                <params>
                    <param name="followManifests" type="boolean"/>
                </params>
            </method>
            <javadoc line="237">
                Returns getCanonicalizedOctetStream                
                <return>
                    the canonicalization result octedt stream of <code>SignedInfo</code> element                    
                </return>
                <throws>
                    CanonicalizationException                    
                </throws>
                <throws>
                    InvalidCanonicalizerException                    
                </throws>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="getCanonicalizedOctetStream" type="byte[]" line="247">
                <comment line="250">
                                        
                </comment>
                <comment line="258">
                    make defensive copy                    
                </comment>
                <scope line="250">
                    <declaration name="c14nizer" type="Canonicalizer" line="251"/>
                </scope>
                <declaration name="output" type="byte[]" line="259"/>
            </method>
            <javadoc line="266">
                Output the C14n stream to the give outputstream.                
                <param>
                    os                    
                </param>
                <throws>
                    CanonicalizationException                    
                </throws>
                <throws>
                    InvalidCanonicalizerException                    
                </throws>
                <throws>
                    XMLSecurityException                    
                </throws>
            </javadoc>
            <method name="signInOctectStream" type="void" line="275">
                <params>
                    <param name="os" type="OutputStream"/>
                </params>
                <scope line="277">
                    <declaration name="c14nizer" type="Canonicalizer" line="278"/>
                    <declaration name="inclusiveNamespaces" type="String" line="281"/>
                </scope>
                <scope line="287">
                    <scope line="288"/>
                    <scope line="290"/>
                </scope>
            </method>
            <javadoc line="296">
                Returns the Canonicalization method URI                
                <return>
                    the Canonicalization method URI                    
                </return>
            </javadoc>
            <method name="getCanonicalizationMethodURI" type="String" line="301"/>
            <javadoc line="307">
                Returns the Signature method URI                
                <return>
                    the Signature method URI                    
                </return>
            </javadoc>
            <method name="getSignatureMethodURI" type="String" line="312">
                <declaration name="signatureElement" type="Element" line="314"/>
                <scope line="316"/>
            </method>
            <javadoc line="323">
                Method getSignatureMethodElement                
                <return>
                    gets The SignatureMethod Node.                    
                </return>
            </javadoc>
            <method name="getSignatureMethodElement" type="Element" line="328"/>
            <javadoc line="332">
                Creates a SecretKey for the appropriate Mac algorithm based on a
                  byte[] array password.                
                <param>
                    secretKeyBytes                    
                </param>
                <return>
                    the secret key for the SignedInfo element.                    
                </return>
            </javadoc>
            <method name="createSecretKey" type="SecretKey" line="340">
                <params>
                    <param name="secretKeyBytes" type="byte[]"/>
                </params>
            </method>
            <method name="getSignatureAlgorithm" type="SignatureAlgorithm" line="347"/>
            <javadoc line="350">
                Method getBaseLocalName                
                <inheritDoc>
                                        
                </inheritDoc>
            </javadoc>
            <method name="getBaseLocalName" type="String" line="355"/>
            <method name="getInclusiveNamespaces" type="String" line="359">
                <declaration name="c14nMethodURI" type="String" line="363"/>
                <scope line="365"/>
                <declaration name="inclusiveElement" type="Element" line="369"/>
                <scope line="373">
                    <scope line="375">
                        <declaration name="inclusiveNamespaces" type="String" line="376"/>
                    </scope>
                    <scope line="381"/>
                </scope>
            </method>
        </class>
    </source>