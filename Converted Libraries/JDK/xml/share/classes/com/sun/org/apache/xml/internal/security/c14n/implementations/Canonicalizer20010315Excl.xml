<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security.c14n.implementations">
        <import package="java.io.IOException"/>
        <import package="java.util.Iterator"/>
        <import package="java.util.Set"/>
        <import package="java.util.SortedSet"/>
        <import package="java.util.TreeSet"/>
        <import package="javax.xml.parsers.ParserConfigurationException"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.CanonicalizationException"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.helper.C14nHelper"/>
        <import package="com.sun.org.apache.xml.internal.security.signature.XMLSignatureInput"/>
        <import package="com.sun.org.apache.xml.internal.security.transforms.params.InclusiveNamespaces"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.Constants"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.XMLUtils"/>
        <import package="org.w3c.dom.Attr"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.NamedNodeMap"/>
        <import package="org.w3c.dom.Node"/>
        <import package="org.xml.sax.SAXException"/>
        <class name="Canonicalizer20010315Excl" line="43">
            <extends class="CanonicalizerBase"/>
            <javadoc line="43">
                Implements &amp;quot; &lt;A
                  HREF=&quot;http://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718/&quot;&gt;Exclusive XML
                  Canonicalization, Version 1.0 &lt;/A&gt;&amp;quot; &lt;BR /&gt;
                  Credits: During restructuring of the Canonicalizer framework, Ren??
                  Kollmorgen from Software AG submitted an implementation of ExclC14n which
                  fitted into the old architecture and which based heavily on my old (and slow)
                  implementation of &quot;Canonical XML&quot;. A big &quot;thank you&quot; to Ren?? for this.
                  &lt;BR /&gt;
                  &lt;i&gt;THIS &lt;/i&gt; implementation is a complete rewrite of the algorithm.                
                <author>
                    Christian Geuer-Pollmann &lt;geuerp@apache.org&gt;                    
                </author>
                <version>
                    $Revision: 1.5 $                    
                </version>
                <see>
                    &lt;a href=&quot;http://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718/ Exclusive#&quot;&gt;
                               XML Canonicalization, Version 1.0&lt;/a&gt;                    
                </see>
            </javadoc>
            <declaration name="_inclusiveNSSet" type="TreeSet" line="60"/>
            <javadoc line="60">
                This Set contains the names (Strings like &quot;xmlns&quot; or &quot;xmlns:foo&quot;) of
                  the inclusive namespaces.                
            </javadoc>
            <declaration name="XMLNS_URI" type="String" line="65"/>
            <declaration name="result" type="SortedSet" line="66"/>
            <javadoc line="67">
                Constructor Canonicalizer20010315Excl                
                <param>
                    includeComments                    
                </param>
            </javadoc>
            <method name="Canonicalizer20010315Excl" type="constructor" line="72">
                <params>
                    <param name="includeComments" type="boolean"/>
                </params>
            </method>
            <javadoc line="76">
                Method engineCanonicalizeSubTree                
                <inheritDoc>
                                        
                </inheritDoc>
                <param>
                    rootNode                    
                </param>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="engineCanonicalizeSubTree" type="byte[]" line="84">
                <params>
                    <param name="rootNode" type="Node"/>
                </params>
            </method>
            <javadoc line="87">
                Method engineCanonicalizeSubTree                
                <inheritDoc>
                                        
                </inheritDoc>
                <param>
                    rootNode                    
                </param>
                <param>
                    inclusiveNamespaces                    
                </param>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="engineCanonicalizeSubTree" type="byte[]" line="96">
                <params>
                    <param name="rootNode" type="Node"/>
                    <param name="inclusiveNamespaces" type="String"/>
                </params>
            </method>
            <javadoc line="99">
                Method engineCanonicalizeSubTree                
                <param>
                    rootNode                    
                </param>
                <param>
                    inclusiveNamespaces                    
                </param>
                <param>
                    excl A element to exclude from the c14n process.                    
                </param>
                <return>
                    the rootNode c14n.                    
                </return>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="engineCanonicalizeSubTree" type="byte[]" line="108">
                <params>
                    <param name="rootNode" type="Node"/>
                    <param name="inclusiveNamespaces" type="String"/>
                    <param name="excl" type="Node"/>
                </params>
            </method>
            <javadoc line="113">
                @param rootNode                
                <param>
                    inclusiveNamespaces                    
                </param>
                <return>
                    the rootNode c14n.                    
                </return>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="engineCanonicalize" type="byte[]" line="121">
                <params>
                    <param name="rootNode" type="XMLSignatureInput"/>
                    <param name="inclusiveNamespaces" type="String"/>
                </params>
            </method>
            <javadoc line="127">
                Method handleAttributesSubtree                
                <inheritDoc>
                                        
                </inheritDoc>
                <param>
                    E                    
                </param>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="handleAttributesSubtree" type="Iterator" line="134">
                <params>
                    <param name="E" type="Element"/>
                    <param name="ns" type="NameSpaceSymbTable"/>
                </params>
                <comment line="136">
                    System.out.println(&quot;During the traversal, I encountered &quot; +
                     XMLUtils.getXPath(E));
                     result will contain the attrs which have to be outputted                    
                </comment>
                <comment line="148">
                    The prefix visibly utilized(in the attribute or in the name) in the element                    
                </comment>
                <comment line="155">
                    Not a namespace definition.
                    The Element is output element, add his prefix(if used) to visibyUtilized                    
                </comment>
                <comment line="161">
                    Add to the result.                    
                </comment>
                <comment line="169">
                    New definition check if it is relative.                    
                </comment>
                <comment line="190">
                    This can be optimezed by I don&apos;t have time                    
                </comment>
                <declaration name="result" type="SortedSet" line="138"/>
                <declaration name="attrs" type="NamedNodeMap" line="140"/>
                <declaration name="attrsLength" type="int" line="142"/>
                <scope line="143"/>
                <declaration name="visiblyUtilized" type="SortedSet" line="148"/>
                <scope line="150">
                    <declaration name="N" type="Attr" line="151"/>
                    <scope line="153">
                        <declaration name="prefix" type="String" line="156"/>
                        <scope line="157"/>
                    </scope>
                    <declaration name="NName" type="String" line="164"/>
                    <declaration name="NNodeValue" type="String" line="165"/>
                    <scope line="167">
                        <scope line="169">
                            <declaration name="exArgs" type="Object" line="170"/>
                        </scope>
                    </scope>
                </scope>
                <declaration name="prefix" type="String" line="177"/>
                <scope line="178">
                    <scope line="180"/>
                </scope>
                <scope line="184"/>
                <declaration name="it" type="Iterator" line="190"/>
                <scope line="191">
                    <declaration name="s" type="String" line="192"/>
                    <declaration name="key" type="Attr" line="193"/>
                    <scope line="194"/>
                </scope>
            </method>
            <javadoc line="203">
                Method engineCanonicalizeXPathNodeSet                
                <inheritDoc>
                                        
                </inheritDoc>
                <param>
                    xpathNodeSet                    
                </param>
                <param>
                    inclusiveNamespaces                    
                </param>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="engineCanonicalizeXPathNodeSet" type="byte[]" line="211">
                <params>
                    <param name="xpathNodeSet" type="Set"/>
                    <param name="inclusiveNamespaces" type="String"/>
                </params>
            </method>
            <javadoc line="220">
                @inheritDoc                
                <param>
                    E                    
                </param>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="handleAttributes" type="Iterator" line="226">
                <params>
                    <param name="E" type="Element"/>
                    <param name="ns" type="NameSpaceSymbTable"/>
                </params>
                <comment line="228">
                    result will contain the attrs which have to be outputted                    
                </comment>
                <comment line="237">
                    The prefix visibly utilized(in the attribute or in the name) in the element                    
                </comment>
                <comment line="239">
                    It&apos;s the output selected.                    
                </comment>
                <comment line="251">
                    The node is not in the nodeset(if there is a nodeset)                    
                </comment>
                <comment line="254">
                    Not a namespace definition.                    
                </comment>
                <comment line="256">
                    The Element is output element, add his prefix(if used) to visibyUtilized                    
                </comment>
                <comment line="261">
                    Add to the result.                    
                </comment>
                <comment line="288">
                    New definiton check if it is relative                    
                </comment>
                <comment line="299">
                    The element is visible, handle the xmlns definition                    
                </comment>
                <comment line="302">
                    There is a definition but the xmlns is not selected by the xpath.
                    then xmlns=&quot;&quot;                    
                </comment>
                <comment line="317">
                    This can be optimezed by I don&apos;t have time
                    visiblyUtilized.addAll(this._inclusiveNSSet);                    
                </comment>
                <declaration name="result" type="SortedSet" line="228"/>
                <declaration name="attrs" type="NamedNodeMap" line="230"/>
                <declaration name="attrsLength" type="int" line="231"/>
                <scope line="232"/>
                <declaration name="visiblyUtilized" type="Set" line="237"/>
                <declaration name="isOutputElement" type="boolean" line="239"/>
                <scope line="240"/>
                <scope line="244">
                    <declaration name="N" type="Attr" line="245"/>
                    <scope line="248">
                        <scope line="249"/>
                        <scope line="254">
                            <declaration name="prefix" type="String" line="256"/>
                            <scope line="257"/>
                        </scope>
                    </scope>
                    <declaration name="NName" type="String" line="265"/>
                    <scope line="266"/>
                    <declaration name="NNodeValue" type="String" line="270"/>
                    <scope line="272">
                        <declaration name="n" type="Node" line="273"/>
                        <scope line="274">
                            <scope line="276">
                                <declaration name="exArgs" type="Object" line="277"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="286">
                        <scope line="288">
                            <declaration name="exArgs" type="Object" line="289"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="297">
                    <declaration name="xmlns" type="Attr" line="299"/>
                    <scope line="300"/>
                    <scope line="306">
                        <declaration name="prefix" type="String" line="307"/>
                        <scope line="308"/>
                        <scope line="310"/>
                    </scope>
                    <scope line="313"/>
                    <declaration name="it" type="Iterator" line="318"/>
                    <scope line="319">
                        <declaration name="s" type="String" line="320"/>
                        <declaration name="key" type="Attr" line="321"/>
                        <scope line="322"/>
                    </scope>
                </scope>
            </method>
            <method name="circumventBugIfNeeded" type="void" line="331">
                <params>
                    <param name="input" type="XMLSignatureInput"/>
                </params>
                <declaration name="doc" type="Document" line="334"/>
                <scope line="335"/>
                <scope line="337"/>
            </method>
        </class>
    </source>