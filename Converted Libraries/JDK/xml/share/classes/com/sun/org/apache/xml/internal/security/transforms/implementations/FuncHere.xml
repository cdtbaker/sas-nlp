<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security.transforms.implementations">
        <import package="javax.xml.transform.TransformerException"/>
        <import package="com.sun.org.apache.xml.internal.dtm.DTM"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.I18n"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.XMLUtils"/>
        <import package="com.sun.org.apache.xpath.internal.NodeSetDTM"/>
        <import package="com.sun.org.apache.xpath.internal.XPathContext"/>
        <import package="com.sun.org.apache.xpath.internal.functions.Function"/>
        <import package="com.sun.org.apache.xpath.internal.objects.XNodeSet"/>
        <import package="com.sun.org.apache.xpath.internal.objects.XObject"/>
        <import package="com.sun.org.apache.xpath.internal.res.XPATHErrorResources"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Node"/>
        <class name="FuncHere" line="14">
            <extends class="Function"/>
            <javadoc line="14">
                The &apos;here()&apos; function returns a node-set containing the attribute or
                  processing instruction node or the parent element of the text node
                  that directly bears the XPath expression.  This expression results
                  in an error if the containing XPath expression does not appear in the
                  same XML document against which the XPath expression is being evaluated.
                  Mainpart is stolen from FuncId.java
                  This does crash under Xalan2.2.D7 and works under Xalan2.2.D9
                  To get this baby to work, a special trick has to be used. The function needs
                  access to the Node where the XPath expression has been defined. This is done
                  by constructing a {@link FuncHere} which has this Node as &apos;owner&apos;.                
                <see>
                    "http://www.w3.org/Signature/Drafts/xmldsig-core/Overview.html#function-here"                    
                </see>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="28"/>
            <javadoc line="28">
                                
            </javadoc>
            <javadoc line="31">
                The here function returns a node-set containing the attribute or
                  processing instruction node or the parent element of the text node
                  that directly bears the XPath expression.  This expression results
                  in an error if the containing XPath expression does not appear in the
                  same XML document against which the XPath expression is being evaluated.                
                <param>
                    xctxt                    
                </param>
                <return>
                    the xobject                    
                </return>
                <throws>
                    javax.xml.transform.TransformerException                    
                </throws>
            </javadoc>
            <method name="execute" type="XObject" line="41">
                <params>
                    <param name="xctxt" type="XPathContext"/>
                </params>
                <declaration name="xpathOwnerNode" type="Node" line="42"/>
                <scope line="43"/>
                <declaration name="xpathOwnerNodeDTM" type="int" line="46"/>
                <declaration name="currentNode" type="int" line="47"/>
                <declaration name="dtm" type="DTM" line="48"/>
                <declaration name="docContext" type="int" line="49"/>
                <scope line="50"/>
                <scope line="53">
                    <declaration name="currentDoc" type="Document" line="54"/>
                    <declaration name="xpathOwnerDoc" type="Document" line="55"/>
                    <scope line="56"/>
                </scope>
                <declaration name="nodes" type="XNodeSet" line="60"/>
                <declaration name="nodeSet" type="NodeSetDTM" line="61"/>
                <scope line="62">
                    <declaration name="hereNode" type="int" line="63"/>
                    <scope line="66"/>
                    <scope line="72"/>
                    <scope line="78"/>
                </scope>
            </method>
            <javadoc line="90">
                No arguments to process, so this does nothing.                
                <param>
                    vars                    
                </param>
                <param>
                    globalsSize                    
                </param>
            </javadoc>
            <method name="fixupVariables" type="void" line="95">
                <params>
                    <param name="vars" type="java.util.Vector"/>
                    <param name="globalsSize" type="int"/>
                </params>
            </method>
        </class>
    </source>