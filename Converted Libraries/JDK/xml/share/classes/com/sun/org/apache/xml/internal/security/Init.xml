<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security">
        <import package="java.io.InputStream"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.PrivilegedAction"/>
        <import package="javax.xml.parsers.DocumentBuilder"/>
        <import package="javax.xml.parsers.DocumentBuilderFactory"/>
        <import package="com.sun.org.apache.xml.internal.security.algorithms.JCEMapper"/>
        <import package="com.sun.org.apache.xml.internal.security.algorithms.SignatureAlgorithm"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.Canonicalizer"/>
        <import package="com.sun.org.apache.xml.internal.security.keys.KeyInfo"/>
        <import package="com.sun.org.apache.xml.internal.security.keys.keyresolver.KeyResolver"/>
        <import package="com.sun.org.apache.xml.internal.security.transforms.Transform"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.I18n"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.XMLUtils"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.resolver.ResourceResolver"/>
        <import package="org.w3c.dom.Attr"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.Node"/>
        <class name="Init" line="45">
            <javadoc line="45">
                This class does the configuration of the library. This includes creating
                  the mapping of Canonicalization and Transform algorithms. Initialization is
                  done by calling {@link Init#init} which should be done in any static block
                  of the files of this library. We ensure that this call is only executed once.                
                <author>
                    $Author: mullan $                    
                </author>
            </javadoc>
            <declaration name="log" type="java.util.logging.Logger" line="55"/>
            <javadoc line="55">
                {@link java.util.logging} logging facility                
            </javadoc>
            <declaration name="_alreadyInitialized" type="boolean" line="59"/>
            <javadoc line="59">
                Field _initialized                
            </javadoc>
            <declaration name="CONF_NS" type="String" line="62"/>
            <javadoc line="62">
                The namespace for CONF file                
            </javadoc>
            <javadoc line="65">
                Method isInitialized                
                <return>
                    true if the librairy is already initialized.                    
                </return>
            </javadoc>
            <method name="isInitialized" type="boolean" line="70"/>
            <javadoc line="74">
                Method init                
            </javadoc>
            <method name="init" type="void" line="78">
                <comment line="101">
                    PRNG.init(new java.security.SecureRandom());                    
                </comment>
                <comment line="105">
                                        
                </comment>
                <comment line="113">
                    We don&apos;t allow users to override the Apache XML Security                    
                </comment>
                <comment line="114">
                    configuration in the JRE. Users should use the standard security                    
                </comment>
                <comment line="115">
                    provider mechanism instead if implementing their own                    
                </comment>
                <comment line="116">
                    transform or canonicalization algorithms.                    
                </comment>
                <comment line="117">
                    InputStream is = Class.forName(&quot;com.sun.org.apache.xml.internal.security.Init&quot;).getResourceAsStream(&quot;resource/config.xml&quot;);                    
                </comment>
                <comment line="121">
                    String cfile = System.getProperty                    
                </comment>
                <comment line="122">
                    (&quot;com.sun.org.apache.xml.internal.security.resource.config&quot;);                    
                </comment>
                <comment line="124">
                    (cfile != null ? cfile : &quot;resource/config.xml&quot;);                    
                </comment>
                <comment line="161">
                                        
                </comment>
                <comment line="162">
                    Commented out: not supported in the JDK. We use the default locale.                    
                </comment>
                <comment line="163">
                                        
                </comment>
                <comment line="164">
                    if (tag.equals(&quot;ResourceBundles&quot;)){                    
                </comment>
                <comment line="165">
                    XX_configure_i18n_start = System.currentTimeMillis();                    
                </comment>
                <comment line="166">
                    Element resource=(Element)el;                    
                </comment>
                <comment line="167">
                    /* configure internationalization */                    
                </comment>
                <comment line="168">
                    Attr langAttr = resource.getAttributeNode(&quot;defaultLanguageCode&quot;);                    
                </comment>
                <comment line="169">
                    Attr countryAttr = resource.getAttributeNode(&quot;defaultCountryCode&quot;);                    
                </comment>
                <comment line="170">
                    String languageCode = (langAttr == null)                    
                </comment>
                <comment line="171">
                    ? null                    
                </comment>
                <comment line="172">
                    : langAttr.getNodeValue();                    
                </comment>
                <comment line="173">
                    String countryCode = (countryAttr == null)                    
                </comment>
                <comment line="174">
                    ? null                    
                </comment>
                <comment line="175">
                    : countryAttr.getNodeValue();                    
                </comment>
                <comment line="176">
                                        
                </comment>
                <comment line="177">
                    I18n.init(languageCode, countryCode);                    
                </comment>
                <comment line="178">
                    XX_configure_i18n_end = System.currentTimeMillis();                    
                </comment>
                <comment line="179">
                    }                    
                </comment>
                <comment line="194">
                    Method methods[] = c.getMethods();
                    
                    for (int j = 0; j &lt; methods.length; j++) {
                    Method currMeth = methods[j];
                    
                    if (currMeth.getDeclaringClass().getName()
                    .equals(JAVACLASS)) {
                    log.log(java.util.logging.Level.FINE, currMeth.getDe claringClass().toString());
                    }                    
                </comment>
                <comment line="271">
                                        
                </comment>
                <comment line="275">
                    Method methods[] = c.getMethods();                    
                </comment>
                <comment line="277">
                    for (int j = 0; j &lt; methods.length; j++) {                    
                </comment>
                <comment line="278">
                    Method currMeth = methods[j];                    
                </comment>
                <comment line="279">
                                        
                </comment>
                <comment line="280">
                    if (currMeth.getDeclaringClass().getName()                    
                </comment>
                <comment line="281">
                    .equals(JAVACLASS)) {                    
                </comment>
                <comment line="282">
                    log.log(java.util.logging.Level.FINE, currMeth.getDe claringClass().toString());                    
                </comment>
                <comment line="283">
                    }                    
                </comment>
                <comment line="284">
                    }                    
                </comment>
                <comment line="390">
                    J-                    
                </comment>
                <scope line="80"/>
                <declaration name="XX_configure_i18n_end" type="long" line="83"/>
                <declaration name="XX_configure_reg_c14n_start" type="long" line="84"/>
                <declaration name="XX_configure_reg_c14n_end" type="long" line="85"/>
                <declaration name="XX_configure_reg_jcemapper_end" type="long" line="86"/>
                <declaration name="XX_configure_reg_keyInfo_start" type="long" line="87"/>
                <declaration name="XX_configure_reg_keyResolver_end" type="long" line="88"/>
                <declaration name="XX_configure_reg_prefixes_start" type="long" line="89"/>
                <declaration name="XX_configure_reg_resourceresolver_start" type="long" line="90"/>
                <declaration name="XX_configure_reg_sigalgos_end" type="long" line="91"/>
                <declaration name="XX_configure_reg_transforms_end" type="long" line="92"/>
                <declaration name="XX_configure_reg_keyInfo_end" type="long" line="93"/>
                <declaration name="XX_configure_reg_keyResolver_start" type="long" line="94"/>
                <scope line="97">
                    <declaration name="XX_init_start" type="long" line="98"/>
                    <declaration name="XX_prng_start" type="long" line="99"/>
                    <declaration name="XX_prng_end" type="long" line="103"/>
                    <declaration name="XX_parsing_start" type="long" line="106"/>
                    <declaration name="dbf" type="DocumentBuilderFactory" line="107"/>
                    <declaration name="db" type="DocumentBuilder" line="112"/>
                    <anonymous_class line="119">
                        <method name="run" type="Object" line="120">
                            <comment line="121">
                                String cfile = System.getProperty                                
                            </comment>
                            <comment line="122">
                                (&quot;com.sun.org.apache.xml.internal.security.resource.config&quot;);                                
                            </comment>
                            <comment line="124">
                                (cfile != null ? cfile : &quot;resource/config.xml&quot;);                                
                            </comment>
                        </method>
                    </anonymous_class>
                    <declaration name="is" type="InputStream" line="118"/>
                    <declaration name="doc" type="Document" line="129"/>
                    <declaration name="XX_parsing_end" type="long" line="130"/>
                    <declaration name="XX_configure_i18n_start" type="long" line="131"/>
                    <scope line="133">
                        <scope line="135"/>
                        <scope line="137"/>
                    </scope>
                    <declaration name="XX_configure_reg_transforms_start" type="long" line="145"/>
                    <declaration name="XX_configure_reg_jcemapper_start" type="long" line="146"/>
                    <declaration name="XX_configure_reg_sigalgos_start" type="long" line="147"/>
                    <declaration name="XX_configure_reg_resourceresolver_end" type="long" line="148"/>
                    <declaration name="XX_configure_reg_prefixes_end" type="long" line="149"/>
                    <declaration name="config" type="Node" line="150"/>
                    <scope line="151">
                        <scope line="152"/>
                    </scope>
                    <scope line="156">
                        <scope line="157"/>
                        <declaration name="tag" type="String" line="160"/>
                        <scope line="181">
                            <declaration name="list" type="Element[]" line="184"/>
                            <scope line="186">
                                <declaration name="URI" type="String" line="187"/>
                                <declaration name="JAVACLASS" type="String" line="189"/>
                                <scope line="192"/>
                                <scope line="208">
                                    <declaration name="exArgs" type="Object" line="209"/>
                                </scope>
                            </scope>
                        </scope>
                        <scope line="218">
                            <declaration name="tranElem" type="Element[]" line="222"/>
                            <scope line="224">
                                <declaration name="URI" type="String" line="225"/>
                                <declaration name="JAVACLASS" type="String" line="227"/>
                                <scope line="230"/>
                                <scope line="235">
                                    <declaration name="exArgs" type="Object" line="236"/>
                                </scope>
                                <scope line="241"/>
                            </scope>
                        </scope>
                        <scope line="249"/>
                        <scope line="257">
                            <declaration name="sigElems" type="Element[]" line="261"/>
                            <scope line="264">
                                <declaration name="URI" type="String" line="265"/>
                                <declaration name="JAVACLASS" type="String" line="267"/>
                                <scope line="273"/>
                                <scope line="288">
                                    <declaration name="exArgs" type="Object" line="289"/>
                                </scope>
                            </scope>
                        </scope>
                        <scope line="301">
                            <declaration name="resolverElem" type="Element[]" line="305"/>
                            <scope line="308">
                                <declaration name="JAVACLASS" type="String" line="309"/>
                                <declaration name="Description" type="String" line="312"/>
                                <scope line="316"/>
                                <scope line="319"/>
                                <scope line="323"/>
                                <scope line="325"/>
                            </scope>
                        </scope>
                        <scope line="339">
                            <declaration name="resolverElem" type="Element[]" line="343"/>
                            <scope line="345">
                                <declaration name="JAVACLASS" type="String" line="346"/>
                                <declaration name="Description" type="String" line="349"/>
                                <scope line="353"/>
                                <scope line="356"/>
                            </scope>
                        </scope>
                        <scope line="367">
                            <declaration name="nl" type="Element[]" line="372"/>
                            <scope line="374">
                                <declaration name="namespace" type="String" line="375"/>
                                <declaration name="prefix" type="String" line="377"/>
                            </scope>
                        </scope>
                    </scope>
                    <declaration name="XX_init_end" type="long" line="388"/>
                    <scope line="391"/>
                </scope>
                <scope line="405"/>
            </method>
        </class>
    </source>