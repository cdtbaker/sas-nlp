<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.org.apache.xml.internal.security.c14n.implementations">
        <import package="java.io.IOException"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.Collection"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.Iterator"/>
        <import package="java.util.List"/>
        <import package="java.util.Map"/>
        <import package="java.util.Set"/>
        <import package="java.util.SortedSet"/>
        <import package="java.util.TreeSet"/>
        <import package="javax.xml.parsers.ParserConfigurationException"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.CanonicalizationException"/>
        <import package="com.sun.org.apache.xml.internal.security.c14n.helper.C14nHelper"/>
        <import package="com.sun.org.apache.xml.internal.security.signature.XMLSignatureInput"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.Constants"/>
        <import package="com.sun.org.apache.xml.internal.security.utils.XMLUtils"/>
        <import package="org.w3c.dom.Attr"/>
        <import package="org.w3c.dom.Document"/>
        <import package="org.w3c.dom.Element"/>
        <import package="org.w3c.dom.NamedNodeMap"/>
        <import package="org.w3c.dom.Node"/>
        <import package="org.xml.sax.SAXException"/>
        <class name="Canonicalizer20010315" line="51">
            <extends class="CanonicalizerBase"/>
            <javadoc line="51">
                Implements &lt;A HREF=&quot;http://www.w3.org/TR/2001/REC-xml-c14n-20010315&quot;&gt;Canonical
                  XML Version 1.0&lt;/A&gt;, a W3C Recommendation from 15 March 2001.                
                <author>
                    Christian Geuer-Pollmann <geuerp@apache.org>                    
                </author>
                <version>
                    $Revision: 1.5 $                    
                </version>
            </javadoc>
            <declaration name="firstCall" type="boolean" line="59"/>
            <declaration name="result" type="SortedSet" line="60"/>
            <declaration name="XMLNS_URI" type="String" line="61"/>
            <declaration name="XML_LANG_URI" type="String" line="62"/>
            <class name="XmlAttrStack" line="63">
                <declaration name="currentLevel" type="int" line="64"/>
                <declaration name="lastlevel" type="int" line="65"/>
                <declaration name="cur" type="XmlsStackElement" line="66"/>
                <class name="XmlsStackElement" line="67">
                    <declaration name="level" type="int" line="68"/>
                    <declaration name="rendered" type="boolean" line="69"/>
                    <declaration name="nodes" type="List" line="70"/>
                </class>
                <declaration name="levels" type="List" line="72"/>
                <method name="push" type="void" line="73">
                    <params>
                        <param name="level" type="int"/>
                    </params>
                    <scope line="78">
                        <scope line="80"/>
                    </scope>
                </method>
                <method name="addXmlnsAttr" type="void" line="87">
                    <params>
                        <param name="n" type="Attr"/>
                    </params>
                    <scope line="88"/>
                </method>
                <method name="getXmlnsAttr" type="void" line="96">
                    <params>
                        <param name="col" type="Collection"/>
                    </params>
                    <comment line="129">
                        if (e.rendered)                        
                    </comment>
                    <comment line="130">
                        break;                        
                    </comment>
                    <comment line="133">
                        cur.nodes.clear();                        
                    </comment>
                    <comment line="134">
                        cur.nodes.addAll(loa.values());                        
                    </comment>
                    <declaration name="size" type="int" line="97"/>
                    <scope line="98"/>
                    <declaration name="parentRendered" type="boolean" line="104"/>
                    <declaration name="e" type="XmlsStackElement" line="105"/>
                    <scope line="106"/>
                    <scope line="108"/>
                    <scope line="114"/>
                    <declaration name="loa" type="Map" line="120"/>
                    <scope line="121">
                        <declaration name="it" type="Iterator" line="123"/>
                        <scope line="124">
                            <declaration name="n" type="Attr" line="125"/>
                        </scope>
                    </scope>
                </method>
            </class>
            <declaration name="xmlattrStack" type="XmlAttrStack" line="140"/>
            <javadoc line="141">
                Constructor Canonicalizer20010315                
                <param>
                    includeComments                    
                </param>
            </javadoc>
            <method name="Canonicalizer20010315" type="constructor" line="146">
                <params>
                    <param name="includeComments" type="boolean"/>
                </params>
            </method>
            <javadoc line="150">
                Returns the Attr[]s to be outputted for the given element.
                  &lt;br&gt;
                  The code of this method is a copy of {@link #handleAttributes(Element,NameSpaceSymbTable)},
                  whereas it takes into account that subtree-c14n is -- well -- subtree-based.
                  So if the element in question isRoot of c14n, it&apos;s parent is not in the
                  node set, as well as all other ancestors.                
                <param>
                    E                    
                </param>
                <param>
                    ns                    
                </param>
                <return>
                    the Attr[]s to be outputted                    
                </return>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="handleAttributesSubtree" type="Iterator" line="165">
                <params>
                    <param name="E" type="Element"/>
                    <param name="ns" type="NameSpaceSymbTable"/>
                </params>
                <comment line="169">
                    result will contain the attrs which have to be outputted                    
                </comment>
                <comment line="180">
                    It&apos;s not a namespace attr node. Add to the result and continue.                    
                </comment>
                <comment line="189">
                    The default mapping for xml must not be output.                    
                </comment>
                <comment line="196">
                    Render the ns definition                    
                </comment>
                <comment line="207">
                    It is the first node of the subtree                    
                </comment>
                <comment line="208">
                    Obtain all the namespaces defined in the parents, and added to the output.                    
                </comment>
                <comment line="210">
                    output the attributes in the xml namespace.                    
                </comment>
                <scope line="166"/>
                <declaration name="result" type="SortedSet" line="170"/>
                <declaration name="attrs" type="NamedNodeMap" line="172"/>
                <declaration name="attrsLength" type="int" line="173"/>
                <scope line="175">
                    <declaration name="N" type="Attr" line="176"/>
                    <declaration name="NUri" type="String" line="177"/>
                    <scope line="179"/>
                    <declaration name="NName" type="String" line="185"/>
                    <declaration name="NValue" type="String" line="186"/>
                    <scope line="188"/>
                    <declaration name="n" type="Node" line="193"/>
                    <scope line="195">
                        <scope line="198">
                            <declaration name="exArgs" type="Object" line="199"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="206"/>
            </method>
            <javadoc line="218">
                Returns the Attr[]s to be outputted for the given element.
                  &lt;br&gt;
                  IMPORTANT: This method expects to work on a modified DOM tree, i.e. a DOM which has
                  been prepared using {@link com.sun.org.apache.xml.internal.security.utils.XMLUtils#circumventBug2650(org.w3c.dom.Document)}.                
                <param>
                    E                    
                </param>
                <param>
                    ns                    
                </param>
                <return>
                    the Attr[]s to be outputted                    
                </return>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="handleAttributes" type="Iterator" line="230">
                <params>
                    <param name="E" type="Element"/>
                    <param name="ns" type="NameSpaceSymbTable"/>
                </params>
                <comment line="231">
                    result will contain the attrs which have to be outputted                    
                </comment>
                <comment line="250">
                    A non namespace definition node.                    
                </comment>
                <comment line="254">
                    The node is visible add the attribute to the list of output attributes.                    
                </comment>
                <comment line="257">
                    keep working                    
                </comment>
                <comment line="265">
                    except omit namespace node with local name xml, which defines
                     the xml prefix, if its string value is http:www.w3.orgXML1998namespace.                    
                </comment>
                <comment line="270">
                    add the prefix binding to the ns symb table.                    
                </comment>
                <comment line="271">
                    ns.addInclusiveMapping(NName,NValue,N,isRealVisible);                    
                </comment>
                <comment line="276">
                    The xpath select this node output it if needed.                    
                </comment>
                <comment line="277">
                    Node n=ns.addMappingAndRenderXNodeSet(NName,NValue,N,isRealVisible);                    
                </comment>
                <comment line="296">
                    The element is visible, handle the xmlns definition                    
                </comment>
                <comment line="300">
                    No xmlns def just get the already defined.                    
                </comment>
                <comment line="303">
                    There is a definition but the xmlns is not selected by the xpath.                    
                </comment>
                <comment line="304">
                    then xmlns=&quot;&quot;                    
                </comment>
                <comment line="307">
                    output the xmlns def if needed.                    
                </comment>
                <comment line="311">
                    Float all xml:* attributes of the unselected parent elements to this one.                    
                </comment>
                <comment line="312">
                    addXmlAttributes(E,result);                    
                </comment>
                <declaration name="isRealVisible" type="boolean" line="233"/>
                <declaration name="attrs" type="NamedNodeMap" line="234"/>
                <declaration name="attrsLength" type="int" line="235"/>
                <scope line="236"/>
                <declaration name="result" type="SortedSet" line="242"/>
                <scope line="245">
                    <declaration name="N" type="Attr" line="246"/>
                    <declaration name="NUri" type="String" line="247"/>
                    <scope line="249">
                        <scope line="251"/>
                        <scope line="253"/>
                    </scope>
                    <declaration name="NName" type="String" line="261"/>
                    <declaration name="NValue" type="String" line="262"/>
                    <scope line="264"/>
                    <scope line="272">
                        <scope line="273"/>
                        <declaration name="n" type="Node" line="278"/>
                        <scope line="279">
                            <scope line="281">
                                <declaration name="exArgs" type="Object" line="282"/>
                            </scope>
                        </scope>
                    </scope>
                    <scope line="287">
                        <scope line="288"/>
                        <scope line="290"/>
                    </scope>
                </scope>
                <scope line="295">
                    <declaration name="xmlns" type="Attr" line="297"/>
                    <declaration name="n" type="Node" line="298"/>
                    <scope line="299"/>
                    <scope line="302"/>
                    <scope line="308"/>
                </scope>
            </method>
            <javadoc line="320">
                Always throws a CanonicalizationException because this is inclusive c14n.                
                <param>
                    xpathNodeSet                    
                </param>
                <param>
                    inclusiveNamespaces                    
                </param>
                <return>
                    none it always fails                    
                </return>
                <throws>
                    CanonicalizationException always                    
                </throws>
            </javadoc>
            <method name="engineCanonicalizeXPathNodeSet" type="byte[]" line="329">
                <params>
                    <param name="xpathNodeSet" type="Set"/>
                    <param name="inclusiveNamespaces" type="String"/>
                </params>
                <comment line="331">
                                        
                </comment>
            </method>
            <javadoc line="336">
                Always throws a CanonicalizationException because this is inclusive c14n.                
                <param>
                    rootNode                    
                </param>
                <param>
                    inclusiveNamespaces                    
                </param>
                <return>
                    none it always fails                    
                </return>
                <throws>
                    CanonicalizationException                    
                </throws>
            </javadoc>
            <method name="engineCanonicalizeSubTree" type="byte[]" line="345">
                <params>
                    <param name="rootNode" type="Node"/>
                    <param name="inclusiveNamespaces" type="String"/>
                </params>
                <comment line="347">
                                        
                </comment>
            </method>
            <method name="circumventBugIfNeeded" type="void" line="351">
                <params>
                    <param name="input" type="XMLSignatureInput"/>
                </params>
                <declaration name="doc" type="Document" line="354"/>
                <scope line="355"/>
                <scope line="357"/>
            </method>
            <method name="handleParent" type="void" line="364">
                <params>
                    <param name="e" type="Element"/>
                    <param name="ns" type="NameSpaceSymbTable"/>
                </params>
                <comment line="374">
                    Not a namespace definition, ignore.                    
                </comment>
                <scope line="365"/>
                <declaration name="attrs" type="NamedNodeMap" line="369"/>
                <declaration name="attrsLength" type="int" line="370"/>
                <scope line="371">
                    <declaration name="N" type="Attr" line="372"/>
                    <scope line="373">
                        <scope line="375"/>
                    </scope>
                    <declaration name="NName" type="String" line="381"/>
                    <declaration name="NValue" type="String" line="382"/>
                    <scope line="384"/>
                </scope>
            </method>
        </class>
    </source>