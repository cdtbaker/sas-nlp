<?xml version="1.0" encoding="UTF-8"?>
    <source package="java.util.jar">
        <import package="java.io"/>
        <import package="java.net.URL"/>
        <import package="java.util"/>
        <import package="java.security"/>
        <import package="java.security.cert.CertificateException"/>
        <import package="java.util.zip.ZipEntry"/>
        <import package="sun.security.util.ManifestDigester"/>
        <import package="sun.security.util.ManifestEntryVerifier"/>
        <import package="sun.security.util.SignatureFileVerifier"/>
        <import package="sun.security.util.Debug"/>
        <class name="JarVerifier" line="12">
            <javadoc line="12">
                @author      Roland Schemers                
            </javadoc>
            <declaration name="debug" type="Debug" line="16"/>
            <declaration name="verifiedSigners" type="Hashtable" line="17"/>
            <declaration name="sigFileSigners" type="Hashtable" line="18"/>
            <declaration name="sigFileData" type="Hashtable" line="19"/>
            <declaration name="pendingBlocks" type="ArrayList" line="20"/>
            <javadoc line="20">
                &quot;queue&quot; of pending PKCS7 blocks that we couldn&apos;t parse
                  until we parsed the .SF file                
            </javadoc>
            <declaration name="signerCache" type="ArrayList" line="25"/>
            <declaration name="parsingBlockOrSF" type="boolean" line="26"/>
            <declaration name="parsingMeta" type="boolean" line="27"/>
            <declaration name="anyToVerify" type="boolean" line="28"/>
            <declaration name="baos" type="ByteArrayOutputStream" line="29"/>
            <declaration name="manDig" type="ManifestDigester" line="30"/>
            <javadoc line="30">
                The ManifestDigester object                
            </javadoc>
            <declaration name="manifestRawBytes" type="byte" line="34"/>
            <javadoc line="34">
                the bytes for the manDig object                
            </javadoc>
            <declaration name="eagerValidation" type="boolean" line="38"/>
            <javadoc line="38">
                controls eager signature validation                
            </javadoc>
            <declaration name="csdomain" type="Object" line="42"/>
            <javadoc line="42">
                makes code source singleton instances unique to us                
            </javadoc>
            <declaration name="manifestDigests" type="List" line="46"/>
            <javadoc line="46">
                collect -DIGEST-MANIFEST values for blacklist                
            </javadoc>
            <method name="JarVerifier" type="constructor" line="50">
                <params>
                    <param name="rawBytes" type="byte"/>
                </params>
            </method>
            <javadoc line="59">
                This method scans to see which entry we&apos;re parsing and
                  keeps various state information depending on what type of
                  file is being parsed.                
            </javadoc>
            <method name="beginEntry" type="void" line="64">
                <params>
                    <param name="je" type="JarEntry"/>
                    <param name="mev" type="ManifestEntryVerifier"/>
                </params>
                <scope line="66"/>
                <declaration name="name" type="String" line="69"/>
                <scope line="70">
                    <declaration name="uname" type="String" line="71"/>
                    <scope line="72">
                        <scope line="73"/>
                        <scope line="77"/>
                    </scope>
                </scope>
                <scope line="85"/>
                <scope line="88"/>
                <scope line="94"/>
            </method>
            <javadoc line="101">
                update a single byte.                
            </javadoc>
            <method name="update" type="void" line="104">
                <params>
                    <param name="b" type="int"/>
                    <param name="mev" type="ManifestEntryVerifier"/>
                </params>
                <scope line="105">
                    <scope line="106"/>
                    <scope line="109"/>
                </scope>
                <scope line="113"/>
            </method>
            <javadoc line="117">
                update an array of bytes.                
            </javadoc>
            <method name="update" type="void" line="120">
                <params>
                    <param name="n" type="int"/>
                    <param name="b" type="byte[]"/>
                    <param name="off" type="int"/>
                    <param name="len" type="int"/>
                    <param name="mev" type="ManifestEntryVerifier"/>
                </params>
                <scope line="121">
                    <scope line="122"/>
                    <scope line="125"/>
                </scope>
                <scope line="129"/>
            </method>
            <javadoc line="133">
                called when we reach the end of entry in one of the read() methods.                
            </javadoc>
            <method name="processEntry" type="void" line="136">
                <params>
                    <param name="mev" type="ManifestEntryVerifier"/>
                </params>
                <scope line="137">
                    <declaration name="je" type="JarEntry" line="138"/>
                    <scope line="139"/>
                </scope>
                <scope line="144">
                    <scope line="145">
                        <scope line="147"/>
                        <declaration name="uname" type="String" line="150"/>
                        <scope line="151">
                            <declaration name="key" type="String" line="152"/>
                            <declaration name="bytes" type="byte" line="153"/>
                            <declaration name="it" type="Iterator" line="155"/>
                            <scope line="156">
                                <declaration name="sfv" type="SignatureFileVerifier" line="157"/>
                                <scope line="158">
                                    <scope line="159"/>
                                </scope>
                            </scope>
                        </scope>
                        <declaration name="key" type="String" line="168"/>
                        <scope line="170">
                            <scope line="171">
                                <scope line="172"/>
                            </scope>
                        </scope>
                        <declaration name="sfv" type="SignatureFileVerifier" line="178"/>
                        <scope line="179">
                            <declaration name="bytes" type="byte[]" line="180"/>
                            <scope line="181">
                                <scope line="182"/>
                            </scope>
                            <scope line="188"/>
                        </scope>
                    </scope>
                    <scope line="194"/>
                    <scope line="197"/>
                    <scope line="200"/>
                    <scope line="203"/>
                </scope>
            </method>
            <javadoc line="208">
                Return an array of java.security.cert.Certificate objects for
                  the given file in the jar.                
                <deprecated>
                                        
                </deprecated>
            </javadoc>
            <method name="getCerts" type="java.security.cert.Certificate[]" line="213">
                <params>
                    <param name="name" type="String"/>
                </params>
            </method>
            <method name="getCerts" type="java.security.cert.Certificate[]" line="216">
                <params>
                    <param name="jar" type="JarFile"/>
                    <param name="entry" type="JarEntry"/>
                </params>
            </method>
            <javadoc line="219">
                return an array of CodeSigner objects for
                  the given file in the jar. this array is not cloned.                
            </javadoc>
            <method name="getCodeSigners" type="CodeSigner[]" line="223">
                <params>
                    <param name="name" type="String"/>
                </params>
            </method>
            <method name="getCodeSigners" type="CodeSigner[]" line="226">
                <params>
                    <param name="jar" type="JarFile"/>
                    <param name="entry" type="JarEntry"/>
                </params>
                <declaration name="name" type="String" line="227"/>
                <scope line="228">
                    <scope line="229">
                        <declaration name="s" type="InputStream" line="230"/>
                        <declaration name="buffer" type="byte[]" line="231"/>
                        <declaration name="n" type="int" line="232"/>
                        <scope line="233"/>
                    </scope>
                    <scope line="238"/>
                </scope>
            </method>
            <method name="mapSignersToCertArray" type="java.security.cert.Certificate[]" line="243">
                <params>
                    <param name="signers" type="CodeSigner[]"/>
                </params>
                <scope line="244">
                    <declaration name="certChains" type="ArrayList" line="245"/>
                    <scope line="246"/>
                </scope>
            </method>
            <javadoc line="253">
                returns true if there no files to verify.
                  should only be called after all the META-INF entries
                  have been processed.                
            </javadoc>
            <method name="nothingToVerify" type="boolean" line="258"/>
            <javadoc line="261">
                called to let us know we have processed all the
                  META-INF entries, and if we re-read one of them, don&apos;t
                  re-process it. Also gets rid of any data structures
                  we needed when parsing META-INF entries.                
            </javadoc>
            <method name="doneWithMeta" type="void" line="267">
                <scope line="275"/>
            </method>
            <class name="VerifierStream" line="279">
                <extends class="java.io.InputStream"/>
                <declaration name="is" type="InputStream" line="280"/>
                <declaration name="jv" type="JarVerifier" line="281"/>
                <declaration name="mev" type="ManifestEntryVerifier" line="282"/>
                <declaration name="numLeft" type="long" line="283"/>
                <method name="VerifierStream" type="constructor" line="284">
                    <params>
                        <param name="man" type="Manifest"/>
                        <param name="je" type="JarEntry"/>
                        <param name="is" type="InputStream"/>
                        <param name="jv" type="JarVerifier"/>
                    </params>
                </method>
                <method name="read" type="int" line="292">
                    <scope line="293">
                        <declaration name="b" type="int" line="294"/>
                    </scope>
                    <scope line="300"/>
                </method>
                <method name="read" type="int" line="304">
                    <params>
                        <param name="b" type="byte"/>
                        <param name="off" type="int"/>
                        <param name="len" type="int"/>
                    </params>
                    <scope line="305"/>
                    <scope line="308">
                        <declaration name="n" type="int" line="309"/>
                    </scope>
                    <scope line="315"/>
                </method>
                <method name="close" type="void" line="319"/>
                <method name="available" type="int" line="325"/>
            </class>
            <declaration name="urlToCodeSourceMap" type="Map" line="329"/>
            <declaration name="signerToCodeSource" type="Map" line="330"/>
            <declaration name="lastURL" type="URL" line="331"/>
            <declaration name="lastURLMap" type="Map" line="332"/>
            <method name="mapSignersToCodeSource" type="CodeSource" line="333">
                <params>
                    <param name="url" type="URL"/>
                    <param name="signers" type="CodeSigner[]"/>
                </params>
                <declaration name="map" type="Map" line="334"/>
                <scope line="335"/>
                <scope line="338">
                    <scope line="340"/>
                </scope>
                <declaration name="cs" type="CodeSource" line="347"/>
                <scope line="348"/>
            </method>
            <method name="mapSignersToCodeSources" type="CodeSource[]" line="354">
                <params>
                    <param name="url" type="URL"/>
                    <param name="signers" type="List"/>
                    <param name="unsigned" type="boolean"/>
                </params>
                <declaration name="sources" type="List" line="355"/>
                <scope line="356"/>
                <scope line="359"/>
            </method>
            <declaration name="emptySigner" type="CodeSigner[]" line="364"/>
            <method name="findMatchingSigners" type="CodeSigner[]" line="365">
                <params>
                    <param name="cs" type="CodeSource"/>
                </params>
                <scope line="366">
                    <declaration name="vcs" type="VerifierCodeSource" line="367"/>
                    <scope line="368"/>
                </scope>
                <declaration name="sources" type="CodeSource[]" line="372"/>
                <declaration name="sourceList" type="List" line="373"/>
                <scope line="374"/>
                <declaration name="j" type="int" line="377"/>
                <scope line="378">
                    <declaration name="match" type="CodeSigner[]" line="379"/>
                    <scope line="381"/>
                </scope>
            </method>
            <class name="VerifierCodeSource" line="388">
                <extends class="CodeSource"/>
                <declaration name="vlocation" type="URL" line="389"/>
                <declaration name="vsigners" type="CodeSigner[]" line="390"/>
                <declaration name="vcerts" type="java.security.cert.Certificate[]" line="391"/>
                <declaration name="csdomain" type="Object" line="392"/>
                <method name="VerifierCodeSource" type="constructor" line="393">
                    <params>
                        <param name="csdomain" type="Object"/>
                        <param name="location" type="URL"/>
                        <param name="signers" type="CodeSigner[]"/>
                    </params>
                </method>
                <method name="VerifierCodeSource" type="constructor" line="399">
                    <params>
                        <param name="csdomain" type="Object"/>
                        <param name="location" type="URL"/>
                        <param name="certs" type="java.security.cert.Certificate[]"/>
                    </params>
                </method>
                <method name="equals" type="boolean" line="405">
                    <params>
                        <param name="obj" type="Object"/>
                    </params>
                    <scope line="406"/>
                    <scope line="409">
                        <declaration name="that" type="VerifierCodeSource" line="410"/>
                        <scope line="411">
                            <scope line="412"/>
                            <scope line="415"/>
                            <scope line="418"/>
                            <scope line="421"/>
                        </scope>
                    </scope>
                </method>
                <method name="isSameDomain" type="boolean" line="428">
                    <params>
                        <param name="csdomain" type="Object"/>
                    </params>
                </method>
                <method name="getPrivateSigners" type="CodeSigner[]" line="431"/>
                <method name="getPrivateCertificates" type="java.security.cert.Certificate[]" line="434"/>
            </class>
            <declaration name="signerMap" type="Map" line="438"/>
            <method name="signerMap" type="Map" line="439">
                <scope line="440"/>
            </method>
            <method name="entryNames" type="Enumeration&lt;String&gt;" line="447">
                <params>
                    <param name="jar" type="JarFile"/>
                    <param name="cs" type="CodeSource[]"/>
                </params>
                <declaration name="map" type="Map" line="448"/>
                <declaration name="itor" type="Iterator" line="449"/>
                <declaration name="matchUnsigned" type="boolean" line="450"/>
                <declaration name="req" type="List" line="451"/>
                <scope line="452">
                    <declaration name="match" type="CodeSigner[]" line="453"/>
                    <scope line="454">
                        <scope line="455"/>
                        <scope line="458"/>
                    </scope>
                </scope>
                <declaration name="signersReq" type="List" line="463"/>
                <declaration name="enum2" type="Enumeration" line="464"/>
                <anonymous_class line="465">
                    <declaration name="name" type="String" line="466"/>
                    <method name="hasMoreElements" type="boolean" line="467">
                        <scope line="468"/>
                        <scope line="471">
                            <declaration name="e" type="Map.Entry" line="472"/>
                            <scope line="473"/>
                        </scope>
                        <scope line="478"/>
                    </method>
                    <method name="nextElement" type="String" line="484">
                        <scope line="485">
                            <declaration name="value" type="String" line="486"/>
                        </scope>
                    </method>
                </anonymous_class>
            </method>
            <method name="entries2" type="Enumeration&lt;JarEntry&gt;" line="495">
                <params>
                    <param name="jar" type="JarFile"/>
                    <param name="e" type="Enumeration"/>
                </params>
                <declaration name="map" type="Map" line="496"/>
                <declaration name="enum_" type="Enumeration" line="498"/>
                <anonymous_class line="499">
                    <declaration name="signers" type="Enumeration" line="500"/>
                    <declaration name="entry" type="JarEntry" line="501"/>
                    <method name="hasMoreElements" type="boolean" line="502">
                        <scope line="503"/>
                        <scope line="506">
                            <declaration name="ze" type="ZipEntry" line="507"/>
                            <scope line="508"/>
                        </scope>
                        <scope line="514"/>
                        <scope line="517">
                            <declaration name="name" type="String" line="518"/>
                        </scope>
                    </method>
                    <method name="nextElement" type="JarEntry" line="524">
                        <scope line="525">
                            <declaration name="je" type="JarEntry" line="526"/>
                        </scope>
                    </method>
                </anonymous_class>
            </method>
            <declaration name="emptyEnumeration" type="Enumeration" line="536"/>
            <anonymous_class line="536">
                <method name="hasMoreElements" type="boolean" line="537"/>
                <method name="nextElement" type="String" line="540"/>
            </anonymous_class>
            <method name="isSigningRelated" type="boolean" line="545">
                <params>
                    <param name="name" type="String"/>
                </params>
                <scope line="547"/>
                <scope line="551"/>
                <scope line="554"/>
            </method>
            <method name="unsignedEntryNames" type="Enumeration&lt;String&gt;" line="559">
                <params>
                    <param name="jar" type="JarFile"/>
                </params>
                <declaration name="map" type="Map" line="560"/>
                <declaration name="entries" type="Enumeration" line="561"/>
                <anonymous_class line="562">
                    <declaration name="name" type="String" line="563"/>
                    <method name="hasMoreElements" type="boolean" line="564">
                        <scope line="565"/>
                        <scope line="568">
                            <declaration name="value" type="String" line="569"/>
                            <declaration name="e" type="ZipEntry" line="570"/>
                            <scope line="572"/>
                            <scope line="575"/>
                        </scope>
                    </method>
                    <method name="nextElement" type="String" line="582">
                        <scope line="583">
                            <declaration name="value" type="String" line="584"/>
                        </scope>
                    </method>
                </anonymous_class>
            </method>
            <declaration name="jarCodeSigners" type="List" line="593"/>
            <method name="getJarCodeSigners" type="List" line="594">
                <declaration name="signers" type="CodeSigner[]" line="595"/>
                <scope line="596">
                    <declaration name="set" type="HashSet" line="597"/>
                </scope>
            </method>
            <method name="getCodeSources" type="CodeSource[]" line="604">
                <params>
                    <param name="jar" type="JarFile"/>
                    <param name="url" type="URL"/>
                </params>
                <declaration name="hasUnsigned" type="boolean" line="605"/>
            </method>
            <method name="getCodeSource" type="CodeSource" line="608">
                <params>
                    <param name="url" type="URL"/>
                    <param name="name" type="String"/>
                </params>
                <declaration name="signers" type="CodeSigner[]" line="609"/>
            </method>
            <method name="getCodeSource" type="CodeSource" line="613">
                <params>
                    <param name="url" type="URL"/>
                    <param name="jar" type="JarFile"/>
                    <param name="je" type="JarEntry"/>
                </params>
                <declaration name="signers" type="CodeSigner[]" line="614"/>
            </method>
            <method name="setEagerValidation" type="void" line="617">
                <params>
                    <param name="eager" type="boolean"/>
                </params>
            </method>
            <method name="getManifestDigests" type="List" line="620"/>
            <method name="getUnsignedCS" type="CodeSource" line="623">
                <params>
                    <param name="url" type="URL"/>
                </params>
            </method>
        </class>
    </source>