<?xml version="1.0" encoding="UTF-8"?>
    <source package="java.security">
        <import package="java.net.URL"/>
        <import package="java.net.SocketPermission"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.List"/>
        <import package="java.util.Hashtable"/>
        <import package="java.io.ByteArrayInputStream"/>
        <import package="java.io.IOException"/>
        <import package="java.security.cert"/>
        <class name="CodeSource" line="10">
            <implements interface="java.io.Serializable"/>
            <javadoc line="10">
                &lt;p&gt;This class extends the concept of a codebase to
                  encapsulate not only the location (URL) but also the certificate chains
                  that were used to verify signed code originating from that location.                
                <author>
                    Li Gong                    
                </author>
                <author>
                    Roland Schemers                    
                </author>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="18"/>
            <declaration name="location" type="URL" line="19"/>
            <javadoc line="19">
                The code location.                
                <serial>
                                        
                </serial>
            </javadoc>
            <declaration name="signers" type="CodeSigner[]" line="24"/>
            <declaration name="certs" type="java.security.cert.Certificate" line="25"/>
            <declaration name="sp" type="SocketPermission" line="26"/>
            <declaration name="factory" type="CertificateFactory" line="27"/>
            <javadoc line="28">
                Constructs a CodeSource and associates it with the specified
                  location and set of certificates.                
                <param>
                    url the location (URL).                    
                </param>
                <param>
                    certs the certificate(s). It may be null. The contents of the
                      array are copied to protect against subsequent modification.                    
                </param>
            </javadoc>
            <method name="CodeSource" type="constructor" line="35">
                <params>
                    <param name="url" type="URL"/>
                    <param name="certs" type="java.security.cert.Certificate"/>
                </params>
                <scope line="37"/>
            </method>
            <javadoc line="41">
                Constructs a CodeSource and associates it with the specified
                  location and set of code signers.                
                <param>
                    url the location (URL).                    
                </param>
                <param>
                    signers the code signers. It may be null. The contents of the
                      array are copied to protect against subsequent modification.                    
                </param>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <method name="CodeSource" type="constructor" line="49">
                <params>
                    <param name="url" type="URL"/>
                    <param name="signers" type="CodeSigner[]"/>
                </params>
                <scope line="51"/>
            </method>
            <javadoc line="55">
                Returns the hash code value for this object.                
                <return>
                    a hash code value for this object.                    
                </return>
            </javadoc>
            <method name="hashCode" type="int" line="59"/>
            <javadoc line="63">
                Tests for equality between the specified object and this
                  object. Two CodeSource objects are considered equal if their
                  locations are of identical value and if their signer certificate
                  chains are of identical value. It is not required that
                  the certificate chains be in the same order.                
                <param>
                    obj the object to test for equality with this object.                    
                </param>
                <return>
                    true if the objects are considered equal, false otherwise.                    
                </return>
            </javadoc>
            <method name="equals" type="boolean" line="72">
                <params>
                    <param name="obj" type="Object"/>
                </params>
                <declaration name="cs" type="CodeSource" line="75"/>
                <scope line="76"/>
                <scope line="79"/>
            </method>
            <javadoc line="84">
                Returns the location associated with this CodeSource.                
                <return>
                    the location (URL).                    
                </return>
            </javadoc>
            <method name="getLocation" type="URL" line="88"/>
            <javadoc line="91">
                Returns the certificates associated with this CodeSource.
                  &lt;p&gt;
                  If this CodeSource object was created using the{@link #CodeSource(URL url,CodeSigner[] signers)}constructor then its certificate chains are extracted and used to
                  create an array of Certificate objects. Each signer certificate is
                  followed by its supporting certificate chain (which may be empty).
                  Each signer certificate and its supporting certificate chain is ordered
                  bottom-to-top (i.e., with the signer certificate first and the (root)
                  certificate authority last).                
                <return>
                    A copy of the certificates array, or null if there is none.                    
                </return>
            </javadoc>
            <method name="getCertificates" type="java.security.cert.Certificate[]" line="102">
                <scope line="103"/>
                <scope line="106">
                    <declaration name="certChains" type="ArrayList&amp;lt;java.security.cert.Certificate&amp;gt;" line="107"/>
                    <scope line="108"/>
                </scope>
                <scope line="114"/>
            </method>
            <javadoc line="118">
                Returns the code signers associated with this CodeSource.
                  &lt;p&gt;
                  If this CodeSource object was created using the{@link #CodeSource(URL url,Certificate[] certs)}constructor then its certificate chains are extracted and used to
                  create an array of CodeSigner objects. Note that only X.509 certificates
                  are examined - all other certificate types are ignored.                
                <return>
                    A copy of the code signer array, or null if there is none.                    
                </return>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <method name="getCodeSigners" type="CodeSigner[]" line="127">
                <scope line="128"/>
                <scope line="131"/>
                <scope line="135"/>
            </method>
            <javadoc line="139">
                Returns true if this CodeSource object &quot;implies&quot; the specified CodeSource.
                  &lt;P&gt;
                  More specifically, this method makes the following checks, in order.
                  If any fail, it returns false. If they all succeed, it returns true.&lt;p&gt;
                  &lt;ol&gt;
                  &lt;li&gt; &lt;i&gt;codesource&lt;/i&gt; must not be null.
                  &lt;li&gt; If this object&apos;s certificates are not null, then all
                  of this object&apos;s certificates must be present in &lt;i&gt;codesource&lt;/i&gt;&apos;s
                  certificates.
                  &lt;li&gt; If this object&apos;s location (getLocation()) is not null, then the
                  following checks are made against this object&apos;s location and
                  &lt;i&gt;codesource&lt;/i&gt;&apos;s:&lt;p&gt;
                  &lt;ol&gt;
                  &lt;li&gt;  &lt;i&gt;codesource&lt;/i&gt;&apos;s location must not be null.
                  &lt;li&gt;  If this object&apos;s location
                  equals &lt;i&gt;codesource&lt;/i&gt;&apos;s location, then return true.
                  &lt;li&gt;  This object&apos;s protocol (getLocation().getProtocol()) must be
                  equal to &lt;i&gt;codesource&lt;/i&gt;&apos;s protocol.
                  &lt;li&gt;  If this object&apos;s host (getLocation().getHost()) is not null,
                  then the SocketPermission
                  constructed with this object&apos;s host must imply the
                  SocketPermission constructed with &lt;i&gt;codesource&lt;/i&gt;&apos;s host.
                  &lt;li&gt;  If this object&apos;s port (getLocation().getPort()) is not
                  equal to -1 (that is, if a port is specified), it must equal
                  &lt;i&gt;codesource&lt;/i&gt;&apos;s port.
                  &lt;li&gt;  If this object&apos;s file (getLocation().getFile()) doesn&apos;t equal
                  &lt;i&gt;codesource&lt;/i&gt;&apos;s file, then the following checks are made:
                  If this object&apos;s file ends with &quot;/-&quot;,
                  then &lt;i&gt;codesource&lt;/i&gt;&apos;s file must start with this object&apos;s
                  file (exclusive the trailing &quot;-&quot;).
                  If this object&apos;s file ends with a &quot;/&quot;,
                  then &lt;i&gt;codesource&lt;/i&gt;&apos;s file must start with this object&apos;s
                  file and must not have any further &quot;/&quot; separators.
                  If this object&apos;s file doesn&apos;t end with a &quot;/&quot;,
                  then &lt;i&gt;codesource&lt;/i&gt;&apos;s file must match this object&apos;s
                  file with a &apos;/&apos; appended.
                  &lt;li&gt;  If this object&apos;s reference (getLocation().getRef()) is
                  not null, it must equal &lt;i&gt;codesource&lt;/i&gt;&apos;s reference.
                  &lt;/ol&gt;
                  &lt;/ol&gt;
                  &lt;p&gt;
                  For example, the codesource objects with the following locations
                  and null certificates all imply
                  the codesource with the location &quot;http://java.sun.com/classes/foo.jar&quot;
                  and null certificates:
                  &lt;pre&gt;
                  http:
                  http://.sun.com/classes/
                  http://java.sun.com/classes/-
                  http://java.sun.com/classes/foo.jar
                  &lt;/pre&gt;
                  Note that if this CodeSource has a null location and a null
                  certificate chain, then it implies every other CodeSource.                
                <param>
                    codesource CodeSource to compare against.                    
                </param>
                <return>
                    true if the specified codesource is implied by this codesource,
                      false if not.                    
                </return>
            </javadoc>
            <method name="implies" type="boolean" line="197">
                <params>
                    <param name="codesource" type="CodeSource"/>
                </params>
            </method>
            <javadoc line="201">
                Returns true if all the certs in this
                  CodeSource are also in &lt;i&gt;that&lt;/i&gt;.                
                <param>
                    that the CodeSource to check against.                    
                </param>
                <param>
                    strict If true then a strict equality match is performed.
                      Otherwise a subset match is performed.                    
                </param>
            </javadoc>
            <method name="matchCerts" type="boolean" line="208">
                <params>
                    <param name="that" type="CodeSource"/>
                    <param name="strict" type="boolean"/>
                </params>
                <declaration name="match" type="boolean" line="209"/>
                <scope line="210">
                    <scope line="211"/>
                    <scope line="214"/>
                </scope>
                <scope line="218">
                    <scope line="219"/>
                    <scope line="222">
                        <scope line="224">
                            <scope line="225"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="234">
                    <scope line="235"/>
                    <scope line="238">
                        <scope line="240">
                            <scope line="241"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="252">
                Returns true if two CodeSource&apos;s have the &quot;same&quot; location.                
                <param>
                    that CodeSource to compare against                    
                </param>
            </javadoc>
            <method name="matchLocation" type="boolean" line="256">
                <params>
                    <param name="that" type="CodeSource"/>
                </params>
                <scope line="257"/>
                <declaration name="thisHost" type="String" line="263"/>
                <declaration name="thatHost" type="String" line="264"/>
                <scope line="265">
                    <scope line="266"/>
                    <scope line="268">
                        <scope line="269"/>
                        <scope line="272"/>
                        <scope line="275"/>
                        <scope line="278"/>
                    </scope>
                </scope>
                <scope line="283"/>
                <scope line="286">
                    <declaration name="thisPath" type="String" line="287"/>
                </scope>
                <scope line="290">
                    <declaration name="last" type="int" line="291"/>
                    <declaration name="thisPath" type="String" line="293"/>
                    <declaration name="thatPath" type="String" line="294"/>
                </scope>
                <scope line="297">
                    <scope line="298"/>
                </scope>
            </method>
            <javadoc line="305">
                Returns a string describing this CodeSource, telling its
                  URL and certificates.                
                <return>
                    information about this CodeSource.                    
                </return>
            </javadoc>
            <method name="toString" type="String" line="310">
                <declaration name="sb" type="StringBuilder" line="311"/>
                <scope line="314">
                    <scope line="315"/>
                </scope>
                <scope line="319">
                    <scope line="320"/>
                </scope>
                <scope line="324"/>
            </method>
            <javadoc line="330">
                Writes this object out to a stream (i.e., serializes it).                
                <serialData>
                    An initial &lt;code&gt;URL&lt;/code&gt; is followed by an
                      &lt;code&gt;int&lt;/code&gt; indicating the number of certificates to follow
                      (a value of &quot;zero&quot; denotes that there are no certificates associated
                      with this object).
                      Each certificate is written out starting with a &lt;code&gt;String&lt;/code&gt;
                      denoting the certificate type, followed by an
                      &lt;code&gt;int&lt;/code&gt; specifying the length of the certificate encoding,
                      followed by the certificate encoding itself which is written out as an
                      array of bytes. Finally, if any code signers are present then the array
                      of code signers is serialized and written out too.                    
                </serialData>
            </javadoc>
            <method name="writeObject" type="void" line="343">
                <params>
                    <param name="oos" type="java.io.ObjectOutputStream"/>
                </params>
                <scope line="345"/>
                <scope line="348">
                    <scope line="350">
                        <declaration name="cert" type="java.security.cert.Certificate" line="351"/>
                        <scope line="352">
                            <declaration name="encoded" type="byte[]" line="354"/>
                        </scope>
                        <scope line="358"/>
                    </scope>
                </scope>
                <scope line="363"/>
            </method>
            <javadoc line="367">
                Restores this object from a stream (i.e., deserializes it).                
            </javadoc>
            <method name="readObject" type="void" line="370">
                <params>
                    <param name="ois" type="java.io.ObjectInputStream"/>
                </params>
                <declaration name="cf" type="CertificateFactory" line="371"/>
                <declaration name="cfs" type="Hashtable&amp;lt;String,CertificateFactory&amp;gt;" line="372"/>
                <declaration name="size" type="int" line="374"/>
                <scope line="375"/>
                <scope line="379">
                    <declaration name="certType" type="String" line="380"/>
                    <scope line="381"/>
                    <scope line="384">
                        <scope line="385"/>
                        <scope line="388"/>
                    </scope>
                    <declaration name="encoded" type="byte[]" line="393"/>
                    <scope line="394"/>
                    <scope line="397"/>
                    <declaration name="bais" type="ByteArrayInputStream" line="401"/>
                    <scope line="402"/>
                    <scope line="405"/>
                </scope>
                <scope line="410"/>
                <scope line="413"/>
            </method>
            <method name="convertCertArrayToSignerArray" type="CodeSigner[]" line="416">
                <params>
                    <param name="certs" type="java.security.cert.Certificate[]"/>
                </params>
                <scope line="417"/>
                <scope line="420">
                    <scope line="421"/>
                    <declaration name="i" type="int" line="424"/>
                    <declaration name="signers" type="List&amp;lt;CodeSigner&amp;gt;" line="425"/>
                    <scope line="426">
                        <declaration name="certChain" type="List&amp;lt;java.security.cert.Certificate&amp;gt;" line="427"/>
                        <declaration name="j" type="int" line="429"/>
                        <scope line="430"/>
                        <declaration name="certPath" type="CertPath" line="435"/>
                    </scope>
                    <scope line="438"/>
                    <scope line="441"/>
                </scope>
                <scope line="445"/>
            </method>
        </class>
    </source>