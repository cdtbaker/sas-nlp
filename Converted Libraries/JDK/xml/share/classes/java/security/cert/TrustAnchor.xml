<?xml version="1.0" encoding="UTF-8"?>
    <source package="java.security.cert">
        <import package="java.io.IOException"/>
        <import package="java.security.PublicKey"/>
        <import package="javax.security.auth.x500.X500Principal"/>
        <import package="sun.security.x509.NameConstraintsExtension"/>
        <import package="sun.security.x509.X500Name"/>
        <class name="TrustAnchor" line="36">
            <javadoc line="36">
                A trust anchor or most-trusted Certification Authority (CA).
                  &lt;p&gt;
                  This class represents a &quot;most-trusted CA&quot;, which is used as a trust anchor
                  for validating X.509 certification paths. A most-trusted CA includes the
                  public key of the CA, the CA&apos;s name, and any constraints upon the set of
                  paths which may be validated using this key. These parameters can be
                  specified in the form of a trusted &lt;code&gt;X509Certificate&lt;/code&gt; or as
                  individual parameters.
                  &lt;p&gt;
                  &lt;b&gt;Concurrent Access&lt;/b&gt;
                  &lt;p&gt;
                  &lt;p&gt;All &lt;code&gt;TrustAnchor&lt;/code&gt; objects must be immutable and
                  thread-safe. That is, multiple threads may concurrently invoke the
                  methods defined in this class on a single &lt;code&gt;TrustAnchor&lt;/code&gt;
                  object (or more than one) with no ill effects. Requiring
                  &lt;code&gt;TrustAnchor&lt;/code&gt; objects to be immutable and thread-safe
                  allows them to be passed around to various pieces of code without
                  worrying about coordinating access. This stipulation applies to all
                  public fields and methods of this class and any added or overridden
                  by subclasses.                
                <see>
                    PKIXParameters#PKIXParameters(Set)                    
                </see>
                <see>
                    PKIXBuilderParameters#PKIXBuilderParameters(Set,CertSelector)                    
                </see>
                <since>
                    1.4                    
                </since>
                <author>
                    Sean Mullan                    
                </author>
            </javadoc>
            <declaration name="pubKey" type="PublicKey" line="66"/>
            <declaration name="caName" type="String" line="67"/>
            <declaration name="caPrincipal" type="X500Principal" line="68"/>
            <declaration name="trustedCert" type="X509Certificate" line="69"/>
            <declaration name="ncBytes" type="byte[]" line="70"/>
            <declaration name="nc" type="NameConstraintsExtension" line="71"/>
            <javadoc line="73">
                Creates an instance of &lt;code&gt;TrustAnchor&lt;/code&gt; with the specified
                  &lt;code&gt;X509Certificate&lt;/code&gt; and optional name constraints, which
                  are intended to be used as additional constraints when validating
                  an X.509 certification path.
                  &lt;p&gt;
                  The name constraints are specified as a byte array. This byte array
                  should contain the DER encoded form of the name constraints, as they
                  would appear in the NameConstraints structure defined in
                  &lt;a href=&quot;http://www.ietf.org/rfc/rfc3280&quot;&gt;RFC 3280&lt;/a&gt;
                  and X.509. The ASN.1 definition of this structure appears below.
                  &lt;pre&gt;&lt;code&gt;
                  NameConstraints ::= SEQUENCE {
                  permittedSubtrees       [0]     GeneralSubtrees OPTIONAL,
                  excludedSubtrees        [1]     GeneralSubtrees OPTIONAL }
                  GeneralSubtrees ::= SEQUENCE SIZE (1..MAX) OF GeneralSubtree
                  GeneralSubtree ::= SEQUENCE {
                  base                    GeneralName,
                  minimum         [0]     BaseDistance DEFAULT 0,
                  maximum         [1]     BaseDistance OPTIONAL }
                  BaseDistance ::= INTEGER (0..MAX)
                  GeneralName ::= CHOICE {
                  otherName                       [0]     OtherName,
                  rfc822Name                      [1]     IA5String,
                  dNSName                         [2]     IA5String,
                  x400Address                     [3]     ORAddress,
                  directoryName                   [4]     Name,
                  ediPartyName                    [5]     EDIPartyName,
                  uniformResourceIdentifier       [6]     IA5String,
                  iPAddress                       [7]     OCTET STRING,
                  registeredID                    [8]     OBJECT IDENTIFIER}
                  &lt;/code&gt;&lt;/pre&gt;
                  &lt;p&gt;
                  Note that the name constraints byte array supplied is cloned to protect
                  against subsequent modifications.                
                <param>
                    trustedCert a trusted <code>X509Certificate</code>                    
                </param>
                <param>
                    nameConstraints a byte array containing the ASN.1 DER encoding of
                      a NameConstraints extension to be used for checking name constraints.
                      Only the value of the extension is included, not the OID or criticality
                      flag. Specify <code>null</code> to omit the parameter.                    
                </param>
                <throws>
                    IllegalArgumentException if the name constraints cannot be
                      decoded                    
                </throws>
                <throws>
                    NullPointerException if the specified
                      <code>X509Certificate</code> is <code>null</code>                    
                </throws>
            </javadoc>
            <method name="TrustAnchor" type="constructor" line="125">
                <params>
                    <param name="trustedCert" type="X509Certificate"/>
                    <param name="nameConstraints" type="byte[]"/>
                </params>
            </method>
            <javadoc line="136">
                Creates an instance of &lt;code&gt;TrustAnchor&lt;/code&gt; where the
                  most-trusted CA is specified as an X500Principal and public key.
                  Name constraints are an optional parameter, and are intended to be used
                  as additional constraints when validating an X.509 certification path.
                  &lt;p&gt;
                  The name constraints are specified as a byte array. This byte array
                  contains the DER encoded form of the name constraints, as they
                  would appear in the NameConstraints structure defined in RFC 3280
                  and X.509. The ASN.1 notation for this structure is supplied in the
                  documentation for{@link #TrustAnchor(X509Certificate,byte[])TrustAnchor(X509Certificate trustedCert, byte[] nameConstraints) }.
                  &lt;p&gt;
                  Note that the name constraints byte array supplied here is cloned to
                  protect against subsequent modifications.                
                <param>
                    caPrincipal the name of the most-trusted CA as X500Principal                    
                </param>
                <param>
                    pubKey the public key of the most-trusted CA                    
                </param>
                <param>
                    nameConstraints a byte array containing the ASN.1 DER encoding of
                      a NameConstraints extension to be used for checking name constraints.
                      Only the value of the extension is included, not the OID or criticality
                      flag. Specify <code>null</code> to omit the parameter.                    
                </param>
                <throws>
                    NullPointerException if the specified <code>caPrincipal</code> or
                      <code>pubKey</code> parameter is <code>null</code>                    
                </throws>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <method name="TrustAnchor" type="constructor" line="164">
                <params>
                    <param name="caPrincipal" type="X500Principal"/>
                    <param name="pubKey" type="PublicKey"/>
                    <param name="nameConstraints" type="byte[]"/>
                </params>
                <scope line="165"/>
            </method>
            <javadoc line="175">
                Creates an instance of &lt;code&gt;TrustAnchor&lt;/code&gt; where the
                  most-trusted CA is specified as a distinguished name and public key.
                  Name constraints are an optional parameter, and are intended to be used
                  as additional constraints when validating an X.509 certification path.
                  &lt;p&gt;
                  The name constraints are specified as a byte array. This byte array
                  contains the DER encoded form of the name constraints, as they
                  would appear in the NameConstraints structure defined in RFC 3280
                  and X.509. The ASN.1 notation for this structure is supplied in the
                  documentation for{@link #TrustAnchor(X509Certificate,byte[])TrustAnchor(X509Certificate trustedCert, byte[] nameConstraints) }.
                  &lt;p&gt;
                  Note that the name constraints byte array supplied here is cloned to
                  protect against subsequent modifications.                
                <param>
                    caName the X.500 distinguished name of the most-trusted CA in
                      <a href="http://www.ietf.org/rfc/rfc2253.txt">RFC 2253</a>
                      <code>String</code> format                    
                </param>
                <param>
                    pubKey the public key of the most-trusted CA                    
                </param>
                <param>
                    nameConstraints a byte array containing the ASN.1 DER encoding of
                      a NameConstraints extension to be used for checking name constraints.
                      Only the value of the extension is included, not the OID or criticality
                      flag. Specify <code>null</code> to omit the parameter.                    
                </param>
                <throws>
                    IllegalArgumentException if the specified <code>
                      caName</code> parameter is empty <code>(caName.length() == 0)</code>
                      or incorrectly formatted or the name constraints cannot be decoded                    
                </throws>
                <throws>
                    NullPointerException if the specified <code>caName</code> or
                      <code>pubKey</code> parameter is <code>null</code>                    
                </throws>
            </javadoc>
            <method name="TrustAnchor" type="constructor" line="207">
                <params>
                    <param name="caName" type="String"/>
                    <param name="pubKey" type="PublicKey"/>
                    <param name="nameConstraints" type="byte[]"/>
                </params>
                <comment line="218">
                    check if caName is formatted correctly                    
                </comment>
            </method>
            <javadoc line="225">
                Returns the most-trusted CA certificate.                
                <return>
                    a trusted <code>X509Certificate</code> or <code>null</code>
                      if the trust anchor was not specified as a trusted certificate                    
                </return>
            </javadoc>
            <method name="getTrustedCert" type="X509Certificate" line="231"/>
            <javadoc line="235">
                Returns the name of the most-trusted CA as an X500Principal.                
                <return>
                    the X.500 distinguished name of the most-trusted CA, or
                      <code>null</code> if the trust anchor was not specified as a trusted
                      public key and name or X500Principal pair                    
                </return>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <method name="getCA" type="X500Principal" line="243"/>
            <javadoc line="247">
                Returns the name of the most-trusted CA in RFC 2253 &lt;code&gt;String&lt;/code&gt;
                  format.                
                <return>
                    the X.500 distinguished name of the most-trusted CA, or
                      <code>null</code> if the trust anchor was not specified as a trusted
                      public key and name or X500Principal pair                    
                </return>
            </javadoc>
            <method name="getCAName" type="String" line="255"/>
            <javadoc line="259">
                Returns the public key of the most-trusted CA.                
                <return>
                    the public key of the most-trusted CA, or <code>null</code>
                      if the trust anchor was not specified as a trusted public key and name
                      or X500Principal pair                    
                </return>
            </javadoc>
            <method name="getCAPublicKey" type="PublicKey" line="266"/>
            <javadoc line="270">
                Decode the name constraints and clone them if not null.                
            </javadoc>
            <method name="setNameConstraints" type="void" line="273">
                <params>
                    <param name="bytes" type="byte[]"/>
                </params>
                <comment line="280">
                    validate DER encoding                    
                </comment>
                <scope line="274"/>
                <scope line="277">
                    <scope line="280"/>
                    <scope line="282">
                        <declaration name="iae" type="IllegalArgumentException" line="283"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="291">
                Returns the name constraints parameter. The specified name constraints
                  are associated with this trust anchor and are intended to be used
                  as additional constraints when validating an X.509 certification path.
                  &lt;p&gt;
                  The name constraints are returned as a byte array. This byte array
                  contains the DER encoded form of the name constraints, as they
                  would appear in the NameConstraints structure defined in RFC 3280
                  and X.509. The ASN.1 notation for this structure is supplied in the
                  documentation for{@link #TrustAnchor(X509Certificate,byte[])TrustAnchor(X509Certificate trustedCert, byte[] nameConstraints) }.
                  &lt;p&gt;
                  Note that the byte array returned is cloned to protect against
                  subsequent modifications.                
                <return>
                    a byte array containing the ASN.1 DER encoding of
                      a NameConstraints extension used for checking name constraints,
                      or <code>null</code> if not set.                    
                </return>
            </javadoc>
            <method name="getNameConstraints" type="byte[]" line="311"/>
            <javadoc line="315">
                Returns a formatted string describing the &lt;code&gt;TrustAnchor&lt;/code&gt;.                
                <return>
                    a formatted string describing the <code>TrustAnchor</code>                    
                </return>
            </javadoc>
            <method name="toString" type="String" line="320">
                <declaration name="sb" type="StringBuffer" line="321"/>
                <scope line="323"/>
                <scope line="327"/>
            </method>
        </class>
    </source>