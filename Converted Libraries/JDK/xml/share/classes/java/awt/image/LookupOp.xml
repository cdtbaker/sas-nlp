<?xml version="1.0" encoding="UTF-8"?>
    <source package="java.awt.image">
        <import package="java.awt.color.ColorSpace"/>
        <import package="java.awt.geom.Rectangle2D"/>
        <import package="java.awt.Rectangle"/>
        <import package="java.awt.RenderingHints"/>
        <import package="java.awt.geom.Point2D"/>
        <import package="sun.awt.image.ImagingLib"/>
        <class name="LookupOp" line="36">
            <implements interface="BufferedImageOp"/>
            <implements interface="RasterOp"/>
            <javadoc line="36">
                This class implements a lookup operation from the source
                  to the destination.  The LookupTable object may contain a single array
                  or multiple arrays, subject to the restrictions below.
                  &lt;p&gt;
                  For Rasters, the lookup operates on bands.  The number of
                  lookup arrays may be one, in which case the same array is
                  applied to all bands, or it must equal the number of Source
                  Raster bands.
                  &lt;p&gt;
                  For BufferedImages, the lookup operates on color and alpha components.
                  The number of lookup arrays may be one, in which case the
                  same array is applied to all color (but not alpha) components.
                  Otherwise, the number of lookup arrays may
                  equal the number of Source color components, in which case no
                  lookup of the alpha component (if present) is performed.
                  If neither of these cases apply, the number of lookup arrays
                  must equal the number of Source color components plus alpha components,
                  in which case lookup is performed for all color and alpha components.
                  This allows non-uniform rescaling of multi-band BufferedImages.
                  &lt;p&gt;
                  BufferedImage sources with premultiplied alpha data are treated in the same
                  manner as non-premultiplied images for purposes of the lookup.  That is,
                  the lookup is done per band on the raw data of the BufferedImage source
                  without regard to whether the data is premultiplied.  If a color conversion
                  is required to the destination ColorModel, the premultiplied state of
                  both source and destination will be taken into account for this step.
                  &lt;p&gt;
                  Images with an IndexColorModel cannot be used.
                  &lt;p&gt;
                  If a RenderingHints object is specified in the constructor, the
                  color rendering hint and the dithering hint may be used when color
                  conversion is required.
                  &lt;p&gt;
                  This class allows the Source to be the same as the Destination.                
                <see>
                    LookupTable                    
                </see>
                <see>
                    java.awt.RenderingHints#KEY_COLOR_RENDERING                    
                </see>
                <see>
                    java.awt.RenderingHints#KEY_DITHERING                    
                </see>
            </javadoc>
            <declaration name="ltable" type="LookupTable" line="78"/>
            <declaration name="numComponents" type="int" line="79"/>
            <declaration name="hints" type="RenderingHints" line="80"/>
            <javadoc line="82">
                Constructs a &lt;code&gt;LookupOp&lt;/code&gt; object given the lookup
                  table and a &lt;code&gt;RenderingHints&lt;/code&gt; object, which might
                  be &lt;code&gt;null&lt;/code&gt;.                
                <param>
                    lookup the specified <code>LookupTable</code>                    
                </param>
                <param>
                    hints the specified <code>RenderingHints</code>,
                      or <code>null</code>                    
                </param>
            </javadoc>
            <method name="LookupOp" type="constructor" line="90">
                <params>
                    <param name="lookup" type="LookupTable"/>
                    <param name="hints" type="RenderingHints"/>
                </params>
            </method>
            <javadoc line="96">
                Returns the &lt;code&gt;LookupTable&lt;/code&gt;.                
                <return>
                    the <code>LookupTable</code> of this
                      <code>LookupOp</code>.                    
                </return>
            </javadoc>
            <method name="getTable" type="LookupTable" line="101"/>
            <javadoc line="105">
                Performs a lookup operation on a &lt;code&gt;BufferedImage&lt;/code&gt;.
                  If the color model in the source image is not the same as that
                  in the destination image, the pixels will be converted
                  in the destination.  If the destination image is &lt;code&gt;null&lt;/code&gt;,
                  a &lt;code&gt;BufferedImage&lt;/code&gt; will be created with an appropriate
                  &lt;code&gt;ColorModel&lt;/code&gt;.  An &lt;code&gt;IllegalArgumentException&lt;/code&gt;
                  might be thrown if the number of arrays in the
                  &lt;code&gt;LookupTable&lt;/code&gt; does not meet the restrictions
                  stated in the class comment above, or if the source image
                  has an &lt;code&gt;IndexColorModel&lt;/code&gt;.                
                <param>
                    src the <code>BufferedImage</code> to be filtered                    
                </param>
                <param>
                    dst the <code>BufferedImage</code> in which to
                      store the results of the filter operation                    
                </param>
                <return>
                    the filtered <code>BufferedImage</code>.                    
                </return>
                <throws>
                    IllegalArgumentException if the number of arrays in the
                      <code>LookupTable</code> does not meet the restrictions
                      described in the class comments, or if the source image
                      has an <code>IndexColorModel</code>.                    
                </throws>
            </javadoc>
            <method name="filter" type="BufferedImage" line="125">
                <params>
                    <param name="src" type="BufferedImage"/>
                    <param name="dst" type="BufferedImage"/>
                </params>
                <comment line="183">
                    Do it the slow way                    
                </comment>
                <comment line="225">
                    ColorModels are not the same                    
                </comment>
                <declaration name="srcCM" type="ColorModel" line="126"/>
                <declaration name="numBands" type="int" line="127"/>
                <declaration name="dstCM" type="ColorModel" line="128"/>
                <scope line="129"/>
                <declaration name="numComponents" type="int" line="134"/>
                <scope line="138"/>
                <declaration name="needToConvert" type="boolean" line="147"/>
                <declaration name="width" type="int" line="149"/>
                <declaration name="height" type="int" line="150"/>
                <scope line="152"/>
                <scope line="156">
                    <scope line="157"/>
                    <scope line="163"/>
                    <scope line="173"/>
                </scope>
                <declaration name="origDst" type="BufferedImage" line="180"/>
                <scope line="182">
                    <declaration name="srcRaster" type="WritableRaster" line="184"/>
                    <declaration name="dstRaster" type="WritableRaster" line="185"/>
                    <scope line="187">
                        <scope line="188">
                            <declaration name="minx" type="int" line="189"/>
                            <declaration name="miny" type="int" line="190"/>
                            <declaration name="bands" type="int[]" line="191"/>
                            <scope line="192"/>
                        </scope>
                    </scope>
                    <scope line="203">
                        <declaration name="dstNumBands" type="int" line="204"/>
                        <scope line="205">
                            <declaration name="minx" type="int" line="206"/>
                            <declaration name="miny" type="int" line="207"/>
                            <declaration name="bands" type="int[]" line="208"/>
                            <scope line="209"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="224">
                    <declaration name="ccop" type="ColorConvertOp" line="226"/>
                </scope>
            </method>
            <javadoc line="233">
                Performs a lookup operation on a &lt;code&gt;Raster&lt;/code&gt;.
                  If the destination &lt;code&gt;Raster&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;,
                  a new &lt;code&gt;Raster&lt;/code&gt; will be created.
                  The &lt;code&gt;IllegalArgumentException&lt;/code&gt; might be thrown
                  if the source &lt;code&gt;Raster&lt;/code&gt; and the destination
                  &lt;code&gt;Raster&lt;/code&gt; do not have the same
                  number of bands or if the number of arrays in the
                  &lt;code&gt;LookupTable&lt;/code&gt; does not meet the
                  restrictions stated in the class comment above.                
                <param>
                    src the source <code>Raster</code> to filter                    
                </param>
                <param>
                    dst the destination <code>WritableRaster</code> for the
                      filtered <code>src</code>                    
                </param>
                <return>
                    the filtered <code>WritableRaster</code>.                    
                </return>
                <throws>
                    IllegalArgumentException if the source and destinations
                      rasters do not have the same number of bands, or the
                      number of arrays in the <code>LookupTable</code> does
                      not meet the restrictions described in the class comments.                    
                </throws>
            </javadoc>
            <method name="filter" type="WritableRaster" line="253">
                <params>
                    <param name="src" type="Raster"/>
                    <param name="dst" type="WritableRaster"/>
                </params>
                <comment line="260">
                    Create a new destination Raster, if needed                    
                </comment>
                <comment line="294">
                    Optimize for cases we know about                    
                </comment>
                <comment line="304">
                    Not one we recognize so do it slowly                    
                </comment>
                <comment line="313">
                    Find data for all bands at this x,y position                    
                </comment>
                <comment line="316">
                    Lookup the data for all bands at this x,y position                    
                </comment>
                <comment line="319">
                    Put it back for all bands                    
                </comment>
                <declaration name="numBands" type="int" line="254"/>
                <declaration name="dstLength" type="int" line="255"/>
                <declaration name="height" type="int" line="256"/>
                <declaration name="width" type="int" line="257"/>
                <declaration name="srcPix" type="int" line="258"/>
                <scope line="262"/>
                <scope line="265"/>
                <scope line="272"/>
                <declaration name="numComponents" type="int" line="280"/>
                <scope line="281"/>
                <scope line="290"/>
                <scope line="295"/>
                <scope line="299"/>
                <scope line="303">
                    <declaration name="sminX" type="int" line="305"/>
                    <declaration name="sY" type="int" line="306"/>
                    <declaration name="dminX" type="int" line="307"/>
                    <declaration name="dY" type="int" line="308"/>
                    <scope line="309">
                        <declaration name="sX" type="int" line="310"/>
                        <declaration name="dX" type="int" line="311"/>
                        <scope line="312"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="328">
                Returns the bounding box of the filtered destination image.  Since
                  this is not a geometric operation, the bounding box does not
                  change.                
                <param>
                    src the <code>BufferedImage</code> to be filtered                    
                </param>
                <return>
                    the bounds of the filtered definition image.                    
                </return>
            </javadoc>
            <method name="getBounds2D" type="Rectangle2D" line="335">
                <params>
                    <param name="src" type="BufferedImage"/>
                </params>
            </method>
            <javadoc line="339">
                Returns the bounding box of the filtered destination Raster.  Since
                  this is not a geometric operation, the bounding box does not
                  change.                
                <param>
                    src the <code>Raster</code> to be filtered                    
                </param>
                <return>
                    the bounds of the filtered definition <code>Raster</code>.                    
                </return>
            </javadoc>
            <method name="getBounds2D" type="Rectangle2D" line="346">
                <params>
                    <param name="src" type="Raster"/>
                </params>
            </method>
            <javadoc line="351">
                Creates a zeroed destination image with the correct size and number of
                  bands.  If destCM is &lt;code&gt;null&lt;/code&gt;, an appropriate
                  &lt;code&gt;ColorModel&lt;/code&gt; will be used.                
                <param>
                    src       Source image for the filter operation.                    
                </param>
                <param>
                    destCM    the destination's <code>ColorModel</code>, which
                      can be <code>null</code>.                    
                </param>
                <return>
                    a filtered destination <code>BufferedImage</code>.                    
                </return>
            </javadoc>
            <method name="createCompatibleDestImage" type="BufferedImage" line="361">
                <params>
                    <param name="src" type="BufferedImage"/>
                    <param name="destCM" type="ColorModel"/>
                </params>
                <comment line="377">
                    Dst raster should be of type byte                    
                </comment>
                <comment line="392">
                    For byte, no need to change the cm                    
                </comment>
                <declaration name="image" type="BufferedImage" line="362"/>
                <declaration name="w" type="int" line="363"/>
                <declaration name="h" type="int" line="364"/>
                <declaration name="transferType" type="int" line="365"/>
                <scope line="366">
                    <declaration name="cm" type="ColorModel" line="367"/>
                    <declaration name="raster" type="Raster" line="368"/>
                    <scope line="369">
                        <declaration name="db" type="DataBuffer" line="370"/>
                        <declaration name="hasAlpha" type="boolean" line="371"/>
                        <declaration name="isPre" type="boolean" line="372"/>
                        <declaration name="trans" type="int" line="373"/>
                        <declaration name="nbits" type="int[]" line="374"/>
                        <scope line="375">
                            <scope line="376">
                                <scope line="378">
                                    <scope line="380"/>
                                    <scope line="383"/>
                                </scope>
                                <scope line="387"/>
                            </scope>
                        </scope>
                        <scope line="394">
                            <scope line="396">
                                <scope line="397">
                                    <scope line="399"/>
                                    <scope line="402"/>
                                </scope>
                                <scope line="406"/>
                            </scope>
                        </scope>
                        <scope line="412"/>
                    </scope>
                </scope>
                <scope line="423"/>
            </method>
            <javadoc line="434">
                Creates a zeroed-destination &lt;code&gt;Raster&lt;/code&gt; with the
                  correct size and number of bands, given this source.                
                <param>
                    src the <code>Raster</code> to be transformed                    
                </param>
                <return>
                    the zeroed-destination <code>Raster</code>.                    
                </return>
            </javadoc>
            <method name="createCompatibleDestRaster" type="WritableRaster" line="440">
                <params>
                    <param name="src" type="Raster"/>
                </params>
            </method>
            <javadoc line="444">
                Returns the location of the destination point given a
                  point in the source.  If &lt;code&gt;dstPt&lt;/code&gt; is not
                  &lt;code&gt;null&lt;/code&gt;, it will be used to hold the return value.
                  Since this is not a geometric operation, the &lt;code&gt;srcPt&lt;/code&gt;
                  will equal the &lt;code&gt;dstPt&lt;/code&gt;.                
                <param>
                    srcPt a <code>Point2D</code> that represents a point
                      in the source image                    
                </param>
                <param>
                    dstPt a <code>Point2D</code>that represents the location
                      in the destination                    
                </param>
                <return>
                    the <code>Point2D</code> in the destination that
                      corresponds to the specified point in the source.                    
                </return>
            </javadoc>
            <method name="getPoint2D" type="Point2D" line="457">
                <params>
                    <param name="srcPt" type="Point2D"/>
                    <param name="dstPt" type="Point2D"/>
                </params>
                <scope line="458"/>
            </method>
            <javadoc line="466">
                Returns the rendering hints for this op.                
                <return>
                    the <code>RenderingHints</code> object associated
                      with this op.                    
                </return>
            </javadoc>
            <method name="getRenderingHints" type="RenderingHints" line="471"/>
            <method name="byteFilter" type="void" line="477">
                <params>
                    <param name="lookup" type="ByteLookupTable"/>
                    <param name="src" type="Raster"/>
                    <param name="dst" type="WritableRaster"/>
                    <param name="width" type="int"/>
                    <param name="height" type="int"/>
                    <param name="numBands" type="int"/>
                </params>
                <comment line="480">
                    Find the ref to the table and the offset                    
                </comment>
                <comment line="486">
                    Check if it is one lookup applied to all bands                    
                </comment>
                <comment line="496">
                    Loop through the data                    
                </comment>
                <comment line="500">
                    Find data for this band, scanline                    
                </comment>
                <comment line="513">
                    Do the lookup                    
                </comment>
                <comment line="516">
                    Put it back                    
                </comment>
                <declaration name="srcPix" type="int[]" line="478"/>
                <declaration name="table" type="byte[][]" line="481"/>
                <declaration name="offset" type="int" line="482"/>
                <declaration name="tidx" type="int" line="483"/>
                <declaration name="step" type="int" line="484"/>
                <scope line="487"/>
                <declaration name="x" type="int" line="491"/>
                <declaration name="y" type="int" line="492"/>
                <declaration name="band" type="int" line="493"/>
                <declaration name="len" type="int" line="494"/>
                <scope line="497">
                    <scope line="499">
                        <scope line="503">
                            <declaration name="index" type="int" line="504"/>
                            <scope line="505"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <method name="shortFilter" type="void" line="524">
                <params>
                    <param name="lookup" type="ShortLookupTable"/>
                    <param name="src" type="Raster"/>
                    <param name="dst" type="WritableRaster"/>
                    <param name="width" type="int"/>
                    <param name="height" type="int"/>
                    <param name="numBands" type="int"/>
                </params>
                <comment line="528">
                    Find the ref to the table and the offset                    
                </comment>
                <comment line="534">
                    Check if it is one lookup applied to all bands                    
                </comment>
                <comment line="543">
                    Loop through the data                    
                </comment>
                <comment line="547">
                    Find data for this band, scanline                    
                </comment>
                <comment line="559">
                    Do the lookup                    
                </comment>
                <comment line="562">
                    Put it back                    
                </comment>
                <declaration name="band" type="int" line="525"/>
                <declaration name="srcPix" type="int[]" line="526"/>
                <declaration name="table" type="short[][]" line="529"/>
                <declaration name="offset" type="int" line="530"/>
                <declaration name="tidx" type="int" line="531"/>
                <declaration name="step" type="int" line="532"/>
                <scope line="535"/>
                <declaration name="x" type="int" line="539"/>
                <declaration name="y" type="int" line="540"/>
                <declaration name="index" type="int" line="541"/>
                <declaration name="maxShort" type="int" line="542"/>
                <scope line="544">
                    <scope line="546">
                        <scope line="550">
                            <scope line="552"/>
                        </scope>
                    </scope>
                </scope>
            </method>
        </class>
    </source>