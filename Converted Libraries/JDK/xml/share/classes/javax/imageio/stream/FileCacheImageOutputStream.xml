<?xml version="1.0" encoding="UTF-8"?>
    <source package="javax.imageio.stream">
        <import package="java.io.File"/>
        <import package="java.io.IOException"/>
        <import package="java.io.OutputStream"/>
        <import package="java.io.RandomAccessFile"/>
        <import package="com.sun.imageio.stream.StreamCloser"/>
        <class name="FileCacheImageOutputStream" line="34">
            <extends class="ImageOutputStreamImpl"/>
            <comment line="49">
                Pos after last (rightmost) byte written                
            </comment>
            <javadoc line="34">
                An implementation of &lt;code&gt;ImageOutputStream&lt;/code&gt; that writes its
                  output to a regular &lt;code&gt;OutputStream&lt;/code&gt;.  A file is used to
                  cache data until it is flushed to the output stream.                
            </javadoc>
            <declaration name="stream" type="OutputStream" line="42"/>
            <declaration name="cacheFile" type="File" line="44"/>
            <declaration name="cache" type="RandomAccessFile" line="46"/>
            <declaration name="maxStreamPos" type="long" line="49"/>
            <declaration name="closeAction" type="StreamCloser.CloseAction" line="51"/>
            <javadoc line="51">
                The CloseAction that closes the stream in
                  the StreamCloser&apos;s shutdown hook                
            </javadoc>
            <javadoc line="55">
                Constructs a &lt;code&gt;FileCacheImageOutputStream&lt;/code&gt; that will write
                  to a given &lt;code&gt;outputStream&lt;/code&gt;.
                  &lt;p&gt; A temporary file is used as a cache.  If
                  &lt;code&gt;cacheDir&lt;/code&gt;is non-&lt;code&gt;null&lt;/code&gt; and is a
                  directory, the file will be created there.  If it is
                  &lt;code&gt;null&lt;/code&gt;, the system-dependent default temporary-file
                  directory will be used (see the documentation for
                  &lt;code&gt;File.createTempFile&lt;/code&gt; for details).                
                <param>
                    stream an &lt;code&gt;OutputStream&lt;/code&gt; to write to.                    
                </param>
                <param>
                    cacheDir a &lt;code&gt;File&lt;/code&gt; indicating where the
                      cache file should be created, or &lt;code&gt;null&lt;/code&gt; to use the
                      system directory.                    
                </param>
                <exception>
                    IllegalArgumentException if &lt;code&gt;stream&lt;/code&gt;
                      is &lt;code&gt;null&lt;/code&gt;.                    
                </exception>
                <exception>
                    IllegalArgumentException if &lt;code&gt;cacheDir&lt;/code&gt; is
                      non-&lt;code&gt;null&lt;/code&gt; but is not a directory.                    
                </exception>
                <exception>
                    IOException if a cache file cannot be created.                    
                </exception>
            </javadoc>
            <method name="FileCacheImageOutputStream" type="constructor" line="78">
                <params>
                    <param name="stream" type="OutputStream"/>
                    <param name="cacheDir" type="File"/>
                </params>
                <scope line="79"/>
                <scope line="82"/>
            </method>
            <method name="read" type="int" line="94">
                <declaration name="val" type="int" line="97"/>
                <scope line="98"/>
            </method>
            <method name="read" type="int" line="104">
                <params>
                    <param name="b" type="byte[]"/>
                    <param name="off" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <scope line="107"/>
                <scope line="110"/>
                <scope line="117"/>
                <declaration name="nbytes" type="int" line="121"/>
                <scope line="122"/>
            </method>
            <method name="write" type="void" line="128">
                <params>
                    <param name="b" type="int"/>
                </params>
                <comment line="130">
                    this will call checkClosed() for us                    
                </comment>
            </method>
            <method name="write" type="void" line="135">
                <params>
                    <param name="b" type="byte[]"/>
                    <param name="off" type="int"/>
                    <param name="len" type="int"/>
                </params>
                <comment line="137">
                    this will call checkClosed() for us                    
                </comment>
            </method>
            <method name="length" type="long" line="142">
                <scope line="143"/>
                <scope line="146"/>
            </method>
            <javadoc line="151">
                Sets the current stream position and resets the bit offset to
                  0.  It is legal to seek past the end of the file; an
                  &lt;code&gt;EOFException&lt;/code&gt; will be thrown only if a read is
                  performed.  The file length will not be increased until a write
                  is performed.                
                <exception>
                    IndexOutOfBoundsException if &lt;code&gt;pos&lt;/code&gt; is smaller
                      than the flushed position.                    
                </exception>
                <exception>
                    IOException if any other I/O error occurs.                    
                </exception>
            </javadoc>
            <method name="seek" type="void" line="162">
                <params>
                    <param name="pos" type="long"/>
                </params>
                <scope line="165"/>
            </method>
            <javadoc line="175">
                Returns &lt;code&gt;true&lt;/code&gt; since this
                  &lt;code&gt;ImageOutputStream&lt;/code&gt; caches data in order to allow
                  seeking backwards.                
                <return>
                    &lt;code&gt;true&lt;/code&gt;.                    
                </return>
                <see>
                    #isCachedMemory                    
                </see>
                <see>
                    #isCachedFile                    
                </see>
            </javadoc>
            <method name="isCached" type="boolean" line="185"/>
            <javadoc line="189">
                Returns &lt;code&gt;true&lt;/code&gt; since this
                  &lt;code&gt;ImageOutputStream&lt;/code&gt; maintains a file cache.                
                <return>
                    &lt;code&gt;true&lt;/code&gt;.                    
                </return>
                <see>
                    #isCached                    
                </see>
                <see>
                    #isCachedMemory                    
                </see>
            </javadoc>
            <method name="isCachedFile" type="boolean" line="198"/>
            <javadoc line="202">
                Returns &lt;code&gt;false&lt;/code&gt; since this
                  &lt;code&gt;ImageOutputStream&lt;/code&gt; does not maintain a main memory
                  cache.                
                <return>
                    &lt;code&gt;false&lt;/code&gt;.                    
                </return>
                <see>
                    #isCached                    
                </see>
                <see>
                    #isCachedFile                    
                </see>
            </javadoc>
            <method name="isCachedMemory" type="boolean" line="212"/>
            <javadoc line="216">
                Closes this &lt;code&gt;FileCacheImageOutputStream&lt;/code&gt;.  All
                  pending data is flushed to the output, and the cache file
                  is closed and removed.  The destination &lt;code&gt;OutputStream&lt;/code&gt;
                  is not closed.                
                <exception>
                    IOException if an error occurs.                    
                </exception>
            </javadoc>
            <method name="close" type="void" line="224"/>
            <method name="flushBefore" type="void" line="239">
                <params>
                    <param name="pos" type="long"/>
                </params>
                <comment line="242">
                    this will call checkClosed() for us                    
                </comment>
                <declaration name="oFlushedPos" type="long" line="240"/>
                <declaration name="flushBytes" type="long" line="243"/>
                <scope line="244">
                    <declaration name="bufLen" type="int" line="245"/>
                    <declaration name="buf" type="byte[]" line="246"/>
                    <scope line="248">
                        <declaration name="len" type="int" line="249"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>