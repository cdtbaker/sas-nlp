<?xml version="1.0" encoding="UTF-8"?>
    <source package="javax.swing.plaf.nimbus">
        <import package="java.awt.image.BufferedImage"/>
        <import package="java.awt.image.Raster"/>
        <import package="java.awt.image.WritableRaster"/>
        <import package="java.util.Arrays"/>
        <class name="InnerShadowEffect" line="32">
            <extends class="ShadowEffect"/>
            <comment line="41">
                =================================================================================================================
                 Effect Methods                
            </comment>
            <javadoc line="32">
                InnerShadowEffect - This effect currently only works with ARGB type buffered
                  images.                
                <author>
                    Created by Jasper Potts (Jun 18, 2007)                    
                </author>
            </javadoc>
            <javadoc line="43">
                Get the type of this effect, one of UNDER,BLENDED,OVER. UNDER means the result of apply effect should be painted
                  under the src image. BLENDED means the result of apply sffect contains a modified src image so just it should be
                  painted. OVER means the result of apply effect should be painted over the src image.                
                <return>
                    The effect type                    
                </return>
            </javadoc>
            <method name="getEffectType" type="Effect.EffectType" line="50"/>
            <javadoc line="54">
                Apply the effect to the src image generating the result . The result image may or may not contain the source
                  image depending on what the effect type is.                
                <param>
                    src The source image for applying the effect to                    
                </param>
                <param>
                    dst The dstination image to paint effect result into. If this is null then a new image will be created                    
                </param>
                <param>
                    w   The width of the src image to apply effect to, this allow the src and dst buffers to be bigger than
                      the area the need effect applied to it                    
                </param>
                <param>
                    h   The height of the src image to apply effect to, this allow the src and dst buffers to be bigger than
                      the area the need effect applied to it                    
                </param>
                <return>
                    Image with the result of the effect                    
                </return>
            </javadoc>
            <method name="applyEffect" type="BufferedImage" line="66">
                <params>
                    <param name="src" type="BufferedImage"/>
                    <param name="dst" type="BufferedImage"/>
                    <param name="w" type="int"/>
                    <param name="h" type="int"/>
                </params>
                <comment line="76">
                    calculate offset                    
                </comment>
                <comment line="80">
                    clac expanded size                    
                </comment>
                <comment line="85">
                    create tmp buffers                    
                </comment>
                <comment line="91">
                    extract src image alpha channel and inverse and offset                    
                </comment>
                <comment line="102">
                    blur                    
                </comment>
                <comment line="104">
                    horizontal pass                    
                </comment>
                <comment line="105">
                    vertical pass                    
                </comment>
                <comment line="106">
                    rescale                    
                </comment>
                <comment line="112">
                    create color image with shadow color and greyscale image as alpha                    
                </comment>
                <scope line="67"/>
                <scope line="71"/>
                <declaration name="trangleAngle" type="double" line="76"/>
                <declaration name="offsetX" type="int" line="77"/>
                <declaration name="offsetY" type="int" line="78"/>
                <declaration name="tmpOffX" type="int" line="80"/>
                <declaration name="tmpOffY" type="int" line="81"/>
                <declaration name="tmpW" type="int" line="82"/>
                <declaration name="tmpH" type="int" line="83"/>
                <declaration name="lineBuf" type="int[]" line="85"/>
                <declaration name="srcAlphaBuf" type="byte[]" line="86"/>
                <declaration name="tmpBuf1" type="byte[]" line="88"/>
                <declaration name="tmpBuf2" type="byte[]" line="89"/>
                <declaration name="srcRaster" type="Raster" line="91"/>
                <scope line="92">
                    <declaration name="dy" type="int" line="93"/>
                    <declaration name="offset" type="int" line="94"/>
                    <scope line="96">
                        <declaration name="dx" type="int" line="97"/>
                    </scope>
                </scope>
                <declaration name="kernel" type="float[]" line="102"/>
                <declaration name="spread" type="float" line="106"/>
                <scope line="107">
                    <declaration name="val" type="int" line="108"/>
                </scope>
                <declaration name="shadowRaster" type="WritableRaster" line="114"/>
                <declaration name="red" type="int" line="115"/>
                <scope line="116">
                    <declaration name="srcY" type="int" line="117"/>
                    <declaration name="offset" type="int" line="118"/>
                    <declaration name="shadowOffset" type="int" line="119"/>
                    <scope line="120">
                        <declaration name="srcX" type="int" line="121"/>
                        <declaration name="origianlAlphaVal" type="int" line="122"/>
                        <declaration name="shadowVal" type="int" line="123"/>
                        <declaration name="alphaVal" type="int" line="124"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>