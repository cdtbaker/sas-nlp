<?xml version="1.0" encoding="UTF-8"?>
    <source package="javax.swing.text">
        <import package="java.util"/>
        <import package="java.awt"/>
        <import package="java.text.AttributedCharacterIterator"/>
        <import package="java.text.BreakIterator"/>
        <import package="java.awt.font"/>
        <import package="java.awt.geom.AffineTransform"/>
        <import package="javax.swing.JComponent"/>
        <import package="javax.swing.event.DocumentEvent"/>
        <import package="sun.font.BidiUtils"/>
        <class name="TextLayoutStrategy" line="37">
            <extends class="FlowView.FlowStrategy"/>
            <comment line="57">
                --- FlowStrategy methods --------------------------------------------                
            </comment>
            <comment line="336">
                --- variables -------------------------------------------------------                
            </comment>
            <javadoc line="37">
                A flow strategy that uses java.awt.font.LineBreakMeasureer to
                  produce java.awt.font.TextLayout for i18n capable rendering.
                  If the child view being placed into the flow is of type
                  GlyphView and can be rendered by TextLayout, a GlyphPainter
                  that uses TextLayout is plugged into the GlyphView.                
                <author>
                    Timothy Prinzing                    
                </author>
            </javadoc>
            <javadoc line="48">
                Constructs a layout strategy for paragraphs based
                  upon java.awt.font.LineBreakMeasurer.                
            </javadoc>
            <method name="TextLayoutStrategy" type="constructor" line="52"/>
            <javadoc line="58">
                Gives notification that something was inserted into the document
                  in a location that the given flow view is responsible for.  The
                  strategy should update the appropriate changed region (which
                  depends upon the strategy used for repair).                
                <param>
                    e the change information from the associated document                    
                </param>
                <param>
                    alloc the current allocation of the view inside of the insets.
                      This value will be null if the view has not yet been displayed.                    
                </param>
                <see>
                    View#insertUpdate                    
                </see>
            </javadoc>
            <method name="insertUpdate" type="void" line="69">
                <params>
                    <param name="fv" type="FlowView"/>
                    <param name="e" type="DocumentEvent"/>
                    <param name="alloc" type="Rectangle"/>
                </params>
            </method>
            <javadoc line="74">
                Gives notification that something was removed from the document
                  in a location that the given flow view is responsible for.                
                <param>
                    e the change information from the associated document                    
                </param>
                <param>
                    alloc the current allocation of the view inside of the insets.                    
                </param>
                <see>
                    View#removeUpdate                    
                </see>
            </javadoc>
            <method name="removeUpdate" type="void" line="82">
                <params>
                    <param name="fv" type="FlowView"/>
                    <param name="e" type="DocumentEvent"/>
                    <param name="alloc" type="Rectangle"/>
                </params>
            </method>
            <javadoc line="87">
                Gives notification from the document that attributes were changed
                  in a location that this view is responsible for.                
                <param>
                    changes the change information from the associated document                    
                </param>
                <param>
                    a the current allocation of the view                    
                </param>
                <param>
                    f the factory to use to rebuild if the view has children                    
                </param>
                <see>
                    View#changedUpdate                    
                </see>
            </javadoc>
            <method name="changedUpdate" type="void" line="96">
                <params>
                    <param name="fv" type="FlowView"/>
                    <param name="e" type="DocumentEvent"/>
                    <param name="alloc" type="Rectangle"/>
                </params>
            </method>
            <javadoc line="101">
                Does a a full layout on the given View.  This causes all of
                  the rows (child views) to be rebuilt to match the given
                  constraints for each row.  This is called by a FlowView.layout
                  to update the child views in the flow.                
                <param>
                    fv the view to reflow                    
                </param>
            </javadoc>
            <method name="layout" type="void" line="109">
                <params>
                    <param name="fv" type="FlowView"/>
                </params>
            </method>
            <javadoc line="113">
                Creates a row of views that will fit within the
                  layout span of the row.  This is implemented to execute the
                  superclass functionality (which fills the row with child
                  views or view fragments) and follow that with bidi reordering
                  of the unidirectional view fragments.                
                <param>
                    row the row to fill in with views.  This is assumed
                      to be empty on entry.                    
                </param>
                <param>
                    pos  The current position in the children of
                      this views element from which to start.                    
                </param>
                <return>
                    the position to start the next row                    
                </return>
            </javadoc>
            <method name="layoutRow" type="int" line="126">
                <params>
                    <param name="fv" type="FlowView"/>
                    <param name="rowIndex" type="int"/>
                    <param name="p0" type="int"/>
                </params>
                <declaration name="p1" type="int" line="127"/>
                <declaration name="row" type="View" line="128"/>
                <declaration name="doc" type="Document" line="129"/>
                <declaration name="i18nFlag" type="Object" line="130"/>
                <scope line="131">
                    <declaration name="n" type="int" line="132"/>
                    <scope line="133">
                        <declaration name="d" type="AbstractDocument" line="134"/>
                        <declaration name="bidiRoot" type="Element" line="135"/>
                        <declaration name="levels" type="byte[]" line="136"/>
                        <declaration name="reorder" type="View[]" line="137"/>
                        <scope line="139">
                            <declaration name="v" type="View" line="140"/>
                            <declaration name="bidiIndex" type="int" line="141"/>
                            <declaration name="bidiElem" type="Element" line="142"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="154">
                Adjusts the given row if possible to fit within the
                  layout span.  Since all adjustments were already
                  calculated by the LineBreakMeasurer, this is implemented
                  to do nothing.                
                <param>
                    r the row to adjust to the current layout
                      span.                    
                </param>
                <param>
                    desiredSpan the current layout span &gt;= 0                    
                </param>
                <param>
                    x the location r starts at.                    
                </param>
            </javadoc>
            <method name="adjustRow" type="void" line="165">
                <params>
                    <param name="fv" type="FlowView"/>
                    <param name="rowIndex" type="int"/>
                    <param name="desiredSpan" type="int"/>
                    <param name="x" type="int"/>
                </params>
            </method>
            <javadoc line="168">
                Creates a unidirectional view that can be used to represent the
                  current chunk.  This can be either an entire view from the
                  logical view, or a fragment of the view.                
                <param>
                    fv the view holding the flow                    
                </param>
                <param>
                    startOffset the start location for the view being created                    
                </param>
                <param>
                    spanLeft the about of span left to fill in the row                    
                </param>
                <param>
                    rowIndex the row the view will be placed into                    
                </param>
            </javadoc>
            <method name="createView" type="View" line="178">
                <params>
                    <param name="fv" type="FlowView"/>
                    <param name="startOffset" type="int"/>
                    <param name="spanLeft" type="int"/>
                    <param name="rowIndex" type="int"/>
                </params>
                <comment line="180">
                    Get the child view that contains the given starting position                    
                </comment>
                <comment line="194">
                    return the entire view                    
                </comment>
                <comment line="197">
                    return a unidirectional fragment.                    
                </comment>
                <comment line="202">
                    install a TextLayout based renderer if the view is responsible
                     for glyphs.  If the view represents a tab, the default
                     glyph painter is used (may want to handle tabs differently).                    
                </comment>
                <comment line="209">
                    check for tab                    
                </comment>
                <declaration name="lv" type="View" line="180"/>
                <declaration name="row" type="View" line="181"/>
                <declaration name="requireNextWord" type="boolean" line="182"/>
                <declaration name="childIndex" type="int" line="183"/>
                <declaration name="v" type="View" line="184"/>
                <declaration name="endOffset" type="int" line="186"/>
                <scope line="187"/>
                <declaration name="frag" type="View" line="191"/>
                <scope line="192"/>
                <scope line="195"/>
                <scope line="200">
                    <declaration name="isTab" type="boolean" line="204"/>
                    <declaration name="p0" type="int" line="205"/>
                    <declaration name="p1" type="int" line="206"/>
                    <scope line="207">
                        <declaration name="s" type="Segment" line="209"/>
                        <declaration name="ch" type="char" line="210"/>
                        <scope line="211"/>
                    </scope>
                    <declaration name="tl" type="TextLayout" line="215"/>
                    <scope line="218"/>
                </scope>
            </method>
            <javadoc line="225">
                Calculate the limiting offset for the next view fragment.
                  At most this would be the entire view (i.e. the limiting
                  offset would be the end offset in that case).  If the range
                  contains a tab or a direction change, that will limit the
                  offset to something less.  This value is then fed to the
                  LineBreakMeasurer as a limit to consider in addition to the
                  remaining span.                
                <param>
                    v the logical view representing the starting offset.                    
                </param>
                <param>
                    startOffset the model location to start at.                    
                </param>
            </javadoc>
            <method name="getLimitingOffset" type="int" line="237">
                <params>
                    <param name="v" type="View"/>
                    <param name="startOffset" type="int"/>
                    <param name="spanLeft" type="int"/>
                    <param name="requireNextWord" type="boolean"/>
                </params>
                <comment line="241">
                    check for direction change                    
                </comment>
                <comment line="253">
                    check for tab                    
                </comment>
                <comment line="258">
                    if the first character is a tab, create a dedicated
                     view for just the tab                    
                </comment>
                <comment line="264">
                    found a tab, don&apos;t include it in the text                    
                </comment>
                <comment line="272">
                    determine limit from LineBreakMeasurer                    
                </comment>
                <declaration name="endOffset" type="int" line="238"/>
                <declaration name="doc" type="Document" line="241"/>
                <scope line="242">
                    <declaration name="d" type="AbstractDocument" line="243"/>
                    <declaration name="bidiRoot" type="Element" line="244"/>
                    <scope line="245">
                        <declaration name="bidiIndex" type="int" line="246"/>
                        <declaration name="bidiElem" type="Element" line="247"/>
                    </scope>
                </scope>
                <scope line="253">
                    <declaration name="s" type="Segment" line="254"/>
                    <declaration name="ch" type="char" line="255"/>
                    <scope line="256"/>
                    <scope line="260">
                        <scope line="261">
                            <scope line="262"/>
                        </scope>
                    </scope>
                </scope>
                <declaration name="limitIndex" type="int" line="272"/>
                <scope line="273">
                    <declaration name="index" type="int" line="274"/>
                    <scope line="275"/>
                </scope>
                <declaration name="pos" type="int" line="280"/>
            </method>
            <javadoc line="284">
                Synchronize the strategy with its FlowView.  Allows the strategy
                  to update its state to account for changes in that portion of the
                  model represented by the FlowView.  Also allows the strategy
                  to update the FlowView in response to these changes.                
            </javadoc>
            <method name="sync" type="void" line="290">
                <params>
                    <param name="fv" type="FlowView"/>
                </params>
                <comment line="315">
                    If the children of the FlowView&apos;s logical view are GlyphViews, they
                     need to have their painters updated.                    
                </comment>
                <comment line="331">
                    Reset measurer.                    
                </comment>
                <declaration name="lv" type="View" line="291"/>
                <declaration name="container" type="Container" line="294"/>
                <declaration name="frc" type="FontRenderContext" line="295"/>
                <declaration name="iter" type="BreakIterator" line="297"/>
                <declaration name="c" type="Container" line="298"/>
                <scope line="299"/>
                <scope line="301"/>
                <declaration name="shaper" type="Object" line="305"/>
                <scope line="306"/>
                <declaration name="n" type="int" line="316"/>
                <scope line="317">
                    <declaration name="child" type="View" line="318"/>
                    <scope line="319">
                        <declaration name="p0" type="int" line="320"/>
                        <declaration name="p1" type="int" line="321"/>
                        <declaration name="layout" type="TextLayout" line="323"/>
                    </scope>
                </scope>
            </method>
            <declaration name="measurer" type="LineBreakMeasurer" line="337"/>
            <declaration name="text" type="AttributedSegment" line="338"/>
            <class name="AttributedSegment" line="340">
                <extends class="Segment"/>
                <comment line="415">
                    --- AttributedCharacterIterator methods -------------------------                    
                </comment>
                <implements interface="AttributedCharacterIterator"/>
                <javadoc line="340">
                    Implementation of AttributedCharacterIterator that supports
                      the GlyphView attributes for rendering the glyphs through a
                      TextLayout.                    
                </javadoc>
                <method name="AttributedSegment" type="constructor" line="347"/>
                <method name="getView" type="View" line="350"/>
                <method name="setView" type="void" line="354">
                    <params>
                        <param name="v" type="View"/>
                    </params>
                    <declaration name="doc" type="Document" line="356"/>
                    <declaration name="p0" type="int" line="357"/>
                    <declaration name="p1" type="int" line="358"/>
                    <scope line="359"/>
                    <scope line="361"/>
                </method>
                <javadoc line="367">
                    Get a boundary position for the font.
                      This is implemented to assume that two fonts are
                      equal if their references are equal (i.e. that the
                      font came from a cache).                    
                    <return>
                        the location in model coordinates.  This is
                          not the same as the Segment coordinates.                        
                    </return>
                </javadoc>
                <method name="getFontBoundary" type="int" line="376">
                    <params>
                        <param name="childIndex" type="int"/>
                        <param name="dir" type="int"/>
                    </params>
                    <comment line="384">
                        this run is different                        
                    </comment>
                    <declaration name="child" type="View" line="377"/>
                    <declaration name="f" type="Font" line="378"/>
                    <scope line="380">
                        <declaration name="next" type="Font" line="381"/>
                        <scope line="382"/>
                    </scope>
                </method>
                <javadoc line="391">
                    Get the font at the given child index.                    
                </javadoc>
                <method name="getFont" type="Font" line="394">
                    <params>
                        <param name="childIndex" type="int"/>
                    </params>
                    <declaration name="child" type="View" line="395"/>
                    <scope line="396"/>
                </method>
                <method name="toModelPosition" type="int" line="402">
                    <params>
                        <param name="index" type="int"/>
                    </params>
                </method>
                <method name="toIteratorIndex" type="int" line="406">
                    <params>
                        <param name="pos" type="int"/>
                    </params>
                </method>
                <method name="setShaper" type="void" line="410">
                    <params>
                        <param name="shaper" type="Object"/>
                    </params>
                </method>
                <javadoc line="416">
                    Returns the index of the first character of the run
                      with respect to all attributes containing the current character.                    
                </javadoc>
                <method name="getRunStart" type="int" line="420">
                    <declaration name="pos" type="int" line="421"/>
                    <declaration name="i" type="int" line="422"/>
                    <declaration name="child" type="View" line="423"/>
                </method>
                <javadoc line="427">
                    Returns the index of the first character of the run
                      with respect to the given attribute containing the current character.                    
                </javadoc>
                <method name="getRunStart" type="int" line="431">
                    <params>
                        <param name="attribute" type="AttributedCharacterIterator.Attribute"/>
                    </params>
                    <scope line="432">
                        <declaration name="pos" type="int" line="433"/>
                        <declaration name="i" type="int" line="434"/>
                        <scope line="435"/>
                    </scope>
                </method>
                <javadoc line="442">
                    Returns the index of the first character of the run
                      with respect to the given attributes containing the current character.                    
                </javadoc>
                <method name="getRunStart" type="int" line="446">
                    <params>
                        <param name="attributes" type="Set<? extends Attribute>"/>
                    </params>
                    <declaration name="index" type="int" line="447"/>
                    <declaration name="a" type="Object[]" line="448"/>
                    <scope line="449">
                        <declaration name="attr" type="TextAttribute" line="450"/>
                    </scope>
                </method>
                <javadoc line="456">
                    Returns the index of the first character following the run
                      with respect to all attributes containing the current character.                    
                </javadoc>
                <method name="getRunLimit" type="int" line="460">
                    <declaration name="pos" type="int" line="461"/>
                    <declaration name="i" type="int" line="462"/>
                    <declaration name="child" type="View" line="463"/>
                </method>
                <javadoc line="467">
                    Returns the index of the first character following the run
                      with respect to the given attribute containing the current character.                    
                </javadoc>
                <method name="getRunLimit" type="int" line="471">
                    <params>
                        <param name="attribute" type="AttributedCharacterIterator.Attribute"/>
                    </params>
                    <scope line="472">
                        <declaration name="pos" type="int" line="473"/>
                        <declaration name="i" type="int" line="474"/>
                        <scope line="475"/>
                    </scope>
                </method>
                <javadoc line="482">
                    Returns the index of the first character following the run
                      with respect to the given attributes containing the current character.                    
                </javadoc>
                <method name="getRunLimit" type="int" line="486">
                    <params>
                        <param name="attributes" type="Set<? extends Attribute>"/>
                    </params>
                    <declaration name="index" type="int" line="487"/>
                    <declaration name="a" type="Object[]" line="488"/>
                    <scope line="489">
                        <declaration name="attr" type="TextAttribute" line="490"/>
                    </scope>
                </method>
                <javadoc line="496">
                    Returns a map with the attributes defined on the current
                      character.                    
                </javadoc>
                <method name="getAttributes" type="Map<Attribute,Object>" line="500">
                    <declaration name="ka" type="Object[]" line="501"/>
                    <declaration name="h" type="Hashtable&lt;Attribute,Object&gt;" line="502"/>
                    <scope line="503">
                        <declaration name="a" type="TextAttribute" line="504"/>
                        <declaration name="value" type="Object" line="505"/>
                        <scope line="506"/>
                    </scope>
                </method>
                <javadoc line="513">
                    Returns the value of the named attribute for the current character.
                      Returns null if the attribute is not defined.                    
                    <param>
                        attribute the key of the attribute whose value is requested.                        
                    </param>
                </javadoc>
                <method name="getAttribute" type="Object" line="518">
                    <params>
                        <param name="attribute" type="AttributedCharacterIterator.Attribute"/>
                    </params>
                    <declaration name="pos" type="int" line="519"/>
                    <declaration name="childIndex" type="int" line="520"/>
                    <scope line="521"/>
                    <scope line="523"/>
                    <scope line="526"/>
                </method>
                <javadoc line="532">
                    Returns the keys of all attributes defined on the
                      iterator&apos;s text range. The set is empty if no
                      attributes are defined.                    
                </javadoc>
                <method name="getAllAttributeKeys" type="Set<Attribute>" line="537"/>
                <declaration name="v" type="View" line="541"/>
                <declaration name="keys" type="Set&lt;Attribute&gt;" line="543"/>
                <scope line="545"/>
                <declaration name="shaper" type="Object" line="552"/>
            </class>
        </class>
    </source>