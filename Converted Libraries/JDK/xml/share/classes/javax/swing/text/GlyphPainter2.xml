<?xml version="1.0" encoding="UTF-8"?>
    <source package="javax.swing.text">
        <import package="java.text"/>
        <import package="java.awt"/>
        <import package="java.awt.font"/>
        <import package="java.awt.geom.Rectangle2D"/>
        <class name="GlyphPainter2" line="32">
            <extends class="GlyphView.GlyphPainter"/>
            <comment line="383">
                --- variables ---------------------------------------------                
            </comment>
            <javadoc line="32">
                A class to perform rendering of the glyphs.
                  This can be implemented to be stateless, or
                  to hold some information as a cache to
                  facilitate faster rendering and model/view
                  translation.  At a minimum, the GlyphPainter
                  allows a View implementation to perform its
                  duties independent of a particular version
                  of JVM and selection of capabilities (i.e.
                  shaping for i18n, etc).
                  &lt;p&gt;
                  This implementation is intended for operation
                  under the JDK.  It uses the
                  java.awt.font.TextLayout class to do i18n capable
                  rendering.                
                <author>
                    Timothy Prinzing                    
                </author>
                <see>
                    GlyphView                    
                </see>
            </javadoc>
            <method name="GlyphPainter2" type="constructor" line="53">
                <params>
                    <param name="layout" type="TextLayout"/>
                </params>
            </method>
            <javadoc line="57">
                Create a painter to use for the given GlyphView.                
            </javadoc>
            <method name="getPainter" type="GlyphView.GlyphPainter" line="60">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="p0" type="int"/>
                    <param name="p1" type="int"/>
                </params>
            </method>
            <javadoc line="64">
                Determine the span the glyphs given a start location
                  (for tab expansion).  This implementation assumes it
                  has no tabs (i.e. TextLayout doesn&apos;t deal with tab
                  expansion).                
            </javadoc>
            <method name="getSpan" type="float" line="71">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="p0" type="int"/>
                    <param name="p1" type="int"/>
                    <param name="e" type="TabExpander"/>
                    <param name="x" type="float"/>
                </params>
                <scope line="73"/>
                <declaration name="p" type="int" line="76"/>
                <declaration name="index0" type="int" line="77"/>
                <declaration name="index1" type="int" line="78"/>
                <declaration name="hit0" type="TextHitInfo" line="80"/>
                <declaration name="hit1" type="TextHitInfo" line="81"/>
                <declaration name="locs" type="float[]" line="82"/>
                <declaration name="x0" type="float" line="83"/>
                <declaration name="x1" type="float" line="85"/>
            </method>
            <method name="getHeight" type="float" line="89">
                <params>
                    <param name="v" type="GlyphView"/>
                </params>
            </method>
            <javadoc line="93">
                Fetch the ascent above the baseline for the glyphs
                  corresponding to the given range in the model.                
            </javadoc>
            <method name="getAscent" type="float" line="97">
                <params>
                    <param name="v" type="GlyphView"/>
                </params>
            </method>
            <javadoc line="101">
                Fetch the descent below the baseline for the glyphs
                  corresponding to the given range in the model.                
            </javadoc>
            <method name="getDescent" type="float" line="105">
                <params>
                    <param name="v" type="GlyphView"/>
                </params>
            </method>
            <javadoc line="109">
                Paint the glyphs for the given view.  This is implemented
                  to only render if the Graphics is of type Graphics2D which
                  is required by TextLayout (and this should be the case if
                  running on the JDK).                
            </javadoc>
            <method name="paint" type="void" line="115">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="g" type="Graphics"/>
                    <param name="a" type="Shape"/>
                    <param name="p0" type="int"/>
                    <param name="p1" type="int"/>
                </params>
                <comment line="123">
                    TextLayout can&apos;t render only part of it&apos;s range, so if a                    
                </comment>
                <comment line="124">
                    partial range is required, add a clip region.                    
                </comment>
                <scope line="116">
                    <declaration name="alloc" type="Rectangle2D" line="117"/>
                    <declaration name="g2d" type="Graphics2D" line="118"/>
                    <declaration name="y" type="float" line="119"/>
                    <declaration name="x" type="float" line="120"/>
                    <scope line="121">
                        <scope line="122">
                            <declaration name="s" type="Shape" line="125"/>
                            <declaration name="savedClip" type="Shape" line="127"/>
                        </scope>
                        <scope line="131"/>
                    </scope>
                    <scope line="132"/>
                </scope>
            </method>
            <method name="modelToView" type="Shape" line="139">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="pos" type="int"/>
                    <param name="bias" type="Position.Bias"/>
                    <param name="a" type="Shape"/>
                </params>
                <comment line="146">
                    vertical at the baseline, should use slope and check if glyphs                    
                </comment>
                <comment line="147">
                    are being rendered vertically.                    
                </comment>
                <declaration name="offs" type="int" line="140"/>
                <declaration name="alloc" type="Rectangle2D" line="141"/>
                <declaration name="hit" type="TextHitInfo" line="142"/>
                <declaration name="locs" type="float[]" line="144"/>
            </method>
            <javadoc line="152">
                Provides a mapping from the view coordinate space to the logical
                  coordinate space of the model.                
                <param>
                    v the view containing the view coordinates                    
                </param>
                <param>
                    x the X coordinate                    
                </param>
                <param>
                    y the Y coordinate                    
                </param>
                <param>
                    a the allocated region to render into                    
                </param>
                <param>
                    biasReturn either <code>Position.Bias.Forward</code>
                      or <code>Position.Bias.Backward</code> is returned as the
                      zero-th element of this array                    
                </param>
                <return>
                    the location within the model that best represents the
                      given point of view                    
                </return>
                <see>
                    View#viewToModel                    
                </see>
            </javadoc>
            <method name="viewToModel" type="int" line="168">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="x" type="float"/>
                    <param name="y" type="float"/>
                    <param name="a" type="Shape"/>
                    <param name="biasReturn" type="Position.Bias[]"/>
                </params>
                <comment line="171">
                    Move the y co-ord of the hit onto the baseline.  This is because TextLayout supports                    
                </comment>
                <comment line="172">
                    italic carets and we do not.                    
                </comment>
                <declaration name="alloc" type="Rectangle2D" line="170"/>
                <declaration name="hit" type="TextHitInfo" line="173"/>
                <declaration name="pos" type="int" line="174"/>
                <scope line="176"/>
            </method>
            <javadoc line="184">
                Determines the model location that represents the
                  maximum advance that fits within the given span.
                  This could be used to break the given view.  The result
                  should be a location just shy of the given advance.  This
                  differs from viewToModel which returns the closest
                  position which might be proud of the maximum advance.                
                <param>
                    v the view to find the model location to break at.                    
                </param>
                <param>
                    p0 the location in the model where the
                      fragment should start it's representation >= 0.                    
                </param>
                <param>
                    pos the graphic location along the axis that the
                      broken view would occupy >= 0.  This may be useful for
                      things like tab calculations.                    
                </param>
                <param>
                    len specifies the distance into the view
                      where a potential break is desired >= 0.                    
                </param>
                <return>
                    the maximum model location possible for a break.                    
                </return>
                <see>
                    View#breakView                    
                </see>
            </javadoc>
            <method name="getBoundedPosition" type="int" line="203">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="p0" type="int"/>
                    <param name="x" type="float"/>
                    <param name="len" type="float"/>
                </params>
                <comment line="206">
                    note: this only works because swing uses TextLayouts that are                    
                </comment>
                <comment line="207">
                    only pure rtl or pure ltr                    
                </comment>
                <declaration name="hit" type="TextHitInfo" line="208"/>
                <scope line="209"/>
                <scope line="211"/>
            </method>
            <javadoc line="217">
                Provides a way to determine the next visually represented model
                  location that one might place a caret.  Some views may not be
                  visible, they might not be in the same order found in the model, or
                  they just might not allow access to some of the locations in the
                  model.                
                <param>
                    v the view to use                    
                </param>
                <param>
                    pos the position to convert >= 0                    
                </param>
                <param>
                    a the allocated region to render into                    
                </param>
                <param>
                    direction the direction from the current position that can
                      be thought of as the arrow keys typically found on a keyboard.
                      This may be SwingConstants.WEST, SwingConstants.EAST,
                      SwingConstants.NORTH, or SwingConstants.SOUTH.                    
                </param>
                <return>
                    the location within the model that best represents the next
                      location visual position.                    
                </return>
                <exception>
                    BadLocationException                    
                </exception>
                <exception>
                    IllegalArgumentException for an invalid direction                    
                </exception>
            </javadoc>
            <method name="getNextVisualPositionFrom" type="int" line="240">
                <params>
                    <param name="v" type="GlyphView"/>
                    <param name="pos" type="int"/>
                    <param name="b" type="Position.Bias"/>
                    <param name="a" type="Shape"/>
                    <param name="direction" type="int"/>
                    <param name="biasRet" type="Position.Bias[]"/>
                </params>
                <comment line="263">
                    End case for bidi text where newline is at beginning                    
                </comment>
                <comment line="264">
                    of line.                    
                </comment>
                <comment line="268">
                    Entering view from the left.                    
                </comment>
                <comment line="293">
                    If the layout&apos;s base direction is different from                    
                </comment>
                <comment line="294">
                    this view&apos;s run direction, we need to use the weak                    
                </comment>
                <comment line="295">
                    carrat.                    
                </comment>
                <comment line="301">
                    A move to the right from an internal position will                    
                </comment>
                <comment line="302">
                    only take us to the endOffset in a left to right run.                    
                </comment>
                <comment line="324">
                    End case for bidi text where newline is at beginning                    
                </comment>
                <comment line="325">
                    of line.                    
                </comment>
                <comment line="329">
                    Entering view from the right                    
                </comment>
                <comment line="354">
                    If the layout&apos;s base direction is different from                    
                </comment>
                <comment line="355">
                    this view&apos;s run direction, we need to use the weak                    
                </comment>
                <comment line="356">
                    carrat.                    
                </comment>
                <comment line="362">
                    A move to the left from an internal position will                    
                </comment>
                <comment line="363">
                    only take us to the endOffset in a right to left run.                    
                </comment>
                <declaration name="startOffset" type="int" line="242"/>
                <declaration name="endOffset" type="int" line="243"/>
                <declaration name="text" type="Segment" line="244"/>
                <declaration name="doc" type="AbstractDocument" line="245"/>
                <declaration name="viewIsLeftToRight" type="boolean" line="246"/>
                <declaration name="currentHit" type="TextHitInfo" line="247"/>
                <scope line="258">
                    <scope line="259"/>
                </scope>
                <scope line="267">
                    <scope line="269"/>
                    <scope line="272">
                        <declaration name="c" type="char" line="274"/>
                        <scope line="276"/>
                    </scope>
                </scope>
                <scope line="289"/>
                <scope line="292"/>
                <scope line="300">
                    <declaration name="c" type="char" line="304"/>
                    <scope line="306"/>
                </scope>
                <scope line="311"/>
                <scope line="319">
                    <scope line="320"/>
                </scope>
                <scope line="328">
                    <scope line="330">
                        <declaration name="c" type="char" line="332"/>
                        <scope line="334"/>
                    </scope>
                    <scope line="340"/>
                </scope>
                <scope line="350"/>
                <scope line="353"/>
                <scope line="361">
                    <declaration name="c" type="char" line="365"/>
                    <scope line="367"/>
                </scope>
                <scope line="372"/>
            </method>
            <declaration name="layout" type="TextLayout" line="384"/>
        </class>
    </source>