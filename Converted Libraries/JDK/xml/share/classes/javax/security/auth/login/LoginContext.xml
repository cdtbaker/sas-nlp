<?xml version="1.0" encoding="UTF-8"?>
    <source package="javax.security.auth.login">
        <import package="java.lang.reflect.Constructor"/>
        <import package="java.lang.reflect.Method"/>
        <import package="java.lang.reflect.InvocationTargetException"/>
        <import package="java.util.LinkedList"/>
        <import package="java.util.Map"/>
        <import package="java.util.HashMap"/>
        <import package="java.text.MessageFormat"/>
        <import package="javax.security.auth.Subject"/>
        <import package="javax.security.auth.AuthPermission"/>
        <import package="javax.security.auth.callback"/>
        <import package="java.security.AccessController"/>
        <import package="java.security.AccessControlContext"/>
        <import package="sun.security.util.PendingException"/>
        <import package="sun.security.util.ResourcesMgr"/>
        <class name="LoginContext" line="43">
            <comment line="227">
                state saved in the event a user-specified asynchronous exception                
            </comment>
            <comment line="228">
                was specified and thrown                
            </comment>
            <javadoc line="43">
                &lt;p&gt; The &lt;code&gt;LoginContext&lt;/code&gt; class describes the basic methods used
                  to authenticate Subjects and provides a way to develop an
                  application independent of the underlying authentication technology.
                  A &lt;code&gt;Configuration&lt;/code&gt; specifies the authentication technology, or
                  &lt;code&gt;LoginModule&lt;/code&gt;, to be used with a particular application.
                  Different LoginModules can be plugged in under an application
                  without requiring any modifications to the application itself.
                  &lt;p&gt; In addition to supporting &lt;i&gt;pluggable&lt;/i&gt; authentication, this class
                  also supports the notion of &lt;i&gt;stacked&lt;/i&gt; authentication.
                  Applications may be configured to use more than one
                  LoginModule.  For example, one could
                  configure both a Kerberos LoginModule and a smart card
                  LoginModule under an application.
                  &lt;p&gt; A typical caller instantiates a LoginContext with
                  a &lt;i&gt;name&lt;/i&gt; and a &lt;code&gt;CallbackHandler&lt;/code&gt;.
                  LoginContext uses the &lt;i&gt;name&lt;/i&gt; as the index into a
                  Configuration to determine which LoginModules should be used,
                  and which ones must succeed in order for the overall authentication to
                  succeed.  The &lt;code&gt;CallbackHandler&lt;/code&gt; is passed to the underlying
                  LoginModules so they may communicate and interact with users
                  (prompting for a username and password via a graphical user interface,
                  for example).
                  &lt;p&gt; Once the caller has instantiated a LoginContext,
                  it invokes the &lt;code&gt;login&lt;/code&gt; method to authenticate
                  a &lt;code&gt;Subject&lt;/code&gt;.  The &lt;code&gt;login&lt;/code&gt; method invokes
                  the configured modules to perform their respective types of authentication
                  (username/password, smart card pin verification, etc.).
                  Note that the LoginModules will not attempt authentication retries nor
                  introduce delays if the authentication fails.
                  Such tasks belong to the LoginContext caller.
                  &lt;p&gt; If the &lt;code&gt;login&lt;/code&gt; method returns without
                  throwing an exception, then the overall authentication succeeded.
                  The caller can then retrieve
                  the newly authenticated Subject by invoking the
                  &lt;code&gt;getSubject&lt;/code&gt; method.  Principals and Credentials associated
                  with the Subject may be retrieved by invoking the Subject&apos;s
                  respective &lt;code&gt;getPrincipals&lt;/code&gt;, &lt;code&gt;getPublicCredentials&lt;/code&gt;,
                  and &lt;code&gt;getPrivateCredentials&lt;/code&gt; methods.
                  &lt;p&gt; To logout the Subject, the caller calls
                  the &lt;code&gt;logout&lt;/code&gt; method.  As with the &lt;code&gt;login&lt;/code&gt;
                  method, this &lt;code&gt;logout&lt;/code&gt; method invokes the &lt;code&gt;logout&lt;/code&gt;
                  method for the configured modules.
                  &lt;p&gt; A LoginContext should not be used to authenticate
                  more than one Subject.  A separate LoginContext
                  should be used to authenticate each different Subject.
                  &lt;p&gt; The following documentation applies to all LoginContext constructors:
                  &lt;ol&gt;
                  &lt;li&gt; &lt;code&gt;Subject&lt;/code&gt;
                  &lt;ul&gt;
                  &lt;li&gt; If the constructor has a Subject
                  input parameter, the LoginContext uses the caller-specified
                  Subject object.
                  &lt;p&gt;
                  &lt;li&gt; If the caller specifies a &lt;code&gt;null&lt;/code&gt; Subject
                  and a &lt;code&gt;null&lt;/code&gt; value is permitted,
                  the LoginContext instantiates a new Subject.
                  &lt;p&gt;
                  &lt;li&gt; If the constructor does &lt;b&gt;not&lt;/b&gt; have a Subject
                  input parameter, the LoginContext instantiates a new Subject.
                  &lt;p&gt;
                  &lt;/ul&gt;
                  &lt;li&gt; &lt;code&gt;Configuration&lt;/code&gt;
                  &lt;ul&gt;
                  &lt;li&gt; If the constructor has a Configuration
                  input parameter and the caller specifies a non-null Configuration,
                  the LoginContext uses the caller-specified Configuration.
                  &lt;p&gt;
                  If the constructor does &lt;b&gt;not&lt;/b&gt; have a Configuration
                  input parameter, or if the caller specifies a &lt;code&gt;null&lt;/code&gt;
                  Configuration object, the constructor uses the following call to
                  get the installed Configuration:
                  &lt;pre&gt;
                  config = Configuration.getConfiguration();
                  &lt;/pre&gt;
                  For both cases,
                  the &lt;i&gt;name&lt;/i&gt; argument given to the constructor is passed to the
                  &lt;code&gt;Configuration.getAppConfigurationEntry&lt;/code&gt; method.
                  If the Configuration has no entries for the specified &lt;i&gt;name&lt;/i&gt;,
                  then the &lt;code&gt;LoginContext&lt;/code&gt; calls
                  &lt;code&gt;getAppConfigurationEntry&lt;/code&gt; with the name, &quot;&lt;i&gt;other&lt;/i&gt;&quot;
                  (the default entry name).  If there is no entry for &quot;&lt;i&gt;other&lt;/i&gt;&quot;,
                  then a &lt;code&gt;LoginException&lt;/code&gt; is thrown.
                  &lt;p&gt;
                  &lt;li&gt; When LoginContext uses the installed Configuration, the caller
                  requires the createLoginContext.&lt;em&gt;name&lt;/em&gt; and possibly
                  createLoginContext.other AuthPermissions. Furthermore, the
                  LoginContext will invoke configured modules from within an
                  &lt;code&gt;AccessController.doPrivileged&lt;/code&gt; call so that modules that
                  perform security-sensitive tasks (such as connecting to remote hosts,
                  and updating the Subject) will require the respective permissions, but
                  the callers of the LoginContext will not require those permissions.
                  &lt;p&gt;
                  &lt;li&gt; When LoginContext uses a caller-specified Configuration, the caller
                  does not require any createLoginContext AuthPermission.  The LoginContext
                  saves the &lt;code&gt;AccessControlContext&lt;/code&gt; for the caller,
                  and invokes the configured modules from within an
                  &lt;tt&gt;AccessController.doPrivileged&lt;/tt&gt; call constrained by that context.
                  This means the caller context (stored when the LoginContext was created)
                  must have sufficient permissions to perform any security-sensitive tasks
                  that the modules may perform.
                  &lt;p&gt;
                  &lt;/ul&gt;
                  &lt;li&gt; &lt;code&gt;CallbackHandler&lt;/code&gt;
                  &lt;ul&gt;
                  &lt;li&gt; If the constructor has a CallbackHandler
                  input parameter, the LoginContext uses the caller-specified
                  CallbackHandler object.
                  &lt;p&gt;
                  &lt;li&gt; If the constructor does &lt;b&gt;not&lt;/b&gt; have a CallbackHandler
                  input parameter, or if the caller specifies a &lt;code&gt;null&lt;/code&gt;
                  CallbackHandler object (and a &lt;code&gt;null&lt;/code&gt; value is permitted),
                  the LoginContext queries the
                  &lt;i&gt;auth.login.defaultCallbackHandler&lt;/i&gt; security property
                  for the fully qualified class name of a default handler implementation.
                  If the security property is not set,
                  then the underlying modules will not have a
                  CallbackHandler for use in communicating
                  with users.  The caller thus assumes that the configured
                  modules have alternative means for authenticating the user.
                  &lt;p&gt;
                  &lt;li&gt; When the LoginContext uses the installed Configuration (instead of
                  a caller-specified Configuration, see above),
                  then this LoginContext must wrap any
                  caller-specified or default CallbackHandler implementation
                  in a new CallbackHandler implementation
                  whose &lt;code&gt;handle&lt;/code&gt; method implementation invokes the
                  specified CallbackHandler&apos;s &lt;code&gt;handle&lt;/code&gt; method in a
                  &lt;code&gt;java.security.AccessController.doPrivileged&lt;/code&gt; call
                  constrained by the caller&apos;s current &lt;code&gt;AccessControlContext&lt;/code&gt;.
                  &lt;/ul&gt;
                  &lt;/ol&gt;
                  &lt;p&gt; Note that Security Properties
                  (such as &lt;code&gt;auth.login.defaultCallbackHandler&lt;/code&gt;)
                  can be set programmatically via the
                  &lt;code&gt;java.security.Security&lt;/code&gt; class,
                  or statically in the Java security properties file located in the
                  file named &amp;lt;JAVA_HOME&amp;gt;/lib/security/java.security.
                  &amp;lt;JAVA_HOME&amp;gt; refers to the value of the java.home system property,
                  and specifies the directory where the JRE is installed.                
                <see>
                    java.security.Security                    
                </see>
                <see>
                    javax.security.auth.AuthPermission                    
                </see>
                <see>
                    javax.security.auth.Subject                    
                </see>
                <see>
                    javax.security.auth.callback.CallbackHandler                    
                </see>
                <see>
                    javax.security.auth.login.Configuration                    
                </see>
                <see>
                    javax.security.auth.spi.LoginModule                    
                </see>
            </javadoc>
            <declaration name="INIT_METHOD" type="String" line="205"/>
            <declaration name="LOGIN_METHOD" type="String" line="206"/>
            <declaration name="COMMIT_METHOD" type="String" line="207"/>
            <declaration name="ABORT_METHOD" type="String" line="208"/>
            <declaration name="LOGOUT_METHOD" type="String" line="209"/>
            <declaration name="OTHER" type="String" line="210"/>
            <declaration name="DEFAULT_HANDLER" type="String" line="211"/>
            <declaration name="subject" type="Subject" line="213"/>
            <declaration name="subjectProvided" type="boolean" line="214"/>
            <declaration name="loginSucceeded" type="boolean" line="215"/>
            <declaration name="callbackHandler" type="CallbackHandler" line="216"/>
            <declaration name="state" type="Map" line="217"/>
            <declaration name="config" type="Configuration" line="219"/>
            <declaration name="configProvided" type="boolean" line="220"/>
            <declaration name="creatorAcc" type="AccessControlContext" line="221"/>
            <declaration name="moduleStack" type="ModuleInfo[]" line="222"/>
            <declaration name="contextClassLoader" type="ClassLoader" line="223"/>
            <declaration name="PARAMS" type="Class[]" line="224"/>
            <declaration name="moduleIndex" type="int" line="229"/>
            <declaration name="firstError" type="LoginException" line="230"/>
            <declaration name="firstRequiredError" type="LoginException" line="231"/>
            <declaration name="success" type="boolean" line="232"/>
            <declaration name="debug" type="sun.security.util.Debug" line="234"/>
            <method name="init" type="void" line="237">
                <params>
                    <param name="name" type="String"/>
                </params>
                <comment line="249">
                    get the Configuration                    
                </comment>
                <comment line="259">
                    get the LoginModules configured for this application                    
                </comment>
                <comment line="278">
                    clone returned array                    
                </comment>
                <declaration name="sm" type="SecurityManager" line="239"/>
                <scope line="240"/>
                <scope line="250">
                    <anonymous_class line="252">
                        <method name="run" type="Configuration" line="253"/>
                    </anonymous_class>
                </scope>
                <declaration name="entries" type="AppConfigurationEntry[]" line="260"/>
                <scope line="261">
                    <scope line="263"/>
                    <scope line="269">
                        <declaration name="form" type="MessageFormat" line="270"/>
                        <declaration name="source" type="Object[]" line="272"/>
                    </scope>
                </scope>
                <scope line="277"/>
                <anonymous_class line="288">
                    <method name="run" type="ClassLoader" line="289"/>
                </anonymous_class>
            </method>
            <method name="loadDefaultCallbackHandler" type="void" line="295">
                <comment line="297">
                    get the default handler class                    
                </comment>
                <comment line="319">
                    secure it with the caller&apos;s ACC                    
                </comment>
                <scope line="298">
                    <declaration name="finalLoader" type="ClassLoader" line="300"/>
                    <anonymous_class line="303">
                        <method name="run" type="CallbackHandler" line="304">
                            <declaration name="defaultHandler" type="String" line="305"/>
                            <declaration name="c" type="Class" line="309"/>
                        </method>
                    </anonymous_class>
                </scope>
                <scope line="315"/>
                <scope line="320"/>
            </method>
            <javadoc line="327">
                Instantiate a new &lt;code&gt;LoginContext&lt;/code&gt; object with a name.                
                <param>
                    name the name used as the index into the
                      <code>Configuration</code>.                    
                </param>
                <exception>
                    LoginException if the caller-specified <code>name</code>
                      does not appear in the <code>Configuration</code>
                      and there is no <code>Configuration</code> entry
                      for "<i>other</i>", or if the
                      <i>auth.login.defaultCallbackHandler</i>
                      security property was set, but the implementation
                      class could not be loaded.
                      <p>                    
                </exception>
                <exception>
                    SecurityException if a SecurityManager is set and
                      the caller does not have
                      AuthPermission("createLoginContext.<i>name</i>"),
                      or if a configuration entry for <i>name</i> does not exist and
                      the caller does not additionally have
                      AuthPermission("createLoginContext.other")                    
                </exception>
            </javadoc>
            <method name="LoginContext" type="constructor" line="348">
                <params>
                    <param name="name" type="String"/>
                </params>
            </method>
            <javadoc line="353">
                Instantiate a new &lt;code&gt;LoginContext&lt;/code&gt; object with a name
                  and a &lt;code&gt;Subject&lt;/code&gt; object.
                  &lt;p&gt;                
                <param>
                    name the name used as the index into the
                      <code>Configuration</code>. <p>                    
                </param>
                <param>
                    subject the <code>Subject</code> to authenticate.                    
                </param>
                <exception>
                    LoginException if the caller-specified <code>name</code>
                      does not appear in the <code>Configuration</code>
                      and there is no <code>Configuration</code> entry
                      for "<i>other</i>", if the caller-specified <code>subject</code>
                      is <code>null</code>, or if the
                      <i>auth.login.defaultCallbackHandler</i>
                      security property was set, but the implementation
                      class could not be loaded.
                      <p>                    
                </exception>
                <exception>
                    SecurityException if a SecurityManager is set and
                      the caller does not have
                      AuthPermission("createLoginContext.<i>name</i>"),
                      or if a configuration entry for <i>name</i> does not exist and
                      the caller does not additionally have
                      AuthPermission("createLoginContext.other")                    
                </exception>
            </javadoc>
            <method name="LoginContext" type="constructor" line="381">
                <params>
                    <param name="name" type="String"/>
                    <param name="subject" type="Subject"/>
                </params>
            </method>
            <javadoc line="391">
                Instantiate a new &lt;code&gt;LoginContext&lt;/code&gt; object with a name
                  and a &lt;code&gt;CallbackHandler&lt;/code&gt; object.
                  &lt;p&gt;                
                <param>
                    name the name used as the index into the
                      <code>Configuration</code>. <p>                    
                </param>
                <param>
                    callbackHandler the <code>CallbackHandler</code> object used by
                      LoginModules to communicate with the user.                    
                </param>
                <exception>
                    LoginException if the caller-specified <code>name</code>
                      does not appear in the <code>Configuration</code>
                      and there is no <code>Configuration</code> entry
                      for "<i>other</i>", or if the caller-specified
                      <code>callbackHandler</code> is <code>null</code>.
                      <p>                    
                </exception>
                <exception>
                    SecurityException if a SecurityManager is set and
                      the caller does not have
                      AuthPermission("createLoginContext.<i>name</i>"),
                      or if a configuration entry for <i>name</i> does not exist and
                      the caller does not additionally have
                      AuthPermission("createLoginContext.other")                    
                </exception>
            </javadoc>
            <method name="LoginContext" type="constructor" line="417">
                <params>
                    <param name="name" type="String"/>
                    <param name="callbackHandler" type="CallbackHandler"/>
                </params>
            </method>
            <javadoc line="427">
                Instantiate a new &lt;code&gt;LoginContext&lt;/code&gt; object with a name,
                  a &lt;code&gt;Subject&lt;/code&gt; to be authenticated, and a
                  &lt;code&gt;CallbackHandler&lt;/code&gt; object.
                  &lt;p&gt;                
                <param>
                    name the name used as the index into the
                      <code>Configuration</code>. <p>                    
                </param>
                <param>
                    subject the <code>Subject</code> to authenticate. <p>                    
                </param>
                <param>
                    callbackHandler the <code>CallbackHandler</code> object used by
                      LoginModules to communicate with the user.                    
                </param>
                <exception>
                    LoginException if the caller-specified <code>name</code>
                      does not appear in the <code>Configuration</code>
                      and there is no <code>Configuration</code> entry
                      for "<i>other</i>", or if the caller-specified
                      <code>subject</code> is <code>null</code>,
                      or if the caller-specified
                      <code>callbackHandler</code> is <code>null</code>.
                      <p>                    
                </exception>
                <exception>
                    SecurityException if a SecurityManager is set and
                      the caller does not have
                      AuthPermission("createLoginContext.<i>name</i>"),
                      or if a configuration entry for <i>name</i> does not exist and
                      the caller does not additionally have
                      AuthPermission("createLoginContext.other")                    
                </exception>
            </javadoc>
            <method name="LoginContext" type="constructor" line="458">
                <params>
                    <param name="name" type="String"/>
                    <param name="subject" type="Subject"/>
                    <param name="callbackHandler" type="CallbackHandler"/>
                </params>
            </method>
            <javadoc line="468">
                Instantiate a new &lt;code&gt;LoginContext&lt;/code&gt; object with a name,
                  a &lt;code&gt;Subject&lt;/code&gt; to be authenticated,
                  a &lt;code&gt;CallbackHandler&lt;/code&gt; object, and a login
                  &lt;code&gt;Configuration&lt;/code&gt;.
                  &lt;p&gt;                
                <param>
                    name the name used as the index into the caller-specified
                      <code>Configuration</code>. <p>                    
                </param>
                <param>
                    subject the <code>Subject</code> to authenticate,
                      or <code>null</code>. <p>                    
                </param>
                <param>
                    callbackHandler the <code>CallbackHandler</code> object used by
                      LoginModules to communicate with the user, or <code>null</code>.
                      <p>                    
                </param>
                <param>
                    config the <code>Configuration</code> that lists the
                      login modules to be called to perform the authentication,
                      or <code>null</code>.                    
                </param>
                <exception>
                    LoginException if the caller-specified <code>name</code>
                      does not appear in the <code>Configuration</code>
                      and there is no <code>Configuration</code> entry
                      for "<i>other</i>".
                      <p>                    
                </exception>
                <exception>
                    SecurityException if a SecurityManager is set,
                      <i>config</i> is <code>null</code>,
                      and either the caller does not have
                      AuthPermission("createLoginContext.<i>name</i>"),
                      or if a configuration entry for <i>name</i> does not exist and
                      the caller does not additionally have
                      AuthPermission("createLoginContext.other")                    
                </exception>
                <since>
                    1.5                    
                </since>
            </javadoc>
            <method name="LoginContext" type="constructor" line="507">
                <params>
                    <param name="name" type="String"/>
                    <param name="subject" type="Subject"/>
                    <param name="callbackHandler" type="CallbackHandler"/>
                    <param name="config" type="Configuration"/>
                </params>
                <scope line="510"/>
                <scope line="515"/>
                <scope line="519"/>
                <scope line="521"/>
                <scope line="525"/>
            </method>
            <javadoc line="530">
                Perform the authentication.
                  &lt;p&gt; This method invokes the &lt;code&gt;login&lt;/code&gt; method for each
                  LoginModule configured for the &lt;i&gt;name&lt;/i&gt; specified to the
                  &lt;code&gt;LoginContext&lt;/code&gt; constructor, as determined by the login
                  &lt;code&gt;Configuration&lt;/code&gt;.  Each &lt;code&gt;LoginModule&lt;/code&gt;
                  then performs its respective type of authentication
                  (username/password, smart card pin verification, etc.).
                  &lt;p&gt; This method completes a 2-phase authentication process by
                  calling each configured LoginModule&apos;s &lt;code&gt;commit&lt;/code&gt; method
                  if the overall authentication succeeded (the relevant REQUIRED,
                  REQUISITE, SUFFICIENT, and OPTIONAL LoginModules succeeded),
                  or by calling each configured LoginModule&apos;s &lt;code&gt;abort&lt;/code&gt; method
                  if the overall authentication failed.  If authentication succeeded,
                  each successful LoginModule&apos;s &lt;code&gt;commit&lt;/code&gt; method associates
                  the relevant Principals and Credentials with the &lt;code&gt;Subject&lt;/code&gt;.
                  If authentication failed, each LoginModule&apos;s &lt;code&gt;abort&lt;/code&gt; method
                  removes/destroys any previously stored state.
                  &lt;p&gt; If the &lt;code&gt;commit&lt;/code&gt; phase of the authentication process
                  fails, then the overall authentication fails and this method
                  invokes the &lt;code&gt;abort&lt;/code&gt; method for each configured
                  &lt;code&gt;LoginModule&lt;/code&gt;.
                  &lt;p&gt; If the &lt;code&gt;abort&lt;/code&gt; phase
                  fails for any reason, then this method propagates the
                  original exception thrown either during the &lt;code&gt;login&lt;/code&gt; phase
                  or the &lt;code&gt;commit&lt;/code&gt; phase.  In either case, the overall
                  authentication fails.
                  &lt;p&gt; In the case where multiple LoginModules fail,
                  this method propagates the exception raised by the first
                  &lt;code&gt;LoginModule&lt;/code&gt; which failed.
                  &lt;p&gt; Note that if this method enters the &lt;code&gt;abort&lt;/code&gt; phase
                  (either the &lt;code&gt;login&lt;/code&gt; or &lt;code&gt;commit&lt;/code&gt; phase failed),
                  this method invokes all LoginModules configured for the
                  application regardless of their respective &lt;code&gt;Configuration&lt;/code&gt;
                  flag parameters.  Essentially this means that &lt;code&gt;Requisite&lt;/code&gt;
                  and &lt;code&gt;Sufficient&lt;/code&gt; semantics are ignored during the
                  &lt;code&gt;abort&lt;/code&gt; phase.  This guarantees that proper cleanup
                  and state restoration can take place.
                  &lt;p&gt;                
                <exception>
                    LoginException if the authentication fails.                    
                </exception>
            </javadoc>
            <method name="login" type="void" line="579">
                <comment line="589">
                    module invoked in doPrivileged with creatorAcc                    
                </comment>
                <comment line="593">
                    module invoked in doPrivileged                    
                </comment>
                <scope line="583"/>
                <scope line="587">
                    <scope line="588"/>
                    <scope line="592"/>
                </scope>
                <scope line="598">
                    <scope line="599">
                        <scope line="600"/>
                        <scope line="602"/>
                    </scope>
                    <scope line="605"/>
                </scope>
            </method>
            <javadoc line="612">
                Logout the &lt;code&gt;Subject&lt;/code&gt;.
                  &lt;p&gt; This method invokes the &lt;code&gt;logout&lt;/code&gt; method for each
                  &lt;code&gt;LoginModule&lt;/code&gt; configured for this &lt;code&gt;LoginContext&lt;/code&gt;.
                  Each &lt;code&gt;LoginModule&lt;/code&gt; performs its respective logout procedure
                  which may include removing/destroying
                  &lt;code&gt;Principal&lt;/code&gt; and &lt;code&gt;Credential&lt;/code&gt; information
                  from the &lt;code&gt;Subject&lt;/code&gt; and state cleanup.
                  &lt;p&gt; Note that this method invokes all LoginModules configured for the
                  application regardless of their respective
                  &lt;code&gt;Configuration&lt;/code&gt; flag parameters.  Essentially this means
                  that &lt;code&gt;Requisite&lt;/code&gt; and &lt;code&gt;Sufficient&lt;/code&gt; semantics are
                  ignored for this method.  This guarantees that proper cleanup
                  and state restoration can take place.
                  &lt;p&gt;                
                <exception>
                    LoginException if the logout fails.                    
                </exception>
            </javadoc>
            <method name="logout" type="void" line="633">
                <comment line="640">
                    module invoked in doPrivileged with creatorAcc                    
                </comment>
                <comment line="643">
                    module invoked in doPrivileged                    
                </comment>
                <scope line="634"/>
                <scope line="639"/>
                <scope line="642"/>
            </method>
            <javadoc line="648">
                Return the authenticated Subject.
                  &lt;p&gt;                
                <return>
                    the authenticated Subject.  If the caller specified a
                      Subject to this LoginContext's constructor,
                      this method returns the caller-specified Subject.
                      If a Subject was not specified and authentication succeeds,
                      this method returns the Subject instantiated and used for
                      authentication by this LoginContext.
                      If a Subject was not specified, and authentication fails or
                      has not been attempted, this method returns null.                    
                </return>
            </javadoc>
            <method name="getSubject" type="Subject" line="662"/>
            <method name="clearState" type="void" line="668"/>
            <method name="throwException" type="void" line="676">
                <params>
                    <param name="originalError" type="LoginException"/>
                    <param name="le" type="LoginException"/>
                </params>
                <comment line="678">
                    first clear state                    
                </comment>
                <comment line="681">
                    throw the exception                    
                </comment>
                <declaration name="error" type="LoginException" line="682"/>
            </method>
            <javadoc line="686">
                Invokes the login, commit, and logout methods
                  from a LoginModule inside a doPrivileged block.
                  This version is called if the caller did not instantiate
                  the LoginContext with a Configuration object.                
            </javadoc>
            <method name="invokePriv" type="void" line="693">
                <params>
                    <param name="methodName" type="String"/>
                </params>
                <scope line="694">
                    <anonymous_class line="696">
                        <method name="run" type="Void" line="697"/>
                    </anonymous_class>
                </scope>
                <scope line="702"/>
            </method>
            <javadoc line="707">
                Invokes the login, commit, and logout methods
                  from a LoginModule inside a doPrivileged block restricted
                  by creatorAcc
                  This version is called if the caller instantiated
                  the LoginContext with a Configuration object.                
            </javadoc>
            <method name="invokeCreatorPriv" type="void" line="716">
                <params>
                    <param name="methodName" type="String"/>
                </params>
                <scope line="717">
                    <anonymous_class line="719">
                        <method name="run" type="Void" line="720"/>
                    </anonymous_class>
                </scope>
                <scope line="725"/>
            </method>
            <method name="invoke" type="void" line="730">
                <params>
                    <param name="methodName" type="String"/>
                </params>
                <comment line="732">
                    start at moduleIndex                    
                </comment>
                <comment line="733">
                    - this can only be non-zero if methodName is LOGIN_METHOD                    
                </comment>
                <comment line="745">
                    instantiate the LoginModule                    
                </comment>
                <comment line="754">
                    allow any object to be a LoginModule                    
                </comment>
                <comment line="755">
                    as long as it conforms to the interface                    
                </comment>
                <comment line="760">
                    call the LoginModule&apos;s initialize method                    
                </comment>
                <comment line="770">
                    invoke the LoginModule initialize method                    
                </comment>
                <comment line="774">
                    find the requested method in the LoginModule                    
                </comment>
                <comment line="780">
                    set up the arguments to be passed to the LoginModule method                    
                </comment>
                <comment line="783">
                    invoke the LoginModule method                    
                </comment>
                <comment line="789">
                    if SUFFICIENT, return if no prior REQUIRED errors                    
                </comment>
                <comment line="796">
                    clear state                    
                </comment>
                <comment line="831">
                    failure cases                    
                </comment>
                <comment line="838">
                    XXX                    
                </comment>
                <comment line="839">
                                        
                </comment>
                <comment line="840">
                    if a module&apos;s LOGIN_METHOD threw a PendingException                    
                </comment>
                <comment line="841">
                    then immediately throw it.                    
                </comment>
                <comment line="842">
                                        
                </comment>
                <comment line="843">
                    when LoginContext is called again,                    
                </comment>
                <comment line="844">
                    the module that threw the exception is invoked first                    
                </comment>
                <comment line="845">
                    (the module list is not invoked from the start).                    
                </comment>
                <comment line="846">
                    previously thrown exception state is still present.                    
                </comment>
                <comment line="847">
                                        
                </comment>
                <comment line="848">
                    it is assumed that the module which threw                    
                </comment>
                <comment line="849">
                    the exception can have its                    
                </comment>
                <comment line="850">
                    LOGIN_METHOD invoked twice in a row                    
                </comment>
                <comment line="851">
                    without any commit/abort in between.                    
                </comment>
                <comment line="852">
                                        
                </comment>
                <comment line="853">
                    in all cases when LoginContext returns                    
                </comment>
                <comment line="854">
                    (either via natural return or by throwing an exception)                    
                </comment>
                <comment line="855">
                    we need to call clearState before returning.                    
                </comment>
                <comment line="856">
                    the only time that is not true is in this case -                    
                </comment>
                <comment line="857">
                    do not call throwException here.                    
                </comment>
                <comment line="867">
                    do not want privacy leak                    
                </comment>
                <comment line="868">
                    (e.g., sensitive file path in exception msg)                    
                </comment>
                <comment line="881">
                    capture an unexpected LoginModule exception                    
                </comment>
                <comment line="895">
                    if REQUISITE, then immediately throw an exception                    
                </comment>
                <comment line="910">
                    mark down that a REQUIRED module failed                    
                </comment>
                <comment line="919">
                    mark down that an OPTIONAL module failed                    
                </comment>
                <comment line="926">
                    we went thru all the LoginModules.                    
                </comment>
                <comment line="928">
                    a REQUIRED module failed -- return the error                    
                </comment>
                <comment line="931">
                    no module succeeded -- return the first error                    
                </comment>
                <comment line="934">
                    no module succeeded -- all modules were IGNORED                    
                </comment>
                <comment line="939">
                    success                    
                </comment>
                <scope line="735">
                    <scope line="736">
                        <declaration name="mIndex" type="int" line="738"/>
                        <declaration name="methods" type="Method[]" line="739"/>
                        <scope line="741"/>
                        <scope line="743">
                            <declaration name="c" type="Class" line="746"/>
                            <declaration name="constructor" type="Constructor" line="751"/>
                            <declaration name="args" type="Object[]" line="752"/>
                            <scope line="761"/>
                            <declaration name="initArgs" type="Object[]" line="766"/>
                        </scope>
                        <scope line="775"/>
                        <declaration name="args" type="Object[]" line="781"/>
                        <declaration name="status" type="boolean" line="784"/>
                        <scope line="787">
                            <scope line="794"/>
                        </scope>
                        <scope line="807"/>
                    </scope>
                    <scope line="812">
                        <declaration name="form" type="MessageFormat" line="813"/>
                        <declaration name="source" type="Object[]" line="815"/>
                    </scope>
                    <scope line="817"/>
                    <scope line="821"/>
                    <scope line="825"/>
                    <scope line="829">
                        <declaration name="le" type="LoginException" line="833"/>
                        <scope line="836"/>
                        <scope line="861"/>
                        <scope line="865">
                            <scope line="872"/>
                        </scope>
                        <scope line="879">
                            <declaration name="sw" type="java.io.StringWriter" line="882"/>
                        </scope>
                        <scope line="890">
                            <scope line="897"/>
                            <scope line="900"/>
                        </scope>
                        <scope line="905"/>
                        <scope line="914"/>
                    </scope>
                </scope>
                <scope line="927"/>
                <scope line="930"/>
                <scope line="933"/>
                <scope line="938"/>
            </method>
            <class name="SecureCallbackHandler" line="946">
                <implements interface="CallbackHandler"/>
                <javadoc line="946">
                    Wrap the caller-specified CallbackHandler in our own
                      and invoke it within a privileged block, constrained by
                      the caller&apos;s AccessControlContext.                    
                </javadoc>
                <declaration name="acc" type="java.security.AccessControlContext" line="953"/>
                <declaration name="ch" type="CallbackHandler" line="954"/>
                <method name="SecureCallbackHandler" type="constructor" line="957">
                    <params>
                        <param name="acc" type="java.security.AccessControlContext"/>
                        <param name="ch" type="CallbackHandler"/>
                    </params>
                </method>
                <method name="handle" type="void" line="963">
                    <params>
                        <param name="callbacks" type="Callback[]"/>
                    </params>
                    <scope line="964">
                        <anonymous_class line="966">
                            <method name="run" type="Void" line="968"/>
                        </anonymous_class>
                    </scope>
                    <scope line="973">
                        <scope line="974"/>
                        <scope line="976"/>
                    </scope>
                </method>
            </class>
            <class name="ModuleInfo" line="983">
                <javadoc line="983">
                    LoginModule information -
                      incapsulates Configuration info and actual module instances                    
                </javadoc>
                <declaration name="entry" type="AppConfigurationEntry" line="988"/>
                <declaration name="module" type="Object" line="989"/>
                <method name="ModuleInfo" type="constructor" line="991">
                    <params>
                        <param name="newEntry" type="AppConfigurationEntry"/>
                        <param name="newModule" type="Object"/>
                    </params>
                </method>
            </class>
        </class>
    </source>