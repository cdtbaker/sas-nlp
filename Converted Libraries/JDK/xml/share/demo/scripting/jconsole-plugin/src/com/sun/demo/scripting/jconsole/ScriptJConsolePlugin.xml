<?xml version="1.0" encoding="UTF-8"?>
    <source package="com.sun.demo.scripting.jconsole">
        <import package="com.sun.tools.jconsole"/>
        <import package="java.io"/>
        <import package="java.util.concurrent.CountDownLatch"/>
        <import package="javax.script"/>
        <import package="javax.swing"/>
        <import package="java.util"/>
        <class name="ScriptJConsolePlugin" line="41">
            <extends class="JConsolePlugin"/>
            <comment line="48">
                Panel for our tab                
            </comment>
            <comment line="50">
                Tabs that we add to jconsole GUI                
            </comment>
            <comment line="53">
                Script engine that evaluates scripts                
            </comment>
            <comment line="56">
                script engine initialization occurs in background.
                 This latch is used to coorrdinate engine init and eval.                
            </comment>
            <comment line="60">
                File extension used for scripts of chosen language.
                 For eg. &quot;.js&quot; for JavaScript, &quot;.bsh&quot; for BeanShell.                
            </comment>
            <comment line="64">
                Prompt to print in the read-eval-print loop. This is
                 derived from the script file extension.                
            </comment>
            <comment line="124">
                -- Internals only below this point                
            </comment>
            <comment line="137">
                Name of the System property used to select scripting language                
            </comment>
            <comment line="150">
                create Bindings that is backed by a synchronized HashMap                
            </comment>
            <comment line="157">
                create and initialize script engine                
            </comment>
            <comment line="167">
                set pre-defined global variables for script                
            </comment>
            <comment line="174">
                load initial script file (jconsole.&lt;extension&gt;)                
            </comment>
            <comment line="193">
                load user&apos;s initial script file (~/jconsole.&lt;extension&gt;)                
            </comment>
            <implements interface="ScriptShellPanel.CommandProcessor"/>
            <javadoc line="41">
                This is script console plugin. This class uses javax.script API to create
                  interactive read-eval-print script shell within the jconsole GUI.                
            </javadoc>
            <declaration name="window" type="ScriptShellPanel" line="48"/>
            <declaration name="tabs" type="Map&amp;lt;String,JPanel&amp;gt;" line="50"/>
            <declaration name="engine" type="ScriptEngine" line="53"/>
            <declaration name="engineReady" type="CountDownLatch" line="57"/>
            <declaration name="extension" type="String" line="61"/>
            <declaration name="prompt" type="String" line="65"/>
            <javadoc line="67">
                Constructor to create this plugin                
            </javadoc>
            <method name="ScriptJConsolePlugin" type="constructor" line="70"/>
            <method name="getTabs" type="Map&lt;String,JPanel&gt;" line="73">
                <comment line="75">
                    create ScriptEngine                    
                </comment>
                <comment line="78">
                    create panel for tab                    
                </comment>
                <comment line="81">
                    add tab to tabs map                    
                </comment>
                <comment line="88">
                    initialize the script engine                    
                </comment>
                <anonymous_class line="84">
                    <method name="run" type="void" line="86">
                        <comment line="88">
                            initialize the script engine                            
                        </comment>
                    </method>
                </anonymous_class>
            </method>
            <method name="newSwingWorker" type="SwingWorker&lt;?,?&gt;" line="95"/>
            <method name="dispose" type="void" line="99"/>
            <method name="getPrompt" type="String" line="104"/>
            <method name="executeCommand" type="String" line="109">
                <params>
                    <param name="cmd" type="String"/>
                </params>
                <declaration name="res" type="String" line="110"/>
                <scope line="111">
                    <declaration name="tmp" type="Object" line="113"/>
                </scope>
                <scope line="115"/>
                <scope line="117"/>
            </method>
            <method name="createScriptEngine" type="void" line="124">
                <declaration name="manager" type="ScriptEngineManager" line="125"/>
                <declaration name="language" type="String" line="126"/>
                <scope line="128"/>
            </method>
            <declaration name="LANGUAGE_KEY" type="String" line="137"/>
            <method name="getScriptLanguage" type="String" line="139">
                <comment line="141">
                    check whether explicit System property is set                    
                </comment>
                <comment line="144">
                    default is JavaScript                    
                </comment>
                <declaration name="lang" type="String" line="141"/>
                <scope line="142"/>
            </method>
            <method name="createBindings" type="Bindings" line="150">
                <declaration name="map" type="Map&amp;lt;String,Object&amp;gt;" line="151"/>
            </method>
            <method name="initScriptEngine" type="void" line="157">
                <comment line="159">
                    set pre-defined global variables                    
                </comment>
                <comment line="161">
                    load pre-defined initialization file                    
                </comment>
                <comment line="163">
                    load current user&apos;s initialization file                    
                </comment>
            </method>
            <method name="setGlobals" type="void" line="167"/>
            <method name="loadInitFile" type="void" line="174">
                <comment line="187">
                    FIXME: What else I can do here??                    
                </comment>
                <declaration name="oldFilename" type="String" line="175"/>
                <scope line="177">
                    <declaration name="myClass" type="Class&amp;lt;? extends ScriptJConsolePlugin&amp;gt;" line="178"/>
                    <declaration name="stream" type="InputStream" line="179"/>
                    <scope line="181"/>
                </scope>
                <scope line="184"/>
                <scope line="187"/>
            </method>
            <method name="loadUserInitFile" type="void" line="193">
                <comment line="198">
                    no user.home?? should not happen??                    
                </comment>
                <comment line="203">
                    user does not have ~/jconsole.&lt;extension&gt;                    
                </comment>
                <comment line="211">
                    FIXME: What else I can do here??                    
                </comment>
                <declaration name="oldFilename" type="String" line="194"/>
                <declaration name="home" type="String" line="195"/>
                <scope line="196"/>
                <declaration name="fileName" type="String" line="200"/>
                <scope line="201"/>
                <scope line="206"/>
                <scope line="208"/>
                <scope line="211"/>
            </method>
        </class>
    </source>