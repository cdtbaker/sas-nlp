<?xml version="1.0" encoding="UTF-8"?>
    <source package="">
        <import package="java.applet.Applet"/>
        <import package="java.awt"/>
        <import package="java.awt.event"/>
        <import package="java.io"/>
        <import package="java.net"/>
        <class name="SpreadSheet" line="6">
            <extends class="Applet"/>
            <implements interface="MouseListener"/>
            <implements interface="KeyListener"/>
            <declaration name="title" type="String" line="7"/>
            <declaration name="titleFont" type="Font" line="8"/>
            <declaration name="cellColor" type="Color" line="9"/>
            <declaration name="inputColor" type="Color" line="10"/>
            <declaration name="cellWidth" type="int" line="11"/>
            <declaration name="cellHeight" type="int" line="12"/>
            <declaration name="titleHeight" type="int" line="13"/>
            <declaration name="rowLabelWidth" type="int" line="14"/>
            <declaration name="inputFont" type="Font" line="15"/>
            <declaration name="isStopped" type="boolean" line="16"/>
            <declaration name="fullUpdate" type="boolean" line="17"/>
            <declaration name="rows" type="int" line="18"/>
            <declaration name="columns" type="int" line="19"/>
            <declaration name="currentKey" type="int" line="20"/>
            <declaration name="selectedRow" type="int" line="21"/>
            <declaration name="selectedColumn" type="int" line="22"/>
            <declaration name="inputArea" type="SpreadSheetInput" line="23"/>
            <declaration name="cells" type="Cell" line="24"/>
            <declaration name="current" type="Cell" line="25"/>
            <method name="init" type="void" line="26">
                <declaration name="rs" type="String" line="27"/>
                <scope line="33"/>
                <scope line="37"/>
                <scope line="40"/>
                <scope line="44"/>
                <scope line="47"/>
                <declaration name="l" type="char" line="51"/>
                <scope line="52">
                    <scope line="53">
                        <scope line="57"/>
                    </scope>
                </scope>
                <declaration name="d" type="Dimension" line="62"/>
            </method>
            <method name="setCurrentValue" type="void" line="68">
                <params>
                    <param name="val" type="float"/>
                </params>
                <scope line="69"/>
            </method>
            <method name="stop" type="void" line="75"/>
            <method name="start" type="void" line="78"/>
            <method name="destroy" type="void" line="81">
                <scope line="82">
                    <scope line="83">
                        <scope line="84"/>
                    </scope>
                </scope>
            </method>
            <method name="setCurrentValue" type="void" line="90">
                <params>
                    <param name="type" type="int"/>
                    <param name="val" type="String"/>
                </params>
                <scope line="91"/>
            </method>
            <method name="update" type="void" line="97">
                <params>
                    <param name="g" type="Graphics"/>
                </params>
                <scope line="98">
                    <declaration name="cx" type="int" line="99"/>
                    <scope line="101">
                        <scope line="102">
                            <scope line="103"/>
                        </scope>
                    </scope>
                </scope>
                <scope line="111"/>
            </method>
            <method name="recalculate" type="void" line="116">
                <declaration name="i" type="int" line="117"/>
                <scope line="118">
                    <scope line="119">
                        <scope line="120"/>
                    </scope>
                </scope>
            </method>
            <method name="evaluateFormula" type="float" line="128">
                <params>
                    <param name="n" type="Node"/>
                </params>
                <declaration name="val" type="float" line="129"/>
                <scope line="130"/>
                <scope line="154"/>
                <scope line="156"/>
            </method>
            <method name="paint" type="void" line="162">
                <params>
                    <param name="g" type="Graphics"/>
                </params>
                <declaration name="i" type="int" line="163"/>
                <declaration name="cx" type="int" line="164"/>
                <declaration name="l" type="char" line="165"/>
                <declaration name="d" type="Dimension" line="166"/>
                <scope line="173">
                    <scope line="177"/>
                </scope>
                <scope line="184">
                    <scope line="188"/>
                </scope>
                <scope line="194">
                    <scope line="195">
                        <scope line="198"/>
                    </scope>
                </scope>
            </method>
            <method name="mouseClicked" type="void" line="207">
                <params>
                    <param name="e" type="MouseEvent"/>
                </params>
            </method>
            <method name="mousePressed" type="void" line="209">
                <params>
                    <param name="e" type="MouseEvent"/>
                </params>
                <declaration name="x" type="int" line="210"/>
                <declaration name="y" type="int" line="211"/>
                <declaration name="cell" type="Cell" line="212"/>
                <scope line="213">
                    <scope line="215"/>
                </scope>
                <scope line="221">
                    <scope line="223"/>
                </scope>
                <scope line="231">
                    <scope line="233"/>
                </scope>
                <scope line="238">
                    <scope line="239">
                        <scope line="241"/>
                    </scope>
                    <scope line="247">
                        <scope line="250"/>
                    </scope>
                </scope>
            </method>
            <method name="mouseReleased" type="void" line="262">
                <params>
                    <param name="e" type="MouseEvent"/>
                </params>
            </method>
            <method name="mouseEntered" type="void" line="264">
                <params>
                    <param name="e" type="MouseEvent"/>
                </params>
            </method>
            <method name="mouseExited" type="void" line="266">
                <params>
                    <param name="e" type="MouseEvent"/>
                </params>
            </method>
            <method name="keyPressed" type="void" line="268">
                <params>
                    <param name="e" type="KeyEvent"/>
                </params>
            </method>
            <method name="keyTyped" type="void" line="270">
                <params>
                    <param name="e" type="KeyEvent"/>
                </params>
            </method>
            <method name="keyReleased" type="void" line="275">
                <params>
                    <param name="e" type="KeyEvent"/>
                </params>
            </method>
            <method name="getAppletInfo" type="String" line="277"/>
            <method name="getParameterInfo" type="String[][]" line="280">
                <declaration name="info" type="String[][]" line="281"/>
            </method>
        </class>
        <class name="CellUpdater" line="285">
            <extends class="Thread"/>
            <declaration name="target" type="Cell" line="286"/>
            <declaration name="dataStream" type="InputStream" line="287"/>
            <declaration name="tokenStream" type="StreamTokenizer" line="288"/>
            <declaration name="run" type="boolean" line="289"/>
            <method name="CellUpdater" type="constructor" line="290">
                <params>
                    <param name="c" type="Cell"/>
                </params>
            </method>
            <method name="run" type="void" line="294">
                <scope line="295">
                    <scope line="299">
                        <scope line="308"/>
                        <scope line="313"/>
                        <scope line="316"/>
                    </scope>
                </scope>
                <scope line="321"/>
            </method>
        </class>
        <class name="Cell" line="326">
            <declaration name="VALUE" type="int" line="327"/>
            <declaration name="LABEL" type="int" line="328"/>
            <declaration name="URL" type="int" line="329"/>
            <declaration name="FORMULA" type="int" line="330"/>
            <declaration name="parseRoot" type="Node" line="331"/>
            <declaration name="needRedisplay" type="boolean" line="332"/>
            <declaration name="selected" type="boolean" line="333"/>
            <declaration name="transientValue" type="boolean" line="334"/>
            <declaration name="type" type="int" line="335"/>
            <declaration name="valueString" type="String" line="336"/>
            <declaration name="printString" type="String" line="337"/>
            <declaration name="value" type="float" line="338"/>
            <declaration name="bgColor" type="Color" line="339"/>
            <declaration name="fgColor" type="Color" line="340"/>
            <declaration name="highlightColor" type="Color" line="341"/>
            <declaration name="width" type="int" line="342"/>
            <declaration name="height" type="int" line="343"/>
            <declaration name="app" type="SpreadSheet" line="344"/>
            <declaration name="updaterThread" type="CellUpdater" line="345"/>
            <declaration name="paused" type="boolean" line="346"/>
            <method name="Cell" type="constructor" line="347">
                <params>
                    <param name="app" type="SpreadSheet"/>
                    <param name="bgColor" type="Color"/>
                    <param name="fgColor" type="Color"/>
                    <param name="highlightColor" type="Color"/>
                    <param name="width" type="int"/>
                    <param name="height" type="int"/>
                </params>
            </method>
            <method name="setRawValue" type="void" line="356">
                <params>
                    <param name="f" type="float"/>
                </params>
            </method>
            <method name="setValue" type="void" line="360">
                <params>
                    <param name="f" type="float"/>
                </params>
            </method>
            <method name="setTransientValue" type="void" line="368">
                <params>
                    <param name="f" type="float"/>
                </params>
            </method>
            <method name="setUnparsedValue" type="void" line="374">
                <params>
                    <param name="s" type="String"/>
                </params>
            </method>
            <javadoc line="390">
                Parse a spreadsheet formula. The syntax is defined as:
                  formula -&gt; value
                  formula -&gt; value op value
                  value -&gt; &apos;(&apos; formula &apos;)&apos;
                  value -&gt; cell
                  value -&gt; &lt;number&gt;
                  op -&gt; &apos;+&apos; | &apos;&apos; | &apos;/&apos; | &apos;-&apos;
                  cell -&gt; &lt;letter&gt;&lt;number&gt;                
            </javadoc>
            <method name="parseFormula" type="String" line="400">
                <params>
                    <param name="formula" type="String"/>
                    <param name="node" type="Node"/>
                </params>
                <declaration name="subformula" type="String" line="401"/>
                <declaration name="restFormula" type="String" line="402"/>
                <declaration name="left" type="Node" line="403"/>
                <declaration name="right" type="Node" line="404"/>
                <declaration name="op" type="char" line="405"/>
                <scope line="406"/>
                <scope line="410"/>
                <scope line="413"/>
                <scope line="427"/>
                <scope line="435"/>
            </method>
            <method name="parseValue" type="String" line="442">
                <params>
                    <param name="formula" type="String"/>
                    <param name="node" type="Node"/>
                </params>
                <declaration name="c" type="char" line="443"/>
                <declaration name="subformula" type="String" line="444"/>
                <declaration name="restFormula" type="String" line="445"/>
                <declaration name="_value" type="float" line="446"/>
                <declaration name="row" type="int" line="447"/>
                <declaration name="column" type="int" line="448"/>
                <scope line="450">
                    <scope line="453"/>
                    <scope line="456"/>
                </scope>
                <scope line="461">
                    <declaration name="i" type="int" line="462"/>
                    <scope line="463">
                        <scope line="465"/>
                    </scope>
                    <scope line="469"/>
                    <scope line="472"/>
                </scope>
                <scope line="480">
                    <declaration name="i" type="int" line="481"/>
                    <scope line="484">
                        <scope line="486"/>
                    </scope>
                    <scope line="494"/>
                    <scope line="497">
                        <scope line="499"/>
                    </scope>
                </scope>
            </method>
            <method name="setValue" type="void" line="506">
                <params>
                    <param name="type" type="int"/>
                    <param name="s" type="String"/>
                </params>
                <scope line="508"/>
            </method>
            <method name="getValueString" type="String" line="534"/>
            <method name="getPrintString" type="String" line="537"/>
            <method name="select" type="void" line="540"/>
            <method name="deselect" type="void" line="544"/>
            <method name="paint" type="void" line="550">
                <params>
                    <param name="g" type="Graphics"/>
                    <param name="x" type="int"/>
                    <param name="y" type="int"/>
                </params>
                <scope line="551"/>
                <scope line="554"/>
                <scope line="558">
                    <scope line="571"/>
                    <scope line="574">
                        <scope line="575"/>
                        <scope line="578"/>
                    </scope>
                </scope>
            </method>
        </class>
        <class name="Node" line="586">
            <declaration name="OP" type="int" line="587"/>
            <declaration name="VALUE" type="int" line="588"/>
            <declaration name="CELL" type="int" line="589"/>
            <declaration name="type" type="int" line="590"/>
            <declaration name="left" type="Node" line="591"/>
            <declaration name="right" type="Node" line="592"/>
            <declaration name="row" type="int" line="593"/>
            <declaration name="column" type="int" line="594"/>
            <declaration name="value" type="float" line="595"/>
            <declaration name="op" type="char" line="596"/>
            <method name="Node" type="constructor" line="597"/>
            <method name="Node" type="constructor" line="606">
                <params>
                    <param name="n" type="Node"/>
                </params>
            </method>
            <method name="indent" type="void" line="615">
                <params>
                    <param name="ind" type="int"/>
                </params>
                <scope line="616"/>
            </method>
            <method name="print" type="void" line="620">
                <params>
                    <param name="indentLevel" type="int"/>
                </params>
                <declaration name="l" type="char" line="621"/>
            </method>
        </class>
        <class name="InputField" line="641">
            <declaration name="maxchars" type="int" line="642"/>
            <declaration name="cursorPos" type="int" line="643"/>
            <declaration name="app" type="Applet" line="644"/>
            <declaration name="sval" type="String" line="645"/>
            <declaration name="buffer" type="char" line="646"/>
            <declaration name="nChars" type="int" line="647"/>
            <declaration name="width" type="int" line="648"/>
            <declaration name="height" type="int" line="649"/>
            <declaration name="bgColor" type="Color" line="650"/>
            <declaration name="fgColor" type="Color" line="651"/>
            <method name="InputField" type="constructor" line="652">
                <params>
                    <param name="initValue" type="String"/>
                    <param name="app" type="Applet"/>
                    <param name="width" type="int"/>
                    <param name="height" type="int"/>
                    <param name="bgColor" type="Color"/>
                    <param name="fgColor" type="Color"/>
                </params>
                <scope line="660"/>
            </method>
            <method name="setText" type="void" line="666">
                <params>
                    <param name="val" type="String"/>
                </params>
                <declaration name="i" type="int" line="667"/>
                <scope line="668"/>
                <scope line="671"/>
                <scope line="674"/>
            </method>
            <method name="getValue" type="String" line="680"/>
            <method name="paint" type="void" line="683">
                <params>
                    <param name="g" type="Graphics"/>
                    <param name="x" type="int"/>
                    <param name="y" type="int"/>
                </params>
                <scope line="686"/>
            </method>
            <method name="processKey" type="void" line="691">
                <params>
                    <param name="e" type="KeyEvent"/>
                </params>
                <declaration name="ch" type="char" line="692"/>
                <scope line="695"/>
                <scope line="704"/>
            </method>
            <method name="keyReleased" type="void" line="711">
                <params>
                    <param name="e" type="KeyEvent"/>
                </params>
            </method>
            <method name="selected" type="void" line="713"/>
        </class>
        <class name="SpreadSheetInput" line="716">
            <extends class="InputField"/>
            <method name="SpreadSheetInput" type="constructor" line="717">
                <params>
                    <param name="initValue" type="String"/>
                    <param name="app" type="SpreadSheet"/>
                    <param name="width" type="int"/>
                    <param name="height" type="int"/>
                    <param name="bgColor" type="Color"/>
                    <param name="fgColor" type="Color"/>
                </params>
            </method>
            <method name="selected" type="void" line="720">
                <declaration name="f" type="float" line="721"/>
                <declaration name="s" type="String" line="725"/>
                <scope line="726">
                    <declaration name="i" type="int" line="727"/>
                    <scope line="728">
                        <declaration name="c" type="char" line="729"/>
                        <scope line="730"/>
                    </scope>
                </scope>
                <scope line="738"/>
            </method>
        </class>
    </source>