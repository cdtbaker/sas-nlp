<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.fitting">
        <import package="java.util.Random"/>
        <import package="org.apache.commons.math3.optim.nonlinear.vector.jacobian.LevenbergMarquardtOptimizer"/>
        <import package="org.apache.commons.math3.analysis.function.HarmonicOscillator"/>
        <import package="org.apache.commons.math3.exception.NumberIsTooSmallException"/>
        <import package="org.apache.commons.math3.exception.MathIllegalStateException"/>
        <import package="org.apache.commons.math3.util.FastMath"/>
        <import package="org.apache.commons.math3.util.MathUtils"/>
        <import package="org.junit.Test"/>
        <import package="org.junit.Assert"/>
        <class name="HarmonicFitterTest" line="30">
            <method name="testPreconditions1" type="void" line="32">
                <declaration name="fitter" type="HarmonicFitter" line="33"/>
            </method>
            <method name="testNoError" type="void" line="40">
                <declaration name="a" type="double" line="41"/>
                <declaration name="w" type="double" line="42"/>
                <declaration name="p" type="double" line="43"/>
                <declaration name="f" type="HarmonicOscillator" line="44"/>
                <declaration name="fitter" type="HarmonicFitter" line="46"/>
                <scope line="48"/>
                <declaration name="fitted" type="double[]" line="52"/>
                <declaration name="ff" type="HarmonicOscillator" line="57"/>
                <scope line="59"/>
            </method>
            <method name="test1PercentError" type="void" line="65">
                <declaration name="randomizer" type="Random" line="66"/>
                <declaration name="a" type="double" line="67"/>
                <declaration name="w" type="double" line="68"/>
                <declaration name="p" type="double" line="69"/>
                <declaration name="f" type="HarmonicOscillator" line="70"/>
                <declaration name="fitter" type="HarmonicFitter" line="72"/>
                <scope line="74"/>
                <declaration name="fitted" type="double[]" line="79"/>
            </method>
            <method name="testTinyVariationsData" type="void" line="86">
                <comment line="96">
                    This test serves to cover the part of the code of &quot;guessAOmega&quot;                    
                </comment>
                <comment line="97">
                    when the algorithm using integrals fails.                    
                </comment>
                <declaration name="randomizer" type="Random" line="87"/>
                <declaration name="fitter" type="HarmonicFitter" line="89"/>
                <scope line="91"/>
            </method>
            <method name="testInitialGuess" type="void" line="101">
                <declaration name="randomizer" type="Random" line="102"/>
                <declaration name="a" type="double" line="103"/>
                <declaration name="w" type="double" line="104"/>
                <declaration name="p" type="double" line="105"/>
                <declaration name="f" type="HarmonicOscillator" line="106"/>
                <declaration name="fitter" type="HarmonicFitter" line="108"/>
                <scope line="110"/>
                <declaration name="fitted" type="double[]" line="115"/>
            </method>
            <method name="testUnsorted" type="void" line="122">
                <comment line="132">
                    build a regularly spaced array of measurements                    
                </comment>
                <comment line="141">
                    shake it                    
                </comment>
                <comment line="153">
                    pass it to the fitter                    
                </comment>
                <declaration name="randomizer" type="Random" line="123"/>
                <declaration name="a" type="double" line="124"/>
                <declaration name="w" type="double" line="125"/>
                <declaration name="p" type="double" line="126"/>
                <declaration name="f" type="HarmonicOscillator" line="127"/>
                <declaration name="fitter" type="HarmonicFitter" line="129"/>
                <declaration name="size" type="int" line="133"/>
                <declaration name="xTab" type="double[]" line="134"/>
                <declaration name="yTab" type="double[]" line="135"/>
                <scope line="136"/>
                <scope line="142">
                    <declaration name="i1" type="int" line="143"/>
                    <declaration name="i2" type="int" line="144"/>
                    <declaration name="xTmp" type="double" line="145"/>
                    <declaration name="yTmp" type="double" line="146"/>
                </scope>
                <scope line="154"/>
                <declaration name="fitted" type="double[]" line="158"/>
            </method>
            <method name="testMath844" type="void" line="165">
                <comment line="177">
                    The guesser fails because the function is far from an harmonic                    
                </comment>
                <comment line="178">
                    function: It is a triangular periodic function with amplitude 3                    
                </comment>
                <comment line="179">
                    and period 12, and all sample points are taken at integer abscissae                    
                </comment>
                <comment line="180">
                    so function values all belong to the integer subset {-3, -2, -1, 0,                    
                </comment>
                <comment line="181">
                    1, 2, 3}.                    
                </comment>
                <declaration name="y" type="double[]" line="166"/>
                <declaration name="len" type="int" line="171"/>
                <declaration name="points" type="WeightedObservedPoint[]" line="172"/>
                <scope line="173"/>
                <declaration name="guesser" type="HarmonicFitter.ParameterGuesser" line="182"/>
            </method>
        </class>
    </source>