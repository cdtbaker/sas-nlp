<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.util">
        <import package="java.io.PrintStream"/>
        <import package="org.apache.commons.math3.exception.DimensionMismatchException"/>
        <class name="FastMathCalc" line="4">
            <javadoc line="4">
                Class used to compute the classical functions tables.                
                <version>
                    $Id: FastMathCalc.java 1416643 2012-12-03 19:37:14Z tn $                    
                </version>
                <since>
                    3.0                    
                </since>
            </javadoc>
            <declaration name="HEX_40000000" type="long" line="10"/>
            <javadoc line="10">
                0x40000000 - used to split a double into two parts, both with the low order bits cleared.
                  Equivalent to 2^30.                
            </javadoc>
            <declaration name="FACT" type="double" line="15"/>
            <javadoc line="15">
                Factorial table, for Taylor series expansions. 0!, 1!, 2!, ... 19!                
            </javadoc>
            <declaration name="LN_SPLIT_COEF" type="double" line="19"/>
            <javadoc line="19">
                Coefficients for slowLog.                
            </javadoc>
            <declaration name="TABLE_START_DECL" type="String" line="23"/>
            <javadoc line="23">
                Table start declaration.                
            </javadoc>
            <declaration name="TABLE_END_DECL" type="String" line="27"/>
            <javadoc line="27">
                Table end declaration.                
            </javadoc>
            <javadoc line="31">
                Private Constructor.                
            </javadoc>
            <method name="FastMathCalc" type="constructor" line="34"/>
            <javadoc line="36">
                Build the sine and cosine tables.                
                <param>
                    SINE_TABLE_A table of the most significant part of the sines                    
                </param>
                <param>
                    SINE_TABLE_B table of the least significant part of the sines                    
                </param>
                <param>
                    COSINE_TABLE_A table of the most significant part of the cosines                    
                </param>
                <param>
                    COSINE_TABLE_B table of the most significant part of the cosines                    
                </param>
                <param>
                    SINE_TABLE_LEN length of the tables                    
                </param>
                <param>
                    TANGENT_TABLE_A table of the most significant part of the tangents                    
                </param>
                <param>
                    TANGENT_TABLE_B table of the most significant part of the tangents                    
                </param>
            </javadoc>
            <method name="buildSinCosTables" type="void" line="46">
                <params>
                    <param name="SINE_TABLE_A" type="double[]"/>
                    <param name="SINE_TABLE_B" type="double[]"/>
                    <param name="COSINE_TABLE_A" type="double[]"/>
                    <param name="COSINE_TABLE_B" type="double[]"/>
                    <param name="SINE_TABLE_LEN" type="int"/>
                    <param name="TANGENT_TABLE_A" type="double[]"/>
                    <param name="TANGENT_TABLE_B" type="double[]"/>
                </params>
                <declaration name="result" type="double" line="47"/>
                <scope line="48">
                    <declaration name="x" type="double" line="49"/>
                </scope>
                <scope line="57">
                    <declaration name="xs" type="double" line="58"/>
                    <declaration name="ys" type="double" line="59"/>
                    <declaration name="as" type="double" line="60"/>
                    <declaration name="bs" type="double" line="61"/>
                    <declaration name="temps" type="double" line="62"/>
                    <scope line="63"/>
                    <scope line="79"/>
                </scope>
                <scope line="102">
                    <declaration name="xs" type="double" line="103"/>
                    <declaration name="ys" type="double" line="104"/>
                    <declaration name="as" type="double" line="105"/>
                </scope>
            </method>
            <javadoc line="116">
                For x between 0 and pi/4 compute cosine using Talor series
                  cos(x) = 1 - x^2/2! + x^4/4! ...                
                <param>
                    x number from which cosine is requested                    
                </param>
                <param>
                    result placeholder where to put the result in extended precision
                      (may be null)                    
                </param>
                <return>
                    cos(x)                    
                </return>
            </javadoc>
            <method name="slowCos" type="double" line="124">
                <params>
                    <param name="x" type="double"/>
                    <param name="result" type="double"/>
                </params>
                <declaration name="xs" type="double" line="125"/>
                <declaration name="ys" type="double" line="126"/>
                <declaration name="facts" type="double" line="127"/>
                <declaration name="as" type="double" line="128"/>
                <scope line="131">
                    <scope line="135"/>
                    <scope line="140"/>
                </scope>
                <scope line="148"/>
            </method>
            <javadoc line="154">
                For x between 0 and pi/4 compute sine using Taylor expansion:
                  sin(x) = x - x^3/3! + x^5/5! - x^7/7! ...                
                <param>
                    x number from which sine is requested                    
                </param>
                <param>
                    result placeholder where to put the result in extended precision
                      (may be null)                    
                </param>
                <return>
                    sin(x)                    
                </return>
            </javadoc>
            <method name="slowSin" type="double" line="162">
                <params>
                    <param name="x" type="double"/>
                    <param name="result" type="double"/>
                </params>
                <declaration name="xs" type="double" line="163"/>
                <declaration name="ys" type="double" line="164"/>
                <declaration name="facts" type="double" line="165"/>
                <declaration name="as" type="double" line="166"/>
                <scope line="169">
                    <scope line="173"/>
                    <scope line="178"/>
                </scope>
                <scope line="186"/>
            </method>
            <javadoc line="192">
                For x between 0 and 1, returns exp(x), uses extended precision                
                <param>
                    x argument of exponential                    
                </param>
                <param>
                    result placeholder where to place exp(x) split in two terms
                      for extra precision (i.e. exp(x) = result[0] + result[1]                    
                </param>
                <return>
                    exp(x)                    
                </return>
            </javadoc>
            <method name="slowexp" type="double" line="199">
                <params>
                    <param name="x" type="double"/>
                    <param name="result" type="double"/>
                </params>
                <declaration name="xs" type="double" line="200"/>
                <declaration name="ys" type="double" line="201"/>
                <declaration name="facts" type="double" line="202"/>
                <declaration name="as" type="double" line="203"/>
                <scope line="206"/>
                <scope line="216"/>
            </method>
            <javadoc line="222">
                Compute split[0], split[1] such that their sum is equal to d,
                  and split[0] has its 30 least significant bits as zero.                
                <param>
                    d number to split                    
                </param>
                <param>
                    split placeholder where to place the result                    
                </param>
            </javadoc>
            <method name="split" type="void" line="228">
                <params>
                    <param name="d" type="double"/>
                    <param name="split" type="double"/>
                </params>
                <scope line="229">
                    <declaration name="a" type="double" line="230"/>
                </scope>
                <scope line="234">
                    <declaration name="a" type="double" line="235"/>
                </scope>
            </method>
            <javadoc line="240">
                Recompute a split.                
                <param>
                    a input/out array containing the split, changed
                      on output                    
                </param>
            </javadoc>
            <method name="resplit" type="void" line="245">
                <params>
                    <param name="a" type="double"/>
                </params>
                <declaration name="c" type="double" line="246"/>
                <declaration name="d" type="double" line="247"/>
                <scope line="248">
                    <declaration name="z" type="double" line="249"/>
                </scope>
                <scope line="253">
                    <declaration name="z" type="double" line="254"/>
                </scope>
            </method>
            <javadoc line="259">
                Multiply two numbers in split form.                
                <param>
                    a first term of multiplication                    
                </param>
                <param>
                    b second term of multiplication                    
                </param>
                <param>
                    ans placeholder where to put the result                    
                </param>
            </javadoc>
            <method name="splitMult" type="void" line="265">
                <params>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                    <param name="ans" type="double"/>
                </params>
            </method>
            <javadoc line="270">
                Add two numbers in split form.                
                <param>
                    a first term of addition                    
                </param>
                <param>
                    b second term of addition                    
                </param>
                <param>
                    ans placeholder where to put the result                    
                </param>
            </javadoc>
            <method name="splitAdd" type="void" line="276">
                <params>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                    <param name="ans" type="double"/>
                </params>
            </method>
            <javadoc line="281">
                Compute the reciprocal of in.  Use the following algorithm.
                  in = c + d.
                  want to find x + y such that x+y = 1/(c+d) and x is much
                  larger than y and x has several zero bits on the right.
                  Set b = 1/(2^22),  a = 1 - b.  Thus (a+b) = 1.
                  Use following identity to compute (a+b)/(c+d)
                  (a+b)/(c+d)  =   a/c   +    (bc - ad) / (c^2 + cd)
                  set x = a/c  and y = (bc - ad) / (c^2 + cd)
                  This will be close to the right answer, but there will be
                  some rounding in the calculation of X.  So by carefully
                  computing 1 - (c+d)(x+y) we can compute an error and
                  add that back in.   This is done carefully so that terms
                  of similar size are subtracted first.                
                <param>
                    in initial number, in split form                    
                </param>
                <param>
                    result placeholder where to put the result                    
                </param>
            </javadoc>
            <method name="splitReciprocal" type="void" line="298">
                <params>
                    <param name="in" type="double"/>
                    <param name="result" type="double"/>
                </params>
                <declaration name="b" type="double" line="299"/>
                <declaration name="a" type="double" line="300"/>
                <scope line="301"/>
                <scope line="307"/>
                <scope line="311">
                    <declaration name="err" type="double" line="312"/>
                </scope>
            </method>
            <javadoc line="317">
                Compute (a[0] + a[1])  (b[0] + b[1]) in extended precision.                
                <param>
                    a first term of the multiplication                    
                </param>
                <param>
                    b second term of the multiplication                    
                </param>
                <param>
                    result placeholder where to put the result                    
                </param>
            </javadoc>
            <method name="quadMult" type="void" line="323">
                <params>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                    <param name="result" type="double"/>
                </params>
                <declaration name="xs" type="double" line="324"/>
                <declaration name="ys" type="double" line="325"/>
                <declaration name="zs" type="double" line="326"/>
                <declaration name="tmp" type="double" line="334"/>
            </method>
            <javadoc line="359">
                Compute exp(p) for a integer p in extended precision.                
                <param>
                    p integer whose exponential is requested                    
                </param>
                <param>
                    result placeholder where to put the result in extended precision                    
                </param>
                <return>
                    exp(p) in standard precision (equal to result[0] + result[1])                    
                </return>
            </javadoc>
            <method name="expint" type="double" line="365">
                <params>
                    <param name="p" type="int"/>
                    <param name="result" type="double"/>
                </params>
                <declaration name="xs" type="double" line="366"/>
                <declaration name="as" type="double" line="367"/>
                <declaration name="ys" type="double" line="368"/>
                <scope line="372">
                    <scope line="373"/>
                </scope>
                <scope line="383"/>
            </method>
            <javadoc line="390">
                xi in the range of [1, 2].
                  3        5        7
                  x+1           /          x        x        x          \
                  ln ----- =   2   |  x  +   ----  +  ----  +  ---- + ...  |
                  1-x           \          3        5        7          /
                  So, compute a Remez approximation of the following function
                  ln ((sqrt(x)+1)/(1-sqrt(x)))  /  x
                  This will be an even function with only positive coefficents.
                  x is in the range [0 - 1/3].
                  Transform xi for input to the above function by setting
                  x = (xi-1)/(xi+1).   Input to the polynomial is x^2, then
                  the result is multiplied by x.                
                <param>
                    xi number from which log is requested                    
                </param>
                <return>
                    log(xi)                    
                </return>
            </javadoc>
            <method name="slowLog" type="double[]" line="406">
                <params>
                    <param name="xi" type="double"/>
                </params>
                <declaration name="x" type="double" line="407"/>
                <declaration name="x2" type="double" line="408"/>
                <declaration name="y" type="double" line="409"/>
                <declaration name="a" type="double" line="410"/>
                <scope line="423"/>
            </method>
            <javadoc line="436">
                Print an array.                
                <param>
                    out text output stream where output should be printed                    
                </param>
                <param>
                    name array name                    
                </param>
                <param>
                    expectedLen expected length of the array                    
                </param>
                <param>
                    array2d array data                    
                </param>
            </javadoc>
            <method name="printarray" type="void" line="443">
                <params>
                    <param name="out" type="PrintStream"/>
                    <param name="name" type="String"/>
                    <param name="expectedLen" type="int"/>
                    <param name="array2d" type="double[][]"/>
                </params>
                <declaration name="i" type="int" line="447"/>
                <scope line="448">
                    <scope line="450"/>
                </scope>
            </method>
            <javadoc line="457">
                Print an array.                
                <param>
                    out text output stream where output should be printed                    
                </param>
                <param>
                    name array name                    
                </param>
                <param>
                    expectedLen expected length of the array                    
                </param>
                <param>
                    array array data                    
                </param>
            </javadoc>
            <method name="printarray" type="void" line="464">
                <params>
                    <param name="out" type="PrintStream"/>
                    <param name="name" type="String"/>
                    <param name="expectedLen" type="int"/>
                    <param name="array" type="double[]"/>
                </params>
                <scope line="468"/>
            </method>
            <javadoc line="473">
                Format a double.                
                <param>
                    d double number to format                    
                </param>
                <return>
                    formatted number                    
                </return>
            </javadoc>
            <method name="format" type="String" line="478">
                <params>
                    <param name="d" type="double"/>
                </params>
                <scope line="479"/>
                <scope line="482"/>
            </method>
            <javadoc line="486">
                Check two lengths are equal.                
                <param>
                    expectedLen expected length                    
                </param>
                <param>
                    actual actual length                    
                </param>
                <exception>
                    DimensionMismatchException if the two lengths are not equal                    
                </exception>
            </javadoc>
            <method name="checkLen" type="void" line="492">
                <params>
                    <param name="expectedLen" type="int"/>
                    <param name="actual" type="int"/>
                </params>
                <scope line="493"/>
            </method>
        </class>
    </source>