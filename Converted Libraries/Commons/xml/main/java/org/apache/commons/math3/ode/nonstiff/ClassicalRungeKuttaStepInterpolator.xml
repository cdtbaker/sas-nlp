<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.ode.nonstiff">
        <import package="org.apache.commons.math3.ode.sampling.StepInterpolator"/>
        <class name="ClassicalRungeKuttaStepInterpolator" line="22">
            <extends class="RungeKuttaStepInterpolator"/>
            <javadoc line="22">
                This class implements a step interpolator for the classical fourth
                  order Runge-Kutta integrator.
                  &lt;p&gt;This interpolator allows to compute dense output inside the last
                  step computed. The interpolation equation is consistent with the
                  integration scheme :
                  &lt;ul&gt;
                  &lt;li&gt;Using reference point at step start:&lt;br&gt;
                  y(t&lt;sub&gt;n&lt;/sub&gt; + &amp;theta; h) = y (t&lt;sub&gt;n&lt;/sub&gt;)
                  + &amp;theta; (h/6) [  (6 - 9 &amp;theta; + 4 &amp;theta;&lt;sup&gt;2&lt;/sup&gt;) y&apos;&lt;sub&gt;1&lt;/sub&gt;
                  + (    6 &amp;theta; - 4 &amp;theta;&lt;sup&gt;2&lt;/sup&gt;) (y&apos;&lt;sub&gt;2&lt;/sub&gt; + y&apos;&lt;sub&gt;3&lt;/sub&gt;)
                  + (   -3 &amp;theta; + 4 &amp;theta;&lt;sup&gt;2&lt;/sup&gt;) y&apos;&lt;sub&gt;4&lt;/sub&gt;
                  ]
                  &lt;/li&gt;
                  &lt;li&gt;Using reference point at step end:&lt;br&gt;
                  y(t&lt;sub&gt;n&lt;/sub&gt; + &amp;theta; h) = y (t&lt;sub&gt;n&lt;/sub&gt; + h)
                  + (1 - &amp;theta;) (h/6) [ (-4 &amp;theta;^2 + 5 &amp;theta; - 1) y&apos;&lt;sub&gt;1&lt;/sub&gt;
                  +(4 &amp;theta;^2 - 2 &amp;theta; - 2) (y&apos;&lt;sub&gt;2&lt;/sub&gt; + y&apos;&lt;sub&gt;3&lt;/sub&gt;)
                  -(4 &amp;theta;^2 +   &amp;theta; + 1) y&apos;&lt;sub&gt;4&lt;/sub&gt;
                  ]
                  &lt;/li&gt;
                  &lt;/ul&gt;
                  &lt;/p&gt;
                  where &amp;theta; belongs to [0 ; 1] and where y&apos;&lt;sub&gt;1&lt;/sub&gt; to y&apos;&lt;sub&gt;4&lt;/sub&gt; are the four
                  evaluations of the derivatives already computed during the
                  step.&lt;/p&gt;                
                <see>
                    ClassicalRungeKuttaIntegrator                    
                </see>
                <version>
                    $Id: ClassicalRungeKuttaStepInterpolator.java 1416643 2012-12-03 19:37:14Z tn $                    
                </version>
                <since>
                    1.2                    
                </since>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="59"/>
            <javadoc line="59">
                Serializable version identifier.                
            </javadoc>
            <javadoc line="62">
                Simple constructor.
                  This constructor builds an instance that is not usable yet, the{@link RungeKuttaStepInterpolator#reinitialize} method should be
                  called before using the instance in order to initialize the
                  internal arrays. This constructor is used only in order to delay
                  the initialization in some cases. The {@link RungeKuttaIntegrator}class uses the prototyping design pattern to create the step
                  interpolators by cloning an uninitialized model and latter initializing
                  the copy.                
            </javadoc>
            <method name="ClassicalRungeKuttaStepInterpolator" type="constructor" line="72"/>
            <javadoc line="75">
                Copy constructor.                
                <param>
                    interpolator interpolator to copy from. The copy is a deep
                      copy: its arrays are separated from the original arrays of the
                      instance                    
                </param>
            </javadoc>
            <method name="ClassicalRungeKuttaStepInterpolator" type="constructor" line="80">
                <params>
                    <param name="interpolator" type="ClassicalRungeKuttaStepInterpolator"/>
                </params>
            </method>
            <javadoc line="84">
                {@inheritDoc}                
            </javadoc>
            <method name="doCopy" type="StepInterpolator" line="86"/>
            <javadoc line="90">
                {@inheritDoc}                
            </javadoc>
            <method name="computeInterpolatedStateAndDerivatives" type="void" line="93">
                <params>
                    <param name="theta" type="double"/>
                    <param name="oneMinusThetaH" type="double"/>
                </params>
                <declaration name="oneMinusTheta" type="double" line="95"/>
                <declaration name="oneMinus2Theta" type="double" line="96"/>
                <declaration name="coeffDot1" type="double" line="97"/>
                <declaration name="coeffDot23" type="double" line="98"/>
                <declaration name="coeffDot4" type="double" line="99"/>
                <scope line="100">
                    <declaration name="fourTheta2" type="double" line="101"/>
                    <declaration name="s" type="double" line="102"/>
                    <declaration name="coeff1" type="double" line="103"/>
                    <declaration name="coeff23" type="double" line="104"/>
                    <declaration name="coeff4" type="double" line="105"/>
                    <scope line="106">
                        <declaration name="yDot1" type="double" line="107"/>
                        <declaration name="yDot23" type="double" line="108"/>
                        <declaration name="yDot4" type="double" line="109"/>
                    </scope>
                </scope>
                <scope line="115">
                    <declaration name="fourTheta" type="double" line="116"/>
                    <declaration name="s" type="double" line="117"/>
                    <declaration name="coeff1" type="double" line="118"/>
                    <declaration name="coeff23" type="double" line="119"/>
                    <declaration name="coeff4" type="double" line="120"/>
                    <scope line="121">
                        <declaration name="yDot1" type="double" line="122"/>
                        <declaration name="yDot23" type="double" line="123"/>
                        <declaration name="yDot4" type="double" line="124"/>
                    </scope>
                </scope>
            </method>
        </class>
    </source>