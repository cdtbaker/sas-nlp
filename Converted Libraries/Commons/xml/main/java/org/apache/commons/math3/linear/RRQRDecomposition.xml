<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.linear">
        <import package="org.apache.commons.math3.util.FastMath"/>
        <class name="RRQRDecomposition" line="23">
            <extends class="QRDecomposition"/>
            <javadoc line="23">
                Calculates the rank-revealing QR-decomposition of a matrix, with column pivoting.
                  &lt;p&gt;The rank-revealing QR-decomposition of a matrix A consists of three matrices Q,
                  R and P such that AP=QR.  Q is orthogonal (Q&lt;sup&gt;T&lt;/sup&gt;Q = I), and R is upper triangular.
                  If A is m&amp;times;n, Q is m&amp;times;m and R is m&amp;times;n and P is n&amp;times;n.&lt;/p&gt;
                  &lt;p&gt;QR decomposition with column pivoting produces a rank-revealing QR
                  decomposition and the {@link #getRank(double)} method may be used to return the rank of the
                  input matrix A.&lt;/p&gt;
                  &lt;p&gt;This class compute the decomposition using Householder reflectors.&lt;/p&gt;
                  &lt;p&gt;For efficiency purposes, the decomposition in packed form is transposed.
                  This allows inner loop to iterate inside rows, which is much more cache-efficient
                  in Java.&lt;/p&gt;
                  &lt;p&gt;This class is based on the class with similar name from the
                  &lt;a href=&quot;http://math.nist.gov/javanumerics/jama/&quot;&gt;JAMA&lt;/a&gt; library, with the
                  following changes:&lt;/p&gt;
                  &lt;ul&gt;
                  &lt;li&gt;a {@link #getQT() getQT} method has been added,&lt;/li&gt;
                  &lt;li&gt;the {@code solve} and {@code isFullRank} methods have been replaced
                  by a {@link #getSolver() getSolver} method and the equivalent methods
                  provided by the returned {@link DecompositionSolver}.&lt;/li&gt;
                  &lt;/ul&gt;                
                <see>
                    &lt;a href=&quot;http://mathworld.wolfram.com/QRDecomposition.html&quot;&gt;MathWorld&lt;/a&gt;                    
                </see>
                <see>
                    &lt;a href=&quot;http://en.wikipedia.org/wiki/QR_decomposition&quot;&gt;Wikipedia&lt;/a&gt;                    
                </see>
                <version>
                    $Id: RRQRDecomposition.java 1456956 2013-03-15 13:54:20Z luc $                    
                </version>
                <since>
                    3.2                    
                </since>
            </javadoc>
            <declaration name="p" type="int[]" line="53"/>
            <javadoc line="53">
                An array to record the column pivoting for later creation of P.                
            </javadoc>
            <declaration name="cachedP" type="RealMatrix" line="56"/>
            <javadoc line="56">
                Cached value of P.                
            </javadoc>
            <javadoc line="60">
                Calculates the QR-decomposition of the given matrix.
                  The singularity threshold defaults to zero.                
                <param>
                    matrix The matrix to decompose.                    
                </param>
                <see>
                    #RRQRDecomposition(RealMatrix,double)                    
                </see>
            </javadoc>
            <method name="RRQRDecomposition" type="constructor" line="68">
                <params>
                    <param name="matrix" type="RealMatrix"/>
                </params>
            </method>
            <javadoc line="72">
                Calculates the QR-decomposition of the given matrix.                
                <param>
                    matrix The matrix to decompose.                    
                </param>
                <param>
                    threshold Singularity threshold.                    
                </param>
                <see>
                    #RRQRDecomposition(RealMatrix)                    
                </see>
            </javadoc>
            <method name="RRQRDecomposition" type="constructor" line="79">
                <params>
                    <param name="matrix" type="RealMatrix"/>
                    <param name="threshold" type="double"/>
                </params>
            </method>
            <javadoc line="83">
                Decompose matrix.                
                <param>
                    qrt transposed matrix                    
                </param>
            </javadoc>
            <method name="decompose" type="void" line="86">
                <params>
                    <param name="qrt" type="double[][]"/>
                </params>
                <scope line="88"/>
            </method>
            <javadoc line="94">
                Perform Householder reflection for a minor A(minor, minor) of A.                
                <param>
                    minor minor index                    
                </param>
                <param>
                    qrt transposed matrix                    
                </param>
            </javadoc>
            <method name="performHouseholderReflection" type="void" line="98">
                <params>
                    <param name="minor" type="int"/>
                    <param name="qrt" type="double[][]"/>
                </params>
                <comment line="102">
                    Find the unreduced column with the greatest L2-Norm                    
                </comment>
                <comment line="114">
                    swap the current column with that with the greated L2-Norm and record in p                    
                </comment>
                <declaration name="l2NormSquaredMax" type="double" line="100"/>
                <declaration name="l2NormSquaredMaxIndex" type="int" line="102"/>
                <scope line="103">
                    <declaration name="l2NormSquared" type="double" line="104"/>
                    <scope line="105"/>
                    <scope line="108"/>
                </scope>
                <scope line="114">
                    <declaration name="tmp1" type="double[]" line="115"/>
                    <declaration name="tmp2" type="int" line="118"/>
                </scope>
            </method>
            <javadoc line="128">
                Returns the pivot matrix, P, used in the QR Decomposition of matrix A such that AP = QR.
                  If no pivoting is used in this decomposition then P is equal to the identity matrix.                
                <return>
                    a permutation matrix.                    
                </return>
            </javadoc>
            <method name="getP" type="RealMatrix" line="135">
                <scope line="136">
                    <declaration name="n" type="int" line="137"/>
                    <scope line="139"/>
                </scope>
            </method>
            <javadoc line="146">
                Return the effective numerical matrix rank.
                  &lt;p&gt;The effective numerical rank is the number of non-negligible
                  singular values.&lt;/p&gt;
                  &lt;p&gt;This implementation looks at Frobenius norms of the sequence of
                  bottom right submatrices.  When a large fall in norm is seen,
                  the rank is returned. The drop is computed as:&lt;/p&gt;
                  &lt;pre&gt;
                  (thisNorm/lastNorm)  rNorm &lt; dropThreshold
                  &lt;/pre&gt;
                  &lt;p&gt;
                  where thisNorm is the Frobenius norm of the current submatrix,
                  lastNorm is the Frobenius norm of the previous submatrix,
                  rNorm is is the Frobenius norm of the complete matrix
                  &lt;/p&gt;                
                <param>
                    dropThreshold threshold triggering rank computation                    
                </param>
                <return>
                    effective numerical matrix rank                    
                </return>
            </javadoc>
            <method name="getRank" type="int" line="165">
                <params>
                    <param name="dropThreshold" type="double"/>
                </params>
                <declaration name="r" type="RealMatrix" line="166"/>
                <declaration name="rows" type="int" line="167"/>
                <declaration name="columns" type="int" line="168"/>
                <declaration name="rank" type="int" line="169"/>
                <declaration name="lastNorm" type="double" line="170"/>
                <declaration name="rNorm" type="double" line="171"/>
                <scope line="172">
                    <declaration name="thisNorm" type="double" line="173"/>
                    <scope line="174"/>
                </scope>
            </method>
            <javadoc line="183">
                Get a solver for finding the A &amp;times; X = B solution in least square sense.                
                <return>
                    a solver                    
                </return>
            </javadoc>
            <method name="getSolver" type="DecompositionSolver" line="187"/>
            <class name="Solver" line="191">
                <implements interface="DecompositionSolver"/>
                <javadoc line="191">
                    Specialized solver.                    
                </javadoc>
                <declaration name="upper" type="DecompositionSolver" line="194"/>
                <javadoc line="194">
                    Upper level solver.                    
                </javadoc>
                <declaration name="p" type="RealMatrix" line="197"/>
                <javadoc line="197">
                    A permutation matrix for the pivots used in the QR decomposition                    
                </javadoc>
                <javadoc line="200">
                    Build a solver from decomposed matrix.                    
                    <param>
                        upper upper level solver.                        
                    </param>
                    <param>
                        p permutation matrix                        
                    </param>
                </javadoc>
                <method name="Solver" type="constructor" line="206">
                    <params>
                        <param name="upper" type="DecompositionSolver"/>
                        <param name="p" type="RealMatrix"/>
                    </params>
                </method>
                <javadoc line="211">
                    {@inheritDoc}                    
                </javadoc>
                <method name="isNonSingular" type="boolean" line="212"/>
                <javadoc line="216">
                    {@inheritDoc}                    
                </javadoc>
                <method name="solve" type="RealVector" line="217">
                    <params>
                        <param name="b" type="RealVector"/>
                    </params>
                </method>
                <javadoc line="221">
                    {@inheritDoc}                    
                </javadoc>
                <method name="solve" type="RealMatrix" line="222">
                    <params>
                        <param name="b" type="RealMatrix"/>
                    </params>
                </method>
                <javadoc line="226">
                    {@inheritDoc}                    
                </javadoc>
                <method name="getInverse" type="RealMatrix" line="227"/>
            </class>
        </class>
    </source>