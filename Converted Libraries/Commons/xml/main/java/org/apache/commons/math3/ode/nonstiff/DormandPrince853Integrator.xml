<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.ode.nonstiff">
        <import package="org.apache.commons.math3.util.FastMath"/>
        <class name="DormandPrince853Integrator" line="23">
            <extends class="EmbeddedRungeKuttaIntegrator"/>
            <comment line="157">
                elements 2 to 5 are zero, so they are neither stored nor used                
            </comment>
            <comment line="184">
                elements 2 to 5 are zero, so they are neither stored nor used                
            </comment>
            <javadoc line="23">
                This class implements the 8(5,3) Dormand-Prince integrator for Ordinary
                  Differential Equations.
                  &lt;p&gt;This integrator is an embedded Runge-Kutta integrator
                  of order 8(5,3) used in local extrapolation mode (i.e. the solution
                  is computed using the high order formula) with stepsize control
                  (and automatic step initialization) and continuous output. This
                  method uses 12 functions evaluations per step for integration and 4
                  evaluations for interpolation. However, since the first
                  interpolation evaluation is the same as the first integration
                  evaluation of the next step, we have included it in the integrator
                  rather than in the interpolator and specified the method was an
                  &lt;i&gt;fsal&lt;/i&gt;. Hence, despite we have 13 stages here, the cost is
                  really 12 evaluations per step even if no interpolation is done,
                  and the overcost of interpolation is only 3 evaluations.&lt;/p&gt;
                  &lt;p&gt;This method is based on an 8(6) method by Dormand and Prince
                  (i.e. order 8 for the integration and order 6 for error estimation)
                  modified by Hairer and Wanner to use a 5th order error estimator
                  with 3rd order correction. This modification was introduced because
                  the original method failed in some cases (wrong steps can be
                  accepted when step size is too large, for example in the
                  Brusselator problem) and also had &lt;i&gt;severe difficulties when
                  applied to problems with discontinuities&lt;/i&gt;. This modification is
                  explained in the second edition of the first volume (Nonstiff
                  Problems) of the reference book by Hairer, Norsett and Wanner:
                  &lt;i&gt;Solving Ordinary Differential Equations&lt;/i&gt; (Springer-Verlag,
                  ISBN 3-540-56670-8).&lt;/p&gt;                
                <version>
                    $Id: DormandPrince853Integrator.java 1416643 2012-12-03 19:37:14Z tn $                    
                </version>
                <since>
                    1.2                    
                </since>
            </javadoc>
            <declaration name="METHOD_NAME" type="String" line="59"/>
            <javadoc line="59">
                Integrator method name.                
            </javadoc>
            <declaration name="STATIC_C" type="double[]" line="62"/>
            <javadoc line="62">
                Time steps Butcher array.                
            </javadoc>
            <declaration name="STATIC_A" type="double[][]" line="69"/>
            <javadoc line="69">
                Internal weights Butcher array.                
            </javadoc>
            <declaration name="STATIC_B" type="double[]" line="136"/>
            <javadoc line="136">
                Propagation weights Butcher array.                
            </javadoc>
            <declaration name="E1_01" type="double" line="153"/>
            <javadoc line="153">
                First error weights array, element 1.                
            </javadoc>
            <declaration name="E1_06" type="double" line="158"/>
            <javadoc line="158">
                First error weights array, element 6.                
            </javadoc>
            <declaration name="E1_07" type="double" line="161"/>
            <javadoc line="161">
                First error weights array, element 7.                
            </javadoc>
            <declaration name="E1_08" type="double" line="164"/>
            <javadoc line="164">
                First error weights array, element 8.                
            </javadoc>
            <declaration name="E1_09" type="double" line="167"/>
            <javadoc line="167">
                First error weights array, element 9.                
            </javadoc>
            <declaration name="E1_10" type="double" line="170"/>
            <javadoc line="170">
                First error weights array, element 10.                
            </javadoc>
            <declaration name="E1_11" type="double" line="173"/>
            <javadoc line="173">
                First error weights array, element 11.                
            </javadoc>
            <declaration name="E1_12" type="double" line="176"/>
            <javadoc line="176">
                First error weights array, element 12.                
            </javadoc>
            <declaration name="E2_01" type="double" line="180"/>
            <javadoc line="180">
                Second error weights array, element 1.                
            </javadoc>
            <declaration name="E2_06" type="double" line="185"/>
            <javadoc line="185">
                Second error weights array, element 6.                
            </javadoc>
            <declaration name="E2_07" type="double" line="188"/>
            <javadoc line="188">
                Second error weights array, element 7.                
            </javadoc>
            <declaration name="E2_08" type="double" line="191"/>
            <javadoc line="191">
                Second error weights array, element 8.                
            </javadoc>
            <declaration name="E2_09" type="double" line="194"/>
            <javadoc line="194">
                Second error weights array, element 9.                
            </javadoc>
            <declaration name="E2_10" type="double" line="197"/>
            <javadoc line="197">
                Second error weights array, element 10.                
            </javadoc>
            <declaration name="E2_11" type="double" line="200"/>
            <javadoc line="200">
                Second error weights array, element 11.                
            </javadoc>
            <declaration name="E2_12" type="double" line="203"/>
            <javadoc line="203">
                Second error weights array, element 12.                
            </javadoc>
            <javadoc line="206">
                Simple constructor.
                  Build an eighth order Dormand-Prince integrator with the given step bounds                
                <param>
                    minStep minimal step (sign is irrelevant, regardless of
                      integration direction, forward or backward), the last step can
                      be smaller than this                    
                </param>
                <param>
                    maxStep maximal step (sign is irrelevant, regardless of
                      integration direction, forward or backward), the last step can
                      be smaller than this                    
                </param>
                <param>
                    scalAbsoluteTolerance allowed absolute error                    
                </param>
                <param>
                    scalRelativeTolerance allowed relative error                    
                </param>
            </javadoc>
            <method name="DormandPrince853Integrator" type="constructor" line="219">
                <params>
                    <param name="minStep" type="double"/>
                    <param name="maxStep" type="double"/>
                    <param name="scalAbsoluteTolerance" type="double"/>
                    <param name="scalRelativeTolerance" type="double"/>
                </params>
            </method>
            <javadoc line="225">
                Simple constructor.
                  Build an eighth order Dormand-Prince integrator with the given step bounds                
                <param>
                    minStep minimal step (sign is irrelevant, regardless of
                      integration direction, forward or backward), the last step can
                      be smaller than this                    
                </param>
                <param>
                    maxStep maximal step (sign is irrelevant, regardless of
                      integration direction, forward or backward), the last step can
                      be smaller than this                    
                </param>
                <param>
                    vecAbsoluteTolerance allowed absolute error                    
                </param>
                <param>
                    vecRelativeTolerance allowed relative error                    
                </param>
            </javadoc>
            <method name="DormandPrince853Integrator" type="constructor" line="238">
                <params>
                    <param name="minStep" type="double"/>
                    <param name="maxStep" type="double"/>
                    <param name="vecAbsoluteTolerance" type="double[]"/>
                    <param name="vecRelativeTolerance" type="double[]"/>
                </params>
            </method>
            <javadoc line="244">
                {@inheritDoc}                
            </javadoc>
            <method name="getOrder" type="int" line="246"/>
            <javadoc line="250">
                {@inheritDoc}                
            </javadoc>
            <method name="estimateError" type="double" line="254">
                <params>
                    <param name="yDotK" type="double[][]"/>
                    <param name="y0" type="double[]"/>
                    <param name="y1" type="double[]"/>
                    <param name="h" type="double"/>
                </params>
                <declaration name="error1" type="double" line="255"/>
                <declaration name="error2" type="double" line="256"/>
                <scope line="258">
                    <declaration name="errSum1" type="double" line="259"/>
                    <declaration name="errSum2" type="double" line="263"/>
                    <declaration name="yScale" type="double" line="268"/>
                    <declaration name="tol" type="double" line="269"/>
                    <declaration name="ratio1" type="double" line="272"/>
                    <declaration name="ratio2" type="double" line="274"/>
                </scope>
                <declaration name="den" type="double" line="278"/>
                <scope line="279"/>
            </method>
        </class>
    </source>