<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.ode.sampling">
        <import package="org.apache.commons.math3.exception.MaxCountExceededException"/>
        <import package="org.apache.commons.math3.util.FastMath"/>
        <import package="org.apache.commons.math3.util.Precision"/>
        <class name="StepNormalizer" line="24">
            <implements interface="StepHandler"/>
            <javadoc line="24">
                This class wraps an object implementing {@link FixedStepHandler}into a {@link StepHandler}.
                  &lt;p&gt;This wrapper allows to use fixed step handlers with general
                  integrators which cannot guaranty their integration steps will
                  remain constant and therefore only accept general step
                  handlers.&lt;/p&gt;
                  &lt;p&gt;The stepsize used is selected at construction time. The {@link FixedStepHandler#handleStep handleStep} method of the underlying{@link FixedStepHandler} object is called at normalized times. The
                  normalized times can be influenced by the {@link StepNormalizerMode} and{@link StepNormalizerBounds}.&lt;/p&gt;
                  &lt;p&gt;There is no constraint on the integrator, it can use any time step
                  it needs (time steps longer or shorter than the fixed time step and
                  non-integer ratios are all allowed).&lt;/p&gt;
                  &lt;p&gt;
                  &lt;table border=&quot;1&quot; align=&quot;center&quot;&gt;
                  &lt;tr BGCOLOR=&quot;#CCCCFF&quot;&gt;&lt;td colspan=6&gt;&lt;font size=&quot;+2&quot;&gt;Examples (step size = 0.5)&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr BGCOLOR=&quot;#EEEEFF&quot;&gt;&lt;font size=&quot;+1&quot;&gt;&lt;td&gt;Start time&lt;/td&gt;&lt;td&gt;End time&lt;/td&gt;
                  &lt;td&gt;Direction&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode Mode}&lt;/td&gt;
                  &lt;td&gt;{@link StepNormalizerBounds Bounds}&lt;/td&gt;&lt;td&gt;Output&lt;/td&gt;&lt;/font&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;0.8, 1.3, 1.8, 2.3, 2.8&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;0.3, 0.8, 1.3, 1.8, 2.3, 2.8&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;0.8, 1.3, 1.8, 2.3, 2.8, 3.1&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;0.3, 0.8, 1.3, 1.8, 2.3, 2.8, 3.1&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;0.3, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.1&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;0.3, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.1&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;forward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;2.6, 2.1, 1.6, 1.1, 0.6&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;3.1, 2.6, 2.1, 1.6, 1.1, 0.6&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;2.6, 2.1, 1.6, 1.1, 0.6, 0.3&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;3.1, 2.6, 2.1, 1.6, 1.1, 0.6, 0.3&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;3.0, 2.5, 2.0, 1.5, 1.0, 0.5&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;3.1, 3.0, 2.5, 2.0, 1.5, 1.0, 0.5&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;3.0, 2.5, 2.0, 1.5, 1.0, 0.5, 0.3&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.1&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;3.1, 3.0, 2.5, 2.0, 1.5, 1.0, 0.5, 0.3&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;3.0, 2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#INCREMENT INCREMENT}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;3.0, 2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#NEITHER NEITHER}&lt;/td&gt;&lt;td&gt;2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#FIRST FIRST}&lt;/td&gt;&lt;td&gt;3.0, 2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#LAST LAST}&lt;/td&gt;&lt;td&gt;2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;tr&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;backward&lt;/td&gt;&lt;td&gt;{@link StepNormalizerMode#MULTIPLES MULTIPLES}&lt;/td&gt;&lt;td&gt;{@link StepNormalizerBounds#BOTH BOTH}&lt;/td&gt;&lt;td&gt;3.0, 2.5, 2.0, 1.5, 1.0, 0.5, 0.0&lt;/td&gt;&lt;/tr&gt;
                  &lt;/table&gt;
                  &lt;/p&gt;                
                <see>
                    StepHandler                    
                </see>
                <see>
                    FixedStepHandler                    
                </see>
                <see>
                    StepNormalizerMode                    
                </see>
                <see>
                    StepNormalizerBounds                    
                </see>
                <version>
                    $Id: StepNormalizer.java 1416643 2012-12-03 19:37:14Z tn $                    
                </version>
                <since>
                    1.2                    
                </since>
            </javadoc>
            <declaration name="h" type="double" line="93"/>
            <javadoc line="93">
                Fixed time step.                
            </javadoc>
            <declaration name="handler" type="FixedStepHandler" line="96"/>
            <javadoc line="96">
                Underlying step handler.                
            </javadoc>
            <declaration name="firstTime" type="double" line="99"/>
            <javadoc line="99">
                First step time.                
            </javadoc>
            <declaration name="lastTime" type="double" line="102"/>
            <javadoc line="102">
                Last step time.                
            </javadoc>
            <declaration name="lastState" type="double[]" line="105"/>
            <javadoc line="105">
                Last state vector.                
            </javadoc>
            <declaration name="lastDerivatives" type="double[]" line="108"/>
            <javadoc line="108">
                Last derivatives vector.                
            </javadoc>
            <declaration name="forward" type="boolean" line="111"/>
            <javadoc line="111">
                Integration direction indicator.                
            </javadoc>
            <declaration name="bounds" type="StepNormalizerBounds" line="114"/>
            <javadoc line="114">
                The step normalizer bounds settings to use.                
            </javadoc>
            <declaration name="mode" type="StepNormalizerMode" line="117"/>
            <javadoc line="117">
                The step normalizer mode to use.                
            </javadoc>
            <javadoc line="120">
                Simple constructor. Uses {@link StepNormalizerMode#INCREMENT INCREMENT}mode, and {@link StepNormalizerBounds#FIRST FIRST} bounds setting, for
                  backwards compatibility.                
                <param>
                    h fixed time step (sign is not used)                    
                </param>
                <param>
                    handler fixed time step handler to wrap                    
                </param>
            </javadoc>
            <method name="StepNormalizer" type="constructor" line="126">
                <params>
                    <param name="h" type="double"/>
                    <param name="handler" type="FixedStepHandler"/>
                </params>
            </method>
            <javadoc line="131">
                Simple constructor. Uses {@link StepNormalizerBounds#FIRST FIRST}bounds setting.                
                <param>
                    h fixed time step (sign is not used)                    
                </param>
                <param>
                    handler fixed time step handler to wrap                    
                </param>
                <param>
                    mode step normalizer mode to use                    
                </param>
                <since>
                    3.0                    
                </since>
            </javadoc>
            <method name="StepNormalizer" type="constructor" line="139">
                <params>
                    <param name="h" type="double"/>
                    <param name="handler" type="FixedStepHandler"/>
                    <param name="mode" type="StepNormalizerMode"/>
                </params>
            </method>
            <javadoc line="143">
                Simple constructor. Uses {@link StepNormalizerMode#INCREMENT INCREMENT}mode.                
                <param>
                    h fixed time step (sign is not used)                    
                </param>
                <param>
                    handler fixed time step handler to wrap                    
                </param>
                <param>
                    bounds step normalizer bounds setting to use                    
                </param>
                <since>
                    3.0                    
                </since>
            </javadoc>
            <method name="StepNormalizer" type="constructor" line="151">
                <params>
                    <param name="h" type="double"/>
                    <param name="handler" type="FixedStepHandler"/>
                    <param name="bounds" type="StepNormalizerBounds"/>
                </params>
            </method>
            <javadoc line="155">
                Simple constructor.                
                <param>
                    h fixed time step (sign is not used)                    
                </param>
                <param>
                    handler fixed time step handler to wrap                    
                </param>
                <param>
                    mode step normalizer mode to use                    
                </param>
                <param>
                    bounds step normalizer bounds setting to use                    
                </param>
                <since>
                    3.0                    
                </since>
            </javadoc>
            <method name="StepNormalizer" type="constructor" line="164">
                <params>
                    <param name="h" type="double"/>
                    <param name="handler" type="FixedStepHandler"/>
                    <param name="mode" type="StepNormalizerMode"/>
                    <param name="bounds" type="StepNormalizerBounds"/>
                </params>
            </method>
            <javadoc line="176">
                {@inheritDoc}                
            </javadoc>
            <method name="init" type="void" line="177">
                <params>
                    <param name="t0" type="double"/>
                    <param name="y0" type="double[]"/>
                    <param name="t" type="double"/>
                </params>
                <comment line="186">
                    initialize the underlying handler                    
                </comment>
            </method>
            <javadoc line="190">
                Handle the last accepted step                
                <param>
                    interpolator interpolator for the last accepted step. For
                      efficiency purposes, the various integrators reuse the same
                      object on each call, so if the instance wants to keep it across
                      all calls (for example to provide at the end of the integration a
                      continuous model valid throughout the integration range), it
                      should build a local copy using the clone method and store this
                      copy.                    
                </param>
                <param>
                    isLast true if the step is the last one                    
                </param>
                <exception>
                    MaxCountExceededException if the interpolator throws one because
                      the number of functions evaluations is exceeded                    
                </exception>
            </javadoc>
            <method name="handleStep" type="void" line="204">
                <params>
                    <param name="interpolator" type="StepInterpolator"/>
                    <param name="isLast" type="boolean"/>
                </params>
                <comment line="206">
                    The first time, update the last state with the start information.                    
                </comment>
                <comment line="214">
                    Take the integration direction into account.                    
                </comment>
                <comment line="221">
                    Calculate next normalized step time.                    
                </comment>
                <comment line="230">
                    Process normalized steps as long as they are in the current step.                    
                </comment>
                <comment line="233">
                    Output the stored previous step.                    
                </comment>
                <comment line="236">
                    Store the next step as last step.                    
                </comment>
                <comment line="239">
                    Move on to the next step.                    
                </comment>
                <comment line="245">
                    There will be no more steps. The stored one should be given to
                     the handler. We may have to output one more step. Only the last
                     one of those should be flagged as being the last.                    
                </comment>
                <scope line="206">
                    <scope line="215"/>
                </scope>
                <declaration name="nextTime" type="double" line="221"/>
                <scope line="225"/>
                <declaration name="nextInStep" type="boolean" line="230"/>
                <scope line="231"/>
                <scope line="243">
                    <declaration name="addLast" type="boolean" line="247"/>
                    <scope line="250"/>
                </scope>
            </method>
            <javadoc line="257">
                Returns a value indicating whether the next normalized time is in the
                  current step.                
                <param>
                    nextTime the next normalized time                    
                </param>
                <param>
                    interpolator interpolator for the last accepted step, to use to
                      get the end time of the current step                    
                </param>
                <return>
                    value indicating whether the next normalized time is in the
                      current step                    
                </return>
            </javadoc>
            <method name="isNextInStep" type="boolean" line="267">
                <params>
                    <param name="nextTime" type="double"/>
                    <param name="interpolator" type="StepInterpolator"/>
                </params>
            </method>
            <javadoc line="273">
                Invokes the underlying step handler for the current normalized step.                
                <param>
                    isLast true if the step is the last one                    
                </param>
            </javadoc>
            <method name="doNormalizedStep" type="void" line="277">
                <params>
                    <param name="isLast" type="boolean"/>
                </params>
                <scope line="278"/>
            </method>
            <javadoc line="284">
                Stores the interpolated information for the given time in the current
                  state.                
                <param>
                    interpolator interpolator for the last accepted step, to use to
                      get the interpolated information                    
                </param>
                <param>
                    t the time for which to store the interpolated information                    
                </param>
                <exception>
                    MaxCountExceededException if the interpolator throws one because
                      the number of functions evaluations is exceeded                    
                </exception>
            </javadoc>
            <method name="storeStep" type="void" line="293">
                <params>
                    <param name="interpolator" type="StepInterpolator"/>
                    <param name="t" type="double"/>
                </params>
            </method>
        </class>
    </source>