<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.ode.sampling">
        <import package="java.io.IOException"/>
        <import package="java.io.ObjectInput"/>
        <import package="java.io.ObjectOutput"/>
        <import package="java.util.Arrays"/>
        <import package="org.apache.commons.math3.exception.MaxCountExceededException"/>
        <import package="org.apache.commons.math3.linear.Array2DRowRealMatrix"/>
        <import package="org.apache.commons.math3.ode.EquationsMapper"/>
        <import package="org.apache.commons.math3.util.FastMath"/>
        <class name="NordsieckStepInterpolator" line="10">
            <extends class="AbstractStepInterpolator"/>
            <javadoc line="10">
                This class implements an interpolator for integrators using Nordsieck representation.
                  &lt;p&gt;This interpolator computes dense output around the current point.
                  The interpolation equation is based on Taylor series formulas.                
                <see>
                    org.apache.commons.math3.ode.nonstiff.AdamsBashforthIntegrator                    
                </see>
                <see>
                    org.apache.commons.math3.ode.nonstiff.AdamsMoultonIntegrator                    
                </see>
                <version>
                    $Id: NordsieckStepInterpolator.java 1416643 2012-12-03 19:37:14Z tn $                    
                </version>
                <since>
                    2.0                    
                </since>
            </javadoc>
            <declaration name="serialVersionUID" type="long" line="20"/>
            <javadoc line="20">
                Serializable version identifier                
            </javadoc>
            <declaration name="stateVariation" type="double[]" line="24"/>
            <javadoc line="24">
                State variation.                
            </javadoc>
            <declaration name="scalingH" type="double" line="28"/>
            <javadoc line="28">
                Step size used in the first scaled derivative and Nordsieck vector.                
            </javadoc>
            <declaration name="referenceTime" type="double" line="32"/>
            <javadoc line="32">
                Reference time for all arrays.
                  &lt;p&gt;Sometimes, the reference time is the same as previousTime,
                  sometimes it is the same as currentTime, so we use a separate
                  field to avoid any confusion.
                  &lt;/p&gt;                
            </javadoc>
            <declaration name="scaled" type="double[]" line="40"/>
            <javadoc line="40">
                First scaled derivative.                
            </javadoc>
            <declaration name="nordsieck" type="Array2DRowRealMatrix" line="44"/>
            <javadoc line="44">
                Nordsieck vector.                
            </javadoc>
            <javadoc line="48">
                Simple constructor.
                  This constructor builds an instance that is not usable yet, the{@link AbstractStepInterpolator#reinitialize} method should be called
                  before using the instance in order to initialize the internal arrays. This
                  constructor is used only in order to delay the initialization in
                  some cases.                
            </javadoc>
            <method name="NordsieckStepInterpolator" type="constructor" line="55"/>
            <javadoc line="57">
                Copy constructor.                
                <param>
                    interpolator interpolator to copy from. The copy is a deep
                      copy: its arrays are separated from the original arrays of the
                      instance                    
                </param>
            </javadoc>
            <method name="NordsieckStepInterpolator" type="constructor" line="63">
                <params>
                    <param name="interpolator" type="NordsieckStepInterpolator"/>
                </params>
                <scope line="67"/>
                <scope line="70"/>
                <scope line="73"/>
            </method>
            <javadoc line="77">
                {@inheritDoc}                
            </javadoc>
            <method name="doCopy" type="StepInterpolator" line="80"/>
            <javadoc line="83">
                Reinitialize the instance.
                  &lt;p&gt;Beware that all arrays &lt;em&gt;must&lt;/em&gt; be references to integrator
                  arrays, in order to ensure proper update without copy.&lt;/p&gt;                
                <param>
                    y reference to the integrator array holding the state at
                      the end of the step                    
                </param>
                <param>
                    forward integration direction indicator                    
                </param>
                <param>
                    primaryMapper equations mapper for the primary equations set                    
                </param>
                <param>
                    secondaryMappers equations mappers for the secondary equations sets                    
                </param>
            </javadoc>
            <method name="reinitialize" type="void" line="93">
                <params>
                    <param name="y" type="double[]"/>
                    <param name="forward" type="boolean"/>
                    <param name="primaryMapper" type="EquationsMapper"/>
                    <param name="secondaryMappers" type="EquationsMapper[]"/>
                </params>
            </method>
            <javadoc line="97">
                Reinitialize the instance.
                  &lt;p&gt;Beware that all arrays &lt;em&gt;must&lt;/em&gt; be references to integrator
                  arrays, in order to ensure proper update without copy.&lt;/p&gt;                
                <param>
                    time time at which all arrays are defined                    
                </param>
                <param>
                    stepSize step size used in the scaled and nordsieck arrays                    
                </param>
                <param>
                    scaledDerivative reference to the integrator array holding the first
                      scaled derivative                    
                </param>
                <param>
                    nordsieckVector reference to the integrator matrix holding the
                      nordsieck vector                    
                </param>
            </javadoc>
            <method name="reinitialize" type="void" line="108">
                <params>
                    <param name="time" type="double"/>
                    <param name="stepSize" type="double"/>
                    <param name="scaledDerivative" type="double[]"/>
                    <param name="nordsieckVector" type="Array2DRowRealMatrix"/>
                </params>
            </method>
            <javadoc line="115">
                Rescale the instance.
                  &lt;p&gt;Since the scaled and Nordiseck arrays are shared with the caller,
                  this method has the side effect of rescaling this arrays in the caller too.&lt;/p&gt;                
                <param>
                    stepSize new step size to use in the scaled and nordsieck arrays                    
                </param>
            </javadoc>
            <method name="rescale" type="void" line="121">
                <params>
                    <param name="stepSize" type="double"/>
                </params>
                <declaration name="ratio" type="double" line="122"/>
                <scope line="123"/>
                <declaration name="nData" type="double[][]" line="126"/>
                <declaration name="power" type="double" line="127"/>
                <scope line="128">
                    <declaration name="nDataI" type="double[]" line="130"/>
                    <scope line="131"/>
                </scope>
            </method>
            <javadoc line="137">
                Get the state vector variation from current to interpolated state.
                  &lt;p&gt;This method is aimed at computing y(t&lt;sub&gt;interpolation&lt;/sub&gt;)
                  -y(t&lt;sub&gt;current&lt;/sub&gt;) accurately by avoiding the cancellation errors
                  that would occur if the subtraction were performed explicitly.&lt;/p&gt;
                  &lt;p&gt;The returned vector is a reference to a reused array, so
                  it should not be modified and it should be copied if it needs
                  to be preserved across several calls.&lt;/p&gt;                
                <return>
                    state vector at time {@link #getInterpolatedTime}                    
                </return>
                <see>
                    #getInterpolatedDerivatives()                    
                </see>
                <exception>
                    MaxCountExceededException if the number of functions evaluations is exceeded                    
                </exception>
            </javadoc>
            <method name="getInterpolatedStateVariation" type="double[]" line="149"/>
            <javadoc line="153">
                {@inheritDoc}                
            </javadoc>
            <method name="computeInterpolatedStateAndDerivatives" type="void" line="156">
                <params>
                    <param name="theta" type="double"/>
                    <param name="oneMinusThetaH" type="double"/>
                </params>
                <declaration name="x" type="double" line="157"/>
                <declaration name="normalizedAbscissa" type="double" line="158"/>
                <declaration name="nData" type="double[][]" line="161"/>
                <scope line="162">
                    <declaration name="order" type="int" line="163"/>
                    <declaration name="nDataI" type="double[]" line="164"/>
                    <declaration name="power" type="double" line="165"/>
                    <scope line="166">
                        <declaration name="d" type="double" line="167"/>
                    </scope>
                </scope>
                <scope line="172"/>
            </method>
            <javadoc line="178">
                {@inheritDoc}                
            </javadoc>
            <method name="writeExternal" type="void" line="181">
                <params>
                    <param name="out" type="ObjectOutput"/>
                </params>
                <declaration name="n" type="int" line="185"/>
                <scope line="186"/>
                <scope line="189">
                    <scope line="191"/>
                </scope>
                <scope line="195"/>
                <scope line="198"/>
            </method>
            <javadoc line="203">
                {@inheritDoc}                
            </javadoc>
            <method name="readExternal" type="void" line="206">
                <params>
                    <param name="in" type="ObjectInput"/>
                </params>
                <declaration name="t" type="double" line="207"/>
                <declaration name="n" type="int" line="210"/>
                <declaration name="hasScaled" type="boolean" line="211"/>
                <scope line="212">
                    <scope line="214"/>
                </scope>
                <scope line="218"/>
                <declaration name="hasNordsieck" type="boolean" line="221"/>
                <scope line="222"/>
                <scope line="225"/>
                <scope line="228"/>
                <scope line="232"/>
            </method>
        </class>
    </source>