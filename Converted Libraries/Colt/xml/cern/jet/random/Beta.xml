<?xml version="1.0" encoding="UTF-8"?>
    <source package="cern.jet.random">
        <import package="cern.jet.random.engine.RandomEngine"/>
        <import package="cern.jet.stat.Probability"/>
        <class name="Beta" line="13">
            <extends class="AbstractContinousDistribution"/>
            <comment line="47">
                cache to speed up pdf()                
            </comment>
            <comment line="49">
                cached values shared by bXX                
            </comment>
            <comment line="53">
                cached values for b00                
            </comment>
            <comment line="56">
                chached values for b01                
            </comment>
            <comment line="59">
                chached values for b1prs                
            </comment>
            <comment line="65">
                The uniform random number generated shared by all &lt;b&gt;static&lt;/b&gt; methods.                
            </comment>
            <javadoc line="13">
                Beta distribution; &lt;A HREF=&quot;http://www.cern.ch/RD11/rkb/AN16pp/node15.html#SECTION000150000000000000000&quot;&gt; math definition&lt;/A&gt;
                  and &lt;A HREF=&quot;http://www.statsoft.com/textbook/glosb.html#Beta Distribution&quot;&gt; animated definition&lt;/A&gt;.
                  &lt;p&gt;
                  &lt;tt&gt;p(x) = k  x^(alpha-1)  (1-x)^(beta-1)&lt;/tt&gt; with &lt;tt&gt;k = g(alpha+beta)/(g(alpha)g(beta))&lt;/tt&gt; and &lt;tt&gt;g(a)&lt;/tt&gt; being the gamma function.
                  &lt;p&gt;
                  Valid parameter ranges: &lt;tt&gt;alpha &amp;gt; 0&lt;/tt&gt; and &lt;tt&gt;beta &amp;gt; 0&lt;/tt&gt;.            
                  &lt;p&gt;
                  Instance methods operate on a user supplied uniform random number generator; they are unsynchronized.
                  &lt;dt&gt;
                  Static methods operate on a default uniform random number generator; they are synchronized.
                  &lt;p&gt;
                  &lt;b&gt;Implementation:&lt;/b&gt;
                  &lt;dt&gt;Method: Stratified Rejection/Patchwork Rejection.
                  High performance implementation.
                  &lt;dt&gt;This is a port of &lt;tt&gt;bsprc.c&lt;/tt&gt; from the &lt;A HREF=&quot;http://www.cis.tu-graz.ac.at/stat/stadl/random.html&quot;&gt;C-RAND / WIN-RAND&lt;/A&gt; library.
                  C-RAND&apos;s implementation, in turn, is based upon
                  &lt;p&gt;
                  H. Sakasegawa (1983): Stratified rejection and squeeze method for generating beta random numbers, 
                  Ann. Inst. Statist. Math. 35 B, 291-302.                                        
                  &lt;p&gt;
                  and
                  &lt;p&gt;
                  Stadlober E., H. Zechner (1993), &lt;A HREF=&quot;http://www.cis.tu-graz.ac.at/stat/stadl/random.html&quot;&gt; Generating beta variates via patchwork rejection,&lt;/A&gt;,
                  Computing 50, 1-18.                
                <author>
                    wolfgang.hoschek@cern.ch                    
                </author>
                <version>
                    1.0, 09/24/99                    
                </version>
            </javadoc>
            <declaration name="alpha" type="double" line="43"/>
            <declaration name="beta" type="double" line="44"/>
            <declaration name="PDF_CONST" type="double" line="46"/>
            <declaration name="a_last" type="double" line="49"/>
            <declaration name="a_" type="double" line="50"/>
            <declaration name="c" type="double" line="53"/>
            <declaration name="ml" type="double" line="56"/>
            <declaration name="p_last" type="double" line="59"/>
            <declaration name="a" type="double" line="60"/>
            <declaration name="ll" type="double" line="61"/>
            <declaration name="shared" type="Beta" line="65"/>
            <javadoc line="66">
                Constructs a Beta distribution.                
            </javadoc>
            <method name="Beta" type="constructor" line="69">
                <params>
                    <param name="alpha" type="double"/>
                    <param name="beta" type="double"/>
                    <param name="randomGenerator" type="RandomEngine"/>
                </params>
            </method>
            <javadoc line="73">
                                
            </javadoc>
            <method name="b00" type="double" line="76">
                <params>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                    <param name="randomGenerator" type="RandomEngine"/>
                </params>
                <comment line="85">
                    b(1-b) / a(1-a)                    
                </comment>
                <comment line="86">
                    t = t_opt                    
                </comment>
                <comment line="88">
                    f(t) = fa * fb                    
                </comment>
                <comment line="90">
                    0 &lt; X &lt; t                    
                </comment>
                <comment line="91">
                    t &lt; X &lt; 1                    
                </comment>
                <comment line="95">
                    X &lt; t                    
                </comment>
                <comment line="97">
                    squeeze accept:   L(x) = 1 + (1 - b)x                    
                </comment>
                <comment line="99">
                    squeeze reject:   U(x) = 1 + ((1 - t)^(b-1) - 1)/t * x                    
                </comment>
                <comment line="101">
                    quotient accept:  q(x) = (1 - x)^(b-1) / fb                    
                </comment>
                <comment line="105">
                    X &gt; t                    
                </comment>
                <comment line="107">
                    squeeze accept:   L(x) = 1 + (1 - a)(1 - x)                    
                </comment>
                <comment line="109">
                    squeeze reject:   U(x) = 1 + (t^(a-1) - 1)/(1 - t) * (1 - x)                    
                </comment>
                <comment line="111">
                    quotient accept:  q(x) = x^(a-1) / fa                    
                </comment>
                <declaration name="U" type="double" line="77"/>
                <scope line="79"/>
                <scope line="94">
                    <scope line="95">
                        <scope line="100"/>
                    </scope>
                    <scope line="105">
                        <scope line="110"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="118">
                                
            </javadoc>
            <method name="b01" type="double" line="121">
                <params>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                    <param name="randomGenerator" type="RandomEngine"/>
                </params>
                <comment line="130">
                    one step Newton * start value t                    
                </comment>
                <comment line="134">
                    f(t) = fa * fb                    
                </comment>
                <comment line="136">
                    ml = -m1                    
                </comment>
                <comment line="137">
                    mu = -m2 * t                    
                </comment>
                <comment line="143">
                    0 &lt; X &lt; t                    
                </comment>
                <comment line="144">
                    t &lt; X &lt; 1                    
                </comment>
                <comment line="148">
                    X &lt; t                    
                </comment>
                <comment line="150">
                    squeeze accept:   L(x) = 1 + m1*x,  ml = -m1                    
                </comment>
                <comment line="152">
                    squeeze reject:   U(x) = 1 + m2*x,  mu = -m2 * t                    
                </comment>
                <comment line="154">
                    quotient accept:  q(x) = (1 - x)^(b-1)                    
                </comment>
                <comment line="158">
                    X &gt; t                    
                </comment>
                <comment line="160">
                    squeeze accept:   L(x) = 1 + (1 - a)(1 - x)                    
                </comment>
                <comment line="162">
                    squeeze reject:   U(x) = 1 + (t^(a-1) - 1)/(1 - t) * (1 - x)                    
                </comment>
                <comment line="164">
                    quotient accept:  q(x) = (x)^(a-1) / fa                    
                </comment>
                <declaration name="U" type="double" line="122"/>
                <scope line="124">
                    <scope line="135"/>
                    <scope line="139"/>
                </scope>
                <scope line="147">
                    <scope line="148">
                        <scope line="153"/>
                    </scope>
                    <scope line="158">
                        <scope line="163"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="171">
                                
            </javadoc>
            <method name="b1prs" type="double" line="174">
                <params>
                    <param name="p" type="double"/>
                    <param name="q" type="double"/>
                    <param name="randomGenerator" type="RandomEngine"/>
                </params>
                <comment line="200">
                    z1 = x1 - ll                    
                </comment>
                <comment line="215">
                    z5 = x5 + lr                    
                </comment>
                <comment line="219">
                    x1 &lt; X &lt; m                    
                </comment>
                <comment line="220">
                    m  &lt; X &lt; x5                    
                </comment>
                <comment line="221">
                    X &lt; x1                    
                </comment>
                <comment line="222">
                    x5 &lt; X                    
                </comment>
                <comment line="227">
                    immediate accept:  x2 &lt; X &lt; m, - f(x2) &lt; W &lt; 0                    
                </comment>
                <comment line="229">
                    immediate accept:  x1 &lt; X &lt; x2, 0 &lt; W &lt; f(x1)                    
                </comment>
                <comment line="231">
                    candidates for acceptance-rejection-test                    
                </comment>
                <comment line="234">
                    squeeze accept:    L(x) = f(x2) (x - z2) / (x2 - z2)                    
                </comment>
                <comment line="237">
                    squeeze accept:    L(x) = f(x2) + (1 - f(x2))(x - x2)/(m - x2)                    
                </comment>
                <comment line="239">
                    quotient accept:   x2 &lt; Y &lt; m,   W &gt;= 2f2 - f(Y)                    
                </comment>
                <comment line="245">
                    immediate accept:  m &lt; X &lt; x4, - f(x4) &lt; W &lt; 0                    
                </comment>
                <comment line="247">
                    immediate accept:  x4 &lt; X &lt; x5, 0 &lt; W &lt; f(x5)                    
                </comment>
                <comment line="249">
                    candidates for acceptance-rejection-test                    
                </comment>
                <comment line="252">
                    squeeze accept:    L(x) = f(x4) (z4 - x) / (z4 - x4)                    
                </comment>
                <comment line="255">
                    squeeze accept:    L(x) = f(x4) + (1 - f(x4))(x4 - x)/(x4 - m)                    
                </comment>
                <comment line="257">
                    quotient accept:   m &lt; Y &lt; x4,   W &gt;= 2f4 - f(Y)                    
                </comment>
                <comment line="261">
                    X &lt; x1                    
                </comment>
                <comment line="263">
                    X &gt; 0!!                    
                </comment>
                <comment line="265">
                    squeeze accept:    L(x) = f(x1) (x - z1) / (x1 - z1)                    
                </comment>
                <comment line="266">
                    z1 = x1 - ll,   W &lt;= 1 + (X - x1)/ll                    
                </comment>
                <comment line="270">
                    x5 &lt; X                    
                </comment>
                <comment line="272">
                    X &lt; 1!!                    
                </comment>
                <comment line="274">
                    squeeze accept:    L(x) = f(x5) (z5 - x) / (z5 - x5)                    
                </comment>
                <comment line="275">
                    z5 = x5 + lr,   W &lt;= 1 + (x5 - X)/lr                    
                </comment>
                <comment line="279">
                    density accept:  f(x) = (x/m)^a ((1 - x)/(1 - m))^b                    
                </comment>
                <declaration name="U" type="double" line="175"/>
                <scope line="177">
                    <scope line="186"/>
                    <scope line="189">
                        <scope line="192"/>
                        <scope line="196"/>
                    </scope>
                    <scope line="204"/>
                    <scope line="207">
                        <scope line="210"/>
                    </scope>
                </scope>
                <scope line="225">
                    <scope line="226">
                        <scope line="236"/>
                    </scope>
                    <scope line="243">
                        <scope line="254"/>
                    </scope>
                    <scope line="261"/>
                    <scope line="270"/>
                </scope>
            </method>
            <javadoc line="283">
                Returns the cumulative distribution function.                
            </javadoc>
            <method name="cdf" type="double" line="286">
                <params>
                    <param name="x" type="double"/>
                </params>
            </method>
            <method name="f" type="double" line="289">
                <params>
                    <param name="x" type="double"/>
                    <param name="a" type="double"/>
                    <param name="b" type="double"/>
                    <param name="m" type="double"/>
                </params>
            </method>
            <javadoc line="292">
                Returns a random number from the distribution.                
            </javadoc>
            <method name="nextDouble" type="double" line="295"/>
            <javadoc line="298">
                Returns a beta distributed random number; bypasses the internal state.                
            </javadoc>
            <method name="nextDouble" type="double" line="301">
                <params>
                    <param name="alpha" type="double"/>
                    <param name="beta" type="double"/>
                </params>
                <comment line="302">
                    Beta Distribution - Stratified RejectionPatchwork Rejection   
                                                                                    
                    
                     For parameters a &lt; 1 , b &lt; 1  and  a &lt; 1 &lt; b   or  b &lt; 1 &lt; a   
                     the stratified rejection methods b00 and b01 of Sakasegawa are 
                     used. Both procedures employ suitable two-part power functions 
                     from which samples can be obtained by inversion.               
                     If a &gt; 1 , b &gt; 1 (unimodal case) the patchwork rejection       
                     method b1prs of ZechnerStadlober is utilized:                 
                     The area below the density function f(x) in its body is        
                     rearranged by certain point reflections. Within a large center 
                     interval variates are sampled efficiently by rejection from    
                     uniform hats. Rectangular immediate acceptance regions speed   
                     up the generation. The remaining tails are covered by          
                     exponential functions.                                         
                     If (a-1)(b-1) = 0  sampling is done by inversion if either a   
                     or b are not equal to one. If  a = b = 1  a uniform random     
                     variate is delivered.                                          
                                                                                    
                    
                                                                                    
                     FUNCTION :   - bsprc samples a random variate from the beta    
                                    distribution with parameters  a &gt; 0, b &gt; 0.     
                     REFERENCES : - H. Sakasegawa (1983): Stratified rejection and  
                                    squeeze method for generating beta random       
                                    numbers, Ann. Inst. Statist. Math. 35 B,        
                                    291-302.                                        
                                  - H. Zechner, E. Stadlober (1993): Generating     
                                    beta variates via patchwork rejection,          
                                    Computing 50, 1-18.                             
                                                                                    
                     SUBPROGRAMS: - drand(seed) ... (0,1)-Uniform generator with    
                                    unsigned long integer seed.                    
                                  - b00(seed,a,b) ... Beta generator for a&lt;1, b&lt;1   
                                  - b01(seed,a,b) ... Beta generator for a&lt;1&lt;b or   
                                                      b&lt;1&lt;a                         
                                  - b1prs(seed,a,b) ... Beta generator for a&gt;1, b&gt;1 
                                    with unsigned long integer seed, double a, b.                    
                </comment>
                <declaration name="a" type="double" line="344"/>
                <declaration name="b" type="double" line="345"/>
                <scope line="346">
                    <scope line="349"/>
                </scope>
                <scope line="354">
                    <scope line="357"/>
                </scope>
                <scope line="362"/>
            </method>
            <javadoc line="369">
                Returns the cumulative distribution function.                
            </javadoc>
            <method name="pdf" type="double" line="372">
                <params>
                    <param name="x" type="double"/>
                </params>
            </method>
            <javadoc line="376">
                Sets the parameters.                
            </javadoc>
            <method name="setState" type="void" line="379">
                <params>
                    <param name="alpha" type="double"/>
                    <param name="beta" type="double"/>
                </params>
            </method>
            <javadoc line="384">
                Returns a random number from the distribution.                
            </javadoc>
            <method name="staticNextDouble" type="double" line="387">
                <params>
                    <param name="alpha" type="double"/>
                    <param name="beta" type="double"/>
                </params>
                <scope line="388"/>
            </method>
            <javadoc line="392">
                Returns a String representation of the receiver.                
            </javadoc>
            <method name="toString" type="String" line="395"/>
            <javadoc line="398">
                Sets the uniform random number generated shared by all &lt;b&gt;static&lt;/b&gt; methods.                
                <param>
                    randomGenerator the new uniform random number generator to be shared.                    
                </param>
            </javadoc>
            <method name="xstaticSetRandomGenerator" type="void" line="402">
                <params>
                    <param name="randomGenerator" type="RandomEngine"/>
                </params>
                <scope line="403"/>
            </method>
        </class>
    </source>