<?xml version="1.0" encoding="UTF-8"?>
    <source package="edu.umd.cs.piccolox.event">
        <import package="java.awt.BasicStroke"/>
        <import package="java.awt.Color"/>
        <import package="java.awt.Paint"/>
        <import package="java.awt.Stroke"/>
        <import package="java.awt.event.KeyEvent"/>
        <import package="java.awt.geom.Point2D"/>
        <import package="java.util.ArrayList"/>
        <import package="java.util.Collection"/>
        <import package="java.util.Collections"/>
        <import package="java.util.HashMap"/>
        <import package="java.util.Iterator"/>
        <import package="java.util.List"/>
        <import package="java.util.Map"/>
        <import package="edu.umd.cs.piccolo.PCamera"/>
        <import package="edu.umd.cs.piccolo.PLayer"/>
        <import package="edu.umd.cs.piccolo.PNode"/>
        <import package="edu.umd.cs.piccolo.event.PDragSequenceEventHandler"/>
        <import package="edu.umd.cs.piccolo.event.PInputEvent"/>
        <import package="edu.umd.cs.piccolo.nodes.PPath"/>
        <import package="edu.umd.cs.piccolo.util.PBounds"/>
        <import package="edu.umd.cs.piccolo.util.PDimension"/>
        <import package="edu.umd.cs.piccolo.util.PNodeFilter"/>
        <import package="edu.umd.cs.piccolox.handles.PBoundsHandle"/>
        <class name="PSelectionEventHandler" line="25">
            <extends class="PDragSequenceEventHandler"/>
            <javadoc line="25">
                &lt;code&gt;PSelectionEventHandler&lt;/code&gt; provides standard interaction for
                  selection. Clicking selects the object under the cursor. Shift-clicking
                  allows multiple objects to be selected. Dragging offers marquee selection.
                  Pressing the delete key deletes the selection by default.                
                <version>
                    1.0                    
                </version>
                <author>
                    Ben Bederson                    
                </author>
            </javadoc>
            <declaration name="SELECTION_CHANGED_NOTIFICATION" type="String" line="34"/>
            <javadoc line="34">
                Notification name that identifies a change in the selection. Used with
                  PNotificationCenter.                
            </javadoc>
            <declaration name="DASH_WIDTH" type="int" line="39"/>
            <javadoc line="39">
                The default dash width when displaying selection rectangle.                
            </javadoc>
            <declaration name="NUM_STROKES" type="int" line="43"/>
            <declaration name="selection" type="HashMap" line="44"/>
            <javadoc line="44">
                The current selection.                
            </javadoc>
            <declaration name="selectableParents" type="List" line="48"/>
            <javadoc line="48">
                List of nodes whose children can be selected.                
            </javadoc>
            <declaration name="marquee" type="PPath" line="52"/>
            <declaration name="marqueeParent" type="PNode" line="53"/>
            <javadoc line="53">
                Node that marquee is added to as a child.                
            </javadoc>
            <declaration name="presspt" type="Point2D" line="57"/>
            <declaration name="canvasPressPt" type="Point2D" line="58"/>
            <declaration name="strokeNum" type="float" line="59"/>
            <declaration name="strokes" type="Stroke[]" line="60"/>
            <declaration name="allItems" type="HashMap" line="61"/>
            <javadoc line="61">
                Used within drag handler temporarily.                
            </javadoc>
            <declaration name="unselectList" type="ArrayList" line="65"/>
            <javadoc line="65">
                Used within drag handler temporarily.                
            </javadoc>
            <declaration name="marqueeMap" type="HashMap" line="69"/>
            <declaration name="pressNode" type="PNode" line="70"/>
            <javadoc line="70">
                Node pressed on (or null if none).                
            </javadoc>
            <declaration name="deleteKeyActive" type="boolean" line="74"/>
            <javadoc line="74">
                True if DELETE key should delete selection.                
            </javadoc>
            <declaration name="marqueePaint" type="Paint" line="78"/>
            <javadoc line="78">
                Paint applied when drawing the marquee.                
            </javadoc>
            <declaration name="marqueePaintTransparency" type="float" line="82"/>
            <javadoc line="82">
                How transparent the marquee should be.                
            </javadoc>
            <javadoc line="86">
                Creates a selection event handler.                
                <param>
                    marqueeParent The node to which the event handler dynamically adds
                      a marquee (temporarily) to represent the area being selected.                    
                </param>
                <param>
                    selectableParent The node whose children will be selected by this
                      event handler.                    
                </param>
            </javadoc>
            <method name="PSelectionEventHandler" type="constructor" line="93">
                <params>
                    <param name="marqueeParent" type="PNode"/>
                    <param name="selectableParent" type="PNode"/>
                </params>
            </method>
            <javadoc line="99">
                Creates a selection event handler.                
                <param>
                    marqueeParent The node to which the event handler dynamically adds
                      a marquee (temporarily) to represent the area being selected.                    
                </param>
                <param>
                    selectableParents A list of nodes whose children will be selected
                      by this event handler.                    
                </param>
            </javadoc>
            <method name="PSelectionEventHandler" type="constructor" line="106">
                <params>
                    <param name="marqueeParent" type="PNode"/>
                    <param name="selectableParents" type="List"/>
                </params>
            </method>
            <javadoc line="111">
                Initializes the PSelectionEventHandler with a marquee stroke.                
            </javadoc>
            <method name="init" type="void" line="114">
                <declaration name="dash" type="float[]" line="115"/>
                <scope line="119"/>
            </method>
            <javadoc line="127">
                Marks all items as selected.                
                <param>
                    items collection of items to be selected                    
                </param>
            </javadoc>
            <method name="select" type="void" line="131">
                <params>
                    <param name="items" type="Collection"/>
                </params>
                <declaration name="changes" type="boolean" line="132"/>
                <declaration name="itemIt" type="Iterator" line="133"/>
                <scope line="134">
                    <declaration name="node" type="PNode" line="135"/>
                </scope>
                <scope line="138"/>
            </method>
            <javadoc line="142">
                Marks all keys as selected.                
                <param>
                    items map where keys are to be selected                    
                </param>
            </javadoc>
            <method name="select" type="void" line="146">
                <params>
                    <param name="items" type="Map"/>
                </params>
            </method>
            <javadoc line="149">
                Select the passed node if not already selected.                
                <param>
                    node node to be selected                    
                </param>
                <return>
                    true if node was not already selected                    
                </return>
            </javadoc>
            <method name="internalSelect" type="boolean" line="154">
                <params>
                    <param name="node" type="PNode"/>
                </params>
                <scope line="155"/>
            </method>
            <javadoc line="162">
                Dispatches a selection changed notification to the PNodificationCenter.                
            </javadoc>
            <method name="postSelectionChanged" type="void" line="165"/>
            <javadoc line="168">
                Selected the provided node if not already selected.                
                <param>
                    node node to be selected                    
                </param>
            </javadoc>
            <method name="select" type="void" line="172">
                <params>
                    <param name="node" type="PNode"/>
                </params>
                <scope line="173"/>
            </method>
            <javadoc line="177">
                Adds bound handles to the provided node.                
                <param>
                    node node to be decorated                    
                </param>
            </javadoc>
            <method name="decorateSelectedNode" type="void" line="181">
                <params>
                    <param name="node" type="PNode"/>
                </params>
            </method>
            <javadoc line="184">
                Removes all nodes provided from the selection.                
                <param>
                    items items to remove form the selection                    
                </param>
            </javadoc>
            <method name="unselect" type="void" line="188">
                <params>
                    <param name="items" type="Collection"/>
                </params>
                <declaration name="changes" type="boolean" line="189"/>
                <declaration name="itemIt" type="Iterator" line="190"/>
                <scope line="191">
                    <declaration name="node" type="PNode" line="192"/>
                </scope>
                <scope line="195"/>
            </method>
            <javadoc line="199">
                Removes provided selection node if not already selected.                
                <param>
                    node node to remove from selection                    
                </param>
                <return>
                    true on success                    
                </return>
            </javadoc>
            <method name="internalUnselect" type="boolean" line="204">
                <params>
                    <param name="node" type="PNode"/>
                </params>
                <scope line="205"/>
            </method>
            <javadoc line="212">
                Removes node from selection.                
                <param>
                    node node to be removed from selection                    
                </param>
            </javadoc>
            <method name="unselect" type="void" line="216">
                <params>
                    <param name="node" type="PNode"/>
                </params>
                <scope line="217"/>
            </method>
            <javadoc line="221">
                Removes bounds handles from node.                
                <param>
                    node to have handles removed from                    
                </param>
            </javadoc>
            <method name="undecorateSelectedNode" type="void" line="225">
                <params>
                    <param name="node" type="PNode"/>
                </params>
            </method>
            <javadoc line="228">
                Empties the selection.                
            </javadoc>
            <method name="unselectAll" type="void" line="231">
                <declaration name="sel" type="ArrayList" line="232"/>
            </method>
            <javadoc line="235">
                Returns true is provided node is selected.                
                <param>
                    node - node to be tested                    
                </param>
                <return>
                    true if succeeded                    
                </return>
            </javadoc>
            <method name="isSelected" type="boolean" line="240">
                <params>
                    <param name="node" type="PNode"/>
                </params>
            </method>
            <javadoc line="243">
                Returns a copy of the currently selected nodes.                
                <return>
                    copy of selection                    
                </return>
            </javadoc>
            <method name="getSelection" type="Collection" line="247"/>
            <javadoc line="250">
                Gets a reference to the currently selected nodes. You should not modify
                  or store this collection.                
                <return>
                    direct reference to selection                    
                </return>
            </javadoc>
            <method name="getSelectionReference" type="Collection" line="255"/>
            <javadoc line="258">
                Determine if the specified node can be selected (i.e., if it is a child
                  of the one the list of nodes that can be selected).                
                <param>
                    node node being tested                    
                </param>
                <return>
                    true if node can be selected                    
                </return>
            </javadoc>
            <method name="isSelectable" type="boolean" line="264">
                <params>
                    <param name="node" type="PNode"/>
                </params>
                <declaration name="selectable" type="boolean" line="265"/>
                <declaration name="parentsIt" type="Iterator" line="266"/>
                <scope line="267">
                    <declaration name="parent" type="PNode" line="268"/>
                    <scope line="269"/>
                    <scope line="273">
                        <scope line="274">
                            <declaration name="layer" type="PLayer" line="275"/>
                            <scope line="276"/>
                        </scope>
                    </scope>
                </scope>
            </method>
            <javadoc line="285">
                Flags the node provided as a selectable parent. This makes it possible to
                  select its children.                
                <param>
                    node to flag as selectable                    
                </param>
            </javadoc>
            <method name="addSelectableParent" type="void" line="290">
                <params>
                    <param name="node" type="PNode"/>
                </params>
            </method>
            <javadoc line="293">
                Removes the node provided from the set of selectable parents. This makes
                  its impossible to select its children.                
                <param>
                    node to remove from selectable parents                    
                </param>
            </javadoc>
            <method name="removeSelectableParent" type="void" line="298">
                <params>
                    <param name="node" type="PNode"/>
                </params>
            </method>
            <javadoc line="301">
                Sets the node provided as the only selectable parent.                
                <param>
                    node node to become the 1 and only selectable parent                    
                </param>
            </javadoc>
            <method name="setSelectableParent" type="void" line="305">
                <params>
                    <param name="node" type="PNode"/>
                </params>
            </method>
            <javadoc line="309">
                Sets the collection of selectable parents as the only parents that are
                  selectable.                
                <param>
                    c nodes to become selectable parents.                    
                </param>
            </javadoc>
            <method name="setSelectableParents" type="void" line="314">
                <params>
                    <param name="c" type="Collection"/>
                </params>
            </method>
            <javadoc line="318">
                Returns all selectable parents.                
                <return>
                    selectable parents                    
                </return>
            </javadoc>
            <method name="getSelectableParents" type="Collection" line="322"/>
            <javadoc line="325">
                Overrides method in PDragSequenceEventHandler so that, selections have
                  marquees.                
                <param>
                    e the event that started the drag                    
                </param>
            </javadoc>
            <method name="startDrag" type="void" line="330">
                <params>
                    <param name="e" type="PInputEvent"/>
                </params>
                <scope line="333">
                    <scope line="335"/>
                    <scope line="338"/>
                </scope>
                <scope line="342">
                    <scope line="343"/>
                    <scope line="346"/>
                </scope>
            </method>
            <javadoc line="351">
                Updates the marquee to the new bounds caused by the drag.                
                <param>
                    event drag event                    
                </param>
            </javadoc>
            <method name="drag" type="void" line="355">
                <params>
                    <param name="event" type="PInputEvent"/>
                </params>
                <scope line="357">
                    <scope line="359"/>
                    <scope line="362"/>
                </scope>
                <scope line="366"/>
            </method>
            <javadoc line="370">
                Ends the selection marquee when the drag is ended.                
                <param>
                    event the event responsible for ending the drag                    
                </param>
            </javadoc>
            <method name="endDrag" type="void" line="374">
                <params>
                    <param name="event" type="PInputEvent"/>
                </params>
                <scope line="376"/>
                <scope line="379"/>
            </method>
            <javadoc line="383">
                Used to test whether the event is one that changes the selection.                
                <param>
                    pie The event under test                    
                </param>
                <return>
                    true if event changes the selection                    
                </return>
            </javadoc>
            <method name="isOptionSelection" type="boolean" line="388">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="391">
                Tests the input event to see if it is selecting a new node.                
                <param>
                    pie event under test                    
                </param>
                <return>
                    true if there is no current selection                    
                </return>
            </javadoc>
            <method name="isMarqueeSelection" type="boolean" line="396">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="399">
                Starts a selection based on the provided event.                
                <param>
                    pie event used to populate the selection                    
                </param>
            </javadoc>
            <method name="initializeSelection" type="void" line="403">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
                <scope line="407"/>
            </method>
            <javadoc line="411">
                Creates an empty marquee child for use in displaying the marquee around
                  the selection.                
                <param>
                    event event responsible for the initialization                    
                </param>
            </javadoc>
            <method name="initializeMarquee" type="void" line="416">
                <params>
                    <param name="event" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="425">
                Invoked when the marquee is being used to extend the selection.                
                <param>
                    event event causing the option selection                    
                </param>
            </javadoc>
            <method name="startOptionMarqueeSelection" type="void" line="429">
                <params>
                    <param name="event" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="431">
                Invoked at the start of the selection. Removes any selections.                
                <param>
                    event event causing a new marquee selection                    
                </param>
            </javadoc>
            <method name="startMarqueeSelection" type="void" line="435">
                <params>
                    <param name="event" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="438">
                If the pressed node is not selected unselect all nodes and select the
                  pressed node if it allows it.                
                <param>
                    pie event that started the selection                    
                </param>
            </javadoc>
            <method name="startStandardSelection" type="void" line="443">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
                <scope line="444"/>
                <scope line="448"/>
            </method>
            <javadoc line="452">
                Toggle the current selection on the node that was just pressed, but leave
                  the rest of the selected nodes unchanged.                
                <param>
                    pie event responsible for the change in selection                    
                </param>
            </javadoc>
            <method name="startStandardOptionSelection" type="void" line="457">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
                <scope line="458">
                    <scope line="459"/>
                    <scope line="462"/>
                </scope>
            </method>
            <javadoc line="467">
                Updates the marquee rectangle as the result of a drag.                
                <param>
                    pie event responsible for the change in the marquee                    
                </param>
            </javadoc>
            <method name="updateMarquee" type="void" line="471">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
                <declaration name="b" type="PBounds" line="472"/>
                <scope line="473"/>
                <scope line="477"/>
                <declaration name="filter" type="PNodeFilter" line="487"/>
                <declaration name="parentsIt" type="Iterator" line="488"/>
                <scope line="489">
                    <declaration name="parent" type="PNode" line="490"/>
                    <declaration name="items" type="Collection" line="491"/>
                    <scope line="492">
                        <scope line="494"/>
                    </scope>
                    <scope line="498"/>
                    <declaration name="itemsIt" type="Iterator" line="501"/>
                    <scope line="502"/>
                </scope>
            </method>
            <javadoc line="507">
                Sets the selection to be all nodes under the marquee.                
                <param>
                    pie event responsible for the new selection                    
                </param>
            </javadoc>
            <method name="computeMarqueeSelection" type="void" line="511">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
                <declaration name="selectionEn" type="Iterator" line="513"/>
                <scope line="514">
                    <declaration name="node" type="PNode" line="515"/>
                    <scope line="516"/>
                </scope>
                <scope line="522">
                    <declaration name="node" type="PNode" line="523"/>
                    <scope line="524"/>
                    <scope line="527"/>
                </scope>
            </method>
            <javadoc line="533">
                Extends the selection to include all nodes under the marquee.                
                <param>
                    pie event responsible for the change in selection                    
                </param>
            </javadoc>
            <method name="computeOptionMarqueeSelection" type="void" line="537">
                <params>
                    <param name="pie" type="PInputEvent"/>
                </params>
                <declaration name="selectionEn" type="Iterator" line="539"/>
                <scope line="540">
                    <declaration name="node" type="PNode" line="541"/>
                    <scope line="542"/>
                </scope>
                <scope line="549">
                    <declaration name="node" type="PNode" line="550"/>
                    <scope line="551"/>
                    <scope line="554"/>
                </scope>
            </method>
            <javadoc line="560">
                Creates a node filter that will filter all nodes not touching the bounds
                  provided.                
                <param>
                    bounds will be used to filter matches                    
                </param>
                <return>
                    newly created filter                    
                </return>
            </javadoc>
            <method name="createNodeFilter" type="PNodeFilter" line="566">
                <params>
                    <param name="bounds" type="PBounds"/>
                </params>
            </method>
            <javadoc line="569">
                Returns the bounds of the current selection marquee.                
                <return>
                    bounds of current selection marquee                    
                </return>
            </javadoc>
            <method name="getMarqueeBounds" type="PBounds" line="573">
                <scope line="574"/>
            </method>
            <javadoc line="579">
                Drag selected nodes.                
                <param>
                    e event responsible for the drag                    
                </param>
            </javadoc>
            <method name="dragStandardSelection" type="void" line="583">
                <params>
                    <param name="e" type="PInputEvent"/>
                </params>
                <declaration name="d" type="PDimension" line="584"/>
                <declaration name="gDist" type="PDimension" line="586"/>
                <declaration name="selectionEn" type="Iterator" line="587"/>
                <scope line="588">
                    <declaration name="node" type="PNode" line="589"/>
                </scope>
            </method>
            <javadoc line="595">
                Removes marquee and clears selection.                
                <param>
                    e event responsible for the end of the selection                    
                </param>
            </javadoc>
            <method name="endMarqueeSelection" type="void" line="599">
                <params>
                    <param name="e" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="605">
                Ends the &quot;pressed&quot; state of the previously pressed node (if any).                
                <param>
                    e event responsible for the end in the selection                    
                </param>
            </javadoc>
            <method name="endStandardSelection" type="void" line="609">
                <params>
                    <param name="e" type="PInputEvent"/>
                </params>
            </method>
            <javadoc line="612">
                This gets called continuously during the drag, and is used to animate the
                  marquee.                
                <param>
                    aEvent event responsible for this step in the drag sequence                    
                </param>
            </javadoc>
            <method name="dragActivityStep" type="void" line="617">
                <params>
                    <param name="aEvent" type="PInputEvent"/>
                </params>
                <scope line="618">
                    <declaration name="origStrokeNum" type="float" line="619"/>
                    <scope line="621"/>
                </scope>
            </method>
            <javadoc line="626">
                Delete selection when delete key is pressed (if enabled).                
                <param>
                    e the key press event                    
                </param>
            </javadoc>
            <method name="keyPressed" type="void" line="630">
                <params>
                    <param name="e" type="PInputEvent"/>
                </params>
                <scope line="631">
                    <declaration name="selectionEn" type="Iterator" line="632"/>
                    <scope line="633">
                        <declaration name="node" type="PNode" line="634"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="640">
                Returns whether the delete key is a supported action.                
                <return>
                    true if delete is allowed                    
                </return>
            </javadoc>
            <method name="getSupportDeleteKey" type="boolean" line="644"/>
            <javadoc line="647">
                Returns whether the delete key is a supported action.                
                <return>
                    true if delete is allowed                    
                </return>
            </javadoc>
            <method name="isDeleteKeyActive" type="boolean" line="651"/>
            <javadoc line="654">
                Specifies if the DELETE key should delete the selection.                
                <param>
                    deleteKeyActive state to set for the delete action true = enabled                    
                </param>
            </javadoc>
            <method name="setDeleteKeyActive" type="void" line="658">
                <params>
                    <param name="deleteKeyActive" type="boolean"/>
                </params>
            </method>
            <class name="BoundsFilter" line="661">
                <implements interface="PNodeFilter"/>
                <javadoc line="661">
                    Class used to filter nodes that intersect with the marquee&apos;s bounds.                    
                </javadoc>
                <declaration name="localBounds" type="PBounds" line="665"/>
                <declaration name="bounds" type="PBounds" line="666"/>
                <javadoc line="667">
                    Constructs a BoundsFilter for the given bounds.                    
                    <param>
                        bounds bounds to be used when testing nodes for intersection                        
                    </param>
                </javadoc>
                <method name="BoundsFilter" type="constructor" line="671">
                    <params>
                        <param name="bounds" type="PBounds"/>
                    </params>
                </method>
                <javadoc line="674">
                    Returns true if the node is an acceptable selection.                    
                    <param>
                        node node being tested                        
                    </param>
                    <return>
                        true if node is an acceptable selection                        
                    </return>
                </javadoc>
                <method name="accept" type="boolean" line="679">
                    <params>
                        <param name="node" type="PNode"/>
                    </params>
                    <declaration name="boundsIntersects" type="boolean" line="682"/>
                    <declaration name="isMarquee" type="boolean" line="683"/>
                </method>
                <javadoc line="686">
                    Returns whether this filter should accept all children of a node.                    
                    <param>
                        node node being tested                        
                    </param>
                    <return>
                        true if selection should accept children children of the node                        
                    </return>
                </javadoc>
                <method name="acceptChildrenOf" type="boolean" line="691">
                    <params>
                        <param name="node" type="PNode"/>
                    </params>
                </method>
                <javadoc line="694">
                    Tests a node to see if it&apos;s a layer that has an attached camera.                    
                    <param>
                        node node being tested                        
                    </param>
                    <return>
                        true if node is a layer with a camera attached                        
                    </return>
                </javadoc>
                <method name="isCameraLayer" type="boolean" line="699">
                    <params>
                        <param name="node" type="PNode"/>
                    </params>
                    <scope line="700">
                        <scope line="701">
                            <declaration name="parent" type="PNode" line="702"/>
                            <scope line="703"/>
                        </scope>
                    </scope>
                </method>
            </class>
            <javadoc line="711">
                Indicates the color used to paint the marquee.                
                <return>
                    the paint for interior of the marquee                    
                </return>
            </javadoc>
            <method name="getMarqueePaint" type="Paint" line="715"/>
            <javadoc line="718">
                Sets the color used to paint the marquee.                
                <param>
                    paint the paint color                    
                </param>
            </javadoc>
            <method name="setMarqueePaint" type="void" line="722">
                <params>
                    <param name="paint" type="Paint"/>
                </params>
            </method>
            <javadoc line="725">
                Indicates the transparency level for the interior of the marquee.                
                <return>
                    Returns the marquee paint transparency, zero to one                    
                </return>
            </javadoc>
            <method name="getMarqueePaintTransparency" type="float" line="729"/>
            <javadoc line="732">
                Sets the transparency level for the interior of the marquee.                
                <param>
                    marqueePaintTransparency The marquee paint transparency to set.                    
                </param>
            </javadoc>
            <method name="setMarqueePaintTransparency" type="void" line="736">
                <params>
                    <param name="marqueePaintTransparency" type="float"/>
                </params>
            </method>
        </class>
    </source>