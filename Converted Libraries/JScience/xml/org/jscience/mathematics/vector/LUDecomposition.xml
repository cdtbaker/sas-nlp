<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.jscience.mathematics.vector">
        <import package="java.util.Comparator"/>
        <import package="org.jscience.mathematics.structure.Field"/>
        <import package="org.jscience.mathematics.number.Number"/>
        <import package="javolution.context.LocalContext"/>
        <import package="javolution.context.ObjectFactory"/>
        <import package="javolution.util.FastTable"/>
        <import package="javolution.util.Index"/>
        <class name="LUDecomposition" line="21">
            <type_params>
                <type_param name="F"/>
            </type_params>
            <comment line="391">
                /////////////////////                
            </comment>
            <comment line="392">
                Factory creation. //                
            </comment>
            <comment line="393">
                /////////////////////                
            </comment>
            <javadoc line="21">
                &lt;p&gt; This class represents the decomposition of a {@link Matrix matrix} 
                  &lt;code&gt;A&lt;/code&gt; into a product of a {@link #getLower lower} 
                  and {@link #getUpper upper} triangular matrices, &lt;code&gt;L&lt;/code&gt;
                  and &lt;code&gt;U&lt;/code&gt; respectively, such as &lt;code&gt;A = P·L·U&lt;code&gt; with 
                  &lt;code&gt;P&lt;code&gt; a {@link #getPermutation permutation} matrix.&lt;/p&gt;
                  &lt;p&gt; This decomposition&lt;/a&gt; is typically used to resolve linear systems
                  of equations (Gaussian elimination) or to calculate the determinant
                  of a square {@link Matrix} (&lt;code&gt;O(m³)&lt;/code&gt;).&lt;/p&gt;
                  &lt;p&gt; Numerical stability is guaranteed through pivoting if the{@link Field} elements are {@link Number numbers}For others elements types, numerical stability can be ensured by setting
                  the {@link javolution.context.LocalContext context-local} pivot 
                  comparator (see {@link #setPivotComparator}).&lt;/p&gt;
                  &lt;p&gt; Pivoting can be disabled by setting the {@link #setPivotComparator 
                  pivot comparator} to &lt;code&gt;null&lt;/code&gt; ({@link #getPermutation P} 
                  is then the matrix identity).&lt;/p&gt;                
                <author>
                    <a href="mailto:jean-marie@dautelle.com">Jean-Marie Dautelle</a>                    
                </author>
                <version>
                    3.3, January 2, 2007                    
                </version>
                <see>
                    <a href="http://en.wikipedia.org/wiki/LU_decomposition">
                           Wikipedia: LU decomposition</a>                    
                </see>
            </javadoc>
            <declaration name="NUMERIC_COMPARATOR" type="Comparator&lt;Field&gt;" line="49"/>
            <javadoc line="49">
                Holds the default comparator for pivoting.                
            </javadoc>
            <anonymous_class line="52">
                <method name="compare" type="int" line="55">
                    <params>
                        <param name="left" type="Field"/>
                        <param name="right" type="Field"/>
                    </params>
                    <comment line="58">
                        Zero                        
                    </comment>
                    <comment line="60">
                        Zero                        
                    </comment>
                </method>
            </anonymous_class>
            <declaration name="PIVOT_COMPARATOR" type="LocalContext.Reference&lt;Comparator&lt;Field&gt;&gt;" line="66"/>
            <javadoc line="66">
                Holds the local comparator.                
            </javadoc>
            <declaration name="_n" type="int" line="72"/>
            <javadoc line="72">
                Holds the dimension of the square matrix source.                
            </javadoc>
            <declaration name="_pivots" type="FastTable&lt;Index&gt;" line="77"/>
            <javadoc line="77">
                Holds the pivots indexes.                
            </javadoc>
            <declaration name="_LU" type="DenseMatrix&lt;F&gt;" line="82"/>
            <javadoc line="82">
                Holds the LU elements.                
            </javadoc>
            <declaration name="_permutationCount" type="int" line="87"/>
            <javadoc line="87">
                Holds the number of permutation performed.                
            </javadoc>
            <javadoc line="92">
                Returns the lower/upper decomposition of the specified matrix.                
                <param>
                    source the matrix for which the decomposition is calculated.                    
                </param>
                <return>
                    the lower/upper decomposition of the specified matrix.                    
                </return>
                <throws>
                    DimensionException if the specified matrix is not square.                    
                </throws>
            </javadoc>
            <method name="valueOf" type="LUDecomposition<F>" line="101">
                <params>
                    <param name="source" type="Matrix<F>"/>
                </params>
                <declaration name="dimension" type="int" line="104"/>
                <declaration name="lu" type="LUDecomposition" line="105"/>
            </method>
            <javadoc line="112">
                Constructs the LU decomposition of the specified matrix.
                  We make the choise of Lii = ONE (diagonal elements of the
                  lower triangular matrix are multiplicative identities).                
                <param>
                    source the matrix to decompose.                    
                </param>
                <throws>
                    MatrixException if the matrix source is not square.                    
                </throws>
            </javadoc>
            <method name="construct" type="void" line="120">
                <params>
                    <param name="source" type="Matrix<F>"/>
                </params>
                <comment line="128">
                    Main loop.                    
                </comment>
                <comment line="133">
                    Pivoting enabled.                    
                </comment>
                <comment line="134">
                    Rearranges the rows so that the absolutely largest                    
                </comment>
                <comment line="135">
                    elements of the matrix source in each column lies                    
                </comment>
                <comment line="136">
                    in the diagonal.                    
                </comment>
                <comment line="143">
                    Exchanges.                    
                </comment>
                <comment line="156">
                    Computes multipliers and eliminate k-th column.                    
                </comment>
                <comment line="159">
                    Multiplicative order is important                    
                </comment>
                <comment line="160">
                    for non-commutative elements.                    
                </comment>
                <scope line="124"/>
                <declaration name="cmp" type="Comparator&lt;Field&gt;" line="129"/>
                <declaration name="n" type="int" line="130"/>
                <scope line="131">
                    <scope line="133">
                        <declaration name="pivot" type="int" line="137"/>
                        <scope line="138">
                            <scope line="139"/>
                        </scope>
                        <scope line="143">
                            <scope line="144">
                                <declaration name="tmp" type="F" line="145"/>
                            </scope>
                            <declaration name="j" type="int" line="149"/>
                        </scope>
                    </scope>
                    <declaration name="lukkInv" type="F" line="157"/>
                    <scope line="158">
                        <scope line="162"/>
                    </scope>
                </scope>
            </method>
            <javadoc line="170">
                Sets the {@link javolution.context.LocalContext local} comparator used 
                  for pivoting or &lt;code&gt;null&lt;/code&gt; to disable pivoting.                
                <param>
                    cmp the comparator for pivoting or <code>null</code>.                    
                </param>
            </javadoc>
            <method name="setPivotComparator" type="void" line="176">
                <params>
                    <param name="cmp" type="Comparator<Field>"/>
                </params>
            </method>
            <javadoc line="180">
                Returns the {@link javolution.context.LocalContext local} 
                  comparator used for pivoting or &lt;code&gt;null&lt;/code&gt; if pivoting 
                  is not performed (default {@link #NUMERIC_COMPARATOR}).                
                <return>
                    the comparator for pivoting or <code>null</code>.                    
                </return>
            </javadoc>
            <method name="getPivotComparator" type="Comparator<Field>" line="187"/>
            <javadoc line="191">
                Returns the solution X of the equation: A  X = B  with
                  &lt;code&gt;this = A.lu()&lt;/code&gt; using back and forward substitutions.                
                <param>
                    B the input matrix.                    
                </param>
                <return>
                    the solution X = (1 / A)  B.                    
                </return>
                <throws>
                    DimensionException if the dimensions do not match.                    
                </throws>
            </javadoc>
            <method name="solve" type="DenseMatrix<F>" line="199">
                <params>
                    <param name="B" type="Matrix<F>"/>
                </params>
                <comment line="204">
                    Copies B with pivoting.                    
                </comment>
                <comment line="213">
                    Solves L * Y = pivot(B)                    
                </comment>
                <comment line="224">
                    Solves U * X = Y;                    
                </comment>
                <declaration name="n" type="int" line="205"/>
                <declaration name="X" type="DenseMatrix&lt;F&gt;" line="206"/>
                <scope line="207">
                    <scope line="208"/>
                </scope>
                <scope line="214">
                    <scope line="215">
                        <declaration name="luik" type="F" line="216"/>
                        <scope line="217"/>
                    </scope>
                </scope>
                <scope line="225">
                    <scope line="226"/>
                    <scope line="229">
                        <declaration name="luik" type="F" line="230"/>
                        <scope line="231"/>
                    </scope>
                </scope>
            </method>
            <method name="createNullDenseMatrix" type="DenseMatrix<F>" line="240">
                <params>
                    <param name="m" type="int"/>
                    <param name="n" type="int"/>
                </params>
                <declaration name="M" type="DenseMatrix&lt;F&gt;" line="241"/>
                <scope line="242">
                    <declaration name="V" type="DenseVector&lt;F&gt;" line="243"/>
                    <scope line="245"/>
                </scope>
            </method>
            <javadoc line="252">
                Returns the solution X of the equation: A  X = Identity  with
                  &lt;code&gt;this = A.lu()&lt;/code&gt; using back and forward substitutions.                
                <return>
                    <code>this.solve(Identity)</code>                    
                </return>
            </javadoc>
            <method name="inverse" type="DenseMatrix<F>" line="258">
                <comment line="259">
                    Calculates inv(U).                    
                </comment>
                <comment line="277">
                    Solves inv(A) * L = inv(U)                    
                </comment>
                <comment line="291">
                    Swaps columns (reverses pivots permutations).                    
                </comment>
                <declaration name="n" type="int" line="260"/>
                <declaration name="R" type="DenseMatrix&lt;F&gt;" line="261"/>
                <scope line="262">
                    <scope line="263"/>
                </scope>
                <scope line="267">
                    <scope line="269">
                        <declaration name="sum" type="F" line="270"/>
                        <scope line="271"/>
                    </scope>
                </scope>
                <scope line="278">
                    <scope line="279">
                        <scope line="280">
                            <declaration name="lukj" type="F" line="281"/>
                            <scope line="282"/>
                            <scope line="285"/>
                        </scope>
                    </scope>
                </scope>
                <declaration name="tmp" type="FastTable&lt;F&gt;" line="292"/>
                <scope line="293">
                    <scope line="295"/>
                    <scope line="298"/>
                </scope>
            </method>
            <javadoc line="306">
                Returns the determinant of the {@link Matrix} having this
                  decomposition.                
                <return>
                    the determinant of the matrix source.                    
                </return>
            </javadoc>
            <method name="determinant" type="F" line="312">
                <declaration name="product" type="F" line="313"/>
                <scope line="314"/>
            </method>
            <javadoc line="320">
                Returns the lower matrix decomposition (&lt;code&gt;L&lt;/code&gt;) with diagonal
                  elements equal to the multiplicative identity for F.                
                <param>
                    zero the additive identity for F.                    
                </param>
                <param>
                    one the multiplicative identity for F.                    
                </param>
                <return>
                    the lower matrix.                    
                </return>
            </javadoc>
            <method name="getLower" type="DenseMatrix<F>" line="328">
                <params>
                    <param name="zero" type="F"/>
                    <param name="one" type="F"/>
                </params>
                <declaration name="L" type="DenseMatrix&lt;F&gt;" line="329"/>
                <scope line="330">
                    <scope line="331"/>
                </scope>
            </method>
            <javadoc line="339">
                Returns the upper matrix decomposition (&lt;code&gt;U&lt;/code&gt;).                
                <param>
                    zero the additive identity for F.                    
                </param>
                <return>
                    the upper matrix.                    
                </return>
            </javadoc>
            <method name="getUpper" type="DenseMatrix<F>" line="345">
                <params>
                    <param name="zero" type="F"/>
                </params>
                <declaration name="U" type="DenseMatrix&lt;F&gt;" line="346"/>
                <scope line="347">
                    <scope line="348"/>
                </scope>
            </method>
            <javadoc line="355">
                Returns the permutation matrix (&lt;code&gt;P&lt;/code&gt;).                
                <param>
                    zero the additive identity for F.                    
                </param>
                <param>
                    one the multiplicative identity for F.                    
                </param>
                <return>
                    the permutation matrix.                    
                </return>
            </javadoc>
            <method name="getPermutation" type="SparseMatrix<F>" line="362">
                <params>
                    <param name="zero" type="F"/>
                    <param name="one" type="F"/>
                </params>
                <declaration name="P" type="SparseMatrix&lt;F&gt;" line="363"/>
                <scope line="364"/>
            </method>
            <javadoc line="371">
                Returns the lower/upper decomposition in one single matrix.                
                <return>
                    the lower/upper matrix merged in a single matrix.                    
                </return>
            </javadoc>
            <method name="getLU" type="DenseMatrix<F>" line="376"/>
            <javadoc line="380">
                Returns the pivots elements of this decomposition.                
                <return>
                    the row indices after permutation.                    
                </return>
            </javadoc>
            <method name="getPivots" type="FastTable<Index>" line="385"/>
            <declaration name="FACTORY" type="ObjectFactory&lt;LUDecomposition&gt;" line="394"/>
            <anonymous_class line="394">
                <method name="create" type="LUDecomposition" line="395"/>
                <method name="cleanup" type="void" line="400">
                    <params>
                        <param name="lu" type="LUDecomposition"/>
                    </params>
                </method>
            </anonymous_class>
            <method name="LUDecomposition" type="constructor" line="405"/>
        </class>
    </source>