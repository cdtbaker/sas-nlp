<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.distribution">
  <import name="org.apache.commons.math3.special.Gamma" />
  <import name="org.apache.commons.math3.util.FastMath" />
  <import name="org.apache.commons.math3.util.MathUtils" />
  <class name="SaddlePointExpansion" startLine="23">
    <javadoc>
      <text>* <p>
 * Utility class used by various distributions to accurately compute their
 * respective probability mass functions. The implementation for this class is
 * based on the Catherine Loader's <a target="_blank"
 * href="http://www.herine.net/stat/software/dbinom.html">dbinom</a> routines.
 * </p>
 * <p>
 * This class is not intended to be called directly.
 * </p>
 * <p>
 * References:
 * <ol>
 * <li>Catherine Loader (2000). "Fast and Accurate Computation of Binomial
 * Probabilities.". <a target="_blank"
 * href="http://www.herine.net/stat/papers/dbinom.pdf">
 * http://www.herine.net/stat/papers/dbinom.pdf</a></li>
 * </ol>
 * </p></text>
      <since>2.1</since>
      <version>$Id: SaddlePointExpansion.java 1416643 2012-12-03 19:37:14Z tn $</version>
    </javadoc>
    <javadoc>
      <text>* 1/2 * log(2 &#960;).</text>
    </javadoc>
    <declaration type="double" name="HALF_LOG_2_PI" />
    <javadoc>
      <text>* exact Stirling expansion error for certain values.</text>
    </javadoc>
    <declaration type="double[]" name="EXACT_STIRLING_ERRORS" />
    <javadoc>
      <text>* Default constructor.</text>
    </javadoc>
    <method type="constructor" name="SaddlePointExpansion" startLine="88" endLine="90" />
    <javadoc>
      <text>* Compute the error of Stirling's series at the given value.
 * <p>
 * References:
 * <ol>
 * <li>Eric W. Weisstein. "Stirling's Series." From MathWorld--A Wolfram Web
 * Resource. <a target="_blank"
 * href="http://mathworld.wolfram.com/StirlingsSeries.html">
 * http://mathworld.wolfram.com/StirlingsSeries.html</a></li>
 * </ol>
 * </p></text>
      <param>z the value.</param>
      <return>the Striling's series error.</return>
    </javadoc>
    <method type="double" name="getStirlingError" startLine="107" endLine="127">
      <declaration type="double" name="ret" />
      <scope startLine="109" endLine="117">
        <declaration type="double" name="z2" />
        <scope startLine="111" endLine="113" />
        <scope startLine="113" endLine="116" />
      </scope>
      <scope startLine="117" endLine="125">
        <declaration type="double" name="z2" />
      </scope>
    </method>
    <javadoc>
      <text>* A part of the deviance portion of the saddle point approximation.
 * <p>
 * References:
 * <ol>
 * <li>Catherine Loader (2000). "Fast and Accurate Computation of Binomial
 * Probabilities.". <a target="_blank"
 * href="http://www.herine.net/stat/papers/dbinom.pdf">
 * http://www.herine.net/stat/papers/dbinom.pdf</a></li>
 * </ol>
 * </p></text>
      <param>x the x value.</param>
      <param>mu the average.</param>
      <return>a part of the deviance.</return>
    </javadoc>
    <method type="double" name="getDeviancePart" startLine="145" endLine="166">
      <declaration type="double" name="ret" />
      <scope startLine="147" endLine="162">
        <declaration type="double" name="d" />
        <declaration type="double" name="v" />
        <declaration type="double" name="s1" />
        <declaration type="double" name="s" />
        <declaration type="double" name="ej" />
        <declaration type="int" name="j" />
        <scope startLine="155" endLine="160" />
      </scope>
      <scope startLine="162" endLine="164" />
    </method>
    <javadoc>
      <text>* Compute the logarithm of the PMF for a binomial distribution
 * using the saddle point expansion.</text>
      <param>x the value at which the probability is evaluated.</param>
      <param>n the number of trials.</param>
      <param>p the probability of success.</param>
      <param>q the probability of failure (1 - p).</param>
      <return>log(p(x)).</return>
    </javadoc>
    <method type="double" name="logBinomialProbability" startLine="178" endLine="200">
      <declaration type="double" name="ret" />
      <scope startLine="180" endLine="186">
        <scope startLine="181" endLine="183" />
        <scope startLine="183" endLine="185" />
      </scope>
      <scope startLine="186" endLine="192">
        <scope startLine="187" endLine="189" />
        <scope startLine="189" endLine="191" />
      </scope>
      <scope startLine="192" endLine="198">
        <declaration type="double" name="f" />
      </scope>
    </method>
    <comment>private static final double[] EXACT_STIRLING_ERRORS = { 0.0,  0.0</comment>
    <comment>0.1534264097200273452913848,  0.5</comment>
    <comment>0.0810614667953272582196702,  1.0</comment>
    <comment>0.0548141210519176538961390,  1.5</comment>
    <comment>0.0413406959554092940938221,  2.0</comment>
    <comment>0.03316287351993628748511048,  2.5</comment>
    <comment>0.02767792568499833914878929,  3.0</comment>
    <comment>0.02374616365629749597132920,  3.5</comment>
    <comment>0.02079067210376509311152277,  4.0</comment>
    <comment>0.01848845053267318523077934,  4.5</comment>
    <comment>0.01664469118982119216319487,  5.0</comment>
    <comment>0.01513497322191737887351255,  5.5</comment>
    <comment>0.01387612882307074799874573,  6.0</comment>
    <comment>0.01281046524292022692424986,  6.5</comment>
    <comment>0.01189670994589177009505572,  7.0</comment>
    <comment>0.01110455975820691732662991,  7.5</comment>
    <comment>0.010411265261972096497478567,  8.0</comment>
    <comment>0.009799416126158803298389475,  8.5</comment>
    <comment>0.009255462182712732917728637,  9.0</comment>
    <comment>0.008768700134139385462952823,  9.5</comment>
    <comment>0.008330563433362871256469318,  10.0</comment>
    <comment>0.007934114564314020547248100,  10.5</comment>
    <comment>0.007573675487951840794972024,  11.0</comment>
    <comment>0.007244554301320383179543912,  11.5</comment>
    <comment>0.006942840107209529865664152,  12.0</comment>
    <comment>0.006665247032707682442354394,  12.5</comment>
    <comment>0.006408994188004207068439631,  13.0</comment>
    <comment>0.006171712263039457647532867,  13.5</comment>
    <comment>0.005951370112758847735624416,  14.0</comment>
    <comment>0.005746216513010115682023589,  14.5</comment>
    <comment>0.005554733551962801371038690  15.0</comment>
  </class>
</source>
