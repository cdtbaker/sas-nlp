<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.linear">
  <import name="org.apache.commons.math3.Field" />
  <import name="org.apache.commons.math3.FieldElement" />
  <import name="org.apache.commons.math3.exception.DimensionMismatchException" />
  <import name="org.apache.commons.math3.util.MathArrays" />
  <class name="FieldLUDecomposition" startLine="25">
    <javadoc>
      <text>* Calculates the LUP-decomposition of a square matrix.
 * <p>The LUP-decomposition of a matrix A consists of three matrices
 * L, U and P that satisfy: PA = LU, L is lower triangular, and U is
 * upper triangular and P is a permutation matrix. All matrices are
 * m&times;m.</p>
 * <p>Since {@link FieldElement field elements} do not provide an ordering
 * operator, the permutation matrix is computed here only in order to avoid
 * a zero pivot element, no attempt is done to get the largest pivot
 * element.</p>
 * <p>This class is based on the class with similar name from the
 * <a href="http://math.nist.gov/javanumerics/jama/">JAMA</a> library.</p>
 * <ul>
 * <li>a {@link #getP() getP} method has been added,</li>
 * <li>the {@code det} method has been renamed as {@link #getDeterminant()getDeterminant},</li>
 * <li>the {@code getDoublePivot} method has been removed (but the int based{@link #getPivot() getPivot} method has been kept),</li>
 * <li>the {@code solve} and {@code isNonSingular} methods have been replaced
 * by a {@link #getSolver() getSolver} method and the equivalent methods
 * provided by the returned {@link DecompositionSolver}.</li>
 * </ul></text>
      <param><T>
 *  the type of the field elements</param>
      <see><a href="http://mathworld.wolfram.com/LUDecomposition.html">MathWorld</a></see>
      <see><a href="http://en.wikipedia.org/wiki/LU_decomposition">Wikipedia</a></see>
      <version>$Id: FieldLUDecomposition.java 1449528 2013-02-24 19:06:20Z luc $</version>
      <since>2.0 (changed to concrete class in 3.0)</since>
    </javadoc>
    <javadoc>
      <text>* Field to which the elements belong.</text>
    </javadoc>
    <declaration type="Field<T>" name="field" />
    <javadoc>
      <text>* Entries of LU decomposition.</text>
    </javadoc>
    <declaration type="T[][]" name="lu" />
    <javadoc>
      <text>* Pivot permutation associated with LU decomposition.</text>
    </javadoc>
    <declaration type="int[]" name="pivot" />
    <javadoc>
      <text>* Parity of the permutation associated with the LU decomposition.</text>
    </javadoc>
    <declaration type="boolean" name="even" />
    <javadoc>
      <text>* Singularity indicator.</text>
    </javadoc>
    <declaration type="boolean" name="singular" />
    <javadoc>
      <text>* Cached value of L.</text>
    </javadoc>
    <declaration type="FieldMatrix<T>" name="cachedL" />
    <javadoc>
      <text>* Cached value of U.</text>
    </javadoc>
    <declaration type="FieldMatrix<T>" name="cachedU" />
    <javadoc>
      <text>* Cached value of P.</text>
    </javadoc>
    <declaration type="FieldMatrix<T>" name="cachedP" />
    <javadoc>
      <text>* Calculates the LU-decomposition of the given matrix.</text>
      <param>matrix The matrix to decompose.</param>
      <throws>NonSquareMatrixException if matrix is not square</throws>
    </javadoc>
    <method type="constructor" name="FieldLUDecomposition" startLine="85" endLine="165">
      <scope startLine="86" endLine="89" />
      <declaration type="int" name="m" />
      <scope startLine="100" endLine="102" />
      <scope startLine="107" endLine="163">
        <declaration type="T" name="sum" />
        <scope startLine="112" endLine="119">
          <declaration type="T[]" name="luRow" />
          <scope startLine="115" endLine="117" />
        </scope>
        <declaration type="int" name="nonZero" />
        <scope startLine="123" endLine="135">
          <declaration type="T[]" name="luRow" />
          <scope startLine="126" endLine="128" />
          <scope startLine="131" endLine="134" />
        </scope>
        <scope startLine="138" endLine="141" />
        <scope startLine="144" endLine="155">
          <declaration type="T" name="tmp" />
          <scope startLine="146" endLine="150" />
          <declaration type="int" name="temp" />
        </scope>
        <declaration type="T" name="luDiag" />
        <scope startLine="159" endLine="162">
          <declaration type="T[]" name="luRow" />
        </scope>
        <comment>upper</comment>
        <comment>lower</comment>
        <comment>permutation row</comment>
        <comment>try to select a better permutation choice</comment>
        <comment>Singularity check</comment>
        <comment>Pivot if necessary</comment>
        <comment>Divide the lower elements by the "winning" diagonal elt.</comment>
      </scope>
      <comment>Initialize permutation array and parity</comment>
      <comment>Loop over columns</comment>
    </method>
    <javadoc>
      <text>* Returns the matrix L of the decomposition.
 * <p>L is a lower-triangular matrix</p></text>
      <return>the L matrix (or null if decomposed matrix is singular)</return>
    </javadoc>
    <method type="FieldMatrix<T>" name="getL" startLine="172" endLine="185">
      <scope startLine="173" endLine="183">
        <declaration type="int" name="m" />
        <scope startLine="176" endLine="182">
          <declaration type="T[]" name="luI" />
          <scope startLine="178" endLine="180" />
        </scope>
      </scope>
    </method>
    <javadoc>
      <text>* Returns the matrix U of the decomposition.
 * <p>U is an upper-triangular matrix</p></text>
      <return>the U matrix (or null if decomposed matrix is singular)</return>
    </javadoc>
    <method type="FieldMatrix<T>" name="getU" startLine="192" endLine="204">
      <scope startLine="193" endLine="202">
        <declaration type="int" name="m" />
        <scope startLine="196" endLine="201">
          <declaration type="T[]" name="luI" />
          <scope startLine="198" endLine="200" />
        </scope>
      </scope>
    </method>
    <javadoc>
      <text>* Returns the P rows permutation matrix.
 * <p>P is a sparse matrix with exactly one element set to 1.0 in
 * each row and each column, all other elements being set to 0.0.</p>
 * <p>The positions of the 1 elements are given by the {@link #getPivot()pivot permutation vector}.</p></text>
      <return>the P rows permutation matrix (or null if decomposed matrix is singular)</return>
      <see>#getPivot()</see>
    </javadoc>
    <method type="FieldMatrix<T>" name="getP" startLine="215" endLine="224">
      <scope startLine="216" endLine="222">
        <declaration type="int" name="m" />
        <scope startLine="219" endLine="221" />
      </scope>
    </method>
    <javadoc>
      <text>* Returns the pivot permutation vector.</text>
      <return>the pivot permutation vector</return>
      <see>#getP()</see>
    </javadoc>
    <method type="int[]" name="getPivot" startLine="231" endLine="233" />
    <javadoc>
      <text>* Return the determinant of the matrix.</text>
      <return>determinant of the matrix</return>
    </javadoc>
    <method type="T" name="getDeterminant" startLine="239" endLine="250">
      <scope startLine="240" endLine="242" />
      <scope startLine="242" endLine="249">
        <declaration type="int" name="m" />
        <declaration type="T" name="determinant" />
        <scope startLine="245" endLine="247" />
      </scope>
    </method>
    <javadoc>
      <text>* Get a solver for finding the A &times; X = B solution in exact linear sense.</text>
      <return>a solver</return>
    </javadoc>
    <method type="FieldDecompositionSolver<T>" name="getSolver" startLine="256" endLine="258" />
    <class name="Solver" startLine="260">
      <implements name="FieldDecompositionSolver<T>" />
      <javadoc>
        <text>* Specialized solver.</text>
      </javadoc>
      <javadoc>
        <text>* Field to which the elements belong.</text>
      </javadoc>
      <declaration type="Field<T>" name="field" />
      <javadoc>
        <text>* Entries of LU decomposition.</text>
      </javadoc>
      <declaration type="T[][]" name="lu" />
      <javadoc>
        <text>* Pivot permutation associated with LU decomposition.</text>
      </javadoc>
      <declaration type="int[]" name="pivot" />
      <javadoc>
        <text>* Singularity indicator.</text>
      </javadoc>
      <declaration type="boolean" name="singular" />
      <javadoc>
        <text>* Build a solver from decomposed matrix.</text>
        <param>field field to which the matrix elements belong</param>
        <param>lu entries of LU decomposition</param>
        <param>pivot pivot permutation associated with LU decomposition</param>
        <param>singular singularity indicator</param>
      </javadoc>
      <method type="constructor" name="Solver" startLine="283" endLine="288" />
      <javadoc>
        <text>* {@inheritDoc}</text>
      </javadoc>
      <method type="boolean" name="isNonSingular" startLine="291" endLine="293" />
      <javadoc>
        <text>* {@inheritDoc}</text>
      </javadoc>
      <method type="FieldVector<T>" name="solve" startLine="296" endLine="335">
        <scope startLine="297" endLine="299" />
        <scope startLine="299" endLine="334">
          <declaration type="int" name="m" />
          <scope startLine="302" endLine="304" />
          <scope startLine="305" endLine="307" />
          <declaration type="T[]" name="bp" />
          <scope startLine="311" endLine="313" />
          <scope startLine="316" endLine="321">
            <declaration type="T" name="bpCol" />
            <scope startLine="318" endLine="320" />
          </scope>
          <scope startLine="324" endLine="330">
            <declaration type="T" name="bpCol" />
            <scope startLine="327" endLine="329" />
          </scope>
          <comment>Apply permutations to b</comment>
          <comment>Solve LY = b</comment>
          <comment>Solve UX = Y</comment>
        </scope>
      </method>
      <javadoc>
        <text>* Solve the linear equation A &times; X = B.
 * <p>The A matrix is implicit here. It is </p></text>
        <param>b right-hand side of the equation A &times; X = B</param>
        <return>a vector X such that A &times; X = B</return>
        <throws>DimensionMismatchException if the matrices dimensions do not match.</throws>
        <throws>SingularMatrixException if the decomposed matrix is singular.</throws>
      </javadoc>
      <method type="ArrayFieldVector<T>" name="solve" startLine="344" endLine="378">
        <declaration type="int" name="m" />
        <declaration type="int" name="length" />
        <scope startLine="347" endLine="349" />
        <scope startLine="350" endLine="352" />
        <declaration type="T[]" name="bp" />
        <scope startLine="356" endLine="358" />
        <scope startLine="361" endLine="366">
          <declaration type="T" name="bpCol" />
          <scope startLine="363" endLine="365" />
        </scope>
        <scope startLine="369" endLine="375">
          <declaration type="T" name="bpCol" />
          <scope startLine="372" endLine="374" />
        </scope>
        <comment>Apply permutations to b</comment>
        <comment>Solve LY = b</comment>
        <comment>Solve UX = Y</comment>
      </method>
      <javadoc>
        <text>* {@inheritDoc}</text>
      </javadoc>
      <method type="FieldMatrix<T>" name="solve" startLine="381" endLine="432">
        <declaration type="int" name="m" />
        <scope startLine="383" endLine="385" />
        <scope startLine="386" endLine="388" />
        <declaration type="int" name="nColB" />
        <declaration type="T[][]" name="bp" />
        <scope startLine="394" endLine="400">
          <declaration type="T[]" name="bpRow" />
          <declaration type="int" name="pRow" />
          <scope startLine="397" endLine="399" />
        </scope>
        <scope startLine="403" endLine="412">
          <declaration type="T[]" name="bpCol" />
          <scope startLine="405" endLine="411">
            <declaration type="T[]" name="bpI" />
            <declaration type="T" name="luICol" />
            <scope startLine="408" endLine="410" />
          </scope>
        </scope>
        <scope startLine="415" endLine="428">
          <declaration type="T[]" name="bpCol" />
          <declaration type="T" name="luDiag" />
          <scope startLine="418" endLine="420" />
          <scope startLine="421" endLine="427">
            <declaration type="T[]" name="bpI" />
            <declaration type="T" name="luICol" />
            <scope startLine="424" endLine="426" />
          </scope>
        </scope>
        <comment>Apply permutations to b</comment>
        <comment>Solve LY = b</comment>
        <comment>Solve UX = Y</comment>
      </method>
      <javadoc>
        <text>* {@inheritDoc}</text>
      </javadoc>
      <method type="FieldMatrix<T>" name="getInverse" startLine="435" endLine="443">
        <declaration type="int" name="m" />
        <declaration type="T" name="one" />
        <declaration type="FieldMatrix<T>" name="identity" />
        <scope startLine="439" endLine="441" />
      </method>
    </class>
  </class>
</source>
