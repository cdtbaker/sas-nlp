<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.ode.nonstiff">
  <import name="org.apache.commons.math3.exception.DimensionMismatchException" />
  <import name="org.apache.commons.math3.exception.MaxCountExceededException" />
  <import name="org.apache.commons.math3.exception.NoBracketingException" />
  <import name="org.apache.commons.math3.exception.NumberIsTooSmallException" />
  <import name="org.apache.commons.math3.ode.AbstractIntegrator" />
  <import name="org.apache.commons.math3.ode.ExpandableStatefulODE" />
  <import name="org.apache.commons.math3.util.FastMath" />
  <class name="RungeKuttaIntegrator" extends="AbstractIntegrator" startLine="29">
    <javadoc>
      <text>* This class implements the common part of all fixed step Runge-Kutta
 * integrators for Ordinary Differential Equations.
 * <p>These methods are explicit Runge-Kutta methods, their Butcher
 * arrays are as follows :
 * <pre>
 * 0  |
 * c2  | a21
 * c3  | a31  a32
 * ... |        ...
 * cs  | as1  as2  ...  ass-1
 * |--------------------------
 * |  b1   b2  ...   bs-1  bs
 * </pre>
 * </p></text>
      <see>EulerIntegrator</see>
      <see>ClassicalRungeKuttaIntegrator</see>
      <see>GillIntegrator</see>
      <see>MidpointIntegrator</see>
      <version>$Id: RungeKuttaIntegrator.java 1416643 2012-12-03 19:37:14Z tn $</version>
      <since>1.2</since>
    </javadoc>
    <javadoc>
      <text>* Time steps from Butcher array (without the first zero).</text>
    </javadoc>
    <declaration type="double[]" name="c" />
    <javadoc>
      <text>* Internal weights from Butcher array (without the first empty row).</text>
    </javadoc>
    <declaration type="double[][]" name="a" />
    <javadoc>
      <text>* External weights for the high order method from Butcher array.</text>
    </javadoc>
    <declaration type="double[]" name="b" />
    <javadoc>
      <text>* Prototype of the step interpolator.</text>
    </javadoc>
    <declaration type="RungeKuttaStepInterpolator" name="prototype" />
    <javadoc>
      <text>* Integration step.</text>
    </javadoc>
    <declaration type="double" name="step" />
    <javadoc>
      <text>* Simple constructor.
 * Build a Runge-Kutta integrator with the given
 * step. The default step handler does nothing.</text>
      <param>name name of the method</param>
      <param>c time steps from Butcher array (without the first zero)</param>
      <param>a internal weights from Butcher array (without the first empty row)</param>
      <param>b propagation weights for the high order method from Butcher array</param>
      <param>prototype prototype of the step interpolator to use</param>
      <param>step integration step</param>
    </javadoc>
    <method type="constructor" name="RungeKuttaIntegrator" startLine="84" endLine="91" />
    <javadoc>
      <text>* {@inheritDoc}</text>
    </javadoc>
    <method type="void" name="integrate" startLine="97" endLine="186">
      <declaration type="boolean" name="forward" />
      <declaration type="double[]" name="y0" />
      <declaration type="double[]" name="y" />
      <declaration type="int" name="stages" />
      <declaration type="double[][][]" name="yDotK" />
      <scope startLine="108" endLine="110" />
      <declaration type="double[]" name="yTmp" />
      <declaration type="double[]" name="yDotTmp" />
      <declaration type="RungeKuttaStepInterpolator" name="interpolator" />
      <scope startLine="127" endLine="177">
        <scope startLine="135" endLine="147">
          <scope startLine="137" endLine="143">
            <declaration type="double" name="sum" />
            <scope startLine="139" endLine="141" />
          </scope>
        </scope>
        <scope startLine="150" endLine="156">
          <declaration type="double" name="sum" />
          <scope startLine="152" endLine="154" />
        </scope>
        <scope startLine="164" endLine="175">
          <declaration type="double" name="nextT" />
          <declaration type="boolean" name="nextIsLast" />
          <scope startLine="172" endLine="174" />
        </scope>
        <comment>first stage</comment>
        <comment>next stages</comment>
        <comment>estimate the state at the end of the step</comment>
        <comment>discrete events handling</comment>
        <comment>prepare next step</comment>
        <comment>stepsize control for next step</comment>
      </scope>
      <comment>create some internal working arrays</comment>
      <comment>set up an interpolator sharing the integrator arrays</comment>
      <comment>set up integration control objects</comment>
      <comment>main integration loop</comment>
      <comment>dispatch results</comment>
    </method>
  </class>
</source>
