<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.distribution">
  <import name="org.apache.commons.math3.exception.NotStrictlyPositiveException" />
  <import name="org.apache.commons.math3.exception.util.LocalizedFormats" />
  <import name="org.apache.commons.math3.special.Gamma" />
  <import name="org.apache.commons.math3.util.FastMath" />
  <import name="org.apache.commons.math3.random.RandomGenerator" />
  <import name="org.apache.commons.math3.random.Well19937c" />
  <class name="GammaDistribution" extends="AbstractRealDistribution" startLine="26">
    <javadoc>
      <text>* Implementation of the Gamma distribution.</text>
      <see><a href="http://en.wikipedia.org/wiki/Gamma_distribution">Gamma distribution (Wikipedia)</a></see>
      <see><a href="http://mathworld.wolfram.com/GammaDistribution.html">Gamma distribution (MathWorld)</a></see>
      <version>$Id: GammaDistribution.java 1422195 2012-12-15 06:45:18Z psteitz $</version>
    </javadoc>
    <javadoc>
      <text>* Default inverse cumulative probability accuracy.</text>
      <since>2.1</since>
    </javadoc>
    <declaration type="double" name="DEFAULT_INVERSE_ABSOLUTE_ACCURACY" />
    <javadoc>
      <text>* Serializable version identifier.</text>
    </javadoc>
    <declaration type="long" name="serialVersionUID" />
    <javadoc>
      <text>* The shape parameter.</text>
    </javadoc>
    <declaration type="double" name="shape" />
    <javadoc>
      <text>* The scale parameter.</text>
    </javadoc>
    <declaration type="double" name="scale" />
    <javadoc>
      <text>* The constant value of {@code shape + g + 0.5}, where {@code g} is the
 * Lanczos constant {@link Gamma#LANCZOS_G}.</text>
    </javadoc>
    <declaration type="double" name="shiftedShape" />
    <javadoc>
      <text>* The constant value of{@code shape / scale * sqrt(e / (2 * pi * (shape + g + 0.5))) / L(shape)},
 * where {@code L(shape)} is the Lanczos approximation returned by{@link Gamma#lanczos(double)}. This prefactor is used in{@link #density(double)}, when no overflow occurs with the natural
 * calculation.</text>
    </javadoc>
    <declaration type="double" name="densityPrefactor1" />
    <javadoc>
      <text>* The constant value of{@code shape * sqrt(e / (2 * pi * (shape + g + 0.5))) / L(shape)},
 * where {@code L(shape)} is the Lanczos approximation returned by{@link Gamma#lanczos(double)}. This prefactor is used in{@link #density(double)}, when overflow occurs with the natural
 * calculation.</text>
    </javadoc>
    <declaration type="double" name="densityPrefactor2" />
    <javadoc>
      <text>* Lower bound on {@code y = x / scale} for the selection of the computation
 * method in {@link #density(double)}. For {@code y <= minY}, the natural
 * calculation overflows.</text>
    </javadoc>
    <declaration type="double" name="minY" />
    <javadoc>
      <text>* Upper bound on {@code log(y)} ({@code y = x / scale}) for the selection
 * of the computation method in {@link #density(double)}. For{@code log(y) >= maxLogY}, the natural calculation overflows.</text>
    </javadoc>
    <declaration type="double" name="maxLogY" />
    <javadoc>
      <text>* Inverse cumulative probability accuracy.</text>
    </javadoc>
    <declaration type="double" name="solverAbsoluteAccuracy" />
    <javadoc>
      <text>* Creates a new gamma distribution with specified values of the shape and
 * scale parameters.</text>
      <param>shape the shape parameter</param>
      <param>scale the scale parameter</param>
      <throws>NotStrictlyPositiveException if {@code shape <= 0} or{@code scale <= 0}.</throws>
    </javadoc>
    <method type="constructor" name="GammaDistribution" startLine="92" endLine="94" />
    <javadoc>
      <text>* Creates a new gamma distribution with specified values of the shape and
 * scale parameters.</text>
      <param>shape the shape parameter</param>
      <param>scale the scale parameter</param>
      <param>inverseCumAccuracy the maximum absolute error in inverse
 * cumulative probability estimates (defaults to{@link #DEFAULT_INVERSE_ABSOLUTE_ACCURACY}).</param>
      <throws>NotStrictlyPositiveException if {@code shape <= 0} or{@code scale <= 0}.</throws>
      <since>2.1</since>
    </javadoc>
    <method type="constructor" name="GammaDistribution" startLine="110" endLine="112" />
    <javadoc>
      <text>* Creates a Gamma distribution.</text>
      <param>rng Random number generator.</param>
      <param>shape the shape parameter</param>
      <param>scale the scale parameter</param>
      <param>inverseCumAccuracy the maximum absolute error in inverse
 * cumulative probability estimates (defaults to{@link #DEFAULT_INVERSE_ABSOLUTE_ACCURACY}).</param>
      <throws>NotStrictlyPositiveException if {@code shape <= 0} or{@code scale <= 0}.</throws>
      <since>3.1</since>
    </javadoc>
    <method type="constructor" name="GammaDistribution" startLine="131" endLine="152">
      <scope startLine="134" endLine="136" />
      <scope startLine="137" endLine="139" />
      <declaration type="double" name="aux" />
    </method>
    <javadoc>
      <text>* Returns the shape parameter of {@code this} distribution.</text>
      <return>the shape parameter</return>
      <deprecated>as of version 3.1, {@link #getShape()} should be preferred.
 * This method will be removed in version 4.0.</deprecated>
    </javadoc>
    <method type="double" name="getAlpha" startLine="162" endLine="164" />
    <javadoc>
      <text>* Returns the shape parameter of {@code this} distribution.</text>
      <return>the shape parameter</return>
      <since>3.1</since>
    </javadoc>
    <method type="double" name="getShape" startLine="172" endLine="174" />
    <javadoc>
      <text>* Returns the scale parameter of {@code this} distribution.</text>
      <return>the scale parameter</return>
      <deprecated>as of version 3.1, {@link #getScale()} should be preferred.
 * This method will be removed in version 4.0.</deprecated>
    </javadoc>
    <method type="double" name="getBeta" startLine="184" endLine="186" />
    <javadoc>
      <text>* Returns the scale parameter of {@code this} distribution.</text>
      <return>the scale parameter</return>
      <since>3.1</since>
    </javadoc>
    <method type="double" name="getScale" startLine="194" endLine="196" />
    <javadoc>
      <text>* {@inheritDoc}</text>
    </javadoc>
    <method type="double" name="density" startLine="199" endLine="257">
      <scope startLine="238" endLine="240" />
      <declaration type="double" name="y" />
      <scope startLine="242" endLine="251">
        <declaration type="double" name="aux1" />
        <declaration type="double" name="aux2" />
        <declaration type="double" name="aux3" />
        <comment>Overflow.</comment>
      </scope>
      <comment>The present method must return the value of

     1       x a     - x
 ---------- (-)  exp(---)
 x Gamma(a)  b        b

 where a is the shape parameter, and b the scale parameter.
 Substituting the Lanczos approximation of Gamma(a) leads to the
 following expression of the density

 a              e            1         y      a
 - sqrt(------------------) ---- (-----------)  exp(a - y + g),
 x      2 pi (a + g + 0.5)  L(a)  a + g + 0.5

 where y = x  b. The above formula is the "natural" computation, which
 is implemented when no overflow is likely to occur. If overflow occurs
 with the natural computation, the following identity is used. It is
 based on the BOOST library
 http:www.boost.orgdoclibs1_35_0libsmathdocsf_and_disthtmlmath_toolkitspecialsf_gammaigamma.html
 Formula (15) needs adaptations, which are detailed below.

       y      a
 (-----------)  exp(a - y + g)
  a + g + 0.5
                              y - a - g - 0.5    y (g + 0.5)
               = exp(a log1pm(---------------) - ----------- + g),
                                a + g + 0.5      a + g + 0.5

  where log1pm(z) = log(1 + z) - z. Therefore, the value to be
  returned is

 a              e            1
 - sqrt(------------------) ----
 x      2 pi (a + g + 0.5)  L(a)
                              y - a - g - 0.5    y (g + 0.5)
                exp(a log1pm(---------------) - ----------- + g).
                                a + g + 0.5      a + g + 0.5</comment>
      <comment>Natural calculation.</comment>
    </method>
    <javadoc>
      <text>* {@inheritDoc}The implementation of this method is based on:
 * <ul>
 * <li>
 * <a href="http://mathworld.wolfram.com/Chi-SquaredDistribution.html">
 * Chi-Squared Distribution</a>, equation (9).
 * </li>
 * <li>Casella, G., & Berger, R. (1990). <i>Statistical Inference</i>.
 * Belmont, CA: Duxbury Press.
 * </li>
 * </ul></text>
    </javadoc>
    <method type="double" name="cumulativeProbability" startLine="273" endLine="283">
      <declaration type="double" name="ret" />
      <scope startLine="276" endLine="278" />
      <scope startLine="278" endLine="280" />
    </method>
    <javadoc>
      <text>* {@inheritDoc}</text>
    </javadoc>
    <method type="double" name="getSolverAbsoluteAccuracy" startLine="287" endLine="289" />
    <javadoc>
      <text>* {@inheritDoc}For shape parameter {@code alpha} and scale parameter {@code beta}, the
 * mean is {@code alpha * beta}.</text>
    </javadoc>
    <method type="double" name="getNumericalMean" startLine="297" endLine="299" />
    <javadoc>
      <text>* {@inheritDoc}For shape parameter {@code alpha} and scale parameter {@code beta}, the
 * variance is {@code alpha * beta^2}.</text>
      <return>{@inheritDoc}</return>
    </javadoc>
    <method type="double" name="getNumericalVariance" startLine="309" endLine="311" />
    <javadoc>
      <text>* {@inheritDoc}The lower bound of the support is always 0 no matter the parameters.</text>
      <return>lower bound of the support (always 0)</return>
    </javadoc>
    <method type="double" name="getSupportLowerBound" startLine="320" endLine="322" />
    <javadoc>
      <text>* {@inheritDoc}The upper bound of the support is always positive infinity
 * no matter the parameters.</text>
      <return>upper bound of the support (always Double.POSITIVE_INFINITY)</return>
    </javadoc>
    <method type="double" name="getSupportUpperBound" startLine="332" endLine="334" />
    <javadoc>
      <text>* {@inheritDoc}</text>
    </javadoc>
    <method type="boolean" name="isSupportLowerBoundInclusive" startLine="337" endLine="339" />
    <javadoc>
      <text>* {@inheritDoc}</text>
    </javadoc>
    <method type="boolean" name="isSupportUpperBoundInclusive" startLine="342" endLine="344" />
    <javadoc>
      <text>* {@inheritDoc}The support of this distribution is connected.</text>
      <return>{@code true}</return>
    </javadoc>
    <method type="boolean" name="isSupportConnected" startLine="353" endLine="355" />
    <javadoc>
      <text>* <p>This implementation uses the following algorithms: </p>
 * <p>For 0 < shape < 1: <br/>
 * Ahrens, J. H. and Dieter, U., <i>Computer methods for
 * sampling from gamma, beta, Poisson and binomial distributions.</i>
 * Computing, 12, 223-246, 1974.</p>
 * <p>For shape >= 1: <br/>
 * Marsaglia and Tsang, <i>A Simple Method for Generating
 * Gamma Variables.</i> ACM Transactions on Mathematical Software,
 * Volume 26 Issue 3, September, 2000.</p></text>
      <return>random value sampled from the Gamma(shape, scale) distribution</return>
    </javadoc>
    <method type="double" name="sample" startLine="373" endLine="436">
      <scope startLine="374" endLine="409">
        <scope startLine="377" endLine="408">
          <declaration type="double" name="u" />
          <declaration type="double" name="bGS" />
          <declaration type="double" name="p" />
          <scope startLine="383" endLine="395">
            <declaration type="double" name="x" />
            <declaration type="double" name="u2" />
            <scope startLine="389" endLine="392" />
            <scope startLine="392" endLine="394" />
          </scope>
          <scope startLine="395" endLine="407">
            <declaration type="double" name="x" />
            <declaration type="double" name="u2" />
            <scope startLine="401" endLine="404" />
            <scope startLine="404" endLine="406" />
          </scope>
        </scope>
        <comment>[1]: p. 228, Algorithm GS</comment>
        <comment>Step 1:</comment>
        <comment>Step 2:</comment>
        <comment>Reject</comment>
        <comment>Step 3:</comment>
        <comment>Reject</comment>
      </scope>
      <declaration type="double" name="d" />
      <declaration type="double" name="c" />
      <scope startLine="416" endLine="435">
        <declaration type="double" name="x" />
        <declaration type="double" name="v" />
        <scope startLine="420" endLine="422" />
        <declaration type="double" name="x2" />
        <declaration type="double" name="u" />
        <scope startLine="428" endLine="430" />
        <scope startLine="432" endLine="434" />
        <comment>Squeeze</comment>
      </scope>
      <comment>Now shape >= 1</comment>
    </method>
  </class>
</source>
