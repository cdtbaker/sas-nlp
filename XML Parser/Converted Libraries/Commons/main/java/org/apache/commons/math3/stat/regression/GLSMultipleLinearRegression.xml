<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.stat.regression">
  <import name="org.apache.commons.math3.linear.LUDecomposition" />
  <import name="org.apache.commons.math3.linear.RealMatrix" />
  <import name="org.apache.commons.math3.linear.Array2DRowRealMatrix" />
  <import name="org.apache.commons.math3.linear.RealVector" />
  <class name="GLSMultipleLinearRegression" extends="AbstractMultipleLinearRegression" startLine="24">
    <javadoc>
      <text>* The GLS implementation of the multiple linear regression.
 * GLS assumes a general covariance matrix Omega of the error
 * <pre>
 * u ~ N(0, Omega)
 * </pre>
 * Estimated by GLS,
 * <pre>
 * b=(X' Omega^-1 X)^-1X'Omega^-1 y
 * </pre>
 * whose variance is
 * <pre>
 * Var(b)=(X' Omega^-1 X)^-1
 * </pre></text>
      <version>$Id: GLSMultipleLinearRegression.java 1416643 2012-12-03 19:37:14Z tn $</version>
      <since>2.0</since>
    </javadoc>
    <javadoc>
      <text>* Covariance matrix.</text>
    </javadoc>
    <declaration type="RealMatrix" name="Omega" />
    <javadoc>
      <text>* Inverse of covariance matrix.</text>
    </javadoc>
    <declaration type="RealMatrix" name="OmegaInverse" />
    <javadoc>
      <text>* Replace sample data, overriding any previous sample.</text>
      <param>y y values of the sample</param>
      <param>x x values of the sample</param>
      <param>covariance array representing the covariance matrix</param>
    </javadoc>
    <method type="void" name="newSampleData" startLine="56" endLine="62" />
    <javadoc>
      <text>* Add the covariance data.</text>
      <param>omega the [n,n] array representing the covariance</param>
    </javadoc>
    <method type="void" name="newCovarianceData" startLine="69" endLine="72" />
    <javadoc>
      <text>* Get the inverse of the covariance.
 * <p>The inverse of the covariance matrix is lazily evaluated and cached.</p></text>
      <return>inverse of the covariance</return>
    </javadoc>
    <method type="RealMatrix" name="getOmegaInverse" startLine="79" endLine="84">
      <scope startLine="80" endLine="82" />
    </method>
    <javadoc>
      <text>* Calculates beta by GLS.
 * <pre>
 * b=(X' Omega^-1 X)^-1X'Omega^-1 y
 * </pre></text>
      <return>beta</return>
    </javadoc>
    <method type="RealVector" name="calculateBeta" startLine="94" endLine="100">
      <declaration type="RealMatrix" name="OI" />
      <declaration type="RealMatrix" name="XT" />
      <declaration type="RealMatrix" name="XTOIX" />
      <declaration type="RealMatrix" name="inverse" />
    </method>
    <javadoc>
      <text>* Calculates the variance on the beta.
 * <pre>
 * Var(b)=(X' Omega^-1 X)^-1
 * </pre></text>
      <return>The beta variance matrix</return>
    </javadoc>
    <method type="RealMatrix" name="calculateBetaVariance" startLine="110" endLine="114">
      <declaration type="RealMatrix" name="OI" />
      <declaration type="RealMatrix" name="XTOIX" />
    </method>
    <javadoc>
      <text>* Calculates the estimated variance of the error term using the formula
 * <pre>
 * Var(u) = Tr(u' Omega^-1 u)/(n-k)
 * </pre>
 * where n and k are the row and column dimensions of the design
 * matrix X.</text>
      <return>error variance</return>
      <since>2.2</since>
    </javadoc>
    <method type="double" name="calculateErrorVariance" startLine="129" endLine="134">
      <declaration type="RealVector" name="residuals" />
      <declaration type="double" name="t" />
    </method>
  </class>
</source>
