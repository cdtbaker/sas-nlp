<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.fitting">
  <import name="java.util.Random" />
  <import name="org.apache.commons.math3.optim.nonlinear.vector.jacobian.LevenbergMarquardtOptimizer" />
  <import name="org.apache.commons.math3.analysis.function.HarmonicOscillator" />
  <import name="org.apache.commons.math3.exception.NumberIsTooSmallException" />
  <import name="org.apache.commons.math3.exception.MathIllegalStateException" />
  <import name="org.apache.commons.math3.util.FastMath" />
  <import name="org.apache.commons.math3.util.MathUtils" />
  <import name="org.junit.Test" />
  <import name="org.junit.Assert" />
  <class name="HarmonicFitterTest" startLine="30">
    <method type="void" name="testPreconditions1" startLine="32" endLine="37">
      <declaration type="HarmonicFitter" name="fitter" />
    </method>
    <method type="void" name="testNoError" startLine="40" endLine="62">
      <declaration type="double" name="a" />
      <declaration type="double" name="w" />
      <declaration type="double" name="p" />
      <declaration type="HarmonicOscillator" name="f" />
      <declaration type="HarmonicFitter" name="fitter" />
      <scope startLine="48" endLine="50" />
      <declaration type="double[]" name="fitted" />
      <declaration type="HarmonicOscillator" name="ff" />
      <scope startLine="59" endLine="61" />
    </method>
    <method type="void" name="test1PercentError" startLine="65" endLine="83">
      <declaration type="Random" name="randomizer" />
      <declaration type="double" name="a" />
      <declaration type="double" name="w" />
      <declaration type="double" name="p" />
      <declaration type="HarmonicOscillator" name="f" />
      <declaration type="HarmonicFitter" name="fitter" />
      <scope startLine="74" endLine="77" />
      <declaration type="double[]" name="fitted" />
    </method>
    <method type="void" name="testTinyVariationsData" startLine="86" endLine="98">
      <declaration type="Random" name="randomizer" />
      <declaration type="HarmonicFitter" name="fitter" />
      <scope startLine="91" endLine="93" />
      <comment>This test serves to cover the part of the code of "guessAOmega"</comment>
      <comment>when the algorithm using integrals fails.</comment>
    </method>
    <method type="void" name="testInitialGuess" startLine="101" endLine="119">
      <declaration type="Random" name="randomizer" />
      <declaration type="double" name="a" />
      <declaration type="double" name="w" />
      <declaration type="double" name="p" />
      <declaration type="HarmonicOscillator" name="f" />
      <declaration type="HarmonicFitter" name="fitter" />
      <scope startLine="110" endLine="113" />
      <declaration type="double[][]" name="fitted" />
    </method>
    <method type="void" name="testUnsorted" startLine="122" endLine="162">
      <declaration type="Random" name="randomizer" />
      <declaration type="double" name="a" />
      <declaration type="double" name="w" />
      <declaration type="double" name="p" />
      <declaration type="HarmonicOscillator" name="f" />
      <declaration type="HarmonicFitter" name="fitter" />
      <declaration type="int" name="size" />
      <declaration type="double[]" name="xTab" />
      <declaration type="double[]" name="yTab" />
      <scope startLine="136" endLine="139" />
      <scope startLine="142" endLine="151">
        <declaration type="int" name="i1" />
        <declaration type="int" name="i2" />
        <declaration type="double" name="xTmp" />
        <declaration type="double" name="yTmp" />
      </scope>
      <scope startLine="154" endLine="156" />
      <declaration type="double[]" name="fitted" />
      <comment>build a regularly spaced array of measurements</comment>
      <comment>shake it</comment>
      <comment>pass it to the fitter</comment>
    </method>
    <method type="void" name="testMath844" startLine="165" endLine="184">
      <declaration type="double[]" name="y" />
      <declaration type="int" name="len" />
      <declaration type="WeightedObservedPoint[]" name="points" />
      <scope startLine="173" endLine="175" />
      <declaration type="HarmonicFitter.ParameterGuesser" name="guesser" />
      <comment>The guesser fails because the function is far from an harmonic</comment>
      <comment>function: It is a triangular periodic function with amplitude 3</comment>
      <comment>and period 12, and all sample points are taken at integer abscissae</comment>
      <comment>so function values all belong to the integer subset {-3, -2, -1, 0,</comment>
      <comment>1, 2, 3}.</comment>
    </method>
  </class>
</source>
