<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.stat.regression">
  <import name="org.apache.commons.math3.TestUtils" />
  <import name="org.apache.commons.math3.linear.DefaultRealMatrixChangingVisitor" />
  <import name="org.apache.commons.math3.linear.MatrixUtils" />
  <import name="org.apache.commons.math3.linear.RealMatrix" />
  <import name="org.apache.commons.math3.linear.Array2DRowRealMatrix" />
  <import name="org.apache.commons.math3.linear.RealVector" />
  <import name="org.apache.commons.math3.stat.StatUtils" />
  <import name="org.junit.Assert" />
  <import name="org.junit.Before" />
  <import name="org.junit.Test" />
  <class name="OLSMultipleLinearRegressionTest" extends="MultipleLinearRegressionAbstractTest" startLine="31">
    <declaration type="double[]" name="y" />
    <declaration type="double[][]" name="x" />
    <method type="void" name="setUp" startLine="38" endLine="48" />
    <method type="OLSMultipleLinearRegression" name="createRegression" startLine="51" endLine="55">
      <declaration type="OLSMultipleLinearRegression" name="regression" />
    </method>
    <method type="int" name="getNumberOfRegressors" startLine="58" endLine="60" />
    <method type="int" name="getSampleSize" startLine="63" endLine="65" />
    <method type="void" name="cannotAddSampleDataWithSizeMismatch" startLine="68" endLine="73">
      <declaration type="double[][]" name="y" />
      <declaration type="double[][][]" name="x" />
    </method>
    <method type="void" name="testPerfectFit" startLine="76" endLine="102">
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="residuals" />
      <declaration type="RealMatrix" name="errors" />
      <declaration type="double[]" name="s" />
      <declaration type="RealMatrix" name="referenceVariance" />
      <method type="double" name="visit" startLine="90" endLine="96">
        <scope startLine="91" endLine="93" />
        <declaration type="double" name="x" />
      </method>
    </method>
    <javadoc>
      <text>* Test Longley dataset against certified values provided by NIST.
 * Data Source: J. Longley (1967) "An Appraisal of Least Squares
 * Programs for the Electronic Computer from the Point of View of the User"
 * Journal of the American Statistical Association, vol. 62. September,
 * pp. 819-841.
 * Certified values (and data) are from NIST:
 * http://www.itl.nist.gov/div898/strd/lls/data/LINKS/DATA/Longley.dat</text>
    </javadoc>
    <method type="void" name="testLongly" startLine="116" endLine="216">
      <declaration type="double[][]" name="design" />
      <declaration type="int" name="nobs" />
      <declaration type="int" name="nvars" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="residuals" />
      <declaration type="double[]" name="errors" />
      <comment>Y values are first, then independent vars</comment>
      <comment>Each row is one observation</comment>
      <comment>Estimate the model</comment>
      <comment>Check expected beta values from NIST</comment>
      <comment />
      <comment>Check expected residuals from R</comment>
      <comment>Check standard errors from NIST</comment>
      <comment>Check regression standard error against R</comment>
      <comment>Check R-Square statistics against R</comment>
      <comment>Estimate model without intercept</comment>
      <comment>Check expected beta values from R</comment>
      <comment>Check standard errors from R</comment>
      <comment>Check expected residuals from R</comment>
      <comment>Check regression standard error against R</comment>
      <comment>Check R-Square statistics against R</comment>
    </method>
    <javadoc>
      <text>* Test R Swiss fertility dataset against R.
 * Data Source: R datasets package</text>
    </javadoc>
    <method type="void" name="testSwissFertility" startLine="223" endLine="369">
      <declaration type="double[][]" name="design" />
      <declaration type="int" name="nobs" />
      <declaration type="int" name="nvars" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="residuals" />
      <declaration type="double[]" name="errors" />
      <comment>Estimate the model</comment>
      <comment>Check expected beta values from R</comment>
      <comment>Check expected residuals from R</comment>
      <comment>Check standard errors from R</comment>
      <comment>Check regression standard error against R</comment>
      <comment>Check R-Square statistics against R</comment>
      <comment>Estimate the model with no intercept</comment>
      <comment>Check expected beta values from R</comment>
      <comment>Check expected residuals from R</comment>
      <comment>Check standard errors from R</comment>
      <comment>Check regression standard error against R</comment>
      <comment>Check R-Square statistics against R</comment>
    </method>
    <javadoc>
      <text>* Test hat matrix computation</text>
    </javadoc>
    <method type="void" name="testHat" startLine="376" endLine="438">
      <declaration type="double[][]" name="design" />
      <declaration type="int" name="nobs" />
      <declaration type="int" name="nvars" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="RealMatrix" name="hat" />
      <declaration type="double[][]" name="referenceData" />
      <declaration type="int" name="k" />
      <scope startLine="422" endLine="428">
        <scope startLine="423" endLine="427" />
      </scope>
      <declaration type="double[]" name="residuals" />
      <declaration type="RealMatrix" name="I" />
      <declaration type="double[]" name="hatResiduals" />
      <comment>This example is from "The Hat Matrix in Regression and ANOVA",
 David C. Hoaglin and Roy E. Welsch,
 The American Statistician, Vol. 32, No. 1 (Feb., 1978), pp. 17-22.</comment>
      <comment>Estimate the model</comment>
      <comment>Reference data is upper half of symmetric hat matrix</comment>
      <comment>Check against reference data and verify symmetry</comment>
      <comment>Verify that residuals computed using the hat matrix are close to
 what we get from direct computation, i.e. r = (I - H) y</comment>
    </method>
    <javadoc>
      <text>* test calculateYVariance</text>
    </javadoc>
    <method type="void" name="testYVariance" startLine="444" endLine="451">
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <comment>assumes: y = new double[]{11.0, 12.0, 13.0, 14.0, 15.0, 16.0};</comment>
    </method>
    <javadoc>
      <text>* Verifies that calculateYVariance and calculateResidualVariance return consistent
 * values with direct variance computation from Y, residuals, respectively.</text>
    </javadoc>
    <method type="void" name="checkVarianceConsistency" startLine="457" endLine="468">
      <declaration type="double[]" name="residuals" />
      <declaration type="RealMatrix" name="X" />
      <comment>Check Y variance consistency</comment>
      <comment>Check residual variance consistency</comment>
    </method>
    <javadoc>
      <text>* Verifies that setting X and Y separately has the same effect as newSample(X,Y).</text>
    </javadoc>
    <method type="void" name="testNewSample2" startLine="474" endLine="500">
      <declaration type="double[][]" name="y" />
      <declaration type="double[][][]" name="x" />
      <declaration type="OLSMultipleLinearRegression" name="regression" />
      <declaration type="RealMatrix" name="combinedX" />
      <declaration type="RealVector" name="combinedY" />
      <comment>No intercept</comment>
    </method>
    <method type="void" name="testNewSampleDataYNull" startLine="503" endLine="505" />
    <method type="void" name="testNewSampleDataXNull" startLine="508" endLine="510" />
    <method type="void" name="testWampler1" startLine="517" endLine="578">
      <declaration type="double[][]" name="data" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="int" name="nvars" />
      <declaration type="int" name="nobs" />
      <declaration type="double[]" name="tmp" />
      <declaration type="int" name="off" />
      <declaration type="int" name="off2" />
      <scope startLine="548" endLine="557" />
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="se" />
    </method>
    <method type="void" name="testWampler2" startLine="585" endLine="646">
      <declaration type="double[][]" name="data" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="int" name="nvars" />
      <declaration type="int" name="nobs" />
      <declaration type="double[]" name="tmp" />
      <declaration type="int" name="off" />
      <declaration type="int" name="off2" />
      <scope startLine="616" endLine="625" />
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="se" />
    </method>
    <method type="void" name="testWampler3" startLine="653" endLine="715">
      <declaration type="double[][]" name="data" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="int" name="nvars" />
      <declaration type="int" name="nobs" />
      <declaration type="double[]" name="tmp" />
      <declaration type="int" name="off" />
      <declaration type="int" name="off2" />
      <scope startLine="683" endLine="692" />
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="se" />
      <comment />
    </method>
    <method type="void" name="testWampler4" startLine="722" endLine="784">
      <declaration type="double[][]" name="data" />
      <declaration type="OLSMultipleLinearRegression" name="model" />
      <declaration type="int" name="nvars" />
      <declaration type="int" name="nobs" />
      <declaration type="double[]" name="tmp" />
      <declaration type="int" name="off" />
      <declaration type="int" name="off2" />
      <scope startLine="752" endLine="761" />
      <declaration type="double[]" name="betaHat" />
      <declaration type="double[]" name="se" />
    </method>
    <comment>This is a test based on the Wampler1 data set
 http:www.itl.nist.govdiv898strdllsdataWampler1.shtml</comment>
    <comment>This is a test based on the Wampler2 data set
 http:www.itl.nist.govdiv898strdllsdataWampler2.shtml</comment>
    <comment>This is a test based on the Wampler3 data set
 http:www.itl.nist.govdiv898strdllsdataWampler3.shtml</comment>
    <comment>This is a test based on the Wampler4 data set
 http:www.itl.nist.govdiv898strdllsdataWampler4.shtml</comment>
  </class>
</source>
