<?xml version="1.0" encoding="UTF-8"?>
<source package="org.apache.commons.math3.geometry.euclidean.threed">
  <import name="org.apache.commons.math3.analysis.differentiation.DerivativeStructure" />
  <import name="org.apache.commons.math3.exception.MathArithmeticException" />
  <import name="org.apache.commons.math3.exception.MathIllegalArgumentException" />
  <import name="org.apache.commons.math3.linear.MatrixUtils" />
  <import name="org.apache.commons.math3.linear.RealMatrix" />
  <import name="org.apache.commons.math3.random.UnitSphereRandomVectorGenerator" />
  <import name="org.apache.commons.math3.random.Well1024a" />
  <import name="org.apache.commons.math3.util.FastMath" />
  <import name="org.apache.commons.math3.util.MathUtils" />
  <import name="org.junit.Assert" />
  <import name="org.junit.Test" />
  <class name="FieldRotationDSTest" startLine="33">
    <method type="void" name="testIdentity" startLine="36" endLine="56">
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
    </method>
    <method type="void" name="testAxisAngle" startLine="59" endLine="85">
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <declaration type="double" name="s" />
      <scope startLine="69" endLine="72" />
      <scope startLine="72" endLine="73" />
    </method>
    <method type="void" name="testRevert" startLine="88" endLine="154">
      <declaration type="double" name="a" />
      <declaration type="double" name="b" />
      <declaration type="double" name="c" />
      <declaration type="double" name="d" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <declaration type="double" name="a2" />
      <declaration type="double" name="b2" />
      <declaration type="double" name="c2" />
      <declaration type="double" name="d2" />
      <declaration type="double" name="den" />
      <declaration type="FieldRotation<DerivativeStructure>" name="reverted" />
      <declaration type="FieldRotation<DerivativeStructure>" name="rrT" />
      <declaration type="FieldRotation<DerivativeStructure>" name="rTr" />
    </method>
    <method type="void" name="testVectorOnePair" startLine="157" endLine="173">
      <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="v" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <scope startLine="166" endLine="169" />
      <scope startLine="169" endLine="171">
        <comment>expected behavior</comment>
      </scope>
    </method>
    <method type="void" name="testVectorTwoPairs" startLine="176" endLine="213">
      <declaration type="FieldVector3D<DerivativeStructure>" name="u1" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="u2" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="v1" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="v2" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="axis" />
      <scope startLine="188" endLine="190" />
      <scope startLine="190" endLine="192" />
      <declaration type="double" name="sqrt" />
      <scope startLine="206" endLine="209" />
      <scope startLine="209" endLine="211">
        <comment>expected behavior</comment>
      </scope>
    </method>
    <method type="void" name="testMatrix" startLine="217" endLine="359">
      <scope startLine="219" endLine="225" />
      <scope startLine="225" endLine="227">
        <comment>expected behavior</comment>
      </scope>
      <scope startLine="229" endLine="236" />
      <scope startLine="236" endLine="238">
        <comment>expected behavior</comment>
      </scope>
      <scope startLine="240" endLine="247" />
      <scope startLine="247" endLine="249">
        <comment>expected behavior</comment>
      </scope>
      <declaration type="double[][]" name="m1" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <declaration type="double[][]" name="m2" />
      <declaration type="DerivativeStructure[][]" name="m3" />
      <declaration type="double" name="d00" />
      <declaration type="double" name="d01" />
      <declaration type="double" name="d02" />
      <declaration type="double" name="d10" />
      <declaration type="double" name="d11" />
      <declaration type="double" name="d12" />
      <declaration type="double" name="d20" />
      <declaration type="double" name="d21" />
      <declaration type="double" name="d22" />
      <scope startLine="323" endLine="334">
        <scope startLine="324" endLine="333">
          <declaration type="double" name="m3tm3" />
          <scope startLine="328" endLine="330" />
          <scope startLine="330" endLine="332" />
        </scope>
      </scope>
      <declaration type="double[][]" name="m4" />
      <scope startLine="349" endLine="355">
        <declaration type="double[][]" name="m5" />
      </scope>
      <scope startLine="355" endLine="357">
        <comment>expected</comment>
      </scope>
    </method>
    <method type="void" name="testAngles" startLine="363" endLine="409">
      <declaration type="RotationOrder[]" name="CardanOrders" />
      <scope startLine="370" endLine="385">
        <scope startLine="371" endLine="384">
          <scope startLine="372" endLine="383">
            <scope startLine="373" endLine="382">
              <declaration type="FieldRotation<DerivativeStructure>" name="r" />
              <declaration type="DerivativeStructure[]" name="angles" />
            </scope>
          </scope>
        </scope>
      </scope>
      <declaration type="RotationOrder[]" name="EulerOrders" />
      <scope startLine="392" endLine="407">
        <scope startLine="393" endLine="406">
          <scope startLine="394" endLine="405">
            <scope startLine="395" endLine="404">
              <declaration type="FieldRotation<DerivativeStructure>" name="r" />
              <declaration type="DerivativeStructure[]" name="angles" />
            </scope>
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testSingularities" startLine="412" endLine="457">
      <declaration type="RotationOrder[]" name="CardanOrders" />
      <declaration type="double[]" name="singularCardanAngle" />
      <scope startLine="420" endLine="433">
        <scope startLine="421" endLine="432">
          <declaration type="FieldRotation<DerivativeStructure>" name="r" />
          <scope startLine="426" endLine="429" />
          <scope startLine="429" endLine="431" />
        </scope>
        <comment>expected behavior</comment>
      </scope>
      <declaration type="RotationOrder[]" name="EulerOrders" />
      <declaration type="double[]" name="singularEulerAngle" />
      <scope startLine="441" endLine="454">
        <scope startLine="442" endLine="453">
          <declaration type="FieldRotation<DerivativeStructure>" name="r" />
          <scope startLine="447" endLine="450" />
          <scope startLine="450" endLine="452" />
        </scope>
        <comment>expected behavior</comment>
      </scope>
    </method>
    <method type="void" name="testQuaternion" startLine="460" endLine="485">
      <declaration type="FieldRotation<DerivativeStructure>" name="r1" />
      <declaration type="double" name="n" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r2" />
      <scope startLine="467" endLine="474">
        <scope startLine="468" endLine="473">
          <scope startLine="469" endLine="472">
            <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testCompose" startLine="488" endLine="509">
      <declaration type="FieldRotation<DerivativeStructure>" name="r1" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r2" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r3" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r3Double" />
      <scope startLine="499" endLine="507">
        <scope startLine="500" endLine="506">
          <scope startLine="501" endLine="505">
            <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testComposeInverse" startLine="512" endLine="533">
      <declaration type="FieldRotation<DerivativeStructure>" name="r1" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r2" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r3" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r3Double" />
      <scope startLine="523" endLine="531">
        <scope startLine="524" endLine="530">
          <scope startLine="525" endLine="529">
            <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testDoubleVectors" startLine="536" endLine="567">
      <declaration type="Well1024a" name="random" />
      <declaration type="UnitSphereRandomVectorGenerator" name="g" />
      <scope startLine="540" endLine="565">
        <declaration type="double[]" name="unit" />
        <declaration type="FieldRotation<DerivativeStructure>" name="r" />
        <scope startLine="545" endLine="564">
          <scope startLine="546" endLine="563">
            <scope startLine="547" endLine="562">
              <declaration type="FieldVector3D<DerivativeStructure>" name="uds" />
              <declaration type="FieldVector3D<DerivativeStructure>" name="ruds" />
              <declaration type="FieldVector3D<DerivativeStructure>" name="rIuds" />
              <declaration type="Vector3D" name="u" />
              <declaration type="FieldVector3D<DerivativeStructure>" name="ru" />
              <declaration type="FieldVector3D<DerivativeStructure>" name="rIu" />
              <declaration type="DerivativeStructure[]" name="ruArray" />
              <declaration type="DerivativeStructure[]" name="rIuArray" />
            </scope>
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testDoubleRotations" startLine="570" endLine="609">
      <declaration type="Well1024a" name="random" />
      <declaration type="UnitSphereRandomVectorGenerator" name="g" />
      <scope startLine="574" endLine="607">
        <declaration type="double[]" name="unit1" />
        <declaration type="Rotation" name="r1" />
        <declaration type="FieldRotation<DerivativeStructure>" name="r1Prime" />
        <declaration type="double[]" name="unit2" />
        <declaration type="FieldRotation<DerivativeStructure>" name="r2" />
        <declaration type="FieldRotation<DerivativeStructure>" name="rA" />
        <declaration type="FieldRotation<DerivativeStructure>" name="rB" />
        <declaration type="FieldRotation<DerivativeStructure>" name="rC" />
        <declaration type="FieldRotation<DerivativeStructure>" name="rD" />
        <scope startLine="592" endLine="606">
          <scope startLine="593" endLine="605">
            <scope startLine="594" endLine="604">
              <declaration type="FieldVector3D<DerivativeStructure>" name="uds" />
            </scope>
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testDerivatives" startLine="612" endLine="682">
      <declaration type="double" name="eps" />
      <declaration type="double" name="kx" />
      <declaration type="double" name="ky" />
      <declaration type="double" name="kz" />
      <declaration type="double" name="n2" />
      <declaration type="double" name="n" />
      <declaration type="double" name="theta" />
      <declaration type="double" name="cosTheta" />
      <declaration type="double" name="sinTheta" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <declaration type="Vector3D" name="a" />
      <declaration type="RealMatrix[]" name="dadk" />
      <scope startLine="633" endLine="681">
        <scope startLine="634" endLine="680">
          <scope startLine="635" endLine="679">
            <declaration type="Vector3D" name="u" />
            <declaration type="FieldVector3D<DerivativeStructure>" name="v" />
            <declaration type="double" name="dot" />
            <declaration type="Vector3D" name="cross" />
            <declaration type="double" name="c1" />
            <declaration type="double" name="c2" />
            <declaration type="Vector3D" name="rt" />
            <declaration type="RealMatrix[]" name="dvda" />
            <declaration type="RealMatrix" name="dvdk" />
            <declaration type="Vector3D" name="dvdTheta" />
          </scope>
        </scope>
        <comment>explicit formula for rotation of vector u around axis a with angle theta</comment>
        <comment>Jacobian of the image v = r(u) with respect to rotation axis a</comment>
        <comment>(analytical differentiation of the explicit formula)</comment>
        <comment>compose Jacobians</comment>
        <comment>derivatives with respect to un-normalized axis</comment>
        <comment>derivative with respect to rotation angle</comment>
        <comment>(analytical differentiation of the explicit formula)</comment>
      </scope>
      <comment>Jacobian of the normalized rotation axis a with respect to the Cartesian vector k</comment>
    </method>
    <method type="void" name="testArray" startLine="685" endLine="707">
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <scope startLine="689" endLine="705">
        <scope startLine="690" endLine="704">
          <scope startLine="691" endLine="703">
            <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
            <declaration type="FieldVector3D<DerivativeStructure>" name="v" />
            <declaration type="DerivativeStructure[]" name="out" />
          </scope>
        </scope>
      </scope>
    </method>
    <method type="void" name="testApplyInverseTo" startLine="710" endLine="757">
      <declaration type="DerivativeStructure[]" name="in" />
      <declaration type="DerivativeStructure[]" name="out" />
      <declaration type="DerivativeStructure[]" name="rebuilt" />
      <declaration type="FieldRotation<DerivativeStructure>" name="r" />
      <scope startLine="716" endLine="733">
        <scope startLine="717" endLine="732">
          <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
        </scope>
      </scope>
      <scope startLine="736" endLine="744">
        <scope startLine="737" endLine="743">
          <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
        </scope>
      </scope>
      <scope startLine="747" endLine="755">
        <scope startLine="748" endLine="754">
          <declaration type="FieldVector3D<DerivativeStructure>" name="u" />
        </scope>
      </scope>
    </method>
    <method type="void" name="testIssue639" startLine="760" endLine="772">
      <declaration type="FieldVector3D<DerivativeStructure>" name="u1" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="u2" />
      <declaration type="FieldRotation<DerivativeStructure>" name="rot" />
    </method>
    <method type="void" name="testIssue801" startLine="775" endLine="791">
      <declaration type="FieldVector3D<DerivativeStructure>" name="u1" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="u2" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="v1" />
      <declaration type="FieldVector3D<DerivativeStructure>" name="v2" />
      <declaration type="FieldRotation<DerivativeStructure>" name="quat" />
      <declaration type="double" name="q2" />
    </method>
    <method type="void" name="checkAngle" startLine="793" endLine="795" />
    <method type="void" name="checkRotationDS" startLine="797" endLine="800">
      <declaration type="FieldRotation<DerivativeStructure>" name="rPrime" />
    </method>
    <method type="FieldRotation<DerivativeStructure>" name="createRotation" startLine="803" endLine="809" />
    <method type="FieldRotation<DerivativeStructure>" name="createRotation" startLine="811" endLine="821">
      <declaration type="DerivativeStructure[][]" name="mds" />
      <declaration type="int" name="index" />
      <scope startLine="814" endLine="819">
        <scope startLine="815" endLine="818" />
      </scope>
    </method>
    <method type="FieldVector3D<DerivativeStructure>" name="createVector" startLine="823" endLine="827" />
    <method type="FieldVector3D<DerivativeStructure>" name="createAxis" startLine="829" endLine="833" />
    <method type="DerivativeStructure" name="createAngle" startLine="835" endLine="837" />
    <method type="void" name="checkVector" startLine="839" endLine="843" />
  </class>
</source>
