<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.linear">
        <import package="org.apache.commons.math3.exception.DimensionMismatchException"/>
        <import package="org.apache.commons.math3.exception.MaxCountExceededException"/>
        <import package="org.apache.commons.math3.exception.NullArgumentException"/>
        <import package="org.apache.commons.math3.exception.util.ExceptionContext"/>
        <import package="org.apache.commons.math3.util.IterationManager"/>
        <class name="ConjugateGradient" extends="PreconditionedIterativeLinearSolver" line="25">
            <javadoc line="25">
                &lt;p&gt;
                 * This is an implementation of the conjugate gradient method for{@link RealLinearOperator}. It follows closely the template by &lt;a
                 * href=&quot;#BARR1994&quot;&gt;Barrett et al. (1994)&lt;/a&gt; (figure 2.5). The linear system at
                 * hand is A &amp;middot; x = b, and the residual is r = b - A &amp;middot; x.
                 * &lt;/p&gt;
                 * &lt;h3&gt;&lt;a id=&quot;stopcrit&quot;&gt;Default stopping criterion&lt;/a&gt;&lt;/h3&gt;
                 * &lt;p&gt;
                 * A default stopping criterion is implemented. The iterations stop when || r ||
                 * &amp;le; &amp;delta; || b ||, where b is the right-hand side vector, r the current
                 * estimate of the residual, and &amp;delta; a user-specified tolerance. It should
                 * be noted that r is the so-called &lt;em&gt;updated&lt;/em&gt; residual, which might
                 * differ from the true residual due to rounding-off errors (see e.g. &lt;a
                 * href=&quot;#STRA2002&quot;&gt;Strakos and Tichy, 2002&lt;/a&gt;).
                 * &lt;/p&gt;
                 * &lt;h3&gt;Iteration count&lt;/h3&gt;
                 * &lt;p&gt;
                 * In the present context, an iteration should be understood as one evaluation
                 * of the matrix-vector product A &amp;middot; x. The initialization phase therefore
                 * counts as one iteration.
                 * &lt;/p&gt;
                 * &lt;h3&gt;&lt;a id=&quot;context&quot;&gt;Exception context&lt;/a&gt;&lt;/h3&gt;
                 * &lt;p&gt;
                 * Besides standard {@link DimensionMismatchException}, this class might throw{@link NonPositiveDefiniteOperatorException} if the linear operator or
                 * the preconditioner are not positive definite. In this case, the{@link ExceptionContext} provides some more information
                 * &lt;ul&gt;
                 * &lt;li&gt;key {@code &quot;operator&quot;} points to the offending linear operator, say L,&lt;/li&gt;
                 * &lt;li&gt;key {@code &quot;vector&quot;} points to the offending vector, say x, such that
                 * x&lt;sup&gt;T&lt;/sup&gt; &amp;middot; L &amp;middot; x &lt; 0.&lt;/li&gt;
                 * &lt;/ul&gt;
                 * &lt;/p&gt;
                 * &lt;h3&gt;References&lt;/h3&gt;
                 * &lt;dl&gt;
                 * &lt;dt&gt;&lt;a id=&quot;BARR1994&quot;&gt;Barret et al. (1994)&lt;/a&gt;&lt;/dt&gt;
                 * &lt;dd&gt;R. Barrett, M. Berry, T. F. Chan, J. Demmel, J. M. Donato, J. Dongarra,
                 * V. Eijkhout, R. Pozo, C. Romine and H. Van der Vorst,
                 * &lt;a href=&quot;http://www.netlib.org/linalg/html_templates/Templates.html&quot;&gt;&lt;em&gt;
                 * Templates for the Solution of Linear Systems: Building Blocks for Iterative
                 * Methods&lt;/em&gt;&lt;/a&gt;, SIAM&lt;/dd&gt;
                 * &lt;dt&gt;&lt;a id=&quot;STRA2002&quot;&gt;Strakos and Tichy (2002)
                 * &lt;dt&gt;
                 * &lt;dd&gt;Z. Strakos and P. Tichy, &lt;a
                 * href=&quot;http://etna.mcs.kent.edu/vol.13.2002/pp56-80.dir/pp56-80.pdf&quot;&gt;
                 * &lt;em&gt;On error estimation in the conjugate gradient method and why it works
                 * in finite precision computations&lt;/em&gt;&lt;/a&gt;, Electronic Transactions on
                 * Numerical Analysis 13: 56-80, 2002&lt;/dd&gt;
                 * &lt;/dl&gt;                
                <@version>
                    n $Id: ConjugateGradient.java 1416643 2012-12-03 19:37:14Z tn $                    
                </@version>
                <@since>
                    e 3.0                    
                </@since>
            </javadoc>
            <declaration name="OPERATOR" type="String" line="82"/>
            <javadoc line="82">
                Key for the &lt;a href=&quot;#context&quot;&gt;exception context&lt;/a&gt;.                
            </javadoc>
            <declaration name="VECTOR" type="String" line="85"/>
            <javadoc line="85">
                Key for the &lt;a href=&quot;#context&quot;&gt;exception context&lt;/a&gt;.                
            </javadoc>
            <declaration name="check" type="boolean" line="88"/>
            <javadoc line="88">
                {@code true} if positive-definiteness of matrix and preconditioner should
                 * be checked.                
            </javadoc>
            <declaration name="delta" type="double" line="94"/>
            <javadoc line="94">
                The value of &amp;delta;, for the default stopping criterion.                
            </javadoc>
            <javadoc line="97">
                Creates a new instance of this class, with &lt;a href=&quot;#stopcrit&quot;&gt;default
                 * stopping criterion&lt;/a&gt;.                
                <@param>
                    m maxIterations the maximum number of iterations                    
                </@param>
                <@param>
                    m delta the &delta; parameter for the default stopping criterion                    
                </@param>
                <@param>
                    m check {@code true} if positive definiteness of both matrix and
                     * preconditioner should be checked                    
                </@param>
            </javadoc>
            <method name="ConjugateGradient" type="constructor" line="107"/>
            <javadoc line="113">
                Creates a new instance of this class, with &lt;a href=&quot;#stopcrit&quot;&gt;default
                 * stopping criterion&lt;/a&gt; and custom iteration manager.                
                <@param>
                    m manager the custom iteration manager                    
                </@param>
                <@param>
                    m delta the &delta; parameter for the default stopping criterion                    
                </@param>
                <@param>
                    m check {@code true} if positive definiteness of both matrix and
                     * preconditioner should be checked                    
                </@param>
                <@throws>
                    s NullArgumentException if {@code manager} is {@code null}                    
                </@throws>
            </javadoc>
            <method name="ConjugateGradient" type="constructor" line="125"/>
            <javadoc line="131">
                Returns {@code true} if positive-definiteness should be checked for both
                 * matrix and preconditioner.                
                <@return>
                    n {@code true} if the tests are to be performed                    
                </@return>
            </javadoc>
            <method name="getCheck" type="boolean" line="137"/>
            <javadoc line="141">
                {@inheritDoc}                
                <@throws>
                    s NonPositiveDefiniteOperatorException if {@code a} or {@code m} is
                     * not positive definite                    
                </@throws>
            </javadoc>
            <method name="solveInPlace" type="RealVector" line="154">
                <comment line="155">
                    Initialization of default stopping criterion                    
                </comment>
                <comment line="155">
                    Initialization phase counts as one iteration.                    
                </comment>
                <comment line="155">
                    p and x are constructed as copies of x0, since presumably, the type                    
                </comment>
                <comment line="155">
                    of x is optimized for the calculation of the matrix-vector product                    
                </comment>
                <comment line="155">
                    A.x.                    
                </comment>
                <declaration name="manager" type="IterationManager" line="156"/>
                <declaration name="rmax" type="double" line="159"/>
                <declaration name="bro" type="RealVector" line="160"/>
                <declaration name="x" type="RealVector" line="167"/>
                <declaration name="xro" type="RealVector" line="168"/>
                <declaration name="p" type="RealVector" line="169"/>
                <declaration name="q" type="RealVector" line="170"/>
                <declaration name="r" type="RealVector" line="172"/>
                <declaration name="rro" type="RealVector" line="173"/>
                <declaration name="rnorm" type="double" line="174"/>
                <declaration name="z" type="RealVector" line="175"/>
                <scope line="176"/>
                <scope line="178"/>
                <declaration name="evt" type="IterativeLinearSolverEvent" line="181"/>
                <scope line="185"/>
                <declaration name="rhoPrev" type="double" line="189"/>
                <scope line="190">
                    <scope line="195"/>
                    <declaration name="rhoNext" type="double" line="198"/>
                    <scope line="199">
                        <declaration name="e" type="NonPositiveDefiniteOperatorException" line="200"/>
                        <declaration name="context" type="ExceptionContext" line="202"/>
                    </scope>
                    <scope line="207"/>
                    <scope line="209"/>
                    <declaration name="pq" type="double" line="213"/>
                    <scope line="214">
                        <declaration name="e" type="NonPositiveDefiniteOperatorException" line="215"/>
                        <declaration name="context" type="ExceptionContext" line="217"/>
                    </scope>
                    <declaration name="alpha" type="double" line="222"/>
                    <scope line="230"/>
                </scope>
            </method>
        </class>
    </source>