<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.distribution">
        <import package="java.util.List"/>
        <import package="java.util.ArrayList"/>
        <import package="org.apache.commons.math3.exception.NotPositiveException"/>
        <import package="org.apache.commons.math3.exception.MathArithmeticException"/>
        <import package="org.apache.commons.math3.util.Pair"/>
        <import package="org.junit.Assert"/>
        <import package="org.junit.Test"/>
        <class name="MultivariateNormalMixtureModelDistributionTest" line="27">
            <javadoc line="27">
                Test that demonstrates the use of {@link MixtureMultivariateRealDistribution}in order to create a mixture model composed of {@link MultivariateNormalDistributionnormal distributions}.                
            </javadoc>
            <method name="testNonUnitWeightSum" type="void" line="35">
                <declaration name="weights" type="double[]" line="36"/>
                <declaration name="means" type="double[][]" line="37"/>
                <declaration name="covariances" type="double[][][]" line="39"/>
                <declaration name="d" type="MultivariateNormalMixtureModelDistribution" line="43"/>
                <declaration name="comp" type="List&lt;Pair&lt;Double,MultivariateNormalDistribution&gt;&gt;" line="46"/>
            </method>
            <method name="testWeightSumOverFlow" type="void" line="53">
                <declaration name="weights" type="double[]" line="54"/>
                <declaration name="means" type="double[][]" line="55"/>
                <declaration name="covariances" type="double[][][]" line="57"/>
                <declaration name="d" type="MultivariateNormalMixtureModelDistribution" line="61"/>
            </method>
            <method name="testPreconditionPositiveWeights" type="void" line="66">
                <declaration name="negativeWeights" type="double[]" line="67"/>
                <declaration name="means" type="double[][]" line="68"/>
                <declaration name="covariances" type="double[][][]" line="70"/>
                <declaration name="d" type="MultivariateNormalMixtureModelDistribution" line="74"/>
            </method>
            <javadoc line="78">
                Test the accuracy of the density calculation.                
            </javadoc>
            <method name="testDensities" type="void" line="82">
                <comment line="83">
                    Test vectors                    
                </comment>
                <comment line="83">
                    Densities that we should get back.                    
                </comment>
                <comment line="83">
                    Calculated by assigning weights to multivariate normal distribution                    
                </comment>
                <comment line="83">
                    and summing                    
                </comment>
                <comment line="83">
                    values from dmvnorm function in R 2.15 CRAN package Mixtools v0.4.                    
                </comment>
                <comment line="83">
                    Like: .3*dmvnorm(val,mu1,sigma1)+.7*dmvnorm(val,mu2,sigma2)                    
                </comment>
                <declaration name="weights" type="double[]" line="83"/>
                <declaration name="means" type="double[][]" line="84"/>
                <declaration name="covariances" type="double[][][]" line="86"/>
                <declaration name="d" type="MultivariateNormalMixtureModelDistribution" line="90"/>
                <declaration name="testValues" type="double[][]" line="94"/>
                <declaration name="correctDensities" type="double[]" line="104"/>
                <scope line="109"/>
            </method>
            <javadoc line="114">
                Test the accuracy of sampling from the distribution.                
            </javadoc>
            <method name="testSampling" type="void" line="118">
                <declaration name="weights" type="double[]" line="119"/>
                <declaration name="means" type="double[][]" line="120"/>
                <declaration name="covariances" type="double[][][]" line="122"/>
                <declaration name="d" type="MultivariateNormalMixtureModelDistribution" line="126"/>
                <declaration name="correctSamples" type="double[][]" line="130"/>
                <declaration name="n" type="int" line="131"/>
                <declaration name="samples" type="double[][]" line="132"/>
                <scope line="134">
                    <scope line="135"/>
                </scope>
            </method>
            <javadoc line="141">
                Creates a mixture of Gaussian distributions.                
                <@param>
                    m weights Weights.                    
                </@param>
                <@param>
                    m means Means.                    
                </@param>
                <@param>
                    m covariances Covariances.                    
                </@param>
                <@return>
                    n the mixture distribution.                    
                </@return>
            </javadoc>
            <method name="create" type="MultivariateNormalMixtureModelDistribution" line="151">
                <params>
                    <param name="weights" type="double[]"/>
                    <param name="means" type="double[][]"/>
                    <param name="covariances" type="double[][][]"/>
                </params>
                <declaration name="mvns" type="List&lt;Pair&lt;Double,MultivariateNormalDistribution&gt;&gt;" line="152"/>
                <scope line="155">
                    <declaration name="dist" type="MultivariateNormalDistribution" line="156"/>
                </scope>
            </method>
            <javadoc line="164">
                Values used in {@link #testSampling()}.                
            </javadoc>
            <method name="getCorrectSamples" type="double[][]" line="167">
                <comment line="168">
                    These were sampled from the MultivariateNormalMixtureModelDistribution class                    
                </comment>
                <comment line="168">
                    with seed 50.                    
                </comment>
                <comment line="168">
                                        
                </comment>
                <comment line="168">
                    They were then fit to a MVN mixture model in R using mixtools.                    
                </comment>
                <comment line="168">
                                        
                </comment>
                <comment line="168">
                    The optimal parameters were:                    
                </comment>
                <comment line="168">
                    - component weights: {0.3595186, 0.6404814}                    
                </comment>
                <comment line="168">
                    - mean vectors: {-1.645879, 1.989797}, {3.474328, 7.782232}                    
                </comment>
                <comment line="168">
                    - covariance matrices:                    
                </comment>
                <comment line="168">
                    { 1.397738 -1.167732                    
                </comment>
                <comment line="168">
                    -1.167732 1.801782 }                    
                </comment>
                <comment line="168">
                    and                    
                </comment>
                <comment line="168">
                    { 3.934593 2.354787                    
                </comment>
                <comment line="168">
                    2.354787 4.428024 }                    
                </comment>
                <comment line="168">
                                        
                </comment>
                <comment line="168">
                    It is considered fairly close to the actual test parameters,                    
                </comment>
                <comment line="168">
                    considering that the sample size is only 100.                    
                </comment>
            </method>
        </class>
        <class name="MultivariateNormalMixtureModelDistribution" line="290">
            <extends class="MixtureMultivariateRealDistribution">
                <type_params>
                    <type_param name="MultivariateNormalDistribution"/>
                </type_params>
            </extends>
            <javadoc line="290">
                Class that implements a mixture of Gaussian ditributions.                
            </javadoc>
            <method name="MultivariateNormalMixtureModelDistribution" type="constructor" line="296">
                <params>
                    <param name="components" type="List<Pair<Double,MultivariateNormalDistribution>>"/>
                </params>
            </method>
        </class>
    </source>