<?xml version="1.0" encoding="UTF-8"?>
    <source package="org.apache.commons.math3.stat.regression">
        <import package="org.apache.commons.math3.TestUtils"/>
        <import package="org.apache.commons.math3.linear.DefaultRealMatrixChangingVisitor"/>
        <import package="org.apache.commons.math3.linear.MatrixUtils"/>
        <import package="org.apache.commons.math3.linear.RealMatrix"/>
        <import package="org.apache.commons.math3.linear.Array2DRowRealMatrix"/>
        <import package="org.apache.commons.math3.linear.RealVector"/>
        <import package="org.apache.commons.math3.stat.StatUtils"/>
        <import package="org.junit.Assert"/>
        <import package="org.junit.Before"/>
        <import package="org.junit.Test"/>
        <class name="OLSMultipleLinearRegressionTest" extends="MultipleLinearRegressionAbstractTest" line="31">
            <comment line="32">
                This is a test based on the Wampler1 data set                
            </comment>
            <comment line="32">
                This is a test based on the Wampler2 data set                
            </comment>
            <comment line="32">
                This is a test based on the Wampler3 data set                
            </comment>
            <comment line="32">
                This is a test based on the Wampler4 data set                
            </comment>
            <declaration name="y" type="double[]" line="33"/>
            <declaration name="x" type="double[][]" line="34"/>
            <method name="setUp" type="void" line="38"/>
            <method name="createRegression" type="OLSMultipleLinearRegression" line="51">
                <declaration name="regression" type="OLSMultipleLinearRegression" line="52"/>
            </method>
            <method name="getNumberOfRegressors" type="int" line="58"/>
            <method name="getSampleSize" type="int" line="63"/>
            <method name="cannotAddSampleDataWithSizeMismatch" type="void" line="68">
                <declaration name="y" type="double[]" line="69"/>
                <declaration name="x" type="double[][]" line="70"/>
            </method>
            <method name="testPerfectFit" type="void" line="76">
                <declaration name="betaHat" type="double[]" line="77"/>
                <declaration name="residuals" type="double[]" line="81"/>
                <declaration name="errors" type="RealMatrix" line="84"/>
                <declaration name="s" type="double[]" line="86"/>
                <declaration name="referenceVariance" type="RealMatrix" line="87"/>
                <anonymous_class line="88">
                    <method name="visit" type="double" line="90">
                        <scope line="91"/>
                        <declaration name="x" type="double" line="94"/>
                    </method>
                </anonymous_class>
            </method>
            <javadoc line="105">
                Test Longley dataset against certified values provided by NIST.
                 * Data Source: J. Longley (1967) &quot;An Appraisal of Least Squares
                 * Programs for the Electronic Computer from the Point of View of the User&quot;
                 * Journal of the American Statistical Association, vol. 62. September,
                 * pp. 819-841.
                 * Certified values (and data) are from NIST:
                 * http://www.itl.nist.gov/div898/strd/lls/data/LINKS/DATA/Longley.dat                
            </javadoc>
            <method name="testLongly" type="void" line="116">
                <comment line="117">
                    Y values are first, then independent vars                    
                </comment>
                <comment line="117">
                    Each row is one observation                    
                </comment>
                <comment line="117">
                    Estimate the model                    
                </comment>
                <comment line="117">
                    Check expected beta values from NIST                    
                </comment>
                <comment line="117">
                    29.15146461355}, 2E-8); //                    
                </comment>
                <comment line="117">
                    Check expected residuals from R                    
                </comment>
                <comment line="117">
                    Check standard errors from NIST                    
                </comment>
                <comment line="117">
                    Check regression standard error against R                    
                </comment>
                <comment line="117">
                    Check R-Square statistics against R                    
                </comment>
                <comment line="117">
                    Estimate model without intercept                    
                </comment>
                <comment line="117">
                    Check expected beta values from R                    
                </comment>
                <comment line="117">
                    Check standard errors from R                    
                </comment>
                <comment line="117">
                    Check expected residuals from R                    
                </comment>
                <comment line="117">
                    Check regression standard error against R                    
                </comment>
                <comment line="117">
                    Check R-Square statistics against R                    
                </comment>
                <declaration name="design" type="double[]" line="119"/>
                <declaration name="nobs" type="int" line="138"/>
                <declaration name="nvars" type="int" line="139"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="142"/>
                <declaration name="betaHat" type="double[]" line="146"/>
                <declaration name="residuals" type="double[]" line="154"/>
                <declaration name="errors" type="double[]" line="165"/>
            </method>
            <javadoc line="218">
                Test R Swiss fertility dataset against R.
                 * Data Source: R datasets package                
            </javadoc>
            <method name="testSwissFertility" type="void" line="223">
                <comment line="224">
                    Estimate the model                    
                </comment>
                <comment line="224">
                    Check expected beta values from R                    
                </comment>
                <comment line="224">
                    Check expected residuals from R                    
                </comment>
                <comment line="224">
                    Check standard errors from R                    
                </comment>
                <comment line="224">
                    Check regression standard error against R                    
                </comment>
                <comment line="224">
                    Check R-Square statistics against R                    
                </comment>
                <comment line="224">
                    Estimate the model with no intercept                    
                </comment>
                <comment line="224">
                    Check expected beta values from R                    
                </comment>
                <comment line="224">
                    Check expected residuals from R                    
                </comment>
                <comment line="224">
                    Check standard errors from R                    
                </comment>
                <comment line="224">
                    Check regression standard error against R                    
                </comment>
                <comment line="224">
                    Check R-Square statistics against R                    
                </comment>
                <declaration name="design" type="double[]" line="224"/>
                <declaration name="nobs" type="int" line="274"/>
                <declaration name="nvars" type="int" line="275"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="278"/>
                <declaration name="betaHat" type="double[]" line="282"/>
                <declaration name="residuals" type="double[]" line="291"/>
                <declaration name="errors" type="double[]" line="312"/>
            </method>
            <javadoc line="371">
                Test hat matrix computation                
            </javadoc>
            <method name="testHat" type="void" line="376">
                <comment line="377">
                    This example is from &quot;The Hat Matrix in Regression and ANOVA&quot;,
                     David C. Hoaglin and Roy E. Welsch,
                     The American Statistician, Vol. 32, No. 1 (Feb., 1978), pp. 17-22.                    
                </comment>
                <comment line="377">
                    Estimate the model                    
                </comment>
                <comment line="377">
                    Reference data is upper half of symmetric hat matrix                    
                </comment>
                <comment line="377">
                    Check against reference data and verify symmetry                    
                </comment>
                <comment line="377">
                    Verify that residuals computed using the hat matrix are close to
                     what we get from direct computation, i.e. r = (I - H) y                    
                </comment>
                <declaration name="design" type="double[]" line="384"/>
                <declaration name="nobs" type="int" line="397"/>
                <declaration name="nvars" type="int" line="398"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="401"/>
                <declaration name="hat" type="RealMatrix" line="404"/>
                <declaration name="referenceData" type="double[]" line="407"/>
                <declaration name="k" type="int" line="421"/>
                <scope line="422">
                    <scope line="423"/>
                </scope>
                <declaration name="residuals" type="double[]" line="434"/>
                <declaration name="I" type="RealMatrix" line="435"/>
                <declaration name="hatResiduals" type="double[]" line="436"/>
            </method>
            <javadoc line="440">
                test calculateYVariance                
            </javadoc>
            <method name="testYVariance" type="void" line="444">
                <comment line="445">
                    assumes: y = new double[]{11.0, 12.0, 13.0, 14.0, 15.0, 16.0};                    
                </comment>
                <declaration name="model" type="OLSMultipleLinearRegression" line="448"/>
            </method>
            <javadoc line="453">
                Verifies that calculateYVariance and calculateResidualVariance return consistent
                 * values with direct variance computation from Y, residuals, respectively.                
            </javadoc>
            <method name="checkVarianceConsistency" type="void" line="457">
                <comment line="458">
                    Check Y variance consistency                    
                </comment>
                <comment line="458">
                    Check residual variance consistency                    
                </comment>
                <declaration name="residuals" type="double[]" line="462"/>
                <declaration name="X" type="RealMatrix" line="463"/>
            </method>
            <javadoc line="470">
                Verifies that setting X and Y separately has the same effect as newSample(X,Y).                
            </javadoc>
            <method name="testNewSample2" type="void" line="474">
                <comment line="475">
                    No intercept                    
                </comment>
                <declaration name="y" type="double[]" line="475"/>
                <declaration name="x" type="double[][]" line="476"/>
                <declaration name="regression" type="OLSMultipleLinearRegression" line="482"/>
                <declaration name="combinedX" type="RealMatrix" line="484"/>
                <declaration name="combinedY" type="RealVector" line="485"/>
            </method>
            <method name="testNewSampleDataYNull" type="void" line="503"/>
            <method name="testNewSampleDataXNull" type="void" line="508"/>
            <method name="testWampler1" type="void" line="517">
                <declaration name="data" type="double[]" line="518"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="540"/>
                <declaration name="nvars" type="int" line="543"/>
                <declaration name="nobs" type="int" line="544"/>
                <declaration name="tmp" type="double[]" line="545"/>
                <declaration name="off" type="int" line="546"/>
                <declaration name="off2" type="int" line="547"/>
                <scope line="548"/>
                <declaration name="betaHat" type="double[]" line="559"/>
                <declaration name="se" type="double[]" line="566"/>
            </method>
            <method name="testWampler2" type="void" line="585">
                <declaration name="data" type="double[]" line="586"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="608"/>
                <declaration name="nvars" type="int" line="611"/>
                <declaration name="nobs" type="int" line="612"/>
                <declaration name="tmp" type="double[]" line="613"/>
                <declaration name="off" type="int" line="614"/>
                <declaration name="off2" type="int" line="615"/>
                <scope line="616"/>
                <declaration name="betaHat" type="double[]" line="627"/>
                <declaration name="se" type="double[]" line="636"/>
            </method>
            <method name="testWampler3" type="void" line="653">
                <comment line="654">
                    112324854679312}, 1E-8); //                    
                </comment>
                <declaration name="data" type="double[]" line="654"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="677"/>
                <declaration name="nvars" type="int" line="678"/>
                <declaration name="nobs" type="int" line="679"/>
                <declaration name="tmp" type="double[]" line="680"/>
                <declaration name="off" type="int" line="681"/>
                <declaration name="off2" type="int" line="682"/>
                <scope line="683"/>
                <declaration name="betaHat" type="double[]" line="694"/>
                <declaration name="se" type="double[]" line="704"/>
            </method>
            <method name="testWampler4" type="void" line="722">
                <declaration name="data" type="double[]" line="723"/>
                <declaration name="model" type="OLSMultipleLinearRegression" line="746"/>
                <declaration name="nvars" type="int" line="747"/>
                <declaration name="nobs" type="int" line="748"/>
                <declaration name="tmp" type="double[]" line="749"/>
                <declaration name="off" type="int" line="750"/>
                <declaration name="off2" type="int" line="751"/>
                <scope line="752"/>
                <declaration name="betaHat" type="double[]" line="763"/>
                <declaration name="se" type="double[]" line="773"/>
            </method>
        </class>
    </source>