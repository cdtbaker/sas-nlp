<?xml version="1.0" encoding="UTF-8"?>
    <source package="Jama">
        <class name="CholeskyDecomposition" line="3">
            <comment line="4">
                ------------------------
                Class variables
                 ------------------------                
            </comment>
            <comment line="4">
                ------------------------
                Constructor
                 ------------------------                
            </comment>
            <comment line="4">
                ------------------------
                Temporary, experimental code.
                 ------------------------ \
                
                \ Right Triangular Cholesky Decomposition.
                &lt;P&gt;
                For a symmetric, positive definite matrix A, the Right Cholesky
                decomposition is an upper triangular matrix R so that A = R&apos;R.
                This constructor computes R with the Fortran inspired column oriented
                algorithm used in LINPACK and MATLAB.  In Java, we suspect a row oriented,
                lower triangular decomposition is faster.  We have temporarily included
                this constructor here until timing experiments confirm this suspicion.
                \
                
                \ Array for internal storage of right triangular decomposition. \
                private transient double[][] R;
                
                \ Cholesky algorithm for symmetric and positive definite matrix.
                @param  A           Square, symmetric matrix.
                @param  rightflag   Actual value ignored.
                @return             Structure to access R and isspd flag.
                \
                
                public CholeskyDecomposition (Matrix Arg, int rightflag) {
                 Initialize.
                double[][] A = Arg.getArray();
                n = Arg.getColumnDimension();
                R = new double[n][n];
                isspd = (Arg.getColumnDimension() == n);
                 Main loop.
                for (int j = 0; j &lt; n; j++) {
                double d = 0.0;
                for (int k = 0; k &lt; j; k++) {
                double s = A[k][j];
                for (int i = 0; i &lt; k; i++) {
                s = s - R[i][k]R[i][j];
                }
                R[k][j] = s = sR[k][k];
                d = d + ss;
                isspd = isspd &amp; (A[k][j] == A[j][k]);
                }
                d = A[j][j] - d;
                isspd = isspd &amp; (d &gt; 0.0);
                R[j][j] = Math.sqrt(Math.max(d,0.0));
                for (int k = j+1; k &lt; n; k++) {
                R[k][j] = 0.0;
                }
                }
                }
                
                \ Return upper triangular factor.
                @return     R
                \
                
                public Matrix getR () {
                return new Matrix(R,n,n);
                }
                
                \ ------------------------
                End of temporary code.
                 ------------------------ 
                
                 ------------------------
                Public Methods
                 ------------------------ 
                
                 Is the matrix symmetric and positive definite?
                @return     true if A is symmetric and positive definite.                
            </comment>
            <comment line="4">
                ------------------------
                Public Methods
                 ------------------------                
            </comment>
            <implements interface="java.io.Serializable"/>
            <javadoc line="3">
                Cholesky Decomposition.
                 * &lt;P&gt;
                 * For a symmetric, positive definite matrix A, the Cholesky decomposition
                 * is an lower triangular matrix L so that A = L*L&apos;.
                 * &lt;P&gt;
                 * If the matrix is not symmetric or positive definite, the constructor
                 * returns a partial decomposition and sets an internal flag that may
                 * be queried by the isSPD() method.                
            </javadoc>
            <declaration name="L" type="double[][]" line="19"/>
            <javadoc line="19">
                Array for internal storage of decomposition.                
                <@serial>
                    l internal array storage.                    
                </@serial>
            </javadoc>
            <declaration name="n" type="int" line="24"/>
            <javadoc line="24">
                Row and column dimension (square matrix).                
                <@serial>
                    l matrix dimension.                    
                </@serial>
            </javadoc>
            <declaration name="isspd" type="boolean" line="29"/>
            <javadoc line="29">
                Symmetric and positive definite flag.                
                <@serial>
                    l is symmetric and positive definite flag.                    
                </@serial>
            </javadoc>
            <javadoc line="38">
                Cholesky algorithm for symmetric and positive definite matrix.
                 * Structure to access L and isspd flag.                
                <@param>
                    m Arg   Square, symmetric matrix.                    
                </@param>
            </javadoc>
            <method name="CholeskyDecomposition" type="constructor" line="43">
                <comment line="44">
                    Initialize.                    
                </comment>
                <comment line="44">
                    Main loop.                    
                </comment>
                <declaration name="A" type="double[][]" line="47"/>
                <scope line="52">
                    <declaration name="Lrowj" type="double[]" line="53"/>
                    <declaration name="d" type="double" line="54"/>
                    <scope line="55">
                        <declaration name="Lrowk" type="double[]" line="56"/>
                        <declaration name="s" type="double" line="57"/>
                        <scope line="58"/>
                    </scope>
                    <scope line="68"/>
                </scope>
            </method>
            <javadoc line="140">
                Is the matrix symmetric and positive definite?                
                <@return>
                    n     true if A is symmetric and positive definite.                    
                </@return>
            </javadoc>
            <method name="isSPD" type="boolean" line="144"/>
            <javadoc line="148">
                Return triangular factor.                
                <@return>
                    n     L                    
                </@return>
            </javadoc>
            <method name="getL" type="Matrix" line="152"/>
            <javadoc line="156">
                Solve A*X = B                
                <@param>
                    m B   A Matrix with as many rows as A and any number of columns.                    
                </@param>
                <@return>
                    n     X so that L*L'*X = B                    
                </@return>
                <@exception>
                    n IllegalArgumentException  Matrix row dimensions must agree.                    
                </@exception>
                <@exception>
                    n RuntimeException  Matrix is not symmetric positive definite.                    
                </@exception>
            </javadoc>
            <method name="solve" type="Matrix" line="163">
                <comment line="164">
                    Copy right hand side.                    
                </comment>
                <comment line="164">
                    Solve L*Y = B;                    
                </comment>
                <comment line="164">
                    Solve L&apos;*X = Y;                    
                </comment>
                <scope line="164"/>
                <scope line="167"/>
                <declaration name="X" type="double[][]" line="172"/>
                <declaration name="nx" type="int" line="173"/>
                <scope line="176">
                    <scope line="177">
                        <scope line="178"/>
                    </scope>
                </scope>
                <scope line="186">
                    <scope line="187">
                        <scope line="188"/>
                    </scope>
                </scope>
            </method>
            <declaration name="serialVersionUID" type="long" line="198"/>
        </class>
    </source>