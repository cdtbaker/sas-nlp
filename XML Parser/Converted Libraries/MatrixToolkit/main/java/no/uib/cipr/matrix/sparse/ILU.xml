<?xml version="1.0" encoding="UTF-8"?>
<source package="no.uib.cipr.matrix.sparse">
  <import name="no.uib.cipr.matrix.DenseVector" />
  <import name="no.uib.cipr.matrix.Matrix" />
  <import name="no.uib.cipr.matrix.Vector" />
  <class name="ILU" startLine="27">
    <implements name="Preconditioner" />
    <javadoc>
      <text>* ILU(0) preconditioner using a compressed row matrix as internal storage</text>
    </javadoc>
    <javadoc>
      <text>* Factorisation matrix</text>
    </javadoc>
    <declaration type="CompRowMatrix" name="LU" />
    <javadoc>
      <text>* The L and U factors</text>
    </javadoc>
    <declaration type="Matrix" name="L" />
    <javadoc>
      <text>* Temporary vector for solving the factorised system</text>
    </javadoc>
    <declaration type="Vector" name="y" />
    <javadoc>
      <text>* Sets up the ILU preconditioner</text>
      <param>LUMatrix to use internally. For best performance, its non-zero
 * pattern must conform to that of the system matrix</param>
    </javadoc>
    <method type="constructor" name="ILU" startLine="54" endLine="62">
      <declaration type="int" name="n" />
    </method>
    <method type="Vector" name="apply" startLine="64" endLine="70">
      <comment>Ly = b, y = L\b</comment>
      <comment>Ux = L\b = y</comment>
    </method>
    <method type="Vector" name="transApply" startLine="72" endLine="78">
      <comment>U'y = b, y = U'\b</comment>
      <comment>L'x = U'\b = y</comment>
    </method>
    <method type="void" name="setMatrix" startLine="80" endLine="84" />
    <method type="void" name="factor" startLine="86" endLine="125">
      <declaration type="int" name="n" />
      <declaration type="int[]" name="colind" />
      <declaration type="int[]" name="rowptr" />
      <declaration type="double[]" name="data" />
      <declaration type="int[]" name="diagind" />
      <scope startLine="99" endLine="121">
        <declaration type="int" name="index" />
        <declaration type="double" name="LUii" />
        <declaration type="double" name="LUki" />
        <scope startLine="113" endLine="120" />
        <comment>Get the current diagonal entry</comment>
        <comment>Elimination factor</comment>
        <comment>Traverse the sparse row i, reducing on row k</comment>
      </scope>
      <comment>Internal CRS matrix storage</comment>
      <comment>Find the indices to the diagonal entries</comment>
      <comment>Go down along the main diagonal</comment>
    </method>
    <method type="int[]" name="findDiagonalIndices" startLine="127" endLine="140">
      <declaration type="int[]" name="diagind" />
      <scope startLine="130" endLine="137" />
    </method>
  </class>
</source>
