<?xml version="1.0" encoding="UTF-8"?>
    <source package="no.uib.cipr.matrix.sparse">
        <import package="no.uib.cipr.matrix.DenseVector"/>
        <import package="no.uib.cipr.matrix.Matrix"/>
        <import package="no.uib.cipr.matrix.Vector"/>
        <class name="ILU" line="27">
            <implements interface="Preconditioner"/>
            <javadoc line="27">
                ILU(0) preconditioner using a compressed row matrix as internal storage                
            </javadoc>
            <declaration name="LU" type="CompRowMatrix" line="32"/>
            <javadoc line="32">
                Factorisation matrix                
            </javadoc>
            <declaration name="L" type="Matrix" line="37"/>
            <javadoc line="37">
                The L and U factors                
            </javadoc>
            <declaration name="y" type="Vector" line="42"/>
            <javadoc line="42">
                Temporary vector for solving the factorised system                
            </javadoc>
            <javadoc line="47">
                Sets up the ILU preconditioner                
                <@param>
                    m LUMatrix to use internally. For best performance, its non-zero
                      pattern must conform to that of the system matrix                    
                </@param>
            </javadoc>
            <method name="ILU" type="constructor" line="54">
                <params>
                    <param name="LU" type="CompRowMatrix"/>
                </params>
                <declaration name="n" type="int" line="60"/>
            </method>
            <method name="apply" type="Vector" line="64">
                <params>
                    <param name="b" type="Vector"/>
                    <param name="x" type="Vector"/>
                </params>
                <comment line="65">
                    Ly = b, y = L\b                    
                </comment>
                <comment line="65">
                    Ux = L\b = y                    
                </comment>
            </method>
            <method name="transApply" type="Vector" line="72">
                <params>
                    <param name="b" type="Vector"/>
                    <param name="x" type="Vector"/>
                </params>
                <comment line="73">
                    U&apos;y = b, y = U&apos;\b                    
                </comment>
                <comment line="73">
                    L&apos;x = U&apos;\b = y                    
                </comment>
            </method>
            <method name="setMatrix" type="void" line="80">
                <params>
                    <param name="A" type="Matrix"/>
                </params>
            </method>
            <method name="factor" type="void" line="86">
                <comment line="87">
                    Internal CRS matrix storage                    
                </comment>
                <comment line="87">
                    Find the indices to the diagonal entries                    
                </comment>
                <comment line="87">
                    Go down along the main diagonal                    
                </comment>
                <declaration name="n" type="int" line="87"/>
                <declaration name="colind" type="int[]" line="90"/>
                <declaration name="rowptr" type="int[]" line="91"/>
                <declaration name="data" type="double[]" line="92"/>
                <declaration name="diagind" type="int[]" line="95"/>
                <scope line="99">
                    <declaration name="index" type="int" line="102"/>
                    <declaration name="LUii" type="double" line="103"/>
                    <declaration name="LUki" type="double" line="110"/>
                    <scope line="113"/>
                </scope>
            </method>
            <method name="findDiagonalIndices" type="int[]" line="127">
                <params>
                    <param name="m" type="int"/>
                    <param name="colind" type="int[]"/>
                    <param name="rowptr" type="int[]"/>
                </params>
                <declaration name="diagind" type="int[]" line="128"/>
                <scope line="130"/>
            </method>
        </class>
    </source>